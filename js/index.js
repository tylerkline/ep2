/**
 * @license RequireJS domReady 1.0.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
/**
 * @license RequireJS domReady 1.0.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
/**
 * @license RequireJS order 0.27.1 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
/*!
 * jQuery UI 1.8.18
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI Widget 1.8.18
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
/*!
 * jQuery UI Mouse 1.8.18
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
/*!!
 * Title Alert 0.7
 * 
 * Copyright (c) 2009 ESN | http://esn.me
 * Jonatan Heyman | http://heyman.info
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */
/* 
 * @name jQuery.titleAlert
 * @projectDescription Show alert message in the browser title bar
 * @author Jonatan Heyman | http://heyman.info
 * @version 0.7.0
 * @license MIT License
 * 
 * @id jQuery.titleAlert
 * @param {String} text The text that should be flashed in the browser title
 * @param {Object} settings Optional set of settings.
 *	 @option {Number} interval The flashing interval in milliseconds (default: 500).
 *	 @option {Number} originalTitleInterval Time in milliseconds that the original title is diplayed for. If null the time is the same as interval (default: null).
 *	 @option {Number} duration The total lenght of the flashing before it is automatically stopped. Zero means infinite (default: 0).
 *	 @option {Boolean} stopOnFocus If true, the flashing will stop when the window gets focus (default: true).
 *   @option {Boolean} stopOnMouseMove If true, the flashing will stop when the browser window recieves a mousemove event. (default:false).
 *	 @option {Boolean} requireBlur Experimental. If true, the call will be ignored unless the window is out of focus (default: false).
 *                                 Known issues: Firefox doesn't recognize tab switching as blur, and there are some minor IE problems as well.
 *
 * @example $.titleAlert("Hello World!", {requireBlur:true, stopOnFocus:true, duration:10000, interval:500});
 * @desc Flash title bar with text "Hello World!", if the window doesn't have focus, for 10 seconds or until window gets focused, with an interval of 500ms
 */
/*! 
 * jquery.event.drag - v 2.0.0 
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
/*! Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.4
 * 
 * Requires: 1.2.2+
 */
/*!
 * jScrollPane - v2.0.0beta11 - 2011-07-04
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
/*!
 * jQuery idleTimer plugin
 * version 0.9.100511
 * by Paul Irish.
 *   http://github.com/paulirish/yui-misc/tree/
 * MIT license

 * adapted from YUI idle timer by nzakas:
 *   http://github.com/nzakas/yui-misc/
*/
/**
 * @license RequireJS text 1.0.2 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
/** @license
 * RequireJS plugin for async dependency load like JSONP and Google Maps
 * Author: Miller Medeiros
 * Version: 0.1.1 (2011/11/17)
 * Released under the MIT license
 */
define("coreglobals",["require"],function(a){var b={};return b.FORM_WIDGET_SELECTOR="-1",b.FORM_MY_ACCOUNT="808aa364-32dc-4f57-919a-44b3accbb1d1",b.WAIT_SPINNER_TIMEOUT=200,b.CollaborationStatus="Online",b.CurrentAccountID="",b.Authenticated=!1,b.PosConnection=undefined,b.Plong=undefined,b.ForceAjax=!1,b.AddSubscription=undefined,b.AddSubscriptions=undefined,b.ChatManager=undefined,b.NetworkSubscription=function(){this.NotificationName="",this.Callback=undefined},b.NewNetworkSubscription=function(a,c){var d=new b.NetworkSubscription;return d.NotificationName=a,d.Callback=c,d},b}),define("floorchart/contextHelper",["require"],function(a){var b={};return b.TempCanvas={Canvas:undefined,Context:undefined},b.PathBezierPointsXYOntoContext=function(a,b){var c=b;a.beginPath(),a.moveTo(c[0],c[1]);var d=2,e=c.length;while(d<e)a.bezierCurveTo(c[d],c[d+1],c[d+2],c[d+3],c[d+4],c[d+5]),d+=6},b.PathEllipseFromRectOntoContext=function(a,b){var c=.5522848,d=b.Left,e=b.Top,f=b.Right,g=b.Bottom,h=(b.Bottom-b.Top+1)/2,i=h*c,j=(b.Right-b.Left+1)/2,k=j*c,l=d+j,m=e+h;a.beginPath(),a.moveTo(d,e+h),a.bezierCurveTo(d,m-i,l-k,e,d+j,e),a.bezierCurveTo(l+k,e,f,m-i,f,e+h),a.bezierCurveTo(f,m+i,l+k,g,f-j,g),a.bezierCurveTo(l-k,g,d,m+i,d,g-h),a.closePath()},b.PathRoundedRectOntoContext=function(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath()},b.TempCanvas.Canvas=document.createElement("canvas"),b.TempCanvas.Context=b.TempCanvas.Canvas.getContext("2d"),b}),define("floorchart/utilities",["require"],function(a){function g(a){var c=[];for(var d in a)c.push(b.DeepCopy(a[d]));return c}function h(a){if(a===undefined||a===null)return a;if(!a.New)throw new Error("'New' function not implemented by "+b.GetObjectName(a));var c=a.New.call(a);for(var d in a){if(b.IsFunction(a[d]))continue;c[d]=b.DeepCopy(a[d])}return c}var b={},c="_xObjName";b.KeyCodes={Zero:48,One:49,Two:50,Three:51,Four:52,Five:53,Six:54,Seven:55,Eight:56,Nine:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Backspace:8,Delete:46,Enter:13,Escape:27,Space:32,Tab:9};var d=b.KeyCodes;b.IsDigitChar=function(a){return a>=48&&a<=57},b.SetObjectName=function(a,b){a.prototype[c]=b};var e=b.SetObjectName;b.KeyInfo=function(){this.CharCode=0,this.KeyCode=0,this.AltKey=!1,this.CtrlKey=!1,this.ShiftKey=!1},e(b.KeyInfo,"KeyInfo");var f=b.KeyInfo;return b.NewKeyInfo=function(a){var b=new f;return b.CharCode=a.charCode,b.KeyCode=a.keyCode,b.AltKey=a.altKey,b.CtrlKey=a.ctrlKey,b.ShiftKey=a.shiftKey,b},b.ConvertToElement=function(a){return typeof a=="string"?document.getElementById(a):a},b.CopyIntoJsonObject=function(a,c){for(var d in c){if(!c.hasOwnProperty(d))continue;if(!b.IsValid(a[d]))continue;if(b.IsArray(a[d])){c[d]=b.ExportArrayToJson(a[d]);continue}if(b.IsObject(a[d])){c[d]=b.ExportObjectToJson(a[d]);continue}c[d]=a[d]}},b.DeepCopy=function(a){return b.IsArray(a)?g(srcObj[n]):b.IsObject(a)?h(srcObj[n]):a},b.ExportArrayToJson=function(a){var c=[];for(var d in a){if(b.IsArray(a[d])){c.push(b.ExportArrayToJson(a[d]));continue}if(b.IsObject(a[d])){c.push(b.ExportObjectToJson(a[d]));continue}c.push(a[d])}return c},b.ExportObjectToJson=function(a){return b.IsValid(a.ExportToJson)?a.ExportToJson.call(a):undefined},b.FormatString=function(){for(var a=1;a<arguments.length;a++){var b=new RegExp("\\{"+(a-1)+"\\}","gm");arguments[0]=arguments[0].replace(b,arguments[a])}return arguments[0]},b.GenerateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*15|0,c=a=="x"?b:b&3|8;return c.toString(16)})},b.GetObjectName=function(a){return a&&a[c]?a[c]:"Not Defined"},b.InheritFields=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},b.InheritFunctions=function(a,b){for(var c in b.prototype)b.prototype.hasOwnProperty(c)&&(a.prototype[c]=b.prototype[c])},b.IsNotValid=function(a){return a==undefined||a==null},b.IsValid=function(a){return a!==undefined&&a!==null},b.IsArray=function(a){return typeof a=="object"&&a&&a instanceof Array},b.IsFunction=function(a){return typeof a=="function"},b.IsObject=function(a){return typeof a=="object"},b.RemoveChildElements=function(a){if(!a.hasChildNodes())return;while(a.childNodes.length>=1)a.removeChild(a.firstChild)},b.SetElementDisplay=function(a,c){var d=b.ConvertToElement(a);c?d.style.display="block":d.style.display="none"},b.MissingImplementationException=function(a,c){return new Error(b.FormatString("Object '{0}' does not implement '{1}'",b.GetObjectName(c),a))},b.SetObjectName(b.MissingImplementationException,"MissingImplementationException"),b}),define("floorchart/graphics",["require","./contextHelper","./utilities"],function(a){function j(a,b){this.addColorStop(a,b.CSSValue)}var b=a("./contextHelper"),c=a("./utilities"),d={};d.RepeatStyle={NoRepeat:"no-repeat",Repeat:"repeat",RepeatX:"repeat-x",RepeatY:"repeat-y"};var e=d.RepeatStyle;d.Color=function(){this.Hue=0,this.Saturation=0,this.Lightness=0,this.Alpha=1,this.CSSValue=""},c.SetObjectName(d.Color,"Color");var f=d.Color;d.Color.prototype.Lighten=function(a){var b=Math.max(Math.min(this.Lightness+a,100),0);return h(this.Hue,this.Saturation,b,this.Alpha)},d.Color.prototype.updateCSSValue=function(){this.Alpha==1?this.CSSValue="HSL("+this.Hue+","+this.Saturation+"%,"+this.Lightness+"%)":this.CSSValue="HSLA("+this.Hue+","+this.Saturation+"%,"+this.Lightness+"%,"+this.Alpha+")"},d.NewColorHSL=function(a,b,c){var d=new f;return d.Hue=a,d.Saturation=b,d.Lightness=c,d.updateCSSValue(),d};var g=d.NewColorHSL;d.NewColorHSLA=function(a,b,c,d){var e=new f;return e.Hue=a,e.Saturation=b,e.Lightness=c,e.Alpha=d,e.updateCSSValue(),e};var h=d.NewColorHSLA;d.Font=function(){this.Family="sans-serif",this.Size=10,this.SizeUnits="pt",this.Italic=!1,this.Bold=!1,this.CSSValue=""},c.SetObjectName(d.Font,"Font");var i=d.Font;i.prototype.updateCSSValue=function(){var a="";this.Italic&&(a+="italic "),this.Bold&&(a+="bold "),a+=this.Size+this.SizeUnits+" ",a+=this.Family,this.CSSValue=a},d.NewFontFS=function(a,b,c){var d=new i;return d.Family=a,d.Size=b,d.SizeUnits=c,d.updateCSSValue(),d},d.NewFontFSIB=function(a,b,c,d,e){var f=new i;return f.Family=a,f.Size=b,f.SizeUnits=c,f.Italic=d,f.Bold=e,f.updateCSSValue(),f},d.NewGradientLinear=function(a,c,d,e){var f=b.TempCanvas.Context.createLinearGradient(a,c,d,e);return f.AddColorStop=j,f},d.NewGradientRadial=function(a,c,d,e,f,g){var h=b.TempCanvas.Context.createRadialGradient(a,c,d,e,f,g);return h.AddColorStop=j,h},d.NewPattern=function(a,c){return b.TempCanvas.Context.createPattern(a,c)},d.PenType={None:"None",Color:"Color"};var k=d.PenType;d.Pen=function(){this.Type=k.None,this.Width=1,this.Color=undefined},c.SetObjectName(d.Pen,"Pen");var l=d.Pen;d.NewPenColor=function(a){if(a==d.ColorNone)return d.PenNone;var b=new l;return b.Type=k.Color,b.Color=a,b},d.Surface=function(){},c.SetObjectName(d.Surface,"Surface");var m=d.Surface;return d.Surface.prototype.Clear=function(){throw c.MissingImplementationException("Surface.Clear",this)},d.Surface.prototype.DrawRect=function(a,b,d){throw c.MissingImplementationException("Surface.DrawRectangle",this)},d.Surface.prototype.DrawShape=function(a,b){throw c.MissingImplementationException("Surface.DrawShape",this)},d.Surface.prototype.IntersectClipWithRect=function(a){throw c.MissingImplementationException("Surface.IntersectClipWithRect",this)},d.Surface.prototype.RestoreState=function(){throw c.MissingImplementationException("Surface.RestoreState",this)},d.Surface.prototype.SaveState=function(){throw c.MissingImplementationException("Surface.SaveState",this)},d.Surface.prototype.SetOrigin=function(a){throw c.MissingImplementationException("Surface.SetOrigin",this)},d.Surface.prototype.Translate=function(a,b){throw c.MissingImplementationException("Surface.Translate",this)},d.GetTextWidth=function(a,c){return b.TempCanvas.Context.font=c.CSSValue,b.TempCanvas.Context.measureText(a).width},d.ColorNone=null,d.ColorBlack=g(0,0,0),d.ColorBlue=g(240,100,50),d.ColorGreen=g(120,100,50),d.ColorOrange=g(30,100,50),d.ColorRed=g(0,100,50),d.ColorWhite=g(0,0,100),d.BrushNone=undefined,d.PenBlack=d.NewPenColor(d.ColorBlack),d.PenBlue=d.NewPenColor(d.ColorBlue),d.PenNone=new d.Pen,d.PenRed=d.NewPenColor(d.ColorRed),d.PenOrange=d.NewPenColor(d.ColorOrange),d.PenWhite=d.NewPenColor(d.ColorWhite),d.FontDefault=d.NewFontFS("sans-serif",12,"pt"),d.HTextAlign={Left:"left",Center:"center",Right:"right"},d.VTextAlign={Top:"top",Center:"middle",Bottom:"bottom"},d}),define("floorchart/shapes",["require","./utilities","./contextHelper"],function(a){function m(a){return a*(Math.PI/180)}function n(a,b,c,d){var e=o(a,b,c,d);if(e===0)return 0;var f=q(Math.acos((c-a)/e));return d>b&&(f=360-f),f}function o(a,b,c,d){return Math.sqrt(t(a-c)+t(b-d))}function p(a){return a<0?360+a:a>360?a-360:a==360?0:a}function q(a){return a*(180/Math.PI)}function r(a,b,c){if(c===0)return;var d=o(a.X,a.Y,b.X,b.Y),e=m(p(n(b.X,b.Y,a.X,a.Y)+c));a.X=b.X+Math.round(Math.cos(e)*d),a.Y=b.Y-Math.round(Math.sin(e)*d)}function s(a,b){return b!==0?b*Math.round(a/b):a}function t(a){return a*a}var b=a("./utilities"),c=a("./contextHelper"),d={};d.Shape=function(){},b.SetObjectName(d.Shape,"Shape");var e=d.Shape;d.Shape.prototype.AdjustLTRB=function(a,c,d,e){throw b.MissingImplementationException("shape.AdjustLTRB",this)},d.Shape.prototype.GetCenterPoint=function(){throw b.MissingImplementationException("shape.GetCenterPoint",this)},d.Shape.prototype.GetCenterPointX=function(){throw b.MissingImplementationException("shape.GetCenterPointX",this)},d.Shape.prototype.GetCenterPointY=function(){throw b.MissingImplementationException("shape.GetCenterPointY",this)},d.Shape.prototype.GetLeft=function(){throw b.MissingImplementationException("shape.GetLeft",this)},d.Shape.prototype.GetLeftTop=function(){throw b.MissingImplementationException("shape.GetLeftTop",this)},d.Shape.prototype.GetRect=function(){throw b.MissingImplementationException("shape.GetRect",this)},d.Shape.prototype.GetRight=function(){throw b.MissingImplementationException("shape.GetRight",this)},d.Shape.prototype.IsPointIn=function(a){throw b.MissingImplementationException("shape.IsPointIn",this)},d.Shape.prototype.SetLTWH=function(a,c,d,e){throw b.MissingImplementationException("shape.SetLTWH",this)},d.BShapeType={Ellipse:"Ellipse",Rect:"Rect",RoundRect:"RoundRect"};var f=d.BShapeType;d.BShape=function(){this.Type=f.Rect,this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.Radius=8,this.Angle=0,this.bezierPoints=[],this.PolyRect=d.NewPolyRectLTRB(0,0,0,0),this.boundingRect=d.NewRectLTRB(0,0,0,0)},b.InheritFunctions(d.BShape,e),b.SetObjectName(d.BShape,"BShape");var g=d.BShape;g.prototype.adjust=function(){this.Type==f.Ellipse?this.adjust_createEllipse():this.Type==f.Rect?this.adjust_createRect():this.Type==f.RoundRect&&this.adjust_createRoundRect(),this.adjust_rotate(),this.adjust_calculatePolyRect(),this.adjust_calculateBoundingRect()},g.prototype.adjust_calculateBoundingRect=function(){var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MIN_VALUE,e=0,f=this.bezierPoints.length;while(e<f){var g=this.bezierPoints[e],h=this.bezierPoints[e+1];a=Math.min(a,g),b=Math.min(b,h),c=Math.max(c,g),d=Math.max(d,h),e+=2}this.boundingRect.SetLTRB(a,b,c,d)},g.prototype.adjust_calculatePolyRect=function(){this.PolyRect.SetLTRB(this.Left,this.Top,this.Right,this.Bottom),this.PolyRect.Rotate(this.Angle)},g.prototype.adjust_createEllipse=function(){var a=.5522848,b=this.Left,c=this.Top,d=this.Right+1,e=this.Bottom+1,f=this.getRawHeight()/2,g=this.getRawWidth()/2,h=f*a,i=g*a,j=c+f,k=b+g;this.clearPoints(),this.pushPoint(b,j),this.pushPoint(b,j-h),this.pushPoint(k-i,c),this.pushPoint(k,c),this.pushPoint(k+i,c),this.pushPoint(d,j-h),this.pushPoint(d,j),this.pushPoint(d,j+h),this.pushPoint(k+i,e),this.pushPoint(k,e),this.pushPoint(k-i,e),this.pushPoint(b,j+h),this.pushPoint(b,j)},g.prototype.adjust_createRect=function(){var a=this.Left,b=this.Top,c=this.Right+1,d=this.Bottom+1,e=this.getRawHeight()/4,f=this.getRawWidth()/4;this.clearPoints(),this.pushPoint(a,b),this.pushPoint(a+f,b),this.pushPoint(c-f,b),this.pushPoint(c,b),this.pushPoint(c,b+e),this.pushPoint(c,d-e),this.pushPoint(c,d),this.pushPoint(c-f,d),this.pushPoint(a+f,d),this.pushPoint(a,d),this.pushPoint(a,d-e),this.pushPoint(a,b+e),this.pushPoint(a,b)},g.prototype.adjust_createRoundRect=function(){var a=this.Left,b=this.Top,c=this.Right+1,e=this.Bottom+1,f=this.Radius,g=d.NewRectLTRB(a+f,b+f,c-f,e-f),h=g.GetHeight()/4,i=g.GetWidth()/4,j=.5522848,k=f*j;this.clearPoints(),this.pushPoint(g.Left,b),this.pushPoint(g.Left+i,b),this.pushPoint(g.Right-i,b),this.pushPoint(g.Right,b),this.pushPoint(g.Right+k,b),this.pushPoint(c,g.Top-k),this.pushPoint(c,g.Top),this.pushPoint(c,g.Top+h),this.pushPoint(c,g.Bottom-h),this.pushPoint(c,g.Bottom),this.pushPoint(c,g.Bottom+k),this.pushPoint(g.Right+k,e),this.pushPoint(g.Right,e),this.pushPoint(g.Right-i,e),this.pushPoint(g.Left+i,e),this.pushPoint(g.Left,e),this.pushPoint(g.Left-k,e),this.pushPoint(a,g.Bottom+k),this.pushPoint(a,g.Bottom),this.pushPoint(a,g.Bottom-h),this.pushPoint(a,g.Top+h),this.pushPoint(a,g.Top),this.pushPoint(a,g.Top-k),this.pushPoint(g.Left-k,b),this.pushPoint(g.Left,b)},g.prototype.adjust_rotate=function(){if(this.Angle===0)return;var a=this.getRawCenterPoint(),b=0,c=this.bezierPoints.length;while(b<c){var d=this.bezierPoints[b],e=this.bezierPoints[b+1],f=o(d,e,a.X,a.Y),g=m(p(n(a.X,a.Y,d,e)+this.Angle));this.bezierPoints[b]=a.X+Math.round(Math.cos(g)*f),this.bezierPoints[b+1]=a.Y-Math.round(Math.sin(g)*f),b+=2}},g.prototype.AdjustLTRB=function(a,b,c,d){this.Left+=a,this.Top+=b,this.Right+=c,this.Bottom+=d,this.adjust()},g.prototype.clearPoints=function(){this.bezierPoints=[]},g.prototype.ExportToJson=function(){var a=new h;return b.CopyIntoJsonObject(this,a),a},g.prototype.GetCenterPoint=function(){return this.boundingRect.GetCenterPoint()},g.prototype.GetCenterPointX=function(){return this.boundingRect.GetCenterPointX()},g.prototype.GetCenterPointY=function(){return this.boundingRect.GetCenterPointY()},g.prototype.GetLeftTop=function(){return j(this.boundingRect.Left,this.boundingRect.Top)},g.prototype.GetHeight=function(){return this.boundingRect.GetHeight()},g.prototype.GetRect=function(){return this.boundingRect},g.prototype.getRawCenterPoint=function(){var a=this.Left+(this.Right-this.Left+1)/2,b=this.Top+(this.Bottom-this.Top+1)/2;return d.NewPoint(a,b)},g.prototype.getRawHeight=function(){return this.Bottom-this.Top+1},g.prototype.getRawWidth=function(){return this.Right-this.Left+1},g.prototype.GetWidth=function(){return this.boundingRect.GetWidth()},g.prototype.Move=function(a){this.Left+=a.X,this.Top+=a.Y,this.Right+=a.X,this.Bottom+=a.Y,this.adjust()},g.prototype.MoveTo=function(a){this.Move(j(a.X-this.Left,a.Y-this.Top))},g.prototype.New=function(){return new g},g.prototype.IsPointIn=function(a){return c.PathBezierPointsXYOntoContext(c.TempCanvas.Context,this.bezierPoints),c.TempCanvas.Context.isPointInPath(a.X,a.Y)},g.prototype.pushPoint=function(a,b){this.bezierPoints.push(a),this.bezierPoints.push(b)},g.prototype.Rotate=function(a){this.Angle=p(this.Angle+a),this.adjust()},g.prototype.SetLTWH=function(a,c,d,e){var f=b.IsValid(d)?d:this.GetWidth(),g=b.IsValid(e)?e:this.GetHeight();b.IsValid(a)&&(this.Left=a),b.IsValid(c)&&(this.Top=c),this.Right=this.Left+f-1,this.Bottom=this.Top+g-1,this.adjust()},g.prototype.SetType=function(a){this.Type=a,this.adjust()},g.prototype.Size=function(a){var b=d.MovePoint(this.PolyRect.RightBottom,a),c=this.boundingRect.GetCenterPoint();r(b,c,p(360-this.Angle));var e=b.X-this.Right,f=b.Y-this.Bottom;this.Right=Math.max(this.Right+e,this.Left+12),this.Bottom=Math.max(this.Bottom+f,this.Top+12);var g=d.NewPolyRectLTRB(this.Left,this.Top,this.Right,this.Bottom);g.Rotate(this.Angle);var h=this.PolyRect.LeftTop.X-g.LeftTop.X,i=this.PolyRect.LeftTop.Y-g.LeftTop.Y;this.Left+=h,this.Top+=i,this.Right+=h,this.Bottom+=i,this.adjust()},g.prototype.SnapRightBottom=function(a){this.Right=s(this.Right,a.X),this.Bottom=s(this.Bottom,a.Y),this.adjust()},d.NewBShapeJson=function(a){var b=new g;return b.Type=a.Type,b.Left=a.Left,b.Top=a.Top,b.Right=a.Right,b.Bottom=a.Bottom,b.Radius=a.Radius,b.Angle=a.Angle,b.adjust(),b},d.NewBShapeLTWH=function(a,b,c,d,e,f){var h=new g;return h.Type=a,h.Left=b,h.Top=c,h.Right=b+d-1,h.Bottom=c+e-1,h.Radius=f,h.adjust(),h};var h=function(){this.Type="",this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.Radius=0,this.Angle=0};d.Point=function(){this.X=0,this.Y=0},b.SetObjectName(d.Point,"Point");var i=d.Point;i.prototype.Move=function(a){this.X+=a.X,this.Y+=a.Y},i.prototype.New=function(){return new d.Point};var j=d.NewPoint=function(a,b){var c=new i;return c.X=a,c.Y=b,c};d.PolyRect=function(){this.Points=[],this.Points[0]=this.LeftTop=j(0,0),this.Points[1]=this.RightTop=j(0,0),this.Points[2]=this.RightBottom=j(0,0),this.Points[3]=this.LeftBottom=j(0,0),this.boundingRect=d.NewRectLTRB(0,0,0,0)},b.InheritFunctions(d.PolyRect,e),b.SetObjectName(d.PolyRect,"PolyRect"),d.PolyRect.prototype.adjust=function(){var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MIN_VALUE;for(var e in this.Points){var f=this.Points[e];a=Math.min(a,f.X),b=Math.min(b,f.Y),c=Math.max(c,f.X),d=Math.max(d,f.Y)}this.boundingRect.SetLTRB(a,b,c,d)},d.PolyRect.prototype.New=function(){return new d.PolyRect},d.PolyRect.prototype.Rotate=function(a){if(a===0)return;var b=this.boundingRect.GetCenterPoint();for(var c in this.Points)r(this.Points[c],b,a);this.adjust()},d.PolyRect.prototype.SetLTRB=function(a,b,c,d){this.Points[0].X=a,this.Points[0].Y=b,this.Points[1].X=c,this.Points[1].Y=b,this.Points[2].X=c,this.Points[2].Y=d,this.Points[3].X=a,this.Points[3].Y=d,this.adjust()},d.NewPolyRectLTRB=function(a,b,c,e){var f=new d.PolyRect;return f.SetLTRB(a,b,c,e),f},d.Rect=function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0},b.InheritFunctions(d.Rect,e),b.SetObjectName(d.Rect,"Rect");var k=d.Rect;k.prototype.AdjustLTRB=function(a,b,c,d){this.Left+=a,this.Top+=b,this.Right+=c,this.Bottom+=d},k.prototype.Encloses=function(a){return a.Left<this.Left?!1:a.Top<this.Top?!1:a.Right>this.Right?!1:a.Bottom>this.Bottom?!1:!0},k.prototype.GetBottom=function(){return this.Bottom},k.prototype.GetCenterPoint=function(){var a=this.Left+(this.Right-this.Left+1)/2,b=this.Top+(this.Bottom-this.Top+1)/2;return d.NewPoint(a,b)},k.prototype.GetCenterPointX=function(){return this.Left+(this.Right-this.Left+1)/2},k.prototype.GetCenterPointY=function(){return this.Top+(this.Bottom-this.Top+1)/2},k.prototype.GetHeight=function(){return this.Bottom-this.Top+1},k.prototype.GetLeft=function(){return this.Left},k.prototype.GetLeftTop=function(){return d.NewPoint(this.Left,this.Top)},k.prototype.GetRect=function(){return d.NewRectLTRB(this.Left,this.Top,this.Right,this.Bottom)},k.prototype.GetRight=function(){return this.Right},k.prototype.GetTop=function(){return this.Top},k.prototype.GetWidth=function(){return this.Right-this.Left+1},k.prototype.IsPointIn=function(a){return a.X<this.Left?!1:a.X>this.Right?!1:a.Y<this.Top?!1:a.Y>this.Bottom?!1:!0},k.prototype.Move=function(a){this.MoveXY(a.X,a.Y)},k.prototype.MoveXY=function(a,b){this.Left+=a,this.Top+=b,this.Right+=a,this.Bottom+=b},k.prototype.New=function(){return new d.Rect},k.prototype.Normalize=function(){var a;this.Right<this.Left&&(a=this.Left,this.Left=this.Right,this.Right=a),this.Bottom<this.Top&&(a=this.Top,this.Top=this.Bottom,this.Bottom=a)},k.prototype.SetLTRB=function(a,c,d,e){b.IsValid(a)&&(this.Left=a),b.IsValid(c)&&(this.Top=c),b.IsValid(d)&&(this.Right=d),b.IsValid(e)&&(this.Bottom=e)},k.prototype.SetLTWH=function(a,c,d,e){var f=b.IsValid(d)?d:this.GetWidth(),g=b.IsValid(e)?e:this.GetHeight();b.IsValid(a)&&(this.Left=a),b.IsValid(c)&&(this.Top=c),this.Right=this.Left+f-1,this.Bottom=this.Top+g-1},d.NewRectLTRB=function(a,b,c,d){var e=new k;return e.Left=a,e.Top=b,e.Right=c,e.Bottom=d,e},d.NewRectLTWH=function(a,b,c,d){var e=new k;return e.Left=a,e.Top=b,e.Right=a+c-1,e.Bottom=b+d-1,e},d.NewRectRect=function(a){var b=new k;return b.Left=a.Left,b.Top=a.Top,b.Right=a.Right,b.Bottom=a.Bottom,b},d.RoundRect=function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.Radius=8},b.InheritFunctions(d.RoundRect,e),b.SetObjectName(d.RoundRect,"RoundRect");var l=d.RoundRect;return l.prototype.AdjustLTRB=function(a,b,c,d){this.Left+=a,this.Top+=b,this.Right+=c,this.Bottom+=d},l.prototype.GetBottom=function(){return this.Bottom},l.prototype.GetCenterPoint=function(){var a=this.Left+(this.Right-this.Left+1)/2,b=this.Top+(this.Bottom-this.Top+1)/2;return d.NewPoint(a,b)},l.prototype.GetCenterPointX=function(){return this.Left+(this.Right-this.Left+1)/2},l.prototype.GetCenterPointY=function(){return this.Top+(this.Bottom-this.Top+1)/2},l.prototype.GetHeight=function(){return this.Bottom-this.Top+1},l.prototype.GetLeft=function(){return this.Left},l.prototype.GetLeftTop=function(){return d.NewPoint(this.Left,this.Top)},l.prototype.GetRect=function(){return d.NewRectLTRB(this.Left,this.Top,this.Right,this.Bottom)},l.prototype.GetRight=function(){return this.Right},l.prototype.GetTop=function(){return this.Top},l.prototype.GetWidth=function(){return this.Right-this.Left+1},l.prototype.IsPointIn=function(a){return c.PathRoundedRectOntoContext(c.TempCanvas.Context,this.Left,this.Top,this.GetWidth(),this.GetHeight(),this.Radius),c.TempCanvas.Context.isPointInPath(a.X,a.Y)},l.prototype.SetLTWH=function(a,c,d,e){var f=b.IsValid(d)?d:this.GetWidth(),g=b.IsValid(e)?e:this.GetHeight();b.IsValid(a)&&(this.Left=a),b.IsValid(c)&&(this.Top=c),this.Right=this.Left+f-1,this.Bottom=this.Top+g-1},d.NewRoundRectLTWH=function(a,b,c,d,e){var f=new l;return f.Left=a,f.Top=b,f.Right=a+c-1,f.Bottom=b+d-1,f.Radius=e,f},d.CalculateDelta=function(a,b,c){var d,e;return c.X!==0?d=Math.round((b.X-a.X)/c.X)*c.X:d=b.X-a.X,c.Y!==0?e=Math.round((b.Y-a.Y)/c.Y)*c.Y:e=b.Y-a.Y,j(d,e)},d.IsPointInEllipseFromRect=function(a,b){return c.PathEllipseFromRectOntoContext(c.TempCanvas.Context,b),c.TempCanvas.Context.isPointInPath(a.X,a.Y)},d.LocalizePoint=function(a,b){return d.NewPoint(a.X-b.X,a.Y-b.Y)},d.LocalizeRect=function(a,b){var c=d.NewRectRect(a);return c.MoveXY(-b.X,-b.Y),c},d.MovePoint=function(a,b){var c=d.NewPoint(a.X,a.Y);return c.Move(b),c},d.SnapPoint=function(a,b){return d.NewPoint(b.X*Math.round(a.X/b.X),b.Y*Math.round(a.Y/b.Y))},d.MouseHasMoved=function(a,b,c){return Math.abs(b.X-a.X)>=c.X||Math.abs(b.Y-a.Y)>=c.Y},d}),define("floorchart/canvasSurface",["require","./contextHelper","./graphics","./shapes","./utilities"],function(a){var b=a("./contextHelper"),c=a("./graphics"),d=a("./shapes"),e=a("./utilities"),f={};f.CanvasSurface=function(){this.canvas=undefined,this.context=undefined,this.previousFont="",this.previousFonts=[]},e.SetObjectName(f.CanvasSurface,"CanvasSurface");var g=f.CanvasSurface;return g.prototype.Clear=function(){this.canvas.width=this.canvas.width},g.prototype.Adjusted=function(){this.context.translate(.5,.5)},g.prototype.brushToCanvasFillStyle=function(a){return a==c.BrushNone?undefined:a instanceof c.Color?a.CSSValue:a},g.prototype.DrawBShape=function(a,c,d){b.PathBezierPointsXYOntoContext(this.context,a.bezierPoints);var e=a.GetLeftTop();this.fillContext(d,e.X,e.Y),this.strokeContext(c)},g.prototype.DrawEllipseFromRect=function(a,c,d){b.PathEllipseFromRectOntoContext(this.context,a),this.fillContext(d,a.Left,a.Top),this.strokeContext(c)},g.prototype.DrawImage=function(a,b,c){this.context.drawImage(a,b,c)},g.prototype.DrawImageScaled=function(a,b){this.context.drawImage(a,b.Left,b.Top,b.GetWidth(),b.GetHeight())},g.prototype.DrawLineXY=function(a,b,c,d,e){this.context.beginPath(),this.context.moveTo(a,b),this.context.lineTo(c,d),this.strokeContext(e)},g.prototype.DrawRect=function(a,b,c){this.context.beginPath(),this.context.rect(a.Left,a.Top,a.GetWidth(),a.GetHeight()),this.fillContext(c,a.Left,a.Top),this.strokeContext(b)},g.prototype.DrawRoundRect=function(a,c,d){b.PathRoundedRectOntoContext(this.context,a.Left,a.Top,a.GetWidth(),a.GetHeight(),a.Radius),this.fillContext(d,a.Left,a.Top),this.strokeContext(c)},g.prototype.DrawShape=function(a,b,c){if(a instanceof d.Rect)this.DrawRect(a,b,c);else if(a instanceof d.RoundRect)this.DrawRoundRect(a,b,c);else throw new Error(e.FormatString("Invalid shape '{0}'",e.GetObjectName(a)))},g.prototype.DrawText=function(a,b,d,f,g,h){if(h=="")return;this.context.textAlign=f,this.context.textBaseline=g,this.setContextFont(b);var i=0,j=0;if(f==c.HTextAlign.Left)i=a.GetLeft();else if(f==c.HTextAlign.Center)i=a.GetCenterPointX();else if(f==c.HTextAlign.Right)i=a.GetRight();else throw new Error(e.FormatString("Invalid hAlign '{0}'",f));if(g==c.VTextAlign.Top)j=a.GetTop();else if(g==c.VTextAlign.Center)j=a.GetCenterPointY();else if(g==c.VTextAlign.Bottom)j=a.GetBottom();else throw new Error(e.FormatString("Invalid vAlign '{0}'",g));if(d==c.BrushNone)return;this.context.fillStyle=this.brushToCanvasFillStyle(d);if(d instanceof c.Color)this.context.fillText(h,i,j);else{var k=a.GetLeftTop();this.SaveState(),this.context.translate(k.X,k.Y),this.context.fillText(h,i-k.X,j-k.Y),this.RestoreState()}},g.prototype.fillContext=function(a,b,d){if(a==c.BrushNone)return;a instanceof c.Color?(this.context.fillStyle=this.brushToCanvasFillStyle(a),this.context.fill()):(this.context.fillStyle=this.brushToCanvasFillStyle(a),this.SaveState(),this.context.translate(b,d),this.context.fill(),this.RestoreState())},g.prototype.ResetTransformationMatrix=function(){this.context.setTransform(1,0,0,1,0,0)},g.prototype.RestoreState=function(){this.context.restore(),this.previousFont=this.previousFonts.pop()},g.prototype.SaveState=function(){this.previousFonts.push(this.previousFont),this.context.save()},g.prototype.setContextFont=function(a){if(this.previousFont==a.CSSValue)return;this.context.font=a.CSSValue,this.previousFont=a.CSSValue},g.prototype.SetOrigin=function(a){this.context.translate(a.X,a.Y)},g.prototype.strokeContext=function(a){switch(a.Type){case c.PenType.None:break;case c.PenType.Color:this.context.strokeStyle=a.Color.CSSValue,this.context.stroke();break;default:throw new Error(e.FormatString("Unsupported pen type '{0}'",a.Type))}},g.prototype.Scale=function(a,b){this.context.scale(a,b)},g.prototype.Translate=function(a,b){this.context.translate(a,b)},f.NewCanvasSurface=function(a){var b=new g;return b.canvas=a,b.context=a.getContext("2d"),b.Adjusted(),b},f}),define("floorchart/posFloorChart",["require","./graphics","./shapes","./utilities","./canvasSurface"],function(a){function j(a,b,c){return new f.ChangeObject(a,b,c)}function m(a){var b=new l;b.UniqueID=a.UniqueID,b.Name=a.Name;for(var c in a.Objects)b.Objects.push(r(a.Objects[c]));return b}function o(a,b){var d=5,e=new n;return e.Rect=c.NewRectLTRB(a-d,b-d,a+d,b+d),e}function q(a){var b=new p;return b.ChangeShapeType(a),b}function r(a){var b=new p;return b.UniqueID=a.UniqueID,b.Name=a.Name,b.BShape=c.NewBShapeJson(a.BShape),b.Table=a.Table,b}function v(a,b){for(var c in b){var d=b[c];if(d.ContainingDiv==a)return d}return undefined}function w(a){for(var b in a){var d=a[b];if(d.Editing)return d.Rect}return c.NewRectLTWH(0,0,0,0)}function x(a,b){for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.IsPointIn(a))return d}return undefined}function y(a,b){for(var c in b)if(b[c].UniqueID==a)return c;return-1}function z(a){return function(b){b.preventDefault();var c=d.NewKeyInfo(b),e=a.getEventCursorPosition(b);a.handleMouseDown(e,c)}}function A(a){return function(b){b.preventDefault();var c=d.NewKeyInfo(b),e=a.getEventCursorPosition(b);a.handleMouseMove(e,c)}}function B(a){return function(b){b.preventDefault();var c=d.NewKeyInfo(b),e=a.getEventCursorPosition(b);a.handleMouseUp(e,c)}}function C(a){var b=c.NewRectLTRB(Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);for(var d in a){var e=a[d].BShape.GetRect();b.Left=Math.min(b.Left,e.Left),b.Top=Math.min(b.Top,e.Top),b.Right=Math.max(b.Right,e.Right),b.Bottom=Math.max(b.Bottom,e.Bottom)}return b}function D(a){for(var b in a)a[b].PrevSelected=a[b].Selected}var b=a("./graphics"),c=a("./shapes"),d=a("./utilities"),e=a("./canvasSurface"),f={};f.ChangeKinds={AddObjects:"AddObjects",ChangeObjects:"ChangeObjects",DeleteObjects:"DeleteObjects",LayerObjects:"LayerObjects"};var g=f.ChangeKinds;f.Events={Changed:"changed"};var h=f.Events;f.FcShapeType={Ellipse:c.BShapeType.Ellipse,Rect:c.BShapeType.Rect,RoundRect:c.BShapeType.RoundRect},f.PosFloorChart=function(){this.app=undefined,this.areas=[],this.backgroundBrush=b.BrushNone,this.borderPen=b.PenNone,this.currentArea=undefined,this.currentAreaIndex=0,this.events={},this.gridPen=b.NewPenColor(b.NewColorHSL(0,0,20)),this.gridSpacing=24,this.handleColor=b.ColorGreen,this.snapGrid=c.NewPoint(12,12),this.displays=[],this.currentEditDisplay=undefined,this.mouseDownHandler=undefined,this.mouseMoveHandler=undefined,this.mouseUpHandler=undefined,this.mouseBanding=!1,this.mouseMovingObject=!1,this.mouseSizingObject=!1,this.objectChanged=!1,this.previousPoint=undefined,this.focusRect=c.NewRectLTRB(0,0,0,0),this.focusBrush=b.NewColorHSLA(0,0,75,.5),this.areas.push(new l),this.areas[0].Name="Default",this.currentAreaIndex=0,this.currentArea=this.areas[this.currentAreaIndex]},d.SetObjectName(f.PosFloorChart,"PosFloorChart");var i=f.PosFloorChart;i.prototype.AddShape=function(a,b){if(!this.editingAnyDisplay())return;var c=this.addObject(a,b);c.Table=!1,this.adjustScalingAndRefresh();var d=this.newChangeObjectWithSelected(g.AddObjects);this.trigger(h.Changed,[d,"AddShape"])},i.prototype.addObject=function(a,b){this.deselectObjects(this.currentArea.Objects);var c=q(a);return this.currentArea.Objects.push(c),c.Selected=!0,b?c.MoveTo(b):c.CenterInRect(w(this.displays)),c.SnapLeftTop(this.snapGrid),c.SnapRightBottom(this.snapGrid),c},i.prototype.AddTable=function(a,b){if(!this.editingAnyDisplay())return;var c=this.addObject(a,b);c.Table=!0,this.adjustScalingAndRefresh();var d=this.newChangeObjectWithSelected(g.AddObjects);this.trigger(h.Changed,[d,"AddTable"])},i.prototype.Adjust=function(){for(var a in this.displays){var b=this.displays[a];b.Canvas.width=$(b.ContainingDiv).width(),b.Canvas.height=$(b.ContainingDiv).height(),b.Rect.SetLTWH(0,0,b.Canvas.width,b.Canvas.height),this.adjustDisplayScaling(b)}this.Refresh()},i.prototype.adjustDisplayScaling=function(a){if(!a.Scaling.Enabled||a.Editing){a.Scaling.X=1,a.Scaling.Y=1;return}var b=1,c=this.getScalingMaxDimensions();c.Width+=12,c.Height+=12;var d=a.Rect.GetWidth(),e=a.Rect.GetHeight(),f=d/c.Width,g=e/c.Height;d>=c.Width&&e>=c.Height?b=1:f<g?b=f:b=g,a.Scaling.X=b,a.Scaling.Y=b},i.prototype.adjustScalingAndRefresh=function(){for(var a in this.displays){var b=this.displays[a];this.adjustDisplayScaling(b),this.refreshDisplay(b)}},i.prototype.AppendElement=function(a){var b=new k;b.Canvas=document.createElement("canvas"),b.ContainingDiv=a.get(0),a.append(b.Canvas),b.Surface=e.NewCanvasSurface(b.Canvas),b.Canvas.style.cursor="default",this.displays.push(b),this.Adjust()},i.prototype.ApplyChangeObject=function(a){if(a.CurrentAreaIndex<0||a.CurrentAreaIndex>this.areas.length-1)return"Invalid area index.";var b="";switch(a.Kind){case g.AddObjects:b=this.applyChangeObject_addObjects(a);break;case g.ChangeObjects:b=this.applyChangeObject_changeObjects(a);break;case g.DeleteObjects:b=this.applyChangeObject_deleteObjects(a);break;default:return d.FormatString("Invalid change object kind '{0}'",a.Kind)}return b==""&&this.adjustScalingAndRefresh(),b},i.prototype.applyChangeObject_addObjects=function(a){var b=a.CurrentAreaIndex;for(var c in a.Objects)this.areas[b].Objects.push(r(a.Objects[c]));return""},i.prototype.applyChangeObject_changeObjects=function(a){var b=a.CurrentAreaIndex;for(var c in a.Objects){var d=y(a.Objects[c].UniqueID,this.areas[b].Objects);if(d<0)return"Object not found to change";this.areas[b].Objects[d]=r(a.Objects[c])}return""},i.prototype.applyChangeObject_deleteObjects=function(a){var b=a.CurrentAreaIndex;for(var c in a.Objects){var d=y(a.Objects[c].UniqueID,this.areas[b].Objects);if(d<0)return"Object not found to delete";this.areas[b].Objects.splice(d,1)}return""},i.prototype.bandObjects=function(a,b){for(var c in a){var d=a[c];d.Selected=d.PrevSelected,b.Encloses(d.GetRect())&&(d.Selected=!d.PrevSelected)}},i.prototype.Bind=function(a,b){return a=a.toLowerCase(),a in this.events||(this.events[a]=[]),this.events[a].push(b),this},i.prototype.bindEventsToCanvas=function(a,b){var c="";b?c="addEventListener":c="removeEventListener",a[c]("mousedown",this.mouseDownHandler,!1),a[c]("mousemove",this.mouseMoveHandler,!1),a[c]("mouseup",this.mouseUpHandler,!1)},i.prototype.changeSelectedObjectsShape=function(a,b){for(var c in a){var d=a[c];d.Selected&&d.ChangeShapeType(b)}},i.prototype.ChangeSelectedObjectsShape=function(a){if(!this.editingAnyDisplay())return;this.changeSelectedObjectsShape(this.currentArea.Objects,a),this.adjustScalingAndRefresh();var b=this.newChangeObjectWithSelected(g.ChangeObjects);this.trigger(h.Changed,[b,"ChangeShapes"])},i.prototype.deleteSelectedObjects=function(a){for(var b=a.length-1;b>=0;b--)a[b].Selected&&a.splice(b,1)},i.prototype.DeleteSelectedObjects=function(){if(!this.editingAnyDisplay())return;var a=this.newChangeObjectWithSelected(g.DeleteObjects);this.deleteSelectedObjects(this.currentArea.Objects),this.adjustScalingAndRefresh(),this.trigger(h.Changed,[a,"DeleteShapes"])},i.prototype.deselectObjects=function(a){for(var b in a)a[b].Selected=!1},i.prototype.drawGridLines=function(a){var b=a.Surface,c=a.Rect,d=c.GetLeft(),e=c.GetTop(),f=c.GetRight(),g=c.GetBottom();for(var h=d+this.gridSpacing;h<f;h+=this.gridSpacing)b.DrawLineXY(h,e,h,g,this.gridPen);for(var i=e+this.gridSpacing;i<g;i+=this.gridSpacing)b.DrawLineXY(d,i,f,i,this.gridPen)},i.prototype.drawHandle=function(a,c,d){a.DrawEllipseFromRect(c.Rect,b.PenBlack,d)},i.prototype.drawHandles=function(a,b){for(var c in b){var d=b[c];d.Selected&&this.drawObjectHandles(a,d)}},i.prototype.drawObject=function(a,c){var d,e;c.Table?(e=b.PenNone,d=b.NewGradientLinear(0,0,0,c.BShape.GetHeight()),d.AddColorStop(0,b.NewColorHSL(212,100,66)),d.AddColorStop(1,b.NewColorHSL(210,100,50))):(e=b.PenNone,d=b.ColorWhite),c.Draw(a,e,d)},i.prototype.drawObjectHandles=function(a,c){var d=c.BShape.PolyRect,e;e=o(d.LeftTop.X,d.LeftTop.Y),this.drawHandle(a,e,b.ColorWhite),e=o(d.RightTop.X,d.RightTop.Y),this.drawHandle(a,e,b.ColorWhite),e=o(d.RightBottom.X,d.RightBottom.Y),this.drawHandle(a,e,this.handleColor),e=o(d.LeftBottom.X,d.LeftBottom.Y),this.drawHandle(a,e,b.ColorWhite)},i.prototype.drawObjects=function(a,b){for(var c in b)this.drawObject(a,b[c])},i.prototype.editingAnyDisplay=function(){for(var a in this.displays)if(this.displays[a].Editing)return!0;return!1},i.prototype.ExportToJson=function(){var a=new t;for(var b in this.areas)a.Areas.push(this.areas[b].ExportToJson());return a},i.prototype.findHandleByPoint=function(a,b){for(var c in b){if(!b[c].Selected)continue;var d=b[c].BShape.PolyRect,e=o(d.RightBottom.X,d.RightBottom.Y);if(e.IsPointIn(a))return!0}return!1},i.prototype.getEventCursorPosition=function(a){var b=new c.Point;if(!this.currentEditDisplay)return b;if(d.IsValid(a.offsetX)&&d.IsValid(a.offsetY))return b.X=a.offsetX,b.Y=a.offsetY,b;b.X=a.pageX,b.Y=a.pageY;var e=this.currentEditDisplay.Canvas;while(e)b.X-=e.offsetLeft,b.Y-=e.offsetTop,e=e.offsetParent;return b},i.prototype.getScalingMaxDimensions=function(){var a={Width:1,Height:1};for(var b in this.areas){var c=C(this.areas[b].Objects),d=c.GetRight(),e=c.GetBottom();d>a.Width&&(a.Width=d),e>a.Height&&(a.Height=e)}return a},i.prototype.getSelectedObjects=function(a){var b=[];for(var c in a){var d=a[c];d.Selected&&b.push(d)}return b},i.prototype.ImportFromJson=function(a){this.areas=[];for(var b in a.Areas)this.areas.push(m(a.Areas[b]));this.currentAreaIndex=0,this.currentArea=this.areas[this.currentAreaIndex],this.Adjust()},i.prototype.handleMouseDown=function(a,b){this.handleMouseDown_editing(a,b),this.Refresh()},i.prototype.handleMouseDown_editing=function(a,b){var c=a;this.mouseBanding=!1,this.mouseMovingObject=!1,this.mouseSizingObject=!1,this.objectChanged=!1;if(this.findHandleByPoint(c,this.currentArea.Objects)){this.mouseSizingObject=!0,this.previousPoint=a;return}var d=x(c,this.currentArea.Objects);!d&&!b.ShiftKey&&this.deselectObjects(this.currentArea.Objects);if(!d){D(this.currentArea.Objects),this.mouseBanding=!0,this.previousPoint=a,this.startPoint=a,this.focusRect.SetLTRB(a.X,a.Y,a.X,a.Y);return}if(b.ShiftKey){d.Selected=!d.Selected;return}d.Selected||(this.deselectObjects(this.currentArea.Objects),d.Selected=!0),this.mouseMovingObject=!0,this.previousPoint=a},i.prototype.handleMouseDown_notEditing=function(a,b){},i.prototype.handleMouseMove=function(a,b){this.mouseBanding?this.handleMouseMove_banding(a,b):this.mouseMovingObject?this.handleMouseMove_movingObject(a,b):this.mouseSizingObject&&this.handleMouseMove_sizingObject(a,b)},i.prototype.handleMouseMove_banding=function(a,b){if(!c.MouseHasMoved(this.previousPoint,a,this.snapGrid))return;this.focusRect.SetLTRB(this.startPoint.X,this.startPoint.Y,a.X,a.Y),this.focusRect.Normalize(),this.bandObjects(this.currentArea.Objects,this.focusRect),this.previousPoint=a,this.Refresh()},i.prototype.handleMouseMove_movingObject=function(a,b){if(!c.MouseHasMoved(this.previousPoint,a,this.snapGrid))return;this.objectChanged=!0;var d=c.CalculateDelta(this.previousPoint,a,this.snapGrid);this.moveSelectedObjects(this.currentArea.Objects,d),this.previousPoint.Move(d),this.Refresh()},i.prototype.handleMouseMove_sizingObject=function(a,b){if(!c.MouseHasMoved(this.previousPoint,a,this.snapGrid))return;this.objectChanged=!0;var d=c.CalculateDelta(this.previousPoint,a,this.snapGrid);this.sizeSelectedObjects(this.currentArea.Objects,d),this.previousPoint.Move(d),this.Refresh()},i.prototype.handleMouseUp=function(a,b){this.mouseBanding?this.handleMouseUp_banding(a,b):this.mouseMovingObject?this.handleMouseUp_movingObject(a,b):this.mouseSizingObject&&this.handleMouseUp_sizingObject(a,b)},i.prototype.handleMouseUp_banding=function(a,b){this.mouseBanding=!1,this.Refresh()},i.prototype.handleMouseUp_movingObject=function(a,b){this.mouseMovingObject=!1;if(!this.objectChanged)return;this.adjustScalingAndRefresh();var c=this.newChangeObjectWithSelected(g.ChangeObjects);this.trigger(h.Changed,[c,"MoveShapes"])},i.prototype.handleMouseUp_sizingObject=function(a,b){this.mouseSizingObject=!1;if(!this.objectChanged)return;this.adjustScalingAndRefresh();var c=this.newChangeObjectWithSelected(g.ChangeObjects);this.trigger(h.Changed,[c,"SizeShapes"])},i.prototype.handlePaint=function(a){var c=a.Surface;c.ResetTransformationMatrix(),c.DrawRect(a.Rect,this.borderPen,this.backgroundBrush),a.Scaling.Enabled&&!a.Editing&&c.Scale(a.Scaling.X,a.Scaling.Y),c.Translate(.5,.5),a.Editing&&this.drawGridLines(a),this.drawObjects(c,this.currentArea.Objects),a.Editing&&this.drawHandles(c,this.currentArea.Objects),a.Editing&&this.mouseBanding&&c.DrawRect(this.focusRect,b.PenNone,this.focusBrush),a.Editing&&this.mouseBanding&&c.DrawRect(this.focusRect,b.PenNone,this.focusBrush)},i.prototype.moveSelectedObjects=function(a,b){for(var c in a){var d=a[c];d.Selected&&d.Move(b)}},i.prototype.newChangeObjectWithSelected=function(a){var b=this.getSelectedObjects(this.currentArea.Objects);return j(a,this.currentAreaIndex,b)},i.prototype.Refresh=function(){for(var a in this.displays)this.refreshDisplay(this.displays[a])},i.prototype.refreshDisplay=function(a){a.Surface.Clear(),this.handlePaint(a)},i.prototype.RemoveElement=function(a){var b=a.get(0);for(var c in this.displays){var d=this.displays[c];if(d.ContainingDiv!=b)continue;this.displays.splice(c,1),this.bindEventsToCanvas(d.Canvas,!1),$(d.Canvas).remove();return}},i.prototype.RemoveEvent=function(a,b){if(!(a in this.events))return;for(var c=0,d=this.events[a].length;c<d;c++)(this.events[a][c]==b||this.events[a][c].ref&&this.events[a][c].ref==b)&&this.events[a].splice(c,1)},i.prototype.rotateSelectedObjects=function(a,b){for(var c in a){var d=a[c];d.Selected&&d.Rotate(b)}},i.prototype.RotateSelectedObjects=function(a){if(!this.editingAnyDisplay())return;this.rotateSelectedObjects(this.currentArea.Objects,a),this.adjustScalingAndRefresh();var b=this.newChangeObjectWithSelected(g.ChangeObjects);this.trigger(h.Changed,[b,"RotateShapes"])},i.prototype.SetBackgroundBrush=function(a){this.backgroundBrush=a},i.prototype.SetBorderColor=function(a){this.borderPen=b.NewPenColor(a)},i.prototype.SetEditing=function(a,b){var c=v(a.get(0),this.displays);if(!c)return;try{this.currentEditDisplay=undefined,c.Editing=b,this.bindEventsToCanvas(c.Canvas,b);if(!b)return;this.currentEditDisplay=c;for(var d in this.displays){var e=this.displays[d];if(e==c)continue;e.Editing=!1,this.bindEventsToCanvas(e.Canvas,!1)}}finally{this.adjustScalingAndRefresh()}},i.prototype.SetScaling=function(a,b){var c=v(a.get(0),this.displays);if(!c)return;c.Scaling.Enabled=b,this.adjustDisplayScaling(c),this.Refresh()},i.prototype.sizeSelectedObjects=function(a,b){for(var c in a){var d=a[c];d.Selected&&d.Size(b)}},i.prototype.SnapLeftTopSelectedObjects=function(){if(!this.editingAnyDisplay())return;this.snapLeftTopSelectedObjects(this.currentArea.Objects,this.snapGrid),this.adjustScalingAndRefresh();var a=this.newChangeObjectWithSelected(g.ChangeObjects);this.trigger(h.Changed,[a,"SnapLeftTops"])},i.prototype.snapLeftTopSelectedObjects=function(a,b){for(var c in a){var d=a[c];d.Selected&&d.SnapLeftTop(b)}},i.prototype.SnapRightBottomSelectedObjects=function(){if(!this.editingAnyDisplay())return;this.snapRightBottomSelectedObjects(this.currentArea.Objects,this.snapGrid),this.adjustScalingAndRefresh();var a=this.newChangeObjectWithSelected(g.ChangeObjects);this.trigger(h.Changed,[a,"SnapRightBottoms"])},i.prototype.snapRightBottomSelectedObjects=function(a,b){for(var c in a){var d=a[c];d.Selected&&d.SnapRightBottom(b)}},i.prototype.trigger=function(a,b){if(!(a in this.events))return;var c=this.events[a].concat();for(var d=0,e=c.length;d<e;d++)c[d].apply(this,b===undefined?[]:b)},f.NewPosFloorChart=function(){var a=new i;return a.mouseDownHandler=z(a),a.mouseMoveHandler=A(a),a.mouseUpHandler=B(a),a},f.ChangeObject=function(a,b,c){this.Kind=a,this.CurrentAreaIndex=b,this.Objects=d.ExportArrayToJson(c)};var k=function(){this.Rect=c.NewRectLTWH(0,0,0,0),this.Scaling={Enabled:!1,X:1,Y:1},this.ContainingDiv=undefined,this.Canvas=undefined,this.Surface=undefined,this.Editing=!1};d.SetObjectName(k,"fcDisplay");var l=function(){this.UniqueID=d.GenerateUUID(),this.Name="",this.Objects=[]};d.SetObjectName(l,"fcArea"),l.prototype.ExportToJson=function(){var a=new s;return d.CopyIntoJsonObject(this,a),a};var n=function(){this.Rect=undefined};d.SetObjectName(n,"fcHandle"),n.prototype.IsPointIn=function(a){return this.Rect.IsPointIn(a)};var p=function(){this.UniqueID=d.GenerateUUID(),this.Name="",this.BShape=c.NewBShapeLTWH(c.BShapeType.RoundRect,0,0,72,72,5),this.Table=!1,this.Selected=!1,this.PrevSelected=!1};d.SetObjectName(p,"fcObject"),p.prototype.CenterInRect=function(a){var b=this.BShape.GetCenterPoint(),d=a.GetCenterPoint(),e=d.X-b.X,f=d.Y-b.Y;this.Move(c.NewPoint(e,f))},p.prototype.ChangeShapeType=function(a){this.BShape.SetType(a)},p.prototype.ExportToJson=function(){var a=new u;return d.CopyIntoJsonObject(this,a),a},p.prototype.Draw=function(a,b,c){a.DrawBShape(this.BShape,b,c)},p.prototype.GetRect=function(){return this.BShape.GetRect()},p.prototype.IsPointIn=function(a){return this.BShape.IsPointIn(a)},p.prototype.Move=function(a){this.BShape.Move(a)},p.prototype.MoveTo=function(a){this.BShape.MoveTo(a)},p.prototype.New=function(){return new p},p.prototype.Rotate=function(a){this.BShape.Rotate(a)},p.prototype.Size=function(a){this.BShape.Size(a)},p.prototype.SnapLeftTop=function(a){var b=this.BShape.GetLeftTop(),d=c.SnapPoint(b,a),e=c.NewPoint(d.X-b.X,d.Y-b.Y);this.BShape.Move(e)},p.prototype.SnapRightBottom=function(a){this.BShape.SnapRightBottom(a)};var s=function(){this.UniqueID="",this.Name="",this.Objects=[]},t=function(){this.Areas=[]},u=function(){this.UniqueID="",this.Name="",this.BShape={},this.Table=!1};return f}),define("wsocket",["require"],function(a){function e(a){return function(){if(a.connecting){a.connecting=!1,a.emit(c.ConnectFailed);return}a.connected=!1,a.emit(c.Disconnect)}}function f(a){return function(b){a.emit(c.Error,[b])}}function g(a){return function(b){try{var d=JSON.parse(b.data)}catch(e){a.emit(c.Error,["Invalid JSON received: "+e.message]);return}a.emit(c.Message,[d])}}function h(a){return function(){a.connecting=!1,a.connected=!0,a.emit(c.Connect)}}function i(a){var b=i.options,c=b.parser[b.strictMode?"strict":"loose"].exec(a),d={},e=14;while(e--)d[b.key[e]]=c[e]||"";return d[b.q.name]={},d[b.key[12]].replace(b.q.parser,function(a,c,e){c&&(d[b.q.name][c]=e)}),d}var b={};b.Events={Connect:"connect",ConnectFailed:"connect_failed",Connecting:"connecting",Disconnect:"disconnect",Error:"error",Message:"message"};var c=b.Events;b.Socket=function(a,b){this.events={},this.websocket=undefined,this.connecting=!1,this.connected=!1,this.uri=i(a),typeof document!="undefined"&&(this.uri.protocol=this.uri.protocol||document.location.protocol.slice(0,-1),this.uri.host=this.uri.host||document.domain,this.uri.port=this.uri.port||document.location.port),this.options={host:this.uri.host,secure:"https"==this.uri.protocol,port:this.uri.port||("https"==this.uri.protocol?443:80),resource:this.uri.path||"/wsocket"}};var d=b.Socket;return d.prototype.Connect=function(){if(this.connected)return;this.connecting=!0,this.emit(c.Connecting);var a=window.WebSocket;a||(a=window.MozWebSocket);if(!a){this.emit(c.Error,["browser does not support websockets"]);return}this.websocket=new a(this.prepareUrl()),this.websocket.onopen=h(this),this.websocket.onmessage=g(this),this.websocket.onclose=e(this),this.websocket.onerror=f(this)},d.prototype.Disconnect=function(){if(!this.connected)return;this.websocket.close()},d.prototype.IsConnected=function(){return this.connected},d.prototype.IsConnecting=function(){return this.connecting},d.prototype.On=function(a,b){return a in this.events||(this.events[a]=[]),this.events[a].push(b),this},d.prototype.emit=function(a,b){if(!(a in this.events))return;var c=this.events[a].concat();for(var d=0,e=c.length;d<e;d++)c[d].apply(this,b===undefined?[]:b)},d.prototype.prepareUrl=function(){return(this.options.secure?"wss":"ws")+"://"+this.options.host+":"+this.options.port+""+this.options.resource},d.prototype.RemoveEvent=function(a,b){if(!(a in this.events))return;for(var c=0,d=this.events[a].length;c<d;c++)(this.events[a][c]==b||this.events[a][c].ref&&this.events[a][c].ref==b)&&this.events[a].splice(c,1)},d.prototype.Send=function(a){try{var b=JSON.stringify(a)}catch(d){this.emit(c.Error,["Invalid JSON to send: "+d.message]);return}this.websocket.send(b)},i.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},b}),define("utilities",["require"],function(a){var b={},c=b.Eventer=function(){this.bindings={}};c.prototype.Bind=function(a,c,d){var e=this.bindings[a];if(!e)throw new Error("Bind: Event '"+c+"' not registered.");if(!d)return;var f=e[c];for(var g=0;g<f.length;g++)if(b.FunctionsAreSame(f[g],d))throw new Error("Bind: Let's not be a pig and bind the same function more than once to the '"+c+"' event.");e[c].push(d)},c.prototype.Register=function(a,b){var c=this.bindings[a];c||(c=this.bindings[a]={});var d=c[b];if(d)throw new Error("Register: Event '"+b+"' already registered.");c[b]=[]},c.prototype.Trigger=function(a,c,d){var e=this.bindings[a];if(!e)throw new Error("Trigger: Event '"+c+"' not registered for object.");var f=e[c];if(!f)throw new Error("Trigger: Event '"+c+"' not registered.");for(var g=0;g<f.length;g++)b.CallFunction(f[g],d)},c.prototype.Unbind=function(a,c,d){var e=this.bindings[a];if(!e)throw new Error("Unbind: Event '"+c+"' not registered for object.");var f=e[c];if(!f)throw new Error("Unbind: Event '"+c+"' not registered.");if(!d){f=[];return}for(var g=0;g<f.length;g++)if(b.FunctionsAreSame(f[g],d)){f.splice(g,1);return}};var d=b.Point=function(){this.X=0,this.Y=0};d.prototype.Move=function(a){this.X+=a.X,this.Y+=a.Y},b.NewPoint=function(a,b){var c=new d;return c.X=a,c.Y=b,c};var e=b.Rect=function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0};e.prototype.GetHeight=function(){return this.Bottom-this.Top+1},e.prototype.GetWidth=function(){return this.Right-this.Left+1},b.NewRect=function(){return new e},b.CallFunction=function(a,b,c){a&&a.apply(c,b)},b.CompareStringsForSort=function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a<b?-1:a>b?1:0},b.ConcatWithSeparator=function(a,b,c){return a?c?a+b+c:a:c},b.ConvertXmlToJson=function(a){var c={};if(a.nodeType==1){if(a.attributes.length>0){c["@attributes"]={};for(var d=0;d<a.attributes.length;d++){var e=a.attributes.item(d);c["@attributes"][e.nodeName]=e.nodeValue}}}else a.nodeType==3&&(c=a.nodeValue);if(a.hasChildNodes())for(var f=0;f<a.childNodes.length;f++){var g=a.childNodes.item(f),h=g.nodeName;if(typeof c[h]=="undefined")c[h]=b.ConvertXmlToJson(g);else{if(typeof c[h].length=="undefined"){var i=c[h];c[h]=[],c[h].push(i)}c[h].push(b.ConvertXmlToJson(g))}}return c},b.CreateGravatarMarkup=function(a,c){return a==undefined?"":b.FormatString("http://www.gravatar.com/avatar/{0}?d=mm&s={1}&r=g",a.EmailHash,c)},b.FormatDateTime=function(a,b){var c=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,d=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,e=/[^-+\dA-Z]/g,f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],i=b&&b!=""?b:"ddd mmm dd yyyy HH:MM:ss",j=i.slice(0,4)=="UTC:";j&&(i=i.slice(4));var k=j?"getUTC":"get",l=a[k+"Date"](),m=a[k+"Day"](),n=a[k+"Month"](),o=a[k+"FullYear"](),p=a[k+"Hours"](),q=a[k+"Minutes"](),r=a[k+"Seconds"](),s=a[k+"Milliseconds"](),t=j?0:a.getTimezoneOffset(),u={d:l,dd:g(l,"0",2),ddd:f[m],dddd:f[m+7],m:n+1,mm:g(n+1,"0",2),mmm:h[n],mmmm:h[n+12],yy:String(o).slice(2),yyyy:o,h:p%12||12,hh:g(p%12||12,"0",2),H:p,HH:g(p,"0",2),M:q,MM:g(q,"0",2),s:r,ss:g(r,"0",2),l:g(s,"0",3),L:g(s>99?Math.round(s/10):s,"0",2),t:p<12?"a":"p",tt:p<12?"am":"pm",T:p<12?"A":"P",TT:p<12?"AM":"PM",Z:j?"UTC":(String(a).match(d)||[""]).pop().replace(e,""),o:(t>0?"-":"+")+g(Math.floor(Math.abs(t)/60)*100+Math.abs(t)%60,"0",4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return i.replace(c,function(a){return a in u?u[a]:a.slice(1,a.length-1)})},b.FormatString=function(){for(var a=1;a<arguments.length;a++){var b=new RegExp("\\{"+(a-1)+"\\}","gm");arguments[0]=arguments[0].replace(b,arguments[a])}return arguments[0]},b.FormatString=function(){for(var a=1;a<arguments.length;a++){var b=new RegExp("\\{"+(a-1)+"\\}","gm");arguments[0]=arguments[0].replace(b,arguments[a])}return arguments[0]},b.FunctionsAreSame=function(a,b){return a==b||a.ref&&a.ref==b},b.GenerateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*15|0,c=a=="x"?b:b&3|8;return c.toString(16)})},b.InheritFields=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},b.InheritFunctions=function(a,b){for(var c in b.prototype){if(!b.prototype.hasOwnProperty(c))continue;if(a.prototype[c])continue;a.prototype[c]=b.prototype[c]}},b.ItemInArrayHasFieldWithValue=function(a,b,c){if(!a)return!1;for(var d=0;d<a.length;d++)if(a[d][b]==c)return!0;return!1},b.LocalStorage={};var f=b.LocalStorage;f.Set=function(a,b){localStorage.setItem(a,b)},f.Get=function(a){return localStorage.getItem(a)},b.IsEmptyArray=function(a){return a==undefined||a.length==0},b.IsEmptyObject=function(a){for(var b in a)return!1;return!0},b.PadLeft=function(a,b,c){var d=String(a);while(d.length<c)d=b+d;return d};var g=b.PadLeft;return b.PointInRect=function(a,b){return a.X<b.Left?!1:a.Y<b.Top?!1:a.X>b.Right?!1:a.Y>b.Bottom?!1:!0},b.RepeatString=function(a,b){return(new Array(b+1)).join(a)},b}),define("objects/schema/model_utils",["require","utilities"],function(a){var b=a("utilities"),c={};return c.ModelChangeObjectKind={None:0,Delete:1,New:2,Update:3},c.LoadModels=function(a,c,d){function g(a,c){if(f)return;f=!0,b.CallFunction(d,[a,c],undefined)}function h(){if(f)return;e--,e==0&&b.CallFunction(c,undefined,undefined)}var e=a.length,f=!1;if(e==0){b.CallFunction(c,undefined,undefined);return}for(var i=0;i<a.length;i++){if(f)return;a[i].InternalLoad(h,g)}},c}),define("master_api",["require","coreglobals","utilities"],function(a){function h(a,d,h,i){function m(a,b,d){o(0,c.FormatString("API request '{0}' ajax failure. Message: {1}. Error: {2}",j,b,d.message))}function n(a){try{t(JSON.parse(a))}catch(b){p(b)}}function o(a,b){h?(h(a,b),console.warn(c.FormatString("API request '{0}' failed. Code: {1}. Message: {2}",j,a,b))):console.warn(c.FormatString("API request '{0}' failed. Code: {1}. Message: {2}",j,a,b))}function p(a){o(-1,c.FormatString("Exception: {0}",a.message+"<br/>"+a.stack))}function q(){return i==g.Any&&b.ForceAjax?g.Ajax:i==g.Any&&b.Authenticated?g.Websocket:i==g.Any?g.Ajax:i}function r(){$.ajax({type:"POST",url:f,contentType:"application/json",data:JSON.stringify(a),processData:!1,dataType:"text",timeout:5e3,success:n,error:m})}function s(){if(!b.Authenticated){o(-2,"Websocket not connected and authenticated.");return}b.PosConnection.SendMessage(a,v,w)}function t(a){l&&window.clearInterval(l);if(!a.Ok){a.FailureCode==10020&&(c.LocalStorage.Set("sessionToken",""),c.LocalStorage.Set("sessionExpired","1"),window.location.reload()),o(a.FailureCode,a.FailureMessage);return}a.SessionToken&&(e=a.SessionToken,c.LocalStorage.Set("sessionToken",e,"")),c.CallFunction(d,[a])}function u(){l=window.setTimeout(function(){l=undefined,$("#network_busy").show(),k&&window.clearInterval(k),k=window.setTimeout(function(){$("#network_busy").hide()},250)},1500)}function v(a){try{t(a)}catch(b){p(b)}}function w(){o(-1,c.FormatString("API request '{0}' timed out.",j))}var j="",k=undefined,l=undefined;j=a.Action?a.Action:"";try{u();var x=q();a.RequestID||(a.RequestID=c.GenerateUUID()),x!=g.Websocket&&!a.SessionToken&&(a.SessionToken=e),x==g.Ajax?r():x==g.Websocket?s():o(-2,c.FormatString("API request '{0}'. Invalid transport type: {1}",j,i))}catch(y){p(y)}}var b=a("coreglobals"),c=a("utilities"),d={},e="",f="/request";d.GetCurrentToken=function(){return e},d.AutoLogin=function(a,b,d){e=a,c.LocalStorage.Set("sessionToken",e,"");var f={Action:"AutoLogin",SessionToken:a};h(f,function(a){e=a.SessionToken,c.LocalStorage.Set("sessionToken",e,""),b(a)},d,g.Ajax)},d.ChangeCollaboratorStatus=function(a,b,c){var d={Action:"ChangeCollaboratorStatus",Status:a};h(d,b,c,g.Websocket)},d.ChangeConversation=function(a,b,c,d){var e={Action:"ChangeConversation",Conversation_uid:a,ChangeObject:b};h(e,c,d,g.Any)},d.ChangeLocationFloorChart=function(a,b,c,d){var e={Action:"ChangeLocationFloorChart",UniqueID:a,ChangeObject:b};h(e,c,d,g.Any)},d.ChangeOrgStructure=function(a,b,c,d){var e={Action:"ChangeOrgStructure",UniqueID:a,ChangeObject:b};h(e,c,d,g.Any)},d.ChangePassword=function(a,b,c,d,e){var f={Action:"ChangePassword",OldPassword:b,NewPassword:c,UniqueID:a};h(f,d,e,g.Any)},d.CollaboratorEnter=function(a,b,c){var d={Action:"CollaboratorEnter",Form_uid:a};h(d,b,c,g.Any)},d.CollaboratorLeave=function(a,b,c){var d={Action:"CollaboratorLeave",Form_uid:a};h(d,b,c,g.Any)},d.DeleteAccounts=function(a,b,c){var d={Action:"DeleteAccounts",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteBOGroups=function(a,b,c){var d={Action:"DeleteBOGroups",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteConversations=function(a,b,c){var d={Action:"DeleteConversations",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteJobPositions=function(a,b,c){var d={Action:"DeleteJobPositions",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteLocations=function(a,b,c){var d={Action:"DeleteLocations",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteLocationFloorCharts=function(a,b,c){var d={Action:"DeleteLocationFloorCharts",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteOrganizations=function(a,b,c){var d={Action:"DeleteOrganizations",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteOrgStructureElements=function(a,b,c,d,e){var f={Action:"DeleteOrgStructureElements",OrgStructure_uid:a,UniqueIDs:b,MoveChildrenToParent:c};h(f,d,e,g.Any)},d.DeleteOrgStructures=function(a,b,c){var d={Action:"DeleteOrgStructures",UniqueIDs:a};h(d,b,c,g.Any)},d.DeletePosGroups=function(a,b,c){var d={Action:"DeletePosGroups",UniqueIDs:a};h(d,b,c,g.Any)},d.DeletePosUsers=function(a,b,c){var d={Action:"DeletePosUsers",UniqueIDs:a};h(d,b,c,g.Any)},d.DeletePosUserJobPositions=function(a,b,c){var d={Action:"DeletePosUserJobPositions",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteUserLocations=function(a,b,c){var d={Action:"DeleteUserLocations",UniqueIDs:a};h(d,b,c,g.Any)},d.DeleteUsers=function(a,b,c){var d={Action:"DeleteUsers",UniqueIDs:a};h(d,b,c,g.Any)},d.ForgotPassword=function(a,b,c){var d={Action:"ForgotPassword",Email:a};h(d,b,c,g.Any)},d.GetAccounts=function(a,b){var c={Action:"GetAccounts"};h(c,a,b,g.Any)},d.GetBOGroup=function(a,b,c){var d={Action:"GetBOGroup",UniqueID:a};h(d,b,c,g.Any)},d.GetBOGroupHeaders=function(a,b){var c={Action:"GetBOGroupHeaders"};h(c,a,b,g.Any)},d.GetBOPermissions=function(a,b){var c={Action:"GetBOPermissions"};h(c,a,b,g.Any)},d.GetCollaborators=function(a,b){var c={Action:"GetCollaborators"};h(c,a,b,g.Any)},d.GetConversation=function(a,b,c){var d={Action:"GetConversation",UniqueID:a};h(d,b,c,g.Any)},d.GetConversations=function(a,b){var c={Action:"GetConversations"};h(c,a,b,g.Any)},d.GetConnections=function(a,b){var c={Action:"GetConnections"};h(c,a,b,g.Any)},d.GetFloorChart=function(a,b,c){var d={Action:"GetLocationFloorChart",UniqueID:a};h(d,b,c,g.Any)},d.GetJobPositions=function(a,b){var c={Action:"GetJobPositions"};h(c,a,b,g.Any)},d.GetLocations=function(a,b){var c={Action:"GetLocations"};h(c,a,b,g.Any)},d.GetLocationFloorChartHeaders=function(a,b,c,d){var e={Action:"GetLocationFloorChartHeaders",Organization_uid:a,Location_uid:b};h(e,c,d,g.Any)},d.GetOrganizations=function(a,b){var c={Action:"GetOrganizations"};h(c,a,b,g.Any)},d.GetOrgStructureHeaders=function(a,b,c){var d={Action:"GetOrgStructureHeaders",Organization_uid:a};h(d,b,c,g.Any)},d.GetPosPermissions=function(a,b){var c={Action:"GetPosPermissions"};h(c,a,b,g.Any)},d.GetPosUsers=function(a,b){var c={Action:"GetPosUsers"};h(c,a,b,g.Any)},d.GetPosUserJobPositions=function(a,b){var c={Action:"GetPosUserJobPositions"};h(c,a,b,g.Any)},d.GetPosGroup=function(a,b,c){var d={Action:"GetPosGroup",UniqueID:a};h(d,b,c,g.Any)},d.GetPosGroupHeaders=function(a,b){var c={Action:"GetPosGroupHeaders"};h(c,a,b,g.Any)},d.GetStructure=function(a,b,c){var d={Action:"GetOrgStructure",UniqueID:a};h(d,b,c,g.Any)},d.GetUserLocations=function(a,b){var c={Action:"GetUserLocations"};h(c,a,b,g.Any)},d.GetUsers=function(a,b){var c={Action:"GetUsers"};h(c,a,b,g.Any)},d.GetVersion=function(a,b){var c={Action:"GetVersion"};h(c,a,b,g.Any)},d.Login=function(a,b,c,d){var e={Action:"Login",Email:a,Password:b};h(e,c,d,g.Ajax)},d.Logout=function(a,b){var c={Action:"Logout"};h(c,a,b,g.Any)},d.MoveOrgStructureElement=function(a,b,c,d,e,f){var i={Action:"MoveOrgStructureElement",OrgStructure_uid:a,UniqueID:b,Parent_uid:c,Index:d};h(i,e,f,g.Any)},d.NewAccount=function(a,b,c){var d={Action:"NewAccount",Fields:a};h(d,b,c,g.Any)},d.NewBOGroup=function(a,b,c){var d={Action:"NewBOGroup",Fields:a};h(d,b,c,g.Any)},d.NewDesktop=function(a,b,c){var d={Action:"NewDesktop",Fields:a};h(d,b,c,g.Any)},d.NewJobPosition=function(a,b,c){var d={Action:"NewJobPosition",Fields:a};h(d,b,c,g.Any)},d.NewLocation=function(a,b,c){var d={Action:"NewLocation",Fields:a};h(d,b,c,g.Any)},d.NewLocationFloorChart=function(a,b,c){var d={Action:"NewLocationFloorChart",Fields:a};h(d,b,c,g.Any)},d.NewOrganization=function(a,b,c){var d={Action:"NewOrganization",Fields:a};h(d,b,c,g.Any)},d.NewOrgStructure=function(a,b,c){var d={Action:"NewOrgStructure",Fields:a};h(d,b,c,g.Any)},d.NewOrgStructureElement=function(a,b,c,d,e,f){var i={Action:"NewOrgStructureElement",OrgStructure_uid:a,Parent_uid:d,Type:b,Caption:c};h(i,e,f,g.Any)},d.NewPosGroup=function(a,b,c){var d={Action:"NewPosGroup",Fields:a};h(d,b,c,g.Any)},d.NewPosUser=function(a,b,c){var d={Action:"NewPosUser",Fields:a};h(d,b,c,g.Any)},d.NewPosUserJobPosition=function(a,b,c){var d={Action:"NewPosUserJobPosition",Fields:a};h(d,b,c,g.Any)},d.NewUser=function(a,b,c){var d={Action:"NewUser",Fields:a};h(d,b,c,g.Any)},d.NewUserLocation=function(a,b){var c={Action:"NewUserLocation"};h(c,a,b,g.Any)},d.ResetPassword=function(a,b,c){var d={Action:"ResetPassword",UniqueID:a};h(d,b,c,g.Any)},d.SetBOGroupsPermission=function(a,b,c,d,e){var f={Action:"SetBOGroupsPermission",UniqueIDs:a,Permission_uid:b,Value:c};h(f,d,e,g.Any)},d.SetPosGroupsPermission=function(a,b,c,d,e){var f={Action:"SetPosGroupsPermission",UniqueIDs:a,Permission_uid:b,Value:c};h(f,d,e,g.Any)},d.StartChat=function(a,b,c){var d={Action:"StartChat",Account_uids:a};h(d,b,c,g.Any)},d.SubscribeToNotifications=function(a,b,c){var d={Action:"SubscribeToNotifications",Notifications:[]};for(var e=0;e<a.length;e++)d.Notifications.push({Action:a[e]});h(d,b,c,g.Websocket)},d.UnsubscribeFromNotifications=function(a,b,c){var d={Action:"UnsubscribeFromNotifications",Notifications:[]};for(var e=0;e<a.length;e++)d.Notifications.push({Action:a[e]});h(d,b,c,g.Websocket)},d.UpdateAccounts=function(a,b,c,d){var e={Action:"UpdateAccounts",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateBOGroups=function(a,b,c,d){var e={Action:"UpdateBOGroups",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateDesktops=function(a,b,c,d){var e={Action:"UpdateDesktops",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateJobPositions=function(a,b,c,d){var e={Action:"UpdateJobPositions",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateLocations=function(a,b,c,d){var e={Action:"UpdateLocations",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateLocationFloorCharts=function(a,b,c,d){var e={Action:"UpdateLocationFloorCharts",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateOrganizations=function(a,b,c,d){var e={Action:"UpdateOrganizations",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateOrgStructures=function(a,b,c,d){var e={Action:"UpdateOrgStructure",UniqueID:a,Fields:b};h(e,c,d,g.Any)},d.UpdateOrgStructureElement=function(a,b,c,d,e){var f={Action:"UpdateOrgStructureElement",OrgStructure_uid:a,UniqueID:b,Fields:c};h(f,d,e,g.Any)},d.UpdatePosGroups=function(a,b,c,d){var e={Action:"UpdatePosGroups",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdatePosUsers=function(a,b,c,d){var e={Action:"UpdatePosUsers",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdatePosUserJobPositions=function(a,b,c,d){var e={Action:"UpdatePosUserJobPositions",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateUserLocations=function(a,b,c,d){var e={Action:"UpdateUserLocations",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.UpdateUsers=function(a,b,c,d){var e={Action:"UpdateUsers",UniqueIDs:a,Fields:b};h(e,c,d,g.Any)},d.ValidateSession=function(a,b){var c={Action:"ValidateSession"};h(c,a,b,g.Ajax)};var g={Any:1,Ajax:2,Websocket:3};return d}),define("general_functions",["require","utilities"],function(a){function d(a,b,c,e){c=c||{},e=e||"";for(var f in a)if(b||a.hasOwnProperty(f)){var g=a[f];!g||typeof g!="object"||g instanceof Date||g instanceof RegExp?c[e+f]=g:d(g,b,c,e+f+".")}return c}var b={},c=a("utilities");return b.AddNewWithOrganization=function(a,d,e,f,g,h,i){var j=a.Organizations.GetItems();switch(j.length){case 0:b.DialogError("There are no organizations in the system","No Organizations",!0);break;case 1:g.Organization_uid=j[0].UniqueID,d.AddNew(g,h,b.DialogError);break;default:b.DialogSelectOrganization(e,f,a.Organizations,function(a){g.Organization_uid=a,d.AddNew(g,h,b.DialogError),c.CallFunction(i)},i)}},b.DialogSelectOrganization=function(a,c,d,e,f){var g=$("<div></div>");g.append("<span>"+c+"</span><br/><br/>");var h=$("<select></select>");g.append(h),b.SetDropDownList(h,d,null,undefined,!0),g.dialog({modal:!0,resizable:!1,title:a,buttons:{Continue:function(){var a=$(this).find("select").val(),b=$(this);e(a),$(b).dialog("close")},Cancel:function(){var a=$(this);b.CallFunction(f),$(a).dialog("close")}}})},b.ArraysAreEqual=function(a,b){return!!a&&!!b&&!(a<b||b<a)},b.CallFunction=function(a,b,c){a&&a.apply(c,b)},b.CreateChatButton=function(a){return $("<span class='person-link'><img id='status' style='border:none;width:12px;height:12px;vertical-align:middle;margin-top:-4px;margin-right:4px;' src=''/><img src='"+c.CreateGravatarMarkup(a,16)+"' style='width:16px;height:16px;vertical-align:middle;margin-top:-4px;margin-right:4px;'/><span id='user_name'>"+a.Name+"</span></span>").data("account",a)},b.CreateSubFormLinkState=function(a){return{ListViewState:{selectedIds:[a]}}},b.GetModelItemValue=function(a,b,c){var d=a.getItemByID(b);return d!=undefined&&d[c]!=undefined?d[c]:""},b.SetDropDownList=function(a,b,c,d,e){function f(){$(a).data("selectmenu")&&$(a).selectmenu("destroy"),$(a).html(""),e||$(a).html("").append($("<option></option>").attr("value","").text("<span style='color:#ff0000;'>None</span>")),$.each(b.GetItems(d),function(b,c){$(a).append($("<option></option>").attr("value",c.UniqueID).text(c.Name))}),$(a).children().sortElements(function(a,b){var c=$(a).text(),d=$(b).text();return c>d?1:-1}),c&&$(a).val(c),$(a).selectmenu()}f()},b.DialogAlert=function(a,b,c){c?$("#notify_box").removeClass("notify_box").addClass("notify_box_red"):$("#notify_box").removeClass("notify_box_red").addClass("notify_box"),$("#notify_box").stop(!0,!0).html("<div style='padding-bottom:3px;margin-bottom:8px;border-bottom: 1px dotted #606060;'><b>"+b+"</b><div class='ui-icon ui-icon-closethick' onclick='$(\"#notify_box\").stop(true,false).css(\"top\",\"-600px\")' style='position: absolute; top:4px; right:4px;'></div></div><div style='clear:both;'>"+a+"</div>");var d=-1*($("#notify_box").height()+40);$("#notify_box").css("top",d+"px"),$("#notify_box").fadeIn("fast").animate({top:0},750,function(){$("#notify_box").delay(8e3).animate({top:d},750).fadeOut(500)})},b.DialogConfirmYesNo=function(a,b,c){var d=$("<div>"+a+"</div>");$(d).dialog({title:"<div class='icon-confirm' style='float:left;'></div>"+b,modal:!0,width:640,resizable:!1,buttons:{Yes:function(){c(),$(this).dialog("close")},No:function(){$(this).dialog("close")}}})},b.DialogError=function(a,c){b.DialogAlert(c,"Error",!0)},b.GetObjectChanges=function(a,c,e){var f={};return a==null&&(a={}),$.each(a,function(d,g){if(!$.isNumeric(d)&&$.inArray(d.toLowerCase(),e)==-1)switch(typeof c[d]){case"object":f[d]=b.GetObjectChanges(a[d],c[d],[]);break;case"function":break;default:g!=c[d]&&(f[d]=c[d])}}),d(f)},b.GetUniqueIDs=function(a){var b=[];return $.each(a,function(a,c){b.push(c.UniqueID)}),b},b.GetFieldValues=function(a,b){var c=[];for(var d=0;d<a.length;d++)a[d][b]&&c.push(a[d][b]);return c},b.GetCommonFields=function(a,b,c){c=c||"";var d=b[0];c!=""&&(d=this.GetNotatedValue(b[0],c));for(var e in d)switch(typeof d[e]){case"object":this.GetCommonFields(a,b,c+e);break;case"function":break;default:var f=c;f!=""&&(f+=".");var g=this.GetNotatedValue(b[0],f+e),h=!0,i=this;$.each(b,function(a,b){if(i.GetNotatedValue(b,f+e)!=g)return h=!1,!1}),h?$.extend(!0,a,this.GetPartialUpdateObject(f+e,g)):$.extend(!0,a,this.GetPartialUpdateObject(f+e,"xxx_variable_xxx"))}},b.GetNotatedPath=function(a){var b="";switch(typeof a){case"object":case"function":break;default:b=a}return b},b.GetNotatedValue=function(a,b){if(b==undefined)return;if(b.indexOf(".")<0)return a[b];var c=b.split("."),d=a;return $(c).each(function(a,b){d=d[b]}),d},b.GetPartialUpdateObject=function(a,b){var c={},d=a.split(".");if(d.length==1)c[a]=b;else{var e=c;for(var f=0;f<d.length-1;f++)e[d[f]]={},e=e[d[f]];e[d[d.length-1]]=b}return c},b.FormatAddress=function(a){var b=this.ToString(a.Address.Street1);return b=c.ConcatWithSeparator(b,", ",this.ToString(a.Address.Street2)),b=c.ConcatWithSeparator(b,", ",this.ToString(a.Address.City)),b=c.ConcatWithSeparator(b,", ",this.ToString(a.Address.State)),b=c.ConcatWithSeparator(b,", ",this.ToString(a.Address.Zip)),b},b.LogHistory="",b.LogMessage=function(a){var d="<tr><td valign='top'>"+c.FormatDateTime(new Date,"HH:MM:ss")+"</td><td>"+a+"</td></tr>";b.LogHistory=d+b.LogHistory,$(document).trigger("debug",d)},b.OverlayObjectArrays=function(a,b,c){c||(c="UniqueID"),$.each(b,function(b,d){var e=!1;$.each(a,function(a,b){if(b[c]==d[c])return $.extend(!0,b,d),e=!0,!1}),e||a.push(d)});var d=[];$.each(a,function(a,e){var f=!1;$.each(b,function(a,b){if(e[c]==b[c])return f=!0,!1}),f||d.push(a)});for(var e=d.length-1;e>-1;e--)a.splice(d[e],1)},b.ToString=function(a){return a==undefined||a==null?"":a},b.ErrorFormat="<b>{1}</b>&nbsp;&nbsp;<span style='font-size:11pt;'>[Error {0}]</span>",b.AccountTypes=["Unknown","Admin","Reseller","Standard"],b}),define("objects/schema/model_classes",["require","general_functions","master_api","utilities","objects/schema/model_utils","coreglobals"],function(a){function h(a,b){this.successCB=a,this.failureCB=b}var b=a("general_functions"),c=a("master_api"),d=a("utilities"),e=a("objects/schema/model_utils"),f=a("coreglobals"),g={},i="changed",j="itemChanged",k=g.Model=function(){this.eventer=new d.Eventer,this.eventer.Register(this,i),this.eventer.Register(this,j),this.items=new Array,this.keyField="UniqueID",this.requires=[],this.loaded=!1,this.loading=!1,this.loadingCallbackQueue=[],this.NetworkSubscriptions=[]};k.prototype.AddNetworkSubscription=function(a,b){if(!b)throw new Error("AddNetworkSubscription requires a functionCB for "+a);this.NetworkSubscriptions.push(f.NewNetworkSubscription(a,b))},k.prototype.AddNew=function(){throw new Error("AddNew must be implemented at the model level.")},k.prototype.Bind=function(a,b){this.eventer.Bind(this,a,b)},k.prototype.BindChanged=function(a){this.Bind(i,a)},k.prototype.callSelfChanged=function(a){a.Items.length>0&&this.SelfChanged(a)},k.prototype.DeleteItems=function(){throw new Error("DeleteItems must be implemented at the model level.")},k.prototype.ExtendOrAddLocalItems=function(a,c){c||(c=[]);var d=[],f=m(e.ModelChangeObjectKind.New,[],undefined),g=m(e.ModelChangeObjectKind.Update,[],undefined);for(var h=0;h<a.length;h++){var i=this.GetItemByKey(a[h][this.keyField]);if(!i)this.items.push(a[h]),f.Items.push(a[h]);else{var j=b.GetObjectChanges(i,a[h],c);$.extend(!0,i,a[h]),d.push({id:a[h][this.keyField],changes:j}),g.Fields||(g.Fields=j),g.Items.push(a[h])}}this.callSelfChanged(f),this.callSelfChanged(g),this.TriggerChanged_DTM(f),this.TriggerChanged_DTM(g);for(var k=0;k<d.length;k++)this.TriggerItemChanged(d[k])},k.prototype.GetAddNew=function(a,b){var f=this;return function(g,h,i){c[a](g,function(a){var c=m(e.ModelChangeObjectKind.New,[a[b]]);f.items.push(a[b]),f.callSelfChanged(c),f.TriggerChanged_DTM(c),d.CallFunction(h,[a[b]])},function(a,b){d.CallFunction(i,[a,b])})}},k.prototype.GetDeleteItems=function(a){var f=this;return function(g,h,i){var j=b.GetFieldValues(g,f.keyField);c[a](j,function(a){var b=m(e.ModelChangeObjectKind.Delete,[]);for(var c=0;c<j.length;c++)for(var g=f.items.length-1;g>=0;g--)j[c]==f.items[g][f.keyField]&&(b.Items.push(f.items[g]),f.items.splice(g,1));f.callSelfChanged(b),f.TriggerChanged_DTM(b),d.CallFunction(h,[a])},function(a,b){d.CallFunction(i,[a,b])})}},k.prototype.GetItemByKey=function(a){var b=this,c={};c[b.keyField]=a;var d=this.GetItems(c);return d.length==0?undefined:d[0]},k.prototype.GetItemString=function(a,b){var c=this.GetItems(a);return c.length==0?"":c[0][b]?c[0][b]:""},k.prototype.GetItems=function(a){var b=[];a||(a={});for(var c=0;c<this.items.length;c++){var d=!0;for(var e in a)if(a.hasOwnProperty(e)&&this.items[c][e]!=a[e]){d=!1;break}d&&b.push(this.items[c])}return b},k.prototype.GetLoad=function(a,e){var f=this;return function(g,h){c[a](function(a){b.OverlayObjectArrays(f.items,a[e],f.keyField),d.CallFunction(g,[a])},function(a,b){d.CallFunction(h,[a,b])})}},k.prototype.GetNetworkNew=function(a){var b=this;return function(c){for(var d=0;d<b.items.length;d++)if(b.items[d][b.keyField]==c[a][b.keyField])return;var f=new n(c[a][b.keyField],{},c.UserInfo),g=m(e.ModelChangeObjectKind.New,[c[a]],{},f);b.items.push(c[a]),b.callSelfChanged(g),b.TriggerChanged_DTM(g)}},k.prototype.GetNetworkUpdate=function(a,c){var d=this;return function(f){for(var g=0;g<d.items.length;g++)if(d.items[g][d.keyField]==f[a][d.keyField]){var h=b.GetObjectChanges(d.items[g],f[a],c);$.extend(!0,d.items[g],f[a]);var i=new n(d.items[g][d.keyField],h,f.UserInfo),j=m(e.ModelChangeObjectKind.Update,[d.items[g]],h,i);d.callSelfChanged(j),d.TriggerChanged_DTM(j);break}}},k.prototype.GetNetworkDelete=function(){var a=this;return function(b){for(var c=0;c<a.items.length;c++)if(b[a.keyField]==a.items[c][a.keyField]){var d=new n(a.items[c][a.keyField],{},b.UserInfo),f=m(e.ModelChangeObjectKind.Delete,[a.items[c]],{},d);a.items.splice(c,1),a.callSelfChanged(f),a.TriggerChanged_DTM(f);break}}},k.prototype.GetUpdateItems=function(a,f){var g=this;return function(h,i,j,k){var l=b.GetFieldValues(h,g.keyField);c[a](l,i,function(a){var b=m(e.ModelChangeObjectKind.Update,[],i);for(var c=0;c<h.length;c++)for(var k=0;k<a[f].length;k++)h[c][g.keyField]==a[f][k][g.keyField]&&($.extend(!0,h[c],a[f][k]),b.Items.push(a[f][k]));g.callSelfChanged(b),g.TriggerChanged_DTM(b),d.CallFunction(j,[{success:!0}])},function(a,b){d.CallFunction(k,[a,b])})}},k.prototype.Load=function(){throw new Error("Load must be implemented at the model level.")},k.prototype.PostProcess=function(){},k.prototype.RegisterEvent=function(a){this.eventer.Register(this,a)},k.prototype.UpdateItems=function(){throw new Error("UpdateItems must be implemented at the model level.")},k.prototype.SelfChanged=function(a){throw new Error("SelfChanged must be implemented at the model level.")},k.prototype.SubscribeToNotifications=function(){f.AddSubscriptions(this.NetworkSubscriptions)},k.prototype.Trigger=function(a,b){this.eventer.Trigger(this,a,b)},k.prototype.TriggerChanged=function(){this.Trigger(i)},k.prototype.TriggerChanged_DTM=function(a){a.Items.length>0&&this.Trigger(i,[a])},k.prototype.TriggerItemChanged=function(a){this.Trigger(j,[a])},k.prototype.Unbind=function(a,b){this.eventer.Unbind(this,a,b)},k.prototype.Unload=function(){this.loaded=!1,this.loading=!1,this.items=[]},k.prototype.UnbindChanged=function(a){this.eventer.Unbind(this,i,a)},k.prototype.InternalLoad=function(a,b){function f(a,b){var e=[a,b];for(var f=0;f<c.loadingCallbackQueue.length;f++)d.CallFunction(c.loadingCallbackQueue[f].failureCB,e,undefined)}function g(){for(var a=0;a<c.loadingCallbackQueue.length;a++)d.CallFunction(c.loadingCallbackQueue[a].successCB,undefined,undefined)}function i(a,b){c.loading=!1,f(a,b)}function j(){c.loading=!1,c.loaded=!0,c.callSelfChanged(m(e.ModelChangeObjectKind.New,c.items)),c.SubscribeToNotifications(),g(),c.loadingCallbackQueue=[]}function k(a,b){c.loading=!1,f(a,b)}function l(){e.LoadModels(c.requires,j,i)}var c=this;if(this.loaded){d.CallFunction(a,undefined,undefined);return}this.loadingCallbackQueue.push(new h(a,b));if(this.loading)return;this.loading=!0,this.Load(l,k)},k.prototype.Require=function(a,b){a.BindChanged(b),this.requires.push(a)};var l=g.ModelChangeObject=function(){this.Kind=e.ModelChangeObjectKind.None,this.Items=undefined,this.Fields=undefined,this.NetworkChangeObject=undefined};l.prototype.IsDelete=function(){return this.Kind==e.ModelChangeObjectKind.Delete},l.prototype.IsNew=function(){return this.Kind==e.ModelChangeObjectKind.New},l.prototype.IsUpdate=function(){return this.Kind==e.ModelChangeObjectKind.Update},l.prototype.IsLocalDelete=function(){return!this.NetworkChangeObject&&this.Kind==e.ModelChangeObjectKind.Delete},l.prototype.IsLocalNew=function(){return!this.NetworkChangeObject&&this.Kind==e.ModelChangeObjectKind.New},l.prototype.IsLocalUpdate=function(){return!this.NetworkChangeObject&&this.Kind==e.ModelChangeObjectKind.Update},l.prototype.IsNetworkDelete=function(){return this.NetworkChangeObject&&this.Kind==e.ModelChangeObjectKind.Delete},l.prototype.IsNetworkNew=function(){return this.NetworkChangeObject&&this.Kind==e.ModelChangeObjectKind.New},l.prototype.IsNetworkUpdate=function(){return this.NetworkChangeObject&&this.Kind==e.ModelChangeObjectKind.Update};var m=g.NewModelChangeObject=function(a,b,c,d){var e=new l;return e.Kind=a,e.Items=b?b:[],e.Fields=c,e.NetworkChangeObject=d,e},n=g.NetworkChangeObject=function(a,b,c){this.id=a,this.changes=b,this.remoteUser=c};return g}),define("objects/models/model_accounts",["require","objects/schema/model_classes","master_api","utilities"],function(a){var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("utilities"),e=new b.Model;return e.AddNetworkSubscription("DeleteAccountNotification",e.GetNetworkDelete()),e.AddNetworkSubscription("UpdateAccountNotification",e.GetNetworkUpdate("Account")),e.AddNetworkSubscription("NewAccountNotification",e.GetNetworkNew("Account",[])),e.AddNew=e.GetAddNew("NewAccount","Account"),e.Load=e.GetLoad("GetAccounts","Accounts"),e.DeleteItems=e.GetDeleteItems("DeleteAccounts"),e.ResetPassword=function(a,b,e){c.ResetPassword(a.UniqueID,function(a){d.CallFunction(b,[a])},e)},e.SelfChanged=function(a){console.log("model_accounts selfChanged "+a.Items.length)},e.UpdateItems=e.GetUpdateItems("UpdateAccounts","Accounts"),e}),define("objects/models/model_bogroups",["require","objects/schema/model_classes","master_api","utilities"],function(a){function f(a){for(var b=0;b<e.items.length;b++){var c=e.items[b];if(c[e.keyField]==a[e.keyField]){if(c.Detail&&c.Detail.Permissions){var f=!1;$.each(c.Detail.Permissions,function(b,c){b==a.Permission_uid&&($.extend(!0,c,a.Value),f=!0)});if(!f){var g=a.Permission_uid;c.Detail.Permissions[g]=a.Value}}$(e).trigger("permissionChanged",{id:c.UniqueID,changes:a.Value,remote:a.UserInfo.Name,image:d.CreateGravatarMarkup(a.UserInfo,24)})}}}var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("utilities"),e=new b.Model;return e.hasDetails=!0,e.AddNetworkSubscription("DeleteBOGroupNotification",e.GetNetworkDelete()),e.AddNetworkSubscription("UpdateBOGroupNotification",e.GetNetworkUpdate("BOGroup")),e.AddNetworkSubscription("NewBOGroupNotification",e.GetNetworkNew("BOGroup",["detail"])),e.AddNetworkSubscription("SetBOGroupPermissionNotification",f),e.AddNew=e.GetAddNew("NewBOGroup","BOGroup"),e.DeleteItems=e.GetDeleteItems("DeleteBOGroups"),e.getDetails=function(a,b){c.GetBOGroup(a,function(a){e.ExtendOrAddLocalItems([a.BOGroup]),d.CallFunction(b)})},e.Load=e.GetLoad("GetBOGroupHeaders","BOGroups"),e.UpdateItems=e.GetUpdateItems("UpdateBOGroups","BOGroups"),e.SelfChanged=function(a){console.log("model_bogroups selfChanged "+a.Items.length)},e}),define("objects/models/model_jobpositions",["require","objects/schema/model_classes"],function(a){var b=a("objects/schema/model_classes"),c=new b.Model;return c.AddNetworkSubscription("DeleteJobPositionNotification",c.GetNetworkDelete()),c.AddNetworkSubscription("UpdateJobPositionNotification",c.GetNetworkUpdate("JobPosition")),c.AddNetworkSubscription("NewJobPositionNotification",c.GetNetworkNew("JobPosition",[])),c.AddNew=c.GetAddNew("NewJobPosition","JobPosition"),c.DeleteItems=c.GetDeleteItems("DeleteJobPositions"),c.Load=c.GetLoad("GetJobPositions","JobPositions"),c.SelfChanged=function(a){console.log("model_jobpositions selfChanged "+a.Items.length)},c.UpdateItems=c.GetUpdateItems("UpdateJobPositions","JobPositions"),c}),define("objects/models/model_locations",["require","objects/schema/model_classes"],function(a){var b=a("objects/schema/model_classes"),c=new b.Model;return c.AddNetworkSubscription("DeleteLocationNotification",c.GetNetworkDelete()),c.AddNetworkSubscription("UpdateLocationNotification",c.GetNetworkUpdate("Location")),c.AddNetworkSubscription("NewLocationNotification",c.GetNetworkNew("Location",[])),c.AddNew=c.GetAddNew("NewLocation","Location"),c.DeleteItems=c.GetDeleteItems("DeleteLocations"),c.Load=c.GetLoad("GetLocations","Locations"),c.SelfChanged=function(a){console.log("model_locations selfChanged "+a.Items.length)},c.UpdateItems=c.GetUpdateItems("UpdateLocations","Locations"),c}),define("objects/models/model_organizations",["require","objects/schema/model_classes"],function(a){var b=a("objects/schema/model_classes"),c=new b.Model;return c.AddNetworkSubscription("DeleteOrganizationNotification",c.GetNetworkDelete()),c.AddNetworkSubscription("UpdateOrganizationNotification",c.GetNetworkUpdate("Organization")),c.AddNetworkSubscription("NewOrganizationNotification",c.GetNetworkNew("Organization",[])),c.AddNew=c.GetAddNew("NewOrganization","Organization"),c.DeleteItems=c.GetDeleteItems("DeleteOrganizations"),c.Load=c.GetLoad("GetOrganizations","Organizations"),c.UpdateItems=c.GetUpdateItems("UpdateOrganizations","Organizations"),c.SelfChanged=function(a){console.log("model_organizations selfChanged "+a.Items.length)},c}),define("objects/models/model_posgroups",["require","objects/schema/model_classes","master_api","utilities"],function(a){function f(a){for(var b=0;b<e.items.length;b++){var c=e.items[b];if(c[e.keyField]==a[e.keyField]){if(c.Detail&&c.Detail.Permissions){var f=!1;$.each(c.Detail.Permissions,function(b,c){b==a.Permission_uid&&($.extend(!0,c,a.Value),f=!0)});if(!f){var g=a.Permission_uid;c.Detail.Permissions[g]=a.Value}}$(e).trigger("permissionChanged",{id:c.UniqueID,changes:a.Value,remote:a.UserInfo.Name,image:d.CreateGravatarMarkup(a.UserInfo,24)})}}}var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("utilities"),e=new b.Model;return e.hasDetails=!0,e.AddNetworkSubscription("DeletePosGroupNotification",e.GetNetworkDelete()),e.AddNetworkSubscription("UpdatePosGroupNotification",e.GetNetworkUpdate("PosGroup")),e.AddNetworkSubscription("NewPosGroupNotification",e.GetNetworkNew("PosGroup",["detail"])),e.AddNetworkSubscription("SetPosGroupPermissionNotification",f),e.Load=e.GetLoad("GetPosGroupHeaders","PosGroups"),e.AddNew=e.GetAddNew("NewPosGroup","PosGroup"),e.DeleteItem=e.GetDeleteItems("DeletePosGroups"),e.getDetails=function(a,b){c.GetPosGroup(a,function(a){e.ExtendOrAddLocalItems([a.PosGroup]),d.CallFunction(b)})},e.SelfChanged=function(a){console.log("model_posgroups selfChanged "+a.Items.length)},e.UpdateItems=e.GetUpdateItems("UpdatePosGroups","PosGroups"),e}),define("objects/models/model_posuserjobpositions",["require","objects/schema/model_classes","master_api","utilities"],function(a){function f(a){for(var b=0;b<e.items.length;b++){var c=e.items[b];if(c[e.keyField]==a[e.keyField]){if(c.Detail&&c.Detail.Permissions){var f=!1;$.each(c.Detail.Permissions,function(b,c){b==a.Permission_uid&&($.extend(!0,c,a.Value),f=!0)});if(!f){var g=a.Permission_uid;c.Detail.Permissions[g]=a.Value}}$(e).trigger("permissionChanged",{id:c.UniqueID,changes:a.Value,remote:a.UserInfo.Name,image:d.CreateGravatarMarkup(a.UserInfo,24)})}}}var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("utilities"),e=new b.Model;return e.AddNetworkSubscription("DeletePosUserJobPositionNotification",e.GetNetworkDelete()),e.AddNetworkSubscription("UpdatePosUserJobPositionNotification",e.GetNetworkUpdate("PosUserJobPosition")),e.AddNetworkSubscription("NewPosUserJobPositionNotification",e.GetNetworkNew("PosUserJobPosition",["detail"])),e.AddNew=e.GetAddNew("NewPosUserJobPosition","PosUserJobPosition"),e.DeleteItems=e.GetDeleteItems("DeletePosUserJobPositions"),e.getDetails=function(a,b){c.GetPosUserJobPosition(a,function(a){e.ExtendOrAddLocalItems([a.PosUserJobPosition]),d.CallFunction(b)})},e.Load=e.GetLoad("GetPosUserJobPositions","PosUserJobPositions"),e.SelfChanged=function(a){console.log("model_posuserjobpositions selfChanged "+a.Items.length)},e.UpdateItems=e.GetUpdateItems("UpdatePosUserJobPositions","PosUserJobPositions"),e}),define("objects/models/model_posusers",["require","objects/schema/model_classes","utilities"],function(a){function e(a){for(var b=0;b<d.items.length;b++){var e=d.items[b];if(e[d.keyField]==a[d.keyField]){if(e.Detail&&e.Detail.Permissions){var f=!1;$.each(e.Detail.Permissions,function(b,c){b==a.Permission_uid&&($.extend(!0,c,a.Value),f=!0)});if(!f){var g=a.Permission_uid;e.Detail.Permissions[g]=a.Value}}$(d).trigger("permissionChanged",{id:e.UniqueID,changes:a.Value,remote:a.UserInfo.Name,image:c.CreateGravatarMarkup(a.UserInfo,24)})}}}var b=a("objects/schema/model_classes"),c=a("utilities"),d=new b.Model;return d.AddNetworkSubscription("DeletePosUserNotification",d.GetNetworkDelete()),d.AddNetworkSubscription("UpdatePosUserNotification",d.GetNetworkUpdate("PosUser")),d.AddNetworkSubscription("NewPosUserNotification",d.GetNetworkNew("PosUser",["detail"])),d.Load=d.GetLoad("GetPosUsers","PosUsers"),d.AddNew=d.GetAddNew("NewPosUser","PosUser"),d.DeleteItems=d.GetDeleteItems("DeletePosUsers"),d.SelfChanged=function(a){console.log("model_posusers selfChanged "+a.Items.length)},d.UpdateItems=d.GetUpdateItems("UpdatePosUsers","PosUsers"),d}),define("objects/models/model_bopermissions",["require","objects/schema/model_classes","master_api","utilities"],function(a){var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("utilities"),e=new b.Model;return e.AddNew=function(){throw new Error("AddNew is not a valid operation on the bopermissions model.")},e.DeleteItems=function(){throw new Error("DeleteItems is not a valid operation on the bopermissions model.")},e.Load=function(a,b){c.GetBOPermissions(function(b){e.items=new Array;for(var c in b.Permissions){var f=b.Permissions[c];f.UniqueID=c,e.items.push(f)}d.CallFunction(a)},b)},e.SelfChanged=function(a){console.log("model_bopermissions selfChanged "+a.Items.length)},e.UpdateItems=function(){throw new Error("UpdateItems is not a valid operation on the bopermissions model.")},e}),define("objects/models/model_pospermissions",["require","objects/schema/model_classes","master_api","utilities"],function(a){var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("utilities"),e=new b.Model;return e.AddNew=function(){throw new Error("AddNew is not a valid operation on the pospermissions model.")},e.DeleteItems=function(){throw new Error("DeleteItems is not a valid operation on the pospermissions model.")},e.Load=function(a,b){c.GetPosPermissions(function(b){e.items=new Array;for(var c in b.Permissions){var f=b.Permissions[c];f.UniqueID=c,e.items.push(f)}d.CallFunction(a)},b)},e.SelfChanged=function(a){console.log("model_pospermissions selfChanged "+a.Items.length)},e.UpdateItems=function(){throw new Error("UpdateItems is not a valid operation on the pospermissions model.")},e}),define("objects/models/model_collaborators",["require","objects/schema/model_classes","master_api","general_functions"],function(a){function f(a){e.GetItemByKey(a.Account_uid).Status=a.Status,e.TriggerChanged()}function g(a){var b=e.CollaboratorLocationMap[a.Form_uid];if(b)if($.inArray(a.Account_uid,b)==-1)b.push(a.Account_uid);else return;else e.CollaboratorLocationMap[a.Form_uid]=[a.Account_uid];e.Trigger("CollaboratorLocationMapChanged",[a.Form_uid,b])}function h(a){var b=e.CollaboratorLocationMap[a.Form_uid];if(!b)return;var c=$.inArray(a.Account_uid,b);c!=-1&&b.splice(c,1),e.Trigger("CollaboratorLocationMapChanged",[a.Form_uid,b])}var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("general_functions"),e=new b.Model;return e.RegisterEvent("CollaboratorLocationMapChanged"),e.keyField="Account_uid",e.AddNetworkSubscription("CollaboratorChangeNotification",f),e.AddNetworkSubscription("CollaboratorEnterNotification",g),e.AddNetworkSubscription("CollaboratorLeaveNotification",h),e.AddNew=function(){throw new Error("AddNew is not a valid operation on the collaborators model ")},e.ChangeStatus=function(a){function b(){}function e(a,b){}c.ChangeCollaboratorStatus(a,b,d.DialogError)},e.CollaboratorLocationMap={},e.EnterForm=function(a){function b(b){e.CollaboratorLocationMap[a]=b.OtherAccounts,e.Trigger("CollaboratorLocationMapChanged",[a,b.OtherAccounts])}c.CollaboratorEnter(a,b,d.DialogError)},e.LeaveForm=function(a){function b(a){}c.CollaboratorLeave(a,b,d.DialogError)},e.DeletItems=function(){throw new Error("DeletItems is not a valid operation on the collaborators model ")},e.Load=e.GetLoad("GetCollaborators","Collaborators"),e.SelfChanged=function(a){console.log("model_collaborators selfChanged "+a.Items.length)},e.UpdateItems=function(){throw new Error("UpdateItems is not a valid operation on the collaborators model ")},e}),define("objects/models/model_conversations",["require","objects/schema/model_classes","coreglobals","master_api","general_functions","utilities"],function(a){function h(a,b){g.GetConversationDetails(a,function(a,c){a||c.Messages.push(b),$(g).trigger("conversationUpdated",{conversation:c}),g.TriggerChanged(),$.each(c.Accounts,function(a,b){$(g).trigger("messageRead",{read:!1,conversationid:c.UniqueID,accountid:b.UniqueID})})})}function i(a){g.GetConversationDetails(a.UniqueID,function(b,c){if(b){$(g).trigger("conversationUpdated",{conversation:c});switch(a.ChangeObject.Kind){case"AddMessage":g.Trigger("NewMessageReceived",[c,a.ChangeObject.Message]);break;case"MarkAllRead":$(g).trigger("messageRead",{read:!0,conversationid:a.UniqueID,accountid:a.ChangeObject.Account_uid});break;case"AddParticipant":g.Trigger("ParticipantsChanged",c);break;case"RemoveParticipant":g.Trigger("ParticipantsChanged",c)}g.TriggerChanged();return}switch(a.ChangeObject.Kind){case"AddMessage":c.HeaderOnly=!1;var d=!1;for(var f=0;f<c.Messages.length;f++){var h=c.Messages[f];h.UniqueID==a.ChangeObject.Message.UniqueID&&(d=!0)}d||(c.Messages.push(a.ChangeObject.Message),g.Trigger("NewMessageReceived",[c,a.ChangeObject.Message]),g.TriggerChanged());break;case"MarkAllRead":$(g).trigger("messageRead",{read:!0,conversationid:a.UniqueID,accountid:a.ChangeObject.Account_uid});break;case"AddParticipant":c.Accounts.push({UniqueID:a.ChangeObject.Account_uid,UnreadMessages:0}),c.Messages.push(a.ChangeObject.Message),g.Trigger("ParticipantsChanged",c),g.TriggerChanged();break;case"RemoveParticipant":for(var f=0;f<c.Accounts.length;f++){var h=c.Accounts[f];if(h.UniqueID!=a.ChangeObject.Account_uid)continue;c.Accounts.splice(idx,1),c.Messages.push(a.ChangeObject.Message),g.Trigger("ParticipantsChanged",c),g.TriggerChanged();break}break;default:e.DialogError("100","unknown changeobject type: "+a.ChangeObject.Kind)}})}function j(){g.items.sort(function(a,b){return b.LastUpdated-a.LastUpdated})}var b=a("objects/schema/model_classes"),c=a("coreglobals"),d=a("master_api"),e=a("general_functions"),f=a("utilities"),g=new b.Model;return g.hasDetails=!0,g.AddNetworkSubscription("ChangeConversationNotification",i),g.RegisterEvent("NewMessageReceived"),g.RegisterEvent("ParticipantsChanged"),g.AddNew=function(){throw new Error("AddNew is not a valid operation on the conversations model ")},g.AddParticipant=function(a,b){d.ChangeConversation(a,{Kind:"AddParticipant",Account_uid:b},function(c){g.GetItemByKey(a).Accounts.push({UniqueID:b,UnreadMessages:0}),h(a,c.ChangeObject.Message),g.Trigger("ParticipantsChanged",g.GetItemByKey(a)),g.TriggerChanged()},e.DialogError)},g.DeleteItems=function(){throw new Error("DeleteItems is not a valid operation on the conversations model ")},g.GetConversationDetails=function(a,b,c){var e=g.GetItemByKey(a);if(e!=undefined&&!e.HeaderOnly){f.CallFunction(b,[!1,e]);return}if(e&&e.Detail){f.CallFunction(b,[!0,e]);return}d.GetConversation(a,function(a){e==undefined&&(e=a.Conversation,g.items.push(e)),a.Conversation.HeaderOnly=!1,a.Detail=!0,g.ExtendOrAddLocalItems([a.Conversation]),g.TriggerChanged(),f.CallFunction(b,[!0,e])},function(a,b){console.log(b)})},g.getDetails=g.GetConversationDetails,g.Load=function(a,b){d.GetConversations(function(b){e.OverlayObjectArrays(g.items,b.Conversations),f.CallFunction(a,[b]);for(var c=0;c<g.items.length;c++)g.items[c].HeaderOnly=!0},b)},g.MarkAllRead=function(a){d.ChangeConversation(a,{Kind:"MarkAllRead",Account_uid:c.CurrentAccountID},undefined,e.DialogError)},g.RemoveParticipant=function(a,b){d.ChangeConversation(a,{Kind:"RemoveParticipant",Account_uid:b},function(d){if(b==c.CurrentAccountID)for(var e=0;e<g.items.length;e++){if(g.items[e].UniqueID!=a)continue;g.items.splice(e,1),g.TriggerChanged();break}else{var f=g.GetItemByKey(a);for(var e=0;e<f.Accounts.length;e++){if(f.Accounts[e].UniqueID!=b)continue;f.Accounts.splice(e,1),$(g).trigger("conversationUpdated",{conversation:exports.getItemByID(a)}),g.TriggerChanged();break}}},e.DialogError)},g.SelfChanged=function(a){console.log("model_conversations selfChanged "+a.Items.length)},g.SendMessage=function(a,b){if(b.trim()=="")return;d.ChangeConversation(a,{Kind:"AddMessage",Message:{Account_uid:c.CurrentAccountID,DateTimeMilliseconds:1,Value:b}},function(b){h(a,b.ChangeObject.Message)},e.DialogError)},g.StartChat=function(a,b){d.StartChat(a,function(a){var c=a.Conversation.UniqueID;g.items.push(a.Conversation);var d=g.GetItemByKey(c);if(d==undefined||d.HeaderOnly)d==undefined&&(d={},exports.items.push(d)),$.extend(!0,d,a.Conversation),d.HeaderOnly=!1;b(d)},e.DialogError)},g.UpdateItems=function(){throw new Error("UpdateItems is not a valid operation on the conversations model ")},g.LastMessageFrom=function(a){var b=g.GetItemByKey(a);return b?b.Messages[b.Messages.length-1].Account_uid:""},g}),define("objects/models/model_floorcharts",["require","objects/schema/model_classes","master_api","general_functions","utilities","floorchart/posFloorChart"],function(a){function h(){$.each(g.items,function(a,b){!b.floorchartObject&&b.Detail&&(b.floorchartObject=f.NewPosFloorChart(),b.floorchartObject.Bind(f.Events.Changed,function(a,c){g.saveLayout(b,a)})),b.Detail&&b.floorchartObject.ImportFromJson(b.Detail.FloorChart)})}function i(a){$.each(g.items,function(b,c){c.UniqueID==a.FloorChartUniqueID&&(c.floorchartObject&&c.floorchartObject.ApplyChangeObject(a.ChangeObject),$(g).trigger("changeObjectReceived",{id:a.FloorChartUniqueID,remote:a.UserInfo.Name,image:e.CreateGravatarMarkup(a.UserInfo,24)}))})}var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("general_functions"),e=a("utilities"),f=a("floorchart/posFloorChart"),g=new b.Model;return g.hasDetails=!0,g.AddNetworkSubscription("DeleteLocationFloorChartNotification",g.GetNetworkDelete()),g.AddNetworkSubscription("UpdateLocationFloorChartNotification",g.GetNetworkUpdate("LocationFloorChart")),g.AddNetworkSubscription("NewLocationFloorChartNotification",g.GetNetworkNew("LocationFloorChart",["detail"])),g.AddNetworkSubscription("ChangeLocationFloorChartNotification",i),g.AddNew=g.GetAddNew("NewLocationFloorChart","LocationFloorChart"),g.DeleteItems=g.GetDeleteItems("DeleteLocationFloorCharts"),g.getDetails=function(a,b){c.GetFloorChart(a,function(a){g.ExtendOrAddLocalItems([a.LocationFloorChart]),h(),e.CallFunction(b)})},g.Load=function(a,b){c.GetLocationFloorChartHeaders("","",function(b){d.OverlayObjectArrays(g.items,b.LocationFloorCharts),e.CallFunction(a,[b])},b)},g.UpdateItems=g.GetUpdateItems("UpdateLocationFloorCharts","LocationFloorCharts"),g.saveLayout=function(a,b,f){c.ChangeLocationFloorChart(a.UniqueID,b,function(b){a.Detail.FloorChart=a.floorchartObject.ExportToJson(),e.CallFunction(f)},function(a,b){d.LogMessage(a+": "+b)})},g.SelfChanged=function(a){console.log("model_floorcharts selfChanged "+a.Items.length),h()},g}),define("objects/models/model_structures",["require","objects/schema/model_classes","master_api","general_functions","utilities"],function(a){function g(a){$.each(f.items,function(b,c){if(c.UniqueID==a.OrgStructure.UniqueID){var d=f.GetItemByKey(a.OrgStructure.UniqueID);d.Detail&&d.Detail!=null&&(d.Detail.MainElement=a.OrgStructure.Detail.MainElement),$(f).trigger("changeObjectReceived",{id:c.UniqueID,changes:{},remote:a.UserInfo.Name,image:e.CreateGravatarMarkup(a.UserInfo,24)})}})}var b=a("objects/schema/model_classes"),c=a("master_api"),d=a("general_functions"),e=a("utilities"),f=new b.Model;return f.hasDetails=!0,f.AddNetworkSubscription("DeleteOrgStructureNotification",f.GetNetworkDelete()),f.AddNetworkSubscription("UpdateOrgStructureNotification",f.GetNetworkUpdate("OrgStructure")),f.AddNetworkSubscription("NewOrgStructureNotification",f.GetNetworkNew("OrgStructure",["detail"])),f.AddNetworkSubscription("ChangeOrgStructureNotification",g),f.AddNew=f.GetAddNew("NewOrgStructure","OrgStructure"),f.ChangeOrgStructure=function(a,b,d,e){c.ChangeOrgStructure(a,b,function(a){var b=f.GetItemByKey(a.OrgStructure.UniqueID);b.Detail.MainElement=a.OrgStructure.Detail.MainElement,d(a.OrgStructure)},e)},f.DeleteItems=f.GetDeleteItems("DeleteOrgStructures"),f.getDetails=function(a,b){c.GetStructure(a,function(a){f.ExtendOrAddLocalItems([a.OrgStructure]),e.CallFunction(b)})},f.Load=function(a,b){c.GetOrgStructureHeaders("",function(b){d.OverlayObjectArrays(f.items,b.OrgStructures),e.CallFunction(a,[b])},b)},f.SelfChanged=function(a){console.log("model_structures selfChanged "+a.Items.length)},f.UpdateItems=function(a,b,d,e){c.UpdateOrgStructures(a[0][f.keyField],b,function(a){d(a.OrgStructure)},e)},f}),define("objects/models/model_users",["require","master_api","utilities","general_functions","objects/schema/model_classes","objects/models/model_accounts"],function(a){var b=a("master_api"),c=a("utilities"),d=a("general_functions"),e=a("objects/schema/model_classes"),f=a("objects/models/model_accounts"),g=new e.Model;return g.AddNetworkSubscription("DeleteUserNotification",g.GetNetworkDelete()),g.AddNetworkSubscription("UpdateUserNotification",g.GetNetworkUpdate("User")),g.AddNetworkSubscription("NewUserNotification",g.GetNetworkNew("User",[])),g.AddNew=function(a,d,e){b.NewUser(a,function(a){f.ExtendOrAddLocalItems([a.Account]),g.items.push(a.User),c.CallFunction(d,[a])},e)},g.DeleteItems=g.GetDeleteItems("DeleteUsers"),g.Load=g.GetLoad("GetUsers","Users"),g.SelfChanged=function(a){console.log("model_users selfChanged "+a.Items.length)},g.UpdateItems=function(a,e,h,i){var j=d.GetFieldValues(a,g.keyField);b.UpdateUsers(j,e,function(b){var d=[];$.each(a,function(a,c){$.each(b.Users,function(a,e){c.UniqueID==e.UniqueID&&($.extend(!0,c,e),d.push(b.Accounts[a]))})}),f.ExtendOrAddLocalItems(d),c.CallFunction(h,[b])},i)},g}),define("objects/schema/models",["require","objects/models/model_accounts","objects/models/model_bogroups","objects/models/model_collaborators","objects/models/model_conversations","objects/models/model_floorcharts","objects/models/model_jobpositions","objects/models/model_locations","objects/models/model_organizations","objects/models/model_posgroups","objects/models/model_posuserjobpositions","objects/models/model_posusers","objects/models/model_structures","objects/models/model_users","objects/models/model_bopermissions","objects/models/model_pospermissions","objects/schema/model_utils","utilities"],function(a){var b=a("objects/models/model_accounts"),c=a("objects/models/model_bogroups"),d=a("objects/models/model_collaborators"),e=a("objects/models/model_conversations"),f=a("objects/models/model_floorcharts"),g=a("objects/models/model_jobpositions"),h=a("objects/models/model_locations"),i=a("objects/models/model_organizations"),j=a("objects/models/model_posgroups"),k=a("objects/models/model_posuserjobpositions"),l=a("objects/models/model_posusers"),m=a("objects/models/model_structures"),n=a("objects/models/model_users"),o=a("objects/models/model_bopermissions"),p=a("objects/models/model_pospermissions"),q=a("objects/schema/model_utils"),r=a("utilities"),s={};return s.Accounts=b,s.BOGroups=c,s.Collaborators=d,s.FloorCharts=f,s.JobPositions=g,s.Locations=h,s.Organizations=i,s.Conversations=e,s.PosGroups=j,s.PosUserJobPositions=k,s.PosUsers=l,s.Structures=m,s.Users=n,s.BOPermissions=o,s.PosPermissions=p,s.ReloadLoadedModels=function(a,b){var c=[];for(var d in s){if(!s.hasOwnProperty(d))continue;var e=s[d];if(!e.loaded)continue;e.Unload(),c.push(e)}if(c.length==0){r.CallFunction(a);return}q.LoadModels(c,a,b)},s.GetTemplatedAccountName=function(a){if(a=="xxx_variable_xxx")return"variable...";var c=b.GetItemByKey(a);return c?c.Name:""},s.GetTemplatedAccountEmail=function(a){if(a=="xxx_variable_xxx")return"variable...";var c=b.GetItemByKey(a);return c?c.Email:""},s.GetTemplatedBOGroupColor=function(a){if(a=="xxx_variable_xxx")return"variable...";var b=c.GetItemByKey(a);return b?b.Color:""},s.GetTemplatedInitialPosGroupColor=function(a){if(a=="xxx_variable_xxx")return"variable...";var b=j.GetItemByKey(a);return b?b.Color:""},s.GetTemplatedInitialPosGroupName=function(a){if(a=="xxx_variable_xxx")return"variable...";var b=j.GetItemByKey(a);return b?b.Name:""},s.GetTemplatedJobPositionName=function(a){if(a=="xxx_variable_xxx")return"variable...";var b=g.GetItemByKey(a);return b?b.Name:""},s.GetTemplatedLocationName=function(a){if(a=="xxx_variable_xxx")return"variable...";var b=h.GetItemByKey(a);return b?b.Name:""},s.GetTemplatedOrganizationName=function(a){if(a=="xxx_variable_xxx")return"variable...";var b=i.GetItemByKey(a);return b?b.Name:""},s}),define("posConnection",["require","wsocket","utilities"],function(a){function m(a){var b="";a.Action&&(b=a.Action);if(b=="SubscribeToNotifications"||b=="UnsubscribeFromNotifications")for(var c=0;c<a.Notifications.length;c++)b+=", "+a.Notifications[c].Action.replace("Notification","");return b}function n(a){return function(){console.log("disconnect timer event"),a.socket.Disconnect()}}function o(a){return function(){console.log("connect event"),a.lastConnect=Date.now(),a.callOnConnect(),a.restartDisconnectTimer()}}function p(a){return function(){a.callOnConnecting()}}function q(a){return function(){console.log("connect failed event"),a.callOnConnectFailed(),a.tryReconnect()}}function r(a){return function(){console.log("disconnect event"),a.callOnDisconnect();if(a.forcingDisconnect){a.forcingDisconnect=!1;return}a.tryReconnectWaitTimer=setTimeout(function(){console.log("reconnect wait timer event"),a.tryReconnectWaitTimer=undefined,a.tryReconnect()},5e3)}}function s(a){return function(b){a.callOnError(b)}}function t(a){return function(b){a.restartDisconnectTimer();if(b[e]&&b[e]==g){var c={};c[e]=h,a.socket.Send(c);return}if(b[f]){a.disconnectWaitTime=b[f]*1.5*1e3,a.restartDisconnectTimer();return}if(!b.ResponseID){a.callOnMessage(b);return}var d=a.removeOutstandingMessage(b.ResponseID);if(!d)return;clearTimeout(d.timeoutTimer),d.callback(b)}}function u(a){return function(){console.log("reconnect connect event"),a.resetReconnect()}}function v(a,b){return function(){var c=a.removeOutstandingMessage(b.requestID);c&&c.timeoutCallback&&c.timeoutCallback()}}function w(a){return function(){console.log("reconnect connect failed event"),a.reconnectTimer=setTimeout(function(){console.log("reconnect timer event"),a.reconnectTimer=undefined,a.socket.Connect()},15e3)}}function x(){return c.GenerateUUID()}function y(a){return a.hasOwnProperty("ResponseID")?!1:a.hasOwnProperty("RequestID")&&a["RequestID"]!=""?!1:!0}var b=a("wsocket"),c=a("utilities"),d={},e="~heartbeat~",f="~heartbeatinterval~",g="~server~",h="~client~",i=8e3,j=function(a,b,c){this.requestID=a.RequestID,this.callback=b,this.timeoutCallback=c,this.timeoutTimer=undefined};d.ConnectionParams=function(){this.URI=undefined,this.OnConnect=undefined,this.OnConnecting=undefined,this.OnConnectFailed=undefined,this.OnDisconnect=undefined,this.OnError=undefined,this.OnMessage=undefined};var k=d.ConnectionParams;d.Connection=function(){this.socket=undefined,this.outstandingMessages=[],this.reconnecting=!1,this.reconnectTimer=undefined,this.reconnectHandleConnect=u(this),this.reconnectHandleConnectFailed=w(this),this.forcingDisconnect=!1,this.lastConnect=0,this.tryReconnectWaitTimer=undefined,this.disconnectTimer=undefined,this.disconnectWaitTime=6e5,this.onConnect=undefined,this.onConnecting=undefined,this.onConnectFailed=undefined,this.onDisconnect=undefined,this.onError=undefined,this.onMessage=undefined,this.LogMessages=!1};var l=d.Connection;return l.prototype.callOnConnect=function(){this.onConnect&&this.onConnect()},l.prototype.callOnConnecting=function(){this.onConnecting&&this.onConnecting()},l.prototype.callOnConnectFailed=function(){this.onConnectFailed&&this.onConnectFailed()},l.prototype.callOnDisconnect=function(){this.onDisconnect&&this.onDisconnect()},l.prototype.callOnError=function(a){this.onError&&this.onError(a)},l.prototype.callOnMessage=function(a){this.onMessage&&this.onMessage(this,a)},l.prototype.Connect=function(a){this.tryReconnectWaitTimer&&(clearTimeout(this.tryReconnectWaitTimer),this.tryReconnectWaitTimer=undefined),this.reconnecting&&this.resetReconnect();if(this.IsConnected()||this.IsConnecting())return;this.stopDisconnectTimer(),this.forcingDisconnect=!1,this.onConnect=a.OnConnect,this.onConnecting=a.OnConnecting,this.onConnectFailed=a.OnConnectFailed,this.onDisconnect=a.OnDisconnect,this.onMessage=a.OnMessage,this.onError=a.OnError,this.socket=new b.Socket(a.URI,{}),this.socket.On(b.Events.Connect,o(this)),this.socket.On(b.Events.Connecting,p(this)),this.socket.On(b.Events.ConnectFailed,q(this)),this.socket.On(b.Events.Disconnect,r(this)),this.socket.On(b.Events.Error,s(this)),this.socket.On(b.Events.Message,t(this)),this.socket.Connect()},l.prototype.Disconnect=function(){if(!this.socket)return;this.forcingDisconnect=!0,this.reconnecting&&this.resetReconnect(),this.stopDisconnectTimer(),this.socket.Disconnect()},l.prototype.IsConnected=function(){return this.socket&&this.socket.IsConnected()},l.prototype.IsConnecting=function(){return this.socket&&this.socket.IsConnecting()},l.prototype.removeOutstandingMessage=function(a){for(var b in this.outstandingMessages){var c=this.outstandingMessages[b];if(a!=c.requestID)continue;return this.outstandingMessages.splice(b,1),c}return null},l.prototype.resetReconnect=function(){this.reconnecting=!1,this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=undefined),this.socket.RemoveEvent(b.Events.Connect,this.reconnectHandleConnect),this.socket.RemoveEvent(b.Events.ConnectFailed,this.reconnectHandleConnectFailed)},l.prototype.restartDisconnectTimer=function(){this.stopDisconnectTimer(),this.disconnectTimer=setTimeout(n(this),this.disconnectWaitTime)},l.prototype.stopDisconnectTimer=function(){this.disconnectTimer&&(clearTimeout(this.disconnectTimer),this.disconnectTimer=undefined)},l.prototype.tryReconnect=function(){if(this.reconnecting)return;this.reconnecting=!0,this.socket.On(b.Events.Connect,this.reconnectHandleConnect),this.socket.On(b.Events.ConnectFailed,this.reconnectHandleConnectFailed),this.socket.Connect()},l.prototype.SendMessage=function(a,b,c){this.LogMessages&&console.log("ws send: '"+m(a)+"'",a),y(a)&&(a.RequestID=x()),b&&this.addOutstandingMessage(a,b,c),this.socket.Send(a)},l.prototype.addOutstandingMessage=function(a,b,c){var d=new j(a,b,c);this.outstandingMessages.push(d),d.timeoutTimer=setTimeout(v(this,d),i)},d}),define("objects/schema/audio",["require"],function(a){var b={},c=b.AudioStream=function(){this.audio=undefined};return c.prototype.Play=function(){if(!this.audio)return;try{this.audio.play()}catch(a){}},b.NewAudioStream=function(a){var b=new c;try{b.audio=new Audio;var d=b.audio;d.canPlayType("audio/ogg")?d.src=a+".ogg":d.canPlayType("audio/mp3")&&(d.src=a+".mp3")}catch(e){}return b},b}),define("formstuff",["require","utilities","objects/schema/models","coreglobals"],function(a){function s(a,b){var c=new r;return c.Name=a,c.onClickFunction=b,c.refreshDom(),c}function y(a,b,c,d){var e=new x;return e.ID=a,e.Name=b,e.onClickFunction=c,e.onCloseFunction=d,e.refreshDom(),e}function F(a){a.stopPropagation()}function G(a,b){var c=$('<span style="margin-top:-6px;cursor:pointer;"><div class="ui-icon '+a+'" style="float:right;margin-top:-5px;"></div></span>');return c.mousedown(F),b&&c.click(b),c}var b=a("utilities"),c=a("objects/schema/models"),d=a("coreglobals"),e={},f="form-object ui-dialog ui-widget ui-widget-content ui-corner-all",g="ui-dialog ui-widget ui-widget-content ui-corner-all widget-wrapper",h="ui-dialog ui-widget ui-widget-content ui-corner-all widget-float",i=e.Favorite=function(){this.guid="",this.title=""};i.prototype.GetPersistObject=function(){var a=new l;return a.guid=this.guid,a.title=this.title,a},e.NewFavorite=function(a,b){var c=new i;return c.guid=a,c.title=b,c};var j=e.FormState=function(){};e.NewFormState=function(){return new j};var k=e.PersistedDesktopLayout=function(){this.activeFormID="",this.openForms=[],this.eastPaneClosed=!1,this.eastWidgets=[],this.westPaneClosed=!1,this.westWidgets=[],this.widgetStates={},this.favorites=[],this.recentItems=[],this.west={closed:!1,widgets:[]},this.east={closed:!1,widgets:[]},this.taskbarForms=[],this.conversationStates=[],this.collaborationState=!1},l=e.PersistedFavorite=function(){this.guid="",this.title=""},m=e.PersistedRecentItem=function(){this.guid="",this.title=""},n=e.PersistedUIForm=function(){this.FormCrumbs=[],this.Maximized=!1},o=e.PersistedUIFormCrumb=function(){this.FormDescriptionID="",this.FormDescriptionName="",this.State=undefined},p=e.PersistedUIWidget=function(){this.id="",this.title=""},q=e.RecentItem=function(){this.guid="",this.title=""};q.prototype.GetPersistObject=function(){var a=new m;return a.guid=this.guid,a.title=this.title,a},e.NewRecentItem=function(a,b){var c=new q;return c.guid=a,c.title=b,c};var r=e.UIBreadCrumb=function(){this.$element=undefined,this.Name="",this.onClickFunction=undefined};r.prototype.refreshDom=function(){var a=this;this.$element=$("<li><a>"+this.Name+"</a></li>"),this.$element.click(function(){b.CallFunction(a.onClickFunction,[a.ID])})};var t=e.UIBreadBar=function(){this.Crumbs=[],this.$container=undefined,this.$element=undefined,this.$crumbContainer=undefined,this.$currentName=undefined,this.onClickFunction=undefined,this.shown=!1};t.prototype.AddBreadCrumb=function(a){var b=s(a,this.getCrumbClickHandler(this.Crumbs.length));this.Crumbs.push(b),this.$currentName.before(b.$element)},t.prototype.getCrumbClickHandler=function(a){var b=this;return function(){b.onClickFunction(a)}},t.prototype.Hide=function(){if(!this.shown)return;this.$container.hide(),this.shown=!1},t.prototype.RemoveBreadCrumbs=function(a){for(var b=this.Crumbs.length-1;b>=a;b--){var c=this.Crumbs[b];this.Crumbs.splice(b,1),c.$element.remove()}},t.prototype.SetCurrentName=function(a){this.$currentName.html('<li style="margin-left:32px;"><a>'+a+"</a></li>")},t.prototype.Show=function(){if(this.shown)return;this.$container.show(),this.shown=!0},e.NewUIBreadBar=function(a,b){var c=new t;return c.$container=a,c.$element=$('<div style="white-space:nowrap;overflow:hidden; position:absolute; top:0; left:0; display:block;width:100%;height:26px;background-color: #f3f3f3;border-bottom:1px solid #dbdbdb;"></div>'),c.$crumbContainer=$('<ul class="breadcrumb"></ul>'),c.$element.append(c.$crumbContainer),c.$currentName=$("<li></li>"),c.$crumbContainer.append(c.$currentName),c.$container.append(c.$element),c.onClickFunction=b,c.$container.hide(),c.shown=!1,c};var u=e.UICollaborationPopup=function(a){var b=this;this.UIWindow=a,this.$box=$("<div class='collab-info-box-wrapper'>"),this.$dongle=$("<div class='collab-info-box-dongle'>").appendTo(this.$box),this.$body=$("<div class='collab-info-box-body'>").appendTo(this.$box),this.$dongle.append("<img style='cursor:pointer;border-radius:2px;width:16px;height:16px;' src='./img/collab-bar-light.png'/>"),this.$collabLabel=$("<div style='border-bottom:1px dotted #393939;padding:4px;margin-bottom:0;text-align:center;font-size:8pt;font-weight:normal;color:#909090;'></div>").appendTo(this.$body),this.$guts=$("<div class='chatbox-body-guts'></div>").appendTo(this.$body),this.$guts.jScrollPane(),this.jsp=this.$guts.data("jsp"),this.$innerBody=this.jsp.getContentPane(),this.$bodyTable=$("<table style='width:100%;' cellspacing='0' cellpadding='2'></table>").appendTo(this.$innerBody),this.$parentContainer=$("#content-pane"),$(document).mousedown(function(){b.$box.hide()})};u.prototype.GetDomElement=function(){return this.$box},u.prototype.Hide=function(){this.$box.detach(),this.$box.hide()},u.prototype.Show=function(){var a=this.UIWindow.GetCollaboratorButton(),b=a.position(),c=b.left-184,d=b.top;this.$box.css({left:c+"px",top:d+"px"}),this.$parentContainer.append(this.$box),this.$box.show(),this.UpdateCollaborators()},u.prototype.UpdateCollaborators=function(){this.$bodyTable.html(""),this.$collabLabel.html("");for(var a=0;a<this.UIWindow.Collaborators.length;a++)this.AddCollaborator(c.Collaborators.GetItemByKey(this.UIWindow.Collaborators[a].UniqueID));var b="";this.UIWindow.Collaborators.length==0?(this.$dongle.find("img").attr("src","./img/collab-bar-light.png"),b="Nobody else is viewing this form",this.$bodyTable.append("<tr class='collab-row' style='margin-top:6px;'><td><img src='./img/collab-bar-some.png' style='margin-right:4px;'/></td><td style='font-size:8pt;'>When someone else is also viewing this form, the title bar icon will turn green</td></tr>"),this.$bodyTable.append("<tr class='collab-row'><td><img src='./img/collab-bar-hilite.png' style='margin-right:4px;'/></td><td style='font-size:8pt;'>When someone else makes an update that affects data you are working with, the title bar icon will flash orange for a few seconds</td></tr>")):(this.$dongle.find("img").attr("src","./img/collab-bar-some.png"),this.UIWindow.Collaborators.length==1?b="1 other person is viewing this form":b=this.UIWindow.Collaborators.length+" others are viewing this form"),this.$collabLabel.html(b),this.Resize()},u.prototype.AddCollaborator=function(a){if(a==undefined)return;var e=this,f=this.$bodyTable;if(f.find("#"+a.Account_uid).length>0){f.find("#"+a.Account_uid).find("#online_status").attr("src",this.getStatusIcon(a));return}var g=$("<tr style='cursor:pointer;'></tr>");g.attr("id",a.Account_uid),g.addClass("collab-row");var h=c.Accounts.GetItemByKey(a.Account_uid);g.data("collaborator",a),g.data("account",h),f.append(g),g.append("<td style='border-bottom:1px dotted #393939;width:18px;'><img src='"+b.CreateGravatarMarkup(c.Accounts.GetItemByKey(a.Account_uid),16)+"' style='width:16px;height:16px;'/></td>");var i=$("<td id='collab_caption' style='border-bottom:1px dotted #393939;padding:4px;font-size:8pt;color:#909090;'>"+c.GetTemplatedAccountName(a.Account_uid)+"</td>");g.append(i),g.append("<td style='text-align:right;padding-top:4px;border-bottom:1px dotted #393939;width:16px;'><img id='online_status' src='' style='width:12px;height:12px;'/></td>"),g.find("#online_status").attr("src",this.getStatusIcon(a)),g.mousedown(function(a){a.stopPropagation()}),g.click(function(a){a.stopPropagation(),e.Hide();var b=d.ChatManager.findChatBoxWithAccount(h.UniqueID);if(b!=-1){var f=d.ChatManager.AddChatBox(b);d.ChatManager.SetActiveBox(f.ID)}else c.Conversations.StartChat(new Array(h.UniqueID),function(a){var b=d.ChatManager.AddChatBox(a.UniqueID);d.ChatManager.SetActiveBox(b.ID)})})},u.prototype.getStatusIcon=function(a){return a.Status=="Online"?"./img/collab_online.png":a.Status=="Idle"?"./img/collab_idle.png":"./img/collab_offline.png"},u.prototype.getStatusIndex=function(a){switch(a.Status){case"Online":return"00";case"Idle":return"01";default:return"02"}},u.prototype.Resize=function(){this.$box.find(".jspContainer").css({width:this.$body.width(),height:this.$body.height()-28}),this.jsp.reinitialise()};var v=e.UIFormCrumb=function(){this.FormDescription=undefined,this.Form=undefined,this.State=undefined};v.prototype.GetPersistObject=function(){var a=new o;return a.FormDescriptionID=this.FormDescription.ID,a.FormDescriptionName=this.FormDescription.Name,a.State=this.State,a},e.NewUIFormCrumb=function(a,b){var c=new v;return c.FormDescription=a,c.Form=b,c};var w=e.UIForm=function(){this.FormCrumbs=[],this.BaseFormDescription=undefined,this.UIWindow=undefined,this.Maximized=!1};w.prototype.AddUIFormCrumb=function(a){this.FormCrumbs.push(a)},w.prototype.GetBaseFormDescription=function(){return this.BaseFormDescription},w.prototype.GetCurrentForm=function(){var a=this.FormCrumbs.length;return a==0?undefined:this.FormCrumbs[a-1].Form},w.prototype.GetPersistObject=function(){var a=new n;for(var b=0;b<this.FormCrumbs.length;b++)a.FormCrumbs.push(this.FormCrumbs[b].GetPersistObject());return a.Maximized=this.Maximized,a},w.prototype.GetCurrentFormDescription=function(){var a=this.FormCrumbs.length;return a==0?undefined:this.FormCrumbs[a-1].FormDescription},e.NewUIForm=function(){var a=new w;return a};var x=e.UITaskbarButton=function(){this.ID="",this.Name="",this.$element=undefined,this.onClickFunction=undefined,this.onCloseFunction=undefined};x.prototype.refreshDom=function(){var a=this;this.$element=$('<span class="taskbar-item">'+this.Name+"</span>");var c=$('<img style="margin-left:8px;cursor:  pointer;" src="img/window-close.gif"/>');this.$element.append(c),this.$element.click(function(){b.CallFunction(a.onClickFunction,[a.ID])}),c.click(function(c){b.CallFunction(a.onCloseFunction,[a.ID]),c.stopPropagation()})},x.prototype.SetActive=function(a){a?this.$element.removeClass("taskbar-item").addClass("taskbar-item-selected"):this.$element.removeClass("taskbar-item-selected").addClass("taskbar-item")};var z=e.UITaskbar=function(){this.scrollAmount=60,this.Buttons=[],this.ActiveButton=undefined,this.$container=undefined,this.$buttonContainer=undefined,this.$scrollContainer=undefined,this.$leftScrollButton=undefined,this.$rightScrollButton=undefined,this.onClickFunction=undefined,this.onCloseFunction=undefined,this.shown=undefined,this.leftScrollerShown=!1,this.rightScrollerShown=!1};z.prototype.AddButton=function(a,b){var c=y(a,b,this.onClickFunction,this.onCloseFunction);this.Buttons.push(c),this.$scrollContainer.append(c.$element),this.showHideScrollers()},z.prototype.findButton=function(a){for(var b=0;b<this.Buttons.length;b++)if(this.Buttons[b].ID==a)return b;return-1},z.prototype.getLeftScrollClickHandler=function(){var a=this;return function(){a.scroll(a.scrollAmount)}},z.prototype.getTotalButtonsWidth=function(){var a=0;for(var b=0;b<this.Buttons.length;b++)a+=this.Buttons[b].$element.width()+34;return a},z.prototype.Hide=function(){if(!this.shown)return;this.$container.hide(),this.shown=!1},z.prototype.hideLeftScroller=function(){if(!this.leftScrollerShown)return;this.$leftScrollButton.hide(),this.$buttonContainer.css("margin-left",""),this.leftScrollerShown=!1},z.prototype.hideRightScroller=function(){if(!this.rightScrollerShown)return;this.$rightScrollButton.hide(),this.$buttonContainer.css("margin-right",""),this.rightScrollerShown=!1},z.prototype.RemoveButton=function(a){var b=this.findButton(a);if(b<0)return;var c=this.Buttons.splice(b,1)[0];c.$element.remove(),this.showHideScrollers()},z.prototype.getRightScrollClickHandler=function(){var a=this;return function(){a.scroll(-a.scrollAmount)}},z.prototype.SetActiveButton=function(a){var b=this.findButton(a);if(b<0)return;this.ActiveButton&&this.ActiveButton.SetActive(!1);var c=this.Buttons[b];c.SetActive(!0),this.ActiveButton=c},z.prototype.Resize=function(){if(!this.shown)return;this.showHideScrollers()},z.prototype.scroll=function(a){this.scrollX+=a,this.scrollX>0&&(this.scrollX=0),this.$scrollContainer.css("margin-left",this.scrollX+"px"),this.showHideScrollers()},z.prototype.Show=function(){if(this.shown)return;this.$container.show(),this.shown=!0,this.Resize()},z.prototype.showHideScrollers=function(){var a=this.$container.width(),b=this.getTotalButtonsWidth();if(b<=a){this.hideLeftScroller(),this.hideRightScroller(),this.scrollX=0,this.$scrollContainer.css("margin-left","");return}this.scrollX<0&&this.showLeftScroller(),this.scrollX==0&&this.hideLeftScroller(),b-this.scrollX>a&&this.showRightScroller(),b+this.scrollX<a&&this.hideRightScroller()},z.prototype.showLeftScroller=function(){if(this.leftScrollerShown)return;this.$leftScrollButton.show(),this.$buttonContainer.css("margin-left","20px"),this.leftScrollerShown=!0},z.prototype.showRightScroller=function(){if(this.rightScrollerShown)return;this.$rightScrollButton.show(),this.$buttonContainer.css("margin-right","28px"),this.rightScrollerShown=!0},e.NewUITaskBar=function(a,b,c){var d=new z;return d.$container=a,d.onClickFunction=b,d.onCloseFunction=c,d.$buttonContainer=$('<div style="overflow-x: hidden; overflow-y: visible; height:32px;padding-top:3px;margin-top:-2px;"></div>'),d.$container.append(d.$buttonContainer),d.$scrollContainer=$("<div></div>"),d.$buttonContainer.append(d.$scrollContainer),d.$leftScrollButton=$('<div id="taskbar-scroll-left" class="ui-icon-light ui-icon-circle-triangle-w" style="display:none;cursor:pointer;z-index:25000;position:absolute;bottom:12px;left:6px;"></div>'),d.$rightScrollButton=$('<div id="taskbar-scroll-right" class="ui-icon-light ui-icon-circle-triangle-e" style="display:none;cursor:pointer;z-index:25000;position:absolute;bottom:12px;right:6px;"></div>'),d.$buttonContainer.prepend(d.$leftScrollButton),d.$buttonContainer.append(d.$rightScrollButton),d.$leftScrollButton.click(d.getLeftScrollClickHandler()),d.$rightScrollButton.click(d.getRightScrollClickHandler()),d.$container.hide(),d.shown=!1,d};var A=e.UIWidget=function(){this.Widget=undefined,this.UIWindow=undefined,this.$iconView=undefined,this.UIWidgetPanel=undefined};A.prototype.GetPersistObject=function(){var a=new p;return a.id=this.Widget.ID,a.title=this.Widget.Name,a},A.prototype.GetRect=function(){var a=b.NewRect(),c=this.UIWindow.GetDomElement(),d=c.offset();return a.Left=d.left,a.Top=d.top,a.Right=a.Left+c.width()-1,a.Bottom=a.Top+c.height()-1,a},A.prototype.RemoveFromPanel=function(){if(!this.UIWidgetPanel)return;this.UIWidgetPanel.RemoveUIWidget(this)},A.prototype.SetStyleFixed=function(){this.UIWindow.MakeFixedWidgetStyle()},A.prototype.SetStyleFloat=function(){this.UIWindow.MakeFloatWidgetStyle()},A.prototype.ShowContents=function(){this.UIWindow.ClearContents(),this.UIWindow.SetContents(this.Widget.GetContents())},A.prototype.ShowHideDragState=function(a){a?this.UIWindow.GetDomElement().css("opacity","0.3"):this.UIWindow.GetDomElement().css("opacity","1")},A.prototype.ShowIcon=function(){this.UIWindow.ClearContents(),this.UIWindow.SetContents(this.$iconView)},e.NewUIWidget=function(a){var b=new A;return b.Widget=a,b.$iconView=$('<div class="widget-icon" style="text-align: center;vertical-align: middle;height:100%;"></div>'),a.Icon?b.$iconView.append('<img style="vertical-align:middle;margin-top:32px;" src="'+a.Icon+'"/>'):b.$iconView.append('<img style="margin-top:24px;" src="img/widgets/icon-unknown.png"/>'),b};var B=e.UIWidgetDropInfo=function(){this.Found=!1,this.UIWidgetPanel=undefined,this.UIWidget=undefined,this.InsertBeforeUIWidget=undefined,this.PrevInsertBeforeUIWidget=undefined},C=e.UIWidgetPanel=function(){this.scrollAmount=60,this.UIWidgets=[],this.$container=undefined,this.$widgetContainer=undefined,this.scrollY=0,this.$scrollContainer=undefined,this.$upScrollButton=undefined,this.$downScrollButton=undefined,this.upScrollerShown=!1,this.downScrollerShown=!1};C.prototype.AddUIWidget=function(a){this.InsertUIWidget(a,undefined)},C.prototype.getTotalWidgetsHeight=function(){var a=0;for(var b=0;b<this.UIWidgets.length;b++)a+=this.UIWidgets[b].UIWindow.GetDomElement().height()+8;return a+24},C.prototype.GetUIWidgetDropInfo=function(a){var c=new B,d=this.GetRect();if(!b.PointInRect(a,d))return c;c.Found=!0,c.UIWidgetPanel=this;for(var e=0;e<this.UIWidgets.length;e++){var f=this.UIWidgets[e],g=f.GetRect();e==0&&(g.Top=d.Top),g.Bottom+=10,g.Left=d.left,g.Right=d.Right;if(!b.PointInRect(a,g))continue;c.UIWidget=f;var h=g.Top+(g.Bottom-g.Top)/2;a.Y<=h?(c.InsertBeforeUIWidget=f,c.PrevInsertBeforeUIWidget=this.UIWidgets[e-1]):(c.UIWidget=f,c.InsertBeforeUIWidget=this.UIWidgets[e+1],c.PrevInsertBeforeUIWidget=this.UIWidgets[e]);break}return c},C.prototype.findUIWidgetIndex=function(a){for(var b=0;b<this.UIWidgets.length;b++)if(this.UIWidgets[b]==a)return b;return-1},C.prototype.GetRect=function(){var a=b.NewRect(),c=this.$widgetContainer.offset();return a.Left=c.left,a.Top=c.top,a.Right=a.Left+this.$widgetContainer.width()-1,a.Bottom=a.Top+this.$widgetContainer.height()-1,a},C.prototype.getDownScrollClickHandler=function(){var a=this;return function(){a.scroll(-a.scrollAmount)}},C.prototype.getUpScrollClickHandler=function(){var a=this;return function(){a.scroll(a.scrollAmount)}},C.prototype.hideDownScroller=function(){if(!this.downScrollerShown)return;this.$downScrollButton.hide(),this.$scrollWrapper.css("bottom","0"),this.downScrollerShown=!1},C.prototype.hideUpScroller=function(){if(!this.upScrollerShown)return;this.$upScrollButton.hide(),this.$scrollWrapper.css("top","0"),this.upScrollerShown=!1},C.prototype.InsertUIWidget=function(a,b){a.UIWidgetPanel=this;if(!b){this.UIWidgets.push(a),this.$scrollContainer.append(a.UIWindow.GetDomElement()),this.ShowHideScrollers();return}var c=this.findUIWidgetIndex(b);if(c<0)return;this.UIWidgets.splice(c,0,a),b.UIWindow.GetDomElement().before(a.UIWindow.GetDomElement()),this.ShowHideScrollers()},C.prototype.RemoveUIWidget=function(a){var b=this.findUIWidgetIndex(a);if(b<0)return;a.UIWindow.GetDomElement().detach(),this.UIWidgets.splice(b,1),this.ShowHideScrollers()},C.prototype.Resize=function(){for(var a=0;a<this.UIWidgets.length;a++){var b=this.UIWidgets[a];if(!b.Widget)continue;b.Widget.FireResize()}this.ShowHideScrollers()},C.prototype.scroll=function(a){this.scrollY+=a,this.scrollY>0&&(this.scrollY=0),this.$scrollContainer.css("margin-top",this.scrollY+"px"),this.ShowHideScrollers()},C.prototype.ShowHideScrollers=function(){var a=this.$container.height(),b=this.getTotalWidgetsHeight();if(b<=a){this.hideUpScroller(),this.hideDownScroller(),this.scrollY=0,this.$scrollContainer.css("margin-top","");return}this.scrollY<0&&this.showUpScroller(),this.scrollY==0&&this.hideUpScroller(),b-this.scrollY>a&&this.showDownScroller(),b+this.scrollY<a&&this.hideDownScroller()},C.prototype.showUpScroller=function(){this.$scrollWrapper.css("top","24px"),this.$upScrollButton.show(),this.upScrollerShown=!0},C.prototype.showDownScroller=function(){if(this.downScrollerShown)return;this.$scrollWrapper.css("bottom","24px"),this.$downScrollButton.show(),this.downScrollerShown=!0},C.prototype.Sort=function(){this.$widgetContainer.contents().detach(),this.UIWidgets.sort(function(a,c){return b.CompareStringsForSort(a.Widget.Name,c.Widget.Name)});for(var a=0;a<this.UIWidgets.length;a++)this.$widgetContainer.append(this.UIWidgets[a].UIWindow.GetDomElement())},e.NewUIWidgetPanel=function(a){var b=new C;return b.$container=a,b.$widgetContainer=$('<div style="position: absolute; left:4px;top:4px;bottom:4px;right:6px; border:none;"></div>'),b.$container.append(b.$widgetContainer),b.$scrollWrapper=$('<div style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>'),b.$scrollContainer=$('<div style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>'),b.$scrollWrapper.append(b.$scrollContainer),b.$widgetContainer.append(b.$scrollWrapper),b.$upScrollButton=$('<div class="" style="width:16px;height:19px;background-image:url(img/scroll-big-up.png);display:none;cursor:pointer;z-index:25000;position:absolute;top:0;right:48%;"></div>'),b.$downScrollButton=$('<div class="" style="width:16px;height:19px;background-image:url(img/scroll-big-down.png);display:none;cursor:pointer;z-index:25000;position:absolute;bottom:0;right:48%;"></div>'),b.$widgetContainer.prepend(b.$upScrollButton),b.$widgetContainer.append(b.$downScrollButton),b.$upScrollButton.click(b.getUpScrollClickHandler()),b.$downScrollButton.click(b.getDownScrollClickHandler()),b};var D=e.UIWindowSettings=function(){this.CallbackData=undefined,this.Close=undefined,this.Size=undefined,this.Pin=undefined,this.Plus=undefined,this.Collaboration=undefined,this.TitleBarMouseDown=undefined,this.BreadBarOnClick=undefined,this.Title=""},E=e.UIWindow=function(){this.callbackData=undefined,this.title="",this.UIBreadBar=undefined,this.uiBreadBarShown=!1,this.Collaborators=[],this.CollaborationPopup=new u(this),this.$mainElement=undefined,this.$breadBarContainer=undefined,this.$contentsContainer=undefined,this.$pinButton=undefined,this.$collabButton=undefined};return E.prototype.AddCollaborator=function(a){this.Collaborators.push(a),this.SetCollaborationState("some"),this.CollaborationPopup.UpdateCollaborators()},E.prototype.ClearContents=function(){this.$contentsContainer.html("")},E.prototype.ClearCollaborators=function(){this.Collaborators=[],this.SetCollaborationState("none"),this.CollaborationPopup.UpdateCollaborators()},E.prototype.getSetCollaborationState=function(a){var b=this;return function(){b.SetCollaborationState(a)}},E.prototype.GetDomElement=function(){return this.$mainElement},E.prototype.GetCollaboratorButton=function(){return this.$collabButton},E.prototype.getCallbackFunction=function(a){var b=this;return function(c){a(b.callbackData,c)}},E.prototype.HideBreadBar=function(){if(!this.uiBreadBarShown)return;this.UIBreadBar.Hide(),this.$contentsContainer.css("margin-top",""),this.uiBreadBarShown=!1},E.prototype.AppendContents=function(a){this.$contentsContainer.append(a)},E.prototype.SetContents=function(a){this.$contentsContainer.html(""),this.$contentsContainer.append(a)},E.prototype.MakeFixedWidgetStyle=function(){this.$mainElement.removeClass().addClass(g),this.$mainElement.css("width","180px"),this.$mainElement.css("height","160px")},E.prototype.MakeFloatWidgetStyle=function(){this.$mainElement.removeClass().addClass(h),this.$mainElement.css("width","99%"),this.$mainElement.css("height","")},E.prototype.SetPinState=function(a){a?this.$pinButton.removeClass("ui-icon-pin-s").addClass("ui-icon-pin-w"):this.$pinButton.removeClass("ui-icon-pin-w").addClass("ui-icon-pin-s")},E.prototype.SetCollaborationState=function(a){switch(a){case"none":this.$collabButton.removeClass("ui-icon-collab-some").removeClass("ui-icon-collab-hilite").addClass("ui-icon-collab-none");break;case"some":this.$collabButton.removeClass("ui-icon-collab-none").removeClass("ui-icon-collab-hilite").addClass("ui-icon-collab-some");break;case"hilite":this.$collabButton.removeClass("ui-icon-collab-some").removeClass("ui-icon-collab-none").addClass("ui-icon-collab-hilite"),window.setTimeout(this.getSetCollaborationState("some"),3e3);break;default:}},E.prototype.ShowBreadBar=function(){if(this.uiBreadBarShown)return;this.UIBreadBar.Show(),this.$contentsContainer.css("margin-top","30px"),this.uiBreadBarShown=!0},e.NewUIWindow=function(a){var b=new E;a||(a=new D),b.callbackData=a.CallbackData,b.title=a.Title,b.$mainElement=$("<div></div>").addClass(f);var c=$('<div style="height:8px; white-space: nowrap;" class="can_drag ui-dialog-titlebar ui-widget-header ui-corner-all"><span class="ui-dialog-title" style="margin-top:-6px;">'+b.title+"</span></div>");a.Close&&c.append(G("ui-icon-circle-close",b.getCallbackFunction(a.Close))),a.Size&&c.append(G("ui-icon-newwin",b.getCallbackFunction(a.Size)));if(a.Pin){var d=G("ui-icon-pin-s",b.getCallbackFunction(a.Pin));b.$pinButton=d.find(".ui-icon-pin-s"),c.append(d)}if(a.Collaboration){var d=G("ui-icon-collab-none",b.getCallbackFunction(a.Collaboration));b.$collabButton=d.find(".ui-icon-collab-none"),c.append(d)}return a.Plus&&c.append(G("ui-icon-circle-plus",b.getCallbackFunction(a.Plus))),a.TitleBarMouseDown&&c.mousedown(b.getCallbackFunction(a.TitleBarMouseDown)),b.$mainElement.append(c),b.$breadBarContainer=$('<div style="position:relative;"></div>'),b.$mainElement.append(b.$breadBarContainer),b.UIBreadBar=e.NewUIBreadBar(b.$breadBarContainer,a.BreadBarOnClick),b.$contentsContainer=$('<div class="ui-dialog-content ui-widget-content ui-helper-clearfix form-scroller" style="position:absolute;top:28px;left:0;right:0;bottom:0; overflow: hidden; ">'),b.$mainElement.append(b.$contentsContainer),b},e}),define("domReady",[],function(){function i(a){for(var b=0,d;d=a[b];b++)d(c)}function j(){var a=d,c=e;b&&(a.length&&(d=[],i(a)),f.resourcesDone&&c.length&&(e=[],i(c)))}function k(){b||(b=!0,h&&clearInterval(h),j())}function l(a){return b?a(c):d.push(a),l}var a=typeof window!="undefined"&&window.document,b=!a,c=a?document:null,d=[],e=[],f=requirejs||require||{},g=f.resourcesReady,h;return"resourcesReady"in f&&(f.resourcesReady=function(a){g&&g(a),a&&j()}),a&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",k,!1),window.addEventListener("load",k,!1)):window.attachEvent&&(window.attachEvent("onload",k),self===self.top&&(h=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),k())}catch(a){}},30))),document.readyState==="complete"&&k()),l.withResources=function(a){return b&&f.resourcesDone?a(c):e.push(a),l},l.version="1.0.0",l.load=function(a,b,c,d){d.isBuild?c(null):l(c)},l}),define("objects/schema/form_classes",["require","general_functions","utilities","objects/schema/model_utils"],function(a){var b=a("general_functions"),c=a("utilities"),d=a("objects/schema/model_utils"),e={},f=e.RequiredModel=function(a,b){this.model=a,this.modelChangedCB=b},g=e.FormDescription=function(){this.ID="",this.InternalName=undefined,this.Name="",this.NameSpace="",this.Keywords="",this.CanActivate=!0,this.widgets=[],this.UITemplate=undefined,this.requiredModels=[],this.InstanceClass=undefined};g.prototype.CreateInstance=function(){if(!this.InstanceClass)throw new Error("Form '"+this.Name+"' has no InstanceClass.");var a=new this.InstanceClass;return c.InheritFields(a,new h),c.InheritFunctions(this.InstanceClass,h),a.Description=this,a},g.prototype.LoadRequires=function(a,c){var e=b.GetFieldValues(this.requiredModels,"model");d.LoadModels(e,a,c)},g.prototype.RequireModel=function(a,b){this.requiredModels.push(new f(a,b))},g.prototype.AddWidget=function(a){a.FormDescription=this,this.widgets.push(a)};var h=e.FormInstance=function(){this.Description=undefined,this.boundModels=[],this.$contents=undefined};h.prototype.BindRequires=function(a){function c(a,c){if(!c)return;var d=function(a){c(b,a)};b.boundModels.push(new f(a,d)),a.BindChanged(d)}var b=this;for(var d=0;d<a.length;d++)c(a[d].model,a[d].modelChangedCB)},h.prototype.GetContents=function(){return this.$contents},h.prototype.Hide=function(){},h.prototype.Load=function(a){throw new Error("Form "+this.Description.InternalName+" does not have a Load function. Dan thinks this is an error, but if it is really a legit situation, than delete this exception.")},h.prototype.Resize=function(){},h.prototype.Show=function(){},h.prototype.UnbindRequires=function(){for(var a=0;a<this.boundModels.length;a++){var b=this.boundModels[a];b.model.UnbindChanged(b.modelChangedCB)}},h.prototype.Unload=function(){};var i=e.Widget=function(){this.ID="",this.Name="",this.Icon="",this.$contents=undefined,this.FormDescription=undefined,this.Loaded=!1};return i.prototype.FireFormActivated=function(a){this.FormActivated(a)},i.prototype.FireLoad=function(a){if(this.Loaded)return;this.Load(a),this.Loaded=!0},i.prototype.FireResize=function(){if(!this.Loaded)return;this.Resize()},i.prototype.FireUnload=function(){if(!this.Loaded)return;this.Unload(),this.Loaded=!1},i.prototype.FormActivated=function(a){},i.prototype.GetContents=function(){return this.$contents},i.prototype.Load=function(){throw new Error("Widget "+this.Name+" does not have a Load function. Dan thinks this is an error, but if it is really a legit situation, than delete this exception.")},i.prototype.Resize=function(){},i.prototype.Unload=function(){},e}),define("objects/forms/clock",["require","utilities","objects/schema/form_classes"],function(a){function e(){}var b=a("utilities"),c=a("objects/schema/form_classes"),d=new c.FormDescription;d.ID="73269226-5385-4271-91f7-a930eb16f238",d.Name="Clock",d.InternalName="clock",d.NameSpace="extended.General.Clock",d.Keywords="clock,time,hours,calendar,date,minutes,seconds,digital,analog,timer",d.CanActivate=!1,d.InstanceClass=e,e.prototype.Load=function(a){};var f=new c.Widget;return f.ID=d.ID+".0",f.Name="Clock",f.Icon="img/widgets/widget-clock.png",f.currentTimer=undefined,f.calculateTimeout=function(){var a=new Date;return 6e4-a%6e4+10},f.Load=function(){this.$contents=$("<div></div>"),this.$contents.html(this.getDateTimeDiv()),this.runTimer()},f.getDateTimeDiv=function(){var a=new Date,c=b.FormatDateTime(a,"h:MM TT"),d=b.FormatDateTime(a,"dddd, mmmm dS, yyyy");return $(b.FormatString('<div style="text-align: center;font-size:28pt;font-weight:bold;">{0}</div><div style="text-align: center;">{1}</div>',c,d))},f.runTimer=function(){var a=this;this.currentTimer=window.setTimeout(function(){a.$contents.html(a.getDateTimeDiv()),a.runTimer()},a.calculateTimeout())},f.Unload=function(){window.clearTimeout(this.currentTimer)},d.AddWidget(f),d}),define("objects/forms/debugging",["require","general_functions","objects/schema/form_classes"],function(a){function e(){}var b=a("general_functions"),c=a("objects/schema/form_classes"),d=new c.FormDescription;d.ID="e86781f8-fb7e-49b9-8906-0deb1d993019",d.Name="Debugging Log",d.InternalName="debugging",d.NameSpace="base.Tools.Debug Log",d.Keywords="tools,debug,debugging,log,history,messages",d.CanActivate=!0,d.InstanceClass=e,e.prototype.Load=function(a){this.state=a;var c=this;this.$contents=$("<div><div style='text-align: left;font-size:10pt;color:#505050;overflow: auto;'><table>"+b.LogHistory+"</table></div></div>");var d="",e=1;$(document).bind("debug",function(a,b){var f=$(b).find("td:last").text(),g=$(b).find("td:first").text();if(f==d)e++,c.$contents.find("table").find("tr:first").find("td:last").text(f+" (x"+e+")"),c.$contents.find("table").find("tr:first").find("td:first").text(g),c.$contents.find("table").find("tr:first").stop().css("color","#ff3300").delay(1e4).animate({color:"#505050"});else{var h=$(b).fadeIn("slow").css("color","#ff3300").delay(1e4).animate({color:"#505050"});c.$contents.find("table").prepend(h),e=1}d=f})};var f=new c.Widget;return f.id=d.ID+".1",f.name="10 Second Console",f.icon="img/widgets/widget-console.png",f.init=function(a){var b=this;$(a).append("<div style='width:100%;text-align: left;font-size:8pt;color:#505050;'><table><tr><td colspan='2' style='border-bottom:1px dotted #c0c0c0;'>Showing debug messages from the last ten seconds</td></tr></table></div>"),$(b).trigger("updateWidget"),$(document).bind("debug",function(c,d){if(b.running){var e=$(d).fadeIn("slow").css("color","#ff3300").delay(1e4).animate({color:"#505050"},function(){$(e).fadeOut(function(){$(b).trigger("updateWidget")})});$(a).find("table").children().first().after(e),$(b).trigger("updateWidget")}})},f.start=function(){this.running=!0},f.stop=function(){this.running=!1},d.AddWidget(f),d}),function(){window.$jit=function(a){a=a||window;for(var b in $jit)$jit[b].$extend&&(a[b]=$jit[b])},$jit.version="2.0.1";var a=function(a){return document.getElementById(a)};a.empty=function(){},a.extend=function(a,b){for(var c in b||{})a[c]=b[c];return a},a.lambda=function(a){return typeof a=="function"?a:function(){return a}},a.time=Date.now||function(){return+(new Date)},a.splat=function(b){var c=a.type(b);return c?c!="array"?[b]:b:[]},a.type=function(b){var c=a.type.s.call(b).match(/^\[object\s(.*)\]$/)[1].toLowerCase();return c!="object"?c:b&&b.$$family?b.$$family:b&&b.nodeName&&b.nodeType==1?"element":c},a.type.s=Object.prototype.toString,a.each=function(b,c){var d=a.type(b);if(d=="object")for(var e in b)c(b[e],e);else for(var f=0,g=b.length;f<g;f++)c(b[f],f)},a.indexOf=function(a,b){if(Array.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},a.map=function(b,c){var d=[];return a.each(b,function(a,b){d.push(c(a,b))}),d},a.reduce=function(a,b,c){var d=a.length;if(d==0)return c;var e=arguments.length==3?c:a[--d];while(d--)e=b(e,a[d]);return e},a.merge=function(){var b={};for(var c=0,d=arguments.length;c<d;c++){var e=arguments[c];if(a.type(e)!="object")continue;for(var f in e){var g=e[f],h=b[f];b[f]=h&&a.type(g)=="object"&&a.type(h)=="object"?a.merge(h,g):a.unlink(g)}}return b},a.unlink=function(b){var c;switch(a.type(b)){case"object":c={};for(var d in b)c[d]=a.unlink(b[d]);break;case"array":c=[];for(var e=0,f=b.length;e<f;e++)c[e]=a.unlink(b[e]);break;default:return b}return c},a.zip=function(){if(arguments.length===0)return[];for(var a=0,b=[],c=arguments.length,d=arguments[0].length;a<d;a++){for(var e=0,f=[];e<c;e++)f.push(arguments[e][a]);b.push(f)}return b},a.rgbToHex=function(a,b){if(a.length<3)return null;if(a.length==4&&a[3]==0&&!b)return"transparent";var c=[];for(var d=0;d<3;d++){var e=(a[d]-0).toString(16);c.push(e.length==1?"0"+e:e)}return b?c:"#"+c.join("")},a.hexToRgb=function(a){if(a.length!=7){a=a.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/),a.shift();if(a.length!=3)return null;var b=[];for(var c=0;c<3;c++){var d=a[c];d.length==1&&(d+=d),b.push(parseInt(d,16))}return b}return a=parseInt(a.slice(1),16),[a>>16,a>>8&255,a&255]},a.destroy=function(b){a.clean(b),b.parentNode&&b.parentNode.removeChild(b),b.clearAttributes&&b.clearAttributes()},a.clean=function(b){for(var c=b.childNodes,d=0,e=c.length;d<e;d++)a.destroy(c[d])},a.addEvent=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},a.addEvents=function(b,c){for(var d in c)a.addEvent(b,d,c[d])},a.hasClass=function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1},a.addClass=function(b,c){a.hasClass(b,c)||(b.className=b.className+" "+c)},a.removeClass=function(a,b){a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(?:\\s|$)"),"$1")},a.getPos=function(a){function d(a){var b={x:0,y:0};while(a&&!f(a))b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b}function e(a){var b={x:0,y:0};while(a&&!f(a))b.x+=a.scrollLeft,b.y+=a.scrollTop,a=a.parentNode;return b}function f(a){return/^(?:body|html)$/i.test(a.tagName)}var b=d(a),c=e(a);return{x:b.x-c.x,y:b.y-c.y}},a.event={get:function(a,b){return b=b||window,a||b.event},getWheel:function(a){return a.wheelDelta?a.wheelDelta/120:-(a.detail||0)/3},isRightClick:function(a){return a.which==3||a.button==2},getPos:function(a,b){b=b||window,a=a||b.event;var c=b.document;c=c.documentElement||c.body,a.touches&&a.touches.length&&(a=a.touches[0]);var d={x:a.pageX||a.clientX+c.scrollLeft,y:a.pageY||a.clientY+c.scrollTop};return d},stop:function(a){a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1}},$jit.util=$jit.id=a;var b=function(c){c=c||{};var d=function(){for(var c in this)typeof this[c]!="function"&&(this[c]=a.unlink(this[c]));this.constructor=d;if(b.prototyping)return this;var e=this.initialize?this.initialize.apply(this,arguments):this;return this.$$family="class",e};for(var e in b.Mutators){if(!c[e])continue;c=b.Mutators[e](c,c[e]),delete c[e]}return a.extend(d,this),d.constructor=b,d.prototype=c,d};b.Mutators={Implements:function(c,d){return a.each(a.splat(d),function(a){b.prototyping=a;var d=typeof a=="function"?new a:a;for(var e in d)e in c||(c[e]=d[e]);delete b.prototyping}),c}},a.extend(b,{inherit:function(c,d){for(var e in d){var f=d[e],g=c[e],h=a.type(f);g&&h=="function"?f!=g&&b.override(c,e,f):h=="object"?c[e]=a.merge(g,f):c[e]=f}return c},override:function(a,c,d){var e=b.prototyping;e&&a[c]!=e[c]&&(e=null);var f=function(){var b=this.parent;this.parent=e?e[c]:a[c];var f=d.apply(this,arguments);return this.parent=b,f};a[c]=f}}),b.prototype.implement=function(){var c=this.prototype;return a.each(Array.prototype.slice.call(arguments||[]),function(a){b.inherit(c,a)}),this},$jit.Class=b,$jit.json={prune:function(a,b){this.each(a,function(a,c){c==b&&a.children&&(delete a.children,a.children=[])})},getParent:function(a,b){if(a.id==b)return!1;var c=a.children;if(c&&c.length>0)for(var d=0;d<c.length;d++){if(c[d].id==b)return a;var e=this.getParent(c[d],b);if(e)return e}return!1},getSubtree:function(a,b){if(a.id==b)return a;for(var c=0,d=a.children;d&&c<d.length;c++){var e=this.getSubtree(d[c],b);if(e!=null)return e}return null},eachLevel:function(a,b,c,d){if(b<=c){d(a,b);if(!a.children)return;for(var e=0,f=a.children;e<f.length;e++)this.eachLevel(f[e],b+1,c,d)}},each:function(a,b){this.eachLevel(a,0,Number.MAX_VALUE,b)}},$jit.Trans={$extend:!0,linear:function(a){return a}};var c=$jit.Trans;(function(){var b=function(b,c){return c=a.splat(c),a.extend(b,{easeIn:function(a){return b(a,c)},easeOut:function(a){return 1-b(1-a,c)},easeInOut:function(a){return a<=.5?b(2*a,c)/2:(2-b(2*(1-a),c))/2}})},d={Pow:function(a,b){return Math.pow(a,b[0]||6)},Expo:function(a){return Math.pow(2,8*(a-1))},Circ:function(a){return 1-Math.sin(Math.acos(a))},Sine:function(a){return 1-Math.sin((1-a)*Math.PI/2)},Back:function(a,b){return b=b[0]||1.618,Math.pow(a,2)*((b+1)*a-b)},Bounce:function(a){var b;for(var c=0,d=1;1;c+=d,d/=2)if(a>=(7-4*c)/11){b=d*d-Math.pow((11-6*c-11*a)/4,2);break}return b},Elastic:function(a,b){return Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b[0]||1)/3)}};a.each(d,function(a,d){c[d]=b(a)}),a.each(["Quad","Cubic","Quart","Quint"],function(a,d){c[a]=b(function(a){return Math.pow(a,[d+2])})})})();var d=new b({initialize:function(a){this.setOptions(a)},setOptions:function(b){var d={duration:2500,fps:40,transition:c.Quart.easeInOut,compute:a.empty,complete:a.empty,link:"ignore"};return this.opt=a.merge(d,b||{}),this},step:function(){var b=a.time(),c=this.opt;if(b<this.time+c.duration){var d=c.transition((b-this.time)/c.duration);c.compute(d)}else this.timer=clearInterval(this.timer),c.compute(1),c.complete()},start:function(){return this.check()?(this.time=0,this.startTimer(),this):this},startTimer:function(){var b=this,c=this.opt.fps;return this.timer?!1:(this.time=a.time()-this.time,this.timer=setInterval(function(){b.step()},Math.round(1e3/c)),!0)},pause:function(){return this.stopTimer(),this},resume:function(){return this.startTimer(),this},stopTimer:function(){return this.timer?(this.time=a.time()-this.time,this.timer=clearInterval(this.timer),!0):!1},check:function(){return this.timer?this.opt.link=="cancel"?(this.stopTimer(),!0):!1:!0}}),e=function(){var b=arguments;for(var c=0,d=b.length,f={};c<d;c++){var g=e[b[c]];g.$extend?a.extend(f,g):f[b[c]]=g}return f};e.Canvas={$extend:!0,injectInto:"id",type:"2D",width:!1,height:!1,useCanvas:!1,withLabels:!0,background:!1,Scene:{Lighting:{enable:!1,ambient:[1,1,1],directional:{direction:{x:-100,y:-100,z:-100},color:[.5,.3,.1]}}}},e.Node={$extend:!1,overridable:!1,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:!1,autoWidth:!1,lineWidth:1,transform:!0,align:"center",angularWidth:1,span:1,CanvasStyles:{}},e.Edge={$extend:!1,overridable:!1,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}},e.Fx={$extend:!0,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:!0},e.Label={$extend:!1,overridable:!1,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"},e.Tips={$extend:!1,enable:!1,type:"auto",offsetX:20,offsetY:20,force:!1,onShow:a.empty,onHide:a.empty},e.NodeStyles={$extend:!1,enable:!1,type:"auto",stylesHover:!1,stylesClick:!1},e.Events={$extend:!1,enable:!1,enableForEdges:!1,type:"auto",onClick:a.empty,onRightClick:a.empty,onMouseMove:a.empty,onMouseEnter:a.empty,onMouseLeave:a.empty,onDragStart:a.empty,onDragMove:a.empty,onDragCancel:a.empty,onDragEnd:a.empty,onTouchStart:a.empty,onTouchMove:a.empty,onTouchEnd:a.empty,onMouseWheel:a.empty},e.Navigation={$extend:!1,enable:!1,type:"auto",panning:!1,zooming:!1},e.Controller={$extend:!0,onBeforeCompute:a.empty,onAfterCompute:a.empty,onCreateLabel:a.empty,onPlaceLabel:a.empty,onComplete:a.empty,onBeforePlotLine:a.empty,onAfterPlotLine:a.empty,onBeforePlotNode:a.empty,onAfterPlotNode:a.empty,request:!1};var f={initialize:function(a,b){this.viz=b,this.canvas=b.canvas,this.config=b.config[a],this.nodeTypes=b.fx.nodeTypes;var c=this.config.type;this.dom=c=="auto"?b.config.Label.type!="Native":c!="Native",this.labelContainer=this.dom&&b.labels.getLabelContainer(),this.isEnabled()&&this.initializePost()},initializePost:a.empty,setAsProperty:a.lambda(!1),isEnabled:function(){return this.config.enable},isLabel:function(b,c,d){b=a.event.get(b,c);var e=this.labelContainer,f=b.target||b.srcElement,g=b.relatedTarget;return d?g&&g==this.viz.canvas.getCtx().canvas&&!!f&&this.isDescendantOf(f,e):this.isDescendantOf(f,e)},isDescendantOf:function(a,b){while(a&&a.parentNode){if(a.parentNode==b)return a;a=a.parentNode}return!1}},g={onMouseUp:a.empty,onMouseDown:a.empty,onMouseMove:a.empty,onMouseOver:a.empty,onMouseOut:a.empty,onMouseWheel:a.empty,onTouchStart:a.empty,onTouchMove:a.empty,onTouchEnd:a.empty,onTouchCancel:a.empty},h=new b({initialize:function(a){this.viz=a,this.canvas=a.canvas,this.node=!1,this.edge=!1,this.registeredObjects=[],this.attachEvents()},attachEvents:function(){var b=this.canvas.getElement(),c=this;b.oncontextmenu=a.lambda(!1),a.addEvents(b,{mouseup:function(b,d){var e=a.event.get(b,d);c.handleEvent("MouseUp",b,d,c.makeEventObject(b,d),a.event.isRightClick(e))},mousedown:function(b,d){var e=a.event.get(b,d);c.handleEvent("MouseDown",b,d,c.makeEventObject(b,d),a.event.isRightClick(e))},mousemove:function(a,b){c.handleEvent("MouseMove",a,b,c.makeEventObject(a,b))},mouseover:function(a,b){c.handleEvent("MouseOver",a,b,c.makeEventObject(a,b))},mouseout:function(a,b){c.handleEvent("MouseOut",a,b,c.makeEventObject(a,b))},touchstart:function(a,b){c.handleEvent("TouchStart",a,b,c.makeEventObject(a,b))},touchmove:function(a,b){c.handleEvent("TouchMove",a,b,c.makeEventObject(a,b))},touchend:function(a,b){c.handleEvent("TouchEnd",a,b,c.makeEventObject(a,b))}});var d=function(b,d){var e=a.event.get(b,d),f=a.event.getWheel(e);c.handleEvent("MouseWheel",b,d,f)};!document.getBoxObjectFor&&window.mozInnerScreenX==null?a.addEvent(b,"mousewheel",d):b.addEventListener("DOMMouseScroll",d,!1)},register:function(a){this.registeredObjects.push(a)},handleEvent:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();for(var c=0,d=this.registeredObjects,e=d.length;c<e;c++)d[c]["on"+b].apply(d[c],a)},makeEventObject:function(b,c){var d=this,e=this.viz.graph,f=this.viz.fx,g=f.nodeTypes,h=f.edgeTypes;return{pos:!1,node:!1,edge:!1,contains:!1,getNodeCalled:!1,getEdgeCalled:!1,getPos:function(){var e=d.viz.canvas,f=e.getSize(),g=e.getPos(),h=e.translateOffsetX,i=e.translateOffsetY,j=e.scaleOffsetX,k=e.scaleOffsetY,l=a.event.getPos(b,c);return this.pos={x:(l.x-g.x-f.width/2-h)*1/j,y:(l.y-g.y-f.height/2-i)*1/k},this.pos},getNode:function(){if(this.getNodeCalled)return this.node;this.getNodeCalled=!0;for(var a in e.nodes){var b=e.nodes[a],c=b&&g[b.getData("type")],h=c&&c.contains&&c.contains.call(f,b,this.getPos());if(h)return this.contains=h,d.node=this.node=b}return d.node=this.node=!1},getEdge:function(){if(this.getEdgeCalled)return this.edge;this.getEdgeCalled=!0;var a={};for(var b in e.edges){var c=e.edges[b];a[b]=!0;for(var g in c){if(g in a)continue;var i=c[g],j=i&&h[i.getData("type")],k=j&&j.contains&&j.contains.call(f,i,this.getPos());if(k)return this.contains=k,d.edge=this.edge=i}}return d.edge=this.edge=!1},getContains:function(){return this.getNodeCalled?this.contains:(this.getNode(),this.contains)}}}}),i={initializeExtras:function(){var b=new h(this),c=this;a.each(["NodeStyles","Tips","Navigation","Events"],function(a){var d=new i.Classes[a](a,c);d.isEnabled()&&b.register(d),d.setAsProperty()&&(c[a.toLowerCase()]=d)})}};i.Classes={},i.Classes.Events=new b({Implements:[f,g],initializePost:function(){this.fx=this.viz.fx,this.ntypes=this.viz.fx.nodeTypes,this.etypes=this.viz.fx.edgeTypes,this.hovered=!1,this.pressed=!1,this.touched=!1,this.touchMoved=!1,this.moved=!1},setAsProperty:a.lambda(!0),onMouseUp:function(b,c,d,e){var f=a.event.get(b,c);this.moved||(e?this.config.onRightClick(this.hovered,d,f):this.config.onClick(this.pressed,d,f)),this.pressed&&(this.moved?this.config.onDragEnd(this.pressed,d,f):this.config.onDragCancel(this.pressed,d,f),this.pressed=this.moved=!1)},onMouseOut:function(b,c,d){var e=a.event.get(b,c),f;if(this.dom&&(f=this.isLabel(b,c,!0))){this.config.onMouseLeave(this.viz.graph.getNode(f.id),d,e),this.hovered=!1;return}var g=e.relatedTarget,h=this.canvas.getElement();while(g&&g.parentNode){if(h==g.parentNode)return;g=g.parentNode}this.hovered&&(this.config.onMouseLeave(this.hovered,d,e),this.hovered=!1)},onMouseOver:function(b,c,d){var e=a.event.get(b,c),f;this.dom&&(f=this.isLabel(b,c,!0))&&(this.hovered=this.viz.graph.getNode(f.id),this.config.onMouseEnter(this.hovered,d,e))},onMouseMove:function(b,c,d){var e,f=a.event.get(b,c);if(this.pressed){this.moved=!0,this.config.onDragMove(this.pressed,d,f);return}if(this.dom)this.config.onMouseMove(this.hovered,d,f);else{if(this.hovered){var g=this.hovered,h=g.nodeFrom?this.etypes[g.getData("type")]:this.ntypes[g.getData("type")],i=h&&h.contains&&h.contains.call(this.fx,g,d.getPos());if(i){this.config.onMouseMove(g,d,f);return}this.config.onMouseLeave(g,d,f),this.hovered=!1}(this.hovered=d.getNode()||this.config.enableForEdges&&d.getEdge())?this.config.onMouseEnter(this.hovered,d,f):this.config.onMouseMove(!1,d,f)}},onMouseWheel:function(b,c,d){this.config.onMouseWheel(d,a.event.get(b,c))},onMouseDown:function(b,c,d){var e=a.event.get(b,c),f;if(this.dom){if(f=this.isLabel(b,c))this.pressed=this.viz.graph.getNode(f.id)}else this.pressed=d.getNode()||this.config.enableForEdges&&d.getEdge();this.pressed&&this.config.onDragStart(this.pressed,d,e)},onTouchStart:function(b,c,d){var e=a.event.get(b,c),f;this.dom&&(f=this.isLabel(b,c))?this.touched=this.viz.graph.getNode(f.id):this.touched=d.getNode()||this.config.enableForEdges&&d.getEdge(),this.touched&&this.config.onTouchStart(this.touched,d,e)},onTouchMove:function(b,c,d){var e=a.event.get(b,c);this.touched&&(this.touchMoved=!0,this.config.onTouchMove(this.touched,d,e))},onTouchEnd:function(b,c,d){var e=a.event.get(b,c);this.touched&&(this.touchMoved?this.config.onTouchEnd(this.touched,d,e):this.config.onTouchCancel(this.touched,d,e),this.touched=this.touchMoved=!1)}}),i.Classes.Tips=new b({Implements:[f,g],initializePost:function(){if(document.body){var b=a("_tooltip")||document.createElement("div");b.id="_tooltip",b.className="tip",a.extend(b.style,{position:"absolute",display:"none",zIndex:13e3}),document.body.appendChild(b),this.tip=b,this.node=!1}},setAsProperty:a.lambda(!0),onMouseOut:function(b,c){var d=a.event.get(b,c);if(this.dom&&this.isLabel(b,c,!0)){this.hide(!0);return}var e=b.relatedTarget,f=this.canvas.getElement();while(e&&e.parentNode){if(f==e.parentNode)return;e=e.parentNode}this.hide(!1)},onMouseOver:function(a,b){var c;this.dom&&(c=this.isLabel(a,b,!1))&&(this.node=this.viz.graph.getNode(c.id),this.config.onShow(this.tip,this.node,c))},onMouseMove:function(b,c,d){this.dom&&this.isLabel(b,c)&&this.setTooltipPosition(a.event.getPos(b,c));if(!this.dom){var e=d.getNode();if(!e){this.hide(!0);return}if(this.config.force||!this.node||this.node.id!=e.id)this.node=e,this.config.onShow(this.tip,e,d.getContains());this.setTooltipPosition(a.event.getPos(b,c))}},setTooltipPosition:function(a){var b=this.tip,c=b.style,d=this.config;c.display="";var e={height:document.body.clientHeight,width:document.body.clientWidth},f={width:b.offsetWidth,height:b.offsetHeight},g=d.offsetX,h=d.offsetY;c.top=(a.y+h+f.height>e.height?a.y-f.height-h:a.y+h)+"px",c.left=(a.x+f.width+g>e.width?a.x-f.width-g:a.x+g)+"px"},hide:function(a){this.tip.style.display="none",a&&this.config.onHide()}}),i.Classes.NodeStyles=new b({Implements:[f,g],initializePost:function(){this.fx=this.viz.fx,this.types=this.viz.fx.nodeTypes,this.nStyles=this.config,this.nodeStylesOnHover=this.nStyles.stylesHover,this.nodeStylesOnClick=this.nStyles.stylesClick,this.hoveredNode=!1,this.fx.nodeFxAnimation=new d,this.down=!1,this.move=!1},onMouseOut:function(a,b){this.down=this.move=!1;if(!this.hoveredNode)return;this.dom&&this.isLabel(a,b,!0)&&this.toggleStylesOnHover(this.hoveredNode,!1);var c=a.relatedTarget,d=this.canvas.getElement();while(c&&c.parentNode){if(d==c.parentNode)return;c=c.parentNode}this.toggleStylesOnHover(this.hoveredNode,!1),this.hoveredNode=!1},onMouseOver:function(a,b){var c;if(this.dom&&(c=this.isLabel(a,b,!0))){var d=this.viz.graph.getNode(c.id);if(d.selected)return;this.hoveredNode=d,this.toggleStylesOnHover(this.hoveredNode,!0)}},onMouseDown:function(a,b,c,d){if(d)return;var e;this.dom&&(e=this.isLabel(a,b))?this.down=this.viz.graph.getNode(e.id):this.dom||(this.down=c.getNode()),this.move=!1},onMouseUp:function(a,b,c,d){if(d)return;this.move||this.onClick(c.getNode()),this.down=this.move=!1},getRestoredStyles:function(a,b){var c={},d=this["nodeStylesOn"+b];for(var e in d)c[e]=a.styles["$"+e];return c},toggleStylesOnHover:function(a,b){this.nodeStylesOnHover&&this.toggleStylesOn("Hover",a,b)},toggleStylesOnClick:function(a,b){this.nodeStylesOnClick&&this.toggleStylesOn("Click",a,b)},toggleStylesOn:function(b,d,e){var f=this.viz,g=this.nStyles;if(e){var h=this;d.styles||(d.styles=a.merge(d.data,{}));for(var i in this["nodeStylesOn"+b]){var j="$"+i;j in d.styles||(d.styles[j]=d.getData(i))}f.fx.nodeFx(a.extend({elements:{id:d.id,properties:h["nodeStylesOn"+b]},transition:c.Quart.easeOut,duration:300,fps:40},this.config))}else{var k=this.getRestoredStyles(d,b);f.fx.nodeFx(a.extend({elements:{id:d.id,properties:k},transition:c.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(a){if(!a)return;var b=this.nodeStylesOnClick;if(!b)return;a.selected?(this.toggleStylesOnClick(a,!1),delete a.selected):(this.viz.graph.eachNode(function(a){if(a.selected){for(var c in b)a.setData(c,a.styles["$"+c],"end");delete a.selected}}),this.toggleStylesOnClick(a,!0),a.selected=!0,delete a.hovered,this.hoveredNode=!1)},onMouseMove:function(a,b,c){this.down&&(this.move=!0);if(this.dom&&this.isLabel(a,b))return;var d=this.nodeStylesOnHover;if(!d)return;if(!this.dom){if(this.hoveredNode){var e=this.types[this.hoveredNode.getData("type")],f=e&&e.contains&&e.contains.call(this.fx,this.hoveredNode,c.getPos());if(f)return}var g=c.getNode();if(!this.hoveredNode&&!g)return;if(g.hovered)return;g&&!g.selected?(this.fx.nodeFxAnimation.stopTimer(),this.viz.graph.eachNode(function(a){if(a.hovered&&!a.selected){for(var b in d)a.setData(b,a.styles["$"+b],"end");delete a.hovered}}),g.hovered=!0,this.hoveredNode=g,this.toggleStylesOnHover(g,!0)):this.hoveredNode&&!this.hoveredNode.selected&&(this.fx.nodeFxAnimation.stopTimer(),this.toggleStylesOnHover(this.hoveredNode,!1),delete this.hoveredNode.hovered,this.hoveredNode=!1)}}}),i.Classes.Navigation=new b({Implements:[f,g],initializePost:function(){this.pos=!1,this.pressed=!1},onMouseWheel:function(b,c,d){if(!this.config.zooming)return;a.event.stop(a.event.get(b,c));var e=this.config.zooming/1e3,f=1+d*e;this.canvas.scale(f,f)},onMouseDown:function(a,b,c){if(!this.config.panning)return;if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(a,b):c.getNode()))return;this.pressed=!0,this.pos=c.getPos();var d=this.canvas,e=d.translateOffsetX,f=d.translateOffsetY,g=d.scaleOffsetX,h=d.scaleOffsetY;this.pos.x*=g,this.pos.x+=e,this.pos.y*=h,this.pos.y+=f},onMouseMove:function(a,b,c){if(!this.config.panning)return;if(!this.pressed)return;if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(a,b):c.getNode()))return;var d=this.pos,e=c.getPos(),f=this.canvas,g=f.translateOffsetX,h=f.translateOffsetY,i=f.scaleOffsetX,j=f.scaleOffsetY;e.x*=i,e.y*=j,e.x+=g,e.y+=h;var k=e.x-d.x,l=e.y-d.y;this.pos=e,this.canvas.translate(k*1/i,l*1/j)},onMouseUp:function(a,b,c,d){if(!this.config.panning)return;this.pressed=!1}});var j;(function(){function e(b,c){var e=document.createElement(b);for(var f in c)typeof c[f]=="object"?a.extend(e[f],c[f]):e[f]=c[f];return b=="canvas"&&!d&&G_vmlCanvasManager&&(e=G_vmlCanvasManager.initElement(document.body.appendChild(e))),e}var c=typeof HTMLCanvasElement,d=c=="object"||c=="function";$jit.Canvas=j=new b({canvases:[],pos:!1,element:!1,labelContainer:!1,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(b,c){this.viz=b,this.opt=this.config=c;var d=a.type(c.injectInto)=="string"?c.injectInto:c.injectInto.id,f=c.type,g=d+"-label",h=a(d),i=c.width||h.offsetWidth,k=c.height||h.offsetHeight;this.id=d;var l={injectInto:d,width:i,height:k};this.element=e("div",{id:d+"-canvaswidget",style:{position:"relative",width:i+"px",height:k+"px"}}),this.labelContainer=this.createLabelContainer(c.Label.type,g,l),this.canvases.push(new j.Base[f]({config:a.extend({idSuffix:"-canvas"},l),plot:function(a){b.fx.plot()},resize:function(){b.refresh()}}));var m=c.background;if(m){var n=new j.Background[m.type](b,a.extend(m,l));this.canvases.push(new j.Base[f](n))}var o=this.canvases.length;while(o--)this.element.appendChild(this.canvases[o].canvas),o>0&&this.canvases[o].plot();this.element.appendChild(this.labelContainer),h.appendChild(this.element);var p=null,q=this;a.addEvent(window,"scroll",function(){clearTimeout(p),p=setTimeout(function(){q.getPos(!0)},500)})},getCtx:function(a){return this.canvases[a||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(a){return this.canvases[a||0].getSize()},resize:function(a,b){this.getPos(!0),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1;for(var c=0,d=this.canvases.length;c<d;c++)this.canvases[c].resize(a,b);var e=this.element.style;e.width=a+"px",e.height=b+"px",this.labelContainer&&(this.labelContainer.style.width=a+"px")},translate:function(a,b,c){this.translateOffsetX+=a*this.scaleOffsetX,this.translateOffsetY+=b*this.scaleOffsetY;for(var d=0,e=this.canvases.length;d<e;d++)this.canvases[d].translate(a,b,c)},scale:function(a,b,c){var d=this.scaleOffsetX*a,e=this.scaleOffsetY*b,f=this.translateOffsetX*(a-1)/d,g=this.translateOffsetY*(b-1)/e;this.scaleOffsetX=d,this.scaleOffsetY=e;for(var h=0,i=this.canvases.length;h<i;h++)this.canvases[h].scale(a,b,!0);this.translate(f,g,!1)},getPos:function(b){return b||!this.pos?this.pos=a.getPos(this.getElement()):this.pos},clear:function(a){this.canvases[a||0].clear()},path:function(a,b){var c=this.canvases[0].getCtx();c.beginPath(),b(c),c[a](),c.closePath()},createLabelContainer:function(a,b,c){var d="http://www.w3.org/2000/svg";if(a=="HTML"||a=="Native")return e("div",{id:b,style:{overflow:"visible",position:"absolute",top:0,left:0,width:c.width+"px",height:0}});if(a=="SVG"){var f=document.createElementNS(d,"svg:svg");f.setAttribute("width",c.width),f.setAttribute("height",c.height);var g=f.style;g.position="absolute",g.left=g.top="0px";var h=document.createElementNS(d,"svg:g");return h.setAttribute("width",c.width),h.setAttribute("height",c.height),h.setAttribute("x",0),h.setAttribute("y",0),h.setAttribute("id",b),f.appendChild(h),f}}}),j.Base={},j.Base["2D"]=new b({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(a){this.viz=a,this.opt=a.config,this.size=!1,this.createCanvas(),this.translateToCenter()},createCanvas:function(){var a=this.opt,b=a.width,c=a.height;this.canvas=e("canvas",{id:a.injectInto+a.idSuffix,width:b,height:c,style:{position:"absolute",top:0,left:0,width:b+"px",height:c+"px"}})},getCtx:function(){return this.ctx?this.ctx:this.ctx=this.canvas.getContext("2d")},getSize:function(){if(this.size)return this.size;var a=this.canvas;return this.size={width:a.width,height:a.height}},translateToCenter:function(a){var b=this.getSize(),c=a?b.width-a.width-this.translateOffsetX*2:b.width;height=a?b.height-a.height-this.translateOffsetY*2:b.height;var d=this.getCtx();a&&d.scale(1/this.scaleOffsetX,1/this.scaleOffsetY),d.translate(c/2,height/2)},resize:function(a,b){var c=this.getSize(),e=this.canvas,f=e.style;this.size=!1,e.width=a,e.height=b,f.width=a+"px",f.height=b+"px",d?this.translateToCenter():this.translateToCenter(c),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1,this.clear(),this.viz.resize(a,b,this)},translate:function(a,b,c){var d=this.scaleOffsetX,e=this.scaleOffsetY;this.translateOffsetX+=a*d,this.translateOffsetY+=b*e,this.getCtx().translate(a,b),!c&&this.plot()},scale:function(a,b,c){this.scaleOffsetX*=a,this.scaleOffsetY*=b,this.getCtx().scale(a,b),!c&&this.plot()},clear:function(){var a=this.getSize(),b=this.translateOffsetX,c=this.translateOffsetY,d=this.scaleOffsetX,e=this.scaleOffsetY;this.getCtx().clearRect((-a.width/2-b)*1/d,(-a.height/2-c)*1/e,a.width*1/d,a.height*1/e)},plot:function(){this.clear(),this.viz.plot(this)}}),j.Background={},j.Background.Circles=new b({initialize:function(b,c){this.viz=b,this.config=a.merge({idSuffix:"-bkcanvas",levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},c)},resize:function(a,b,c){this.plot(c)},plot:function(a){var b=a.canvas,c=a.getCtx(),d=this.config,e=d.CanvasStyles;for(var f in e)c[f]=e[f];var g=d.numberOfCircles,h=d.levelDistance;for(var i=1;i<=g;i++)c.beginPath(),c.arc(0,0,h*i,0,2*Math.PI,!1),c.stroke(),c.closePath()}})})();var k=function(a,b){this.theta=a||0,this.rho=b||0};$jit.Polar=k,k.prototype={getc:function(a){return this.toComplex(a)},getp:function(){return this},set:function(a){a=a.getp(),this.theta=a.theta,this.rho=a.rho},setc:function(a,b){this.rho=Math.sqrt(a*a+b*b),this.theta=Math.atan2(b,a),this.theta<0&&(this.theta+=Math.PI*2)},setp:function(a,b){this.theta=a,this.rho=b},clone:function(){return new k(this.theta,this.rho)},toComplex:function(a){var b=Math.cos(this.theta)*this.rho,c=Math.sin(this.theta)*this.rho;return a?{x:b,y:c}:new m(b,c)},add:function(a){return new k(this.theta+a.theta,this.rho+a.rho)},scale:function(a){return new k(this.theta,this.rho*a)},equals:function(a){return this.theta==a.theta&&this.rho==a.rho},$add:function(a){return this.theta=this.theta+a.theta,this.rho+=a.rho,this},$madd:function(a){return this.theta=(this.theta+a.theta)%(Math.PI*2),this.rho+=a.rho,this},$scale:function(a){return this.rho*=a,this},isZero:function(){var a=1e-4,b=Math.abs;return b(this.theta)<a&&b(this.rho)<a},interpolate:function(a,b){var c=Math.PI,d=c*2,e=function(a){var b=a<0?a%d+d:a%d;return b},f=this.theta,g=a.theta,h,i=Math.abs(f-g);i==c?f>g?h=e(g+(f-d-g)*b):h=e(g-d+(f-g)*b):i>=c?f>g?h=e(g+(f-d-g)*b):h=e(g-d+(f-(g-d))*b):h=e(g+(f-g)*b);var j=(this.rho-a.rho)*b+a.rho;return{theta:h,rho:j}}};var l=function(a,b){return new k(a,b)};k.KER=l(0,0);var m=function(a,b){this.x=a||0,this.y=b||0};$jit.Complex=m,m.prototype={getc:function(){return this},getp:function(a){return this.toPolar(a)},set:function(a){a=a.getc(!0),this.x=a.x,this.y=a.y},setc:function(a,b){this.x=a,this.y=b},setp:function(a,b){this.x=Math.cos(a)*b,this.y=Math.sin(a)*b},clone:function(){return new m(this.x,this.y)},toPolar:function(a){var b=this.norm(),c=Math.atan2(this.y,this.x);return c<0&&(c+=Math.PI*2),a?{theta:c,rho:b}:new k(c,b)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(a){return new m(this.x+a.x,this.y+a.y)},prod:function(a){return new m(this.x*a.x-this.y*a.y,this.y*a.x+this.x*a.y)},conjugate:function(){return new m(this.x,-this.y)},scale:function(a){return new m(this.x*a,this.y*a)},equals:function(a){return this.x==a.x&&this.y==a.y},$add:function(a){return this.x+=a.x,this.y+=a.y,this},$prod:function(a){var b=this.x,c=this.y;return this.x=b*a.x-c*a.y,this.y=c*a.x+b*a.y,this},$conjugate:function(){return this.y=-this.y,this},$scale:function(a){return this.x*=a,this.y*=a,this},$div:function(a){var b=this.x,c=this.y,d=a.squaredNorm();return this.x=b*a.x+c*a.y,this.y=c*a.x-b*a.y,this.$scale(1/d)},isZero:function(){var a=1e-4,b=Math.abs;return b(this.x)<a&&b(this.y)<a}};var n=function(a,b){return new m(a,b)};m.KER=n(0,0),$jit.Graph=new b({initialize:function(b,c,d,e){var f={klass:m,Node:{}};this.Node=c,this.Edge=d,this.Label=e,this.opt=a.merge(f,b||{}),this.nodes={},this.edges={};var g=this;this.nodeList={};for(var h in p)g.nodeList[h]=function(a){return function(){var b=Array.prototype.slice.call(arguments);g.eachNode(function(c){c[a].apply(c,b)})}}(h)},getNode:function(a){return this.hasNode(a)?this.nodes[a]:!1},get:function(a){return this.getNode(a)},getByName:function(a){for(var b in this.nodes){var c=this.nodes[b];if(c.name==a)return c}return!1},getAdjacence:function(a,b){return a in this.edges?this.edges[a][b]:!1},addNode:function(b){if(!this.nodes[b.id]){var c=this.edges[b.id]={};this.nodes[b.id]=new o.Node(a.extend({id:b.id,name:b.name,data:a.merge(b.data||{},{}),adjacencies:c},this.opt.Node),this.opt.klass,this.Node,this.Edge,this.Label)}return this.nodes[b.id]},addAdjacence:function(a,b,c){this.hasNode(a.id)||this.addNode(a),this.hasNode(b.id)||this.addNode(b),a=this.nodes[a.id],b=this.nodes[b.id];if(!a.adjacentTo(b)){var d=this.edges[a.id]=this.edges[a.id]||{},e=this.edges[b.id]=this.edges[b.id]||{};return d[b.id]=e[a.id]=new o.Adjacence(a,b,c,this.Edge,this.Label),d[b.id]}return this.edges[a.id][b.id]},removeNode:function(a){if(this.hasNode(a)){delete this.nodes[a];var b=this.edges[a];for(var c in b)delete this.edges[c][a];delete this.edges[a]}},removeAdjacence:function(a,b){delete this.edges[a][b],delete this.edges[b][a]},hasNode:function(a){return a in this.nodes},empty:function(){this.nodes={},this.edges={}}});var o=$jit.Graph,p;(function(){var b=function(a,b,c,d,e){var f;c=c||"current",a="$"+(a?a+"-":""),c=="current"?f=this.data:c=="start"?f=this.startData:c=="end"&&(f=this.endData);var g=a+b;return d?f[g]:this.Config.overridable?g in f?f[g]:g in this.data?this.data[g]:e[b]||0:e[b]||0},c=function(a,b,c,d){d=d||"current",a="$"+(a?a+"-":"");var e;d=="current"?e=this.data:d=="start"?e=this.startData:d=="end"&&(e=this.endData),e[a+b]=c},d=function(b,c){b="$"+(b?b+"-":"");var d=this;a.each(c,function(a){var c=b+a;delete d.data[c],delete d.endData[c],delete d.startData[c]})};p={getData:function(a,c,d){return b.call(this,"",a,c,d,this.Config)},setData:function(a,b,d){c.call(this,"",a,b,d)},setDataset:function(b,c){b=a.splat(b);for(var d in c)for(var e=0,f=a.splat(c[d]),g=b.length;e<g;e++)this.setData(d,f[e],b[e])},removeData:function(){d.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(a,c,d){return b.call(this,"canvas",a,c,d,this.Config.CanvasStyles)},setCanvasStyle:function(a,b,d){c.call(this,"canvas",a,b,d)},setCanvasStyles:function(b,c){b=a.splat(b);for(var d in c)for(var e=0,f=a.splat(c[d]),g=b.length;e<g;e++)this.setCanvasStyle(d,f[e],b[e])},removeCanvasStyle:function(){d.call(this,"canvas",Array.prototype.slice.call(arguments))},getLabelData:function(a,c,d){return b.call(this,"label",a,c,d,this.Label)},setLabelData:function(a,b,d){c.call(this,"label",a,b,d)},setLabelDataset:function(b,c){b=a.splat(b);for(var d in c)for(var e=0,f=a.splat(c[d]),g=b.length;e<g;e++)this.setLabelData(d,f[e],b[e])},removeLabelData:function(){d.call(this,"label",Array.prototype.slice.call(arguments))}}})(),o.Node=new b({initialize:function(b,c,d,e,f){var g={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:!1,drawn:!1,exist:!1,angleSpan:{begin:0,end:0},pos:new c,startPos:new c,endPos:new c};a.extend(this,a.extend(g,b)),this.Config=this.Node=d,this.Edge=e,this.Label=f},adjacentTo:function(a){return a.id in this.adjacencies},getAdjacency:function(a){return this.adjacencies[a]},getPos:function(a){a=a||"current";if(a=="current")return this.pos;if(a=="end")return this.endPos;if(a=="start")return this.startPos},setPos:function(a,b){b=b||"current";var c;b=="current"?c=this.pos:b=="end"?c=this.endPos:b=="start"&&(c=this.startPos),c.set(a)}}),o.Node.implement(p),o.Adjacence=new b({initialize:function(a,b,c,d,e){this.nodeFrom=a,this.nodeTo=b,this.data=c||{},this.startData={},this.endData={},this.Config=this.Edge=d,this.Label=e}}),o.Adjacence.implement(p),o.Util={filter:function(b){if(!b||a.type(b)!="string")return function(){return!0};var c=b.split(" ");return function(a){for(var b=0;b<c.length;b++)if(a[c[b]])return!1;return!0}},getNode:function(a,b){return a.nodes[b]},eachNode:function(a,b,c){var d=this.filter(c);for(var e in a.nodes)d(a.nodes[e])&&b(a.nodes[e])},each:function(a,b,c){this.eachNode(a,b,c)},eachAdjacency:function(a,b,c){var d=a.adjacencies,e=this.filter(c);for(var f in d){var g=d[f];if(e(g)){if(g.nodeFrom!=a){var h=g.nodeFrom;g.nodeFrom=g.nodeTo,g.nodeTo=h}b(g,f)}}},computeLevels:function(a,b,c,d){c=c||0;var e=this.filter(d);this.eachNode(a,function(a){a._flag=!1,a._depth=-1},d);var f=a.getNode(b);f._depth=c;var g=[f];while(g.length!=0){var h=g.pop();h._flag=!0,this.eachAdjacency(h,function(a){var b=a.nodeTo;b._flag==0&&e(b)&&(b._depth<0&&(b._depth=h._depth+1+c),g.unshift(b))},d)}},eachBFS:function(a,b,c,d){var e=this.filter(d);this.clean(a);var f=[a.getNode(b)];while(f.length!=0){var g=f.pop();g._flag=!0,c(g,g._depth),this.eachAdjacency(g,function(a){var b=a.nodeTo;b._flag==0&&e(b)&&(b._flag=!0,f.unshift(b))},d)}},eachLevel:function(a,b,c,d,e){var f=a._depth,g=this.filter(e),h=this;c=c===!1?Number.MAX_VALUE-f:c,function i(a,b,c){var e=a._depth;e>=b&&e<=c&&g(a)&&d(a,e),e<c&&h.eachAdjacency(a,function(a){var d=a.nodeTo;d._depth>e&&i(d,b,c)})}(a,b+f,c+f)},eachSubgraph:function(a,b,c){this.eachLevel(a,0,!1,b,c)},eachSubnode:function(a,b,c){this.eachLevel(a,1,1,b,c)},anySubnode:function(b,c,d){var e=!1;c=c||a.lambda(!0);var f=a.type(c)=="string"?function(a){return a[c]}:c;return this.eachSubnode(b,function(a){f(a)&&(e=!0)},d),e},getSubnodes:function(b,c,d){var e=[],f=this;c=c||0;var g,h;return a.type(c)=="array"?(g=c[0],h=c[1]):(g=c,h=Number.MAX_VALUE-b._depth),this.eachLevel(b,g,h,function(a){e.push(a)},d),e},getParents:function(a){var b=[];return this.eachAdjacency(a,function(c){var d=c.nodeTo;d._depth<a._depth&&b.push(d)}),b},isDescendantOf:function(a,b){if(a.id==b)return!0;var c=this.getParents(a),d=!1;for(var e=0;!d&&e<c.length;e++)d=d||this.isDescendantOf(c[e],b);return d},clean:function(a){this.eachNode(a,function(a){a._flag=!1})},getClosestNodeToOrigin:function(a,b,c){return this.getClosestNodeToPos(a,k.KER,b,c)},getClosestNodeToPos:function(a,b,c,d){var e=null;c=c||"current",b=b&&b.getc(!0)||m.KER;var f=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};return this.eachNode(a,function(a){e=e==null||f(a.getPos(c).getc(!0),b)<f(e.getPos(c).getc(!0),b)?a:e},d),e}},a.each(["get","getNode","each","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(a){o.prototype[a]=function(){return o.Util[a].apply(o.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),a.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(a){o.Node.prototype[a]=function(){return o.Util[a].apply(o.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),o.Op={options:{type:"nothing",duration:2e3,hideLabels:!0,fps:30},initialize:function(a){this.viz=a},removeNode:function(b,c){var d=this.viz,e=a.merge(this.options,d.controller,c),f=a.splat(b),g,h,i;switch(e.type){case"nothing":for(g=0;g<f.length;g++)d.graph.removeNode(f[g]);break;case"replot":this.removeNode(f,{type:"nothing"}),d.labels.clearLabels(),d.refresh(!0);break;case"fade:seq":case"fade":h=this;for(g=0;g<f.length;g++)i=d.graph.getNode(f[g]),i.setData("alpha",0,"end");d.fx.animate(a.merge(e,{modes:["node-property:alpha"],onComplete:function(){h.removeNode(f,{type:"nothing"}),d.labels.clearLabels(),d.reposition(),d.fx.animate(a.merge(e,{modes:["linear"]}))}}));break;case"fade:con":h=this;for(g=0;g<f.length;g++)i=d.graph.getNode(f[g]),i.setData("alpha",0,"end"),i.ignore=!0;d.reposition(),d.fx.animate(a.merge(e,{modes:["node-property:alpha","linear"],onComplete:function(){h.removeNode(f,{type:"nothing"}),e.onComplete&&e.onComplete()}}));break;case"iter":h=this,d.fx.sequence({condition:function(){return f.length!=0},step:function(){h.removeNode(f.shift(),{type:"nothing"}),d.labels.clearLabels()},onComplete:function(){e.onComplete&&e.onComplete()},duration:Math.ceil(e.duration/f.length)});break;default:this.doError()}},removeEdge:function(b,c){var d=this.viz,e=a.merge(this.options,d.controller,c),f=a.type(b[0])=="string"?[b]:b,g,h,i;switch(e.type){case"nothing":for(g=0;g<f.length;g++)d.graph.removeAdjacence(f[g][0],f[g][1]);break;case"replot":this.removeEdge(f,{type:"nothing"}),d.refresh(!0);break;case"fade:seq":case"fade":h=this;for(g=0;g<f.length;g++)i=d.graph.getAdjacence(f[g][0],f[g][1]),i&&i.setData("alpha",0,"end");d.fx.animate(a.merge(e,{modes:["edge-property:alpha"],onComplete:function(){h.removeEdge(f,{type:"nothing"}),d.reposition(),d.fx.animate(a.merge(e,{modes:["linear"]}))}}));break;case"fade:con":h=this;for(g=0;g<f.length;g++)i=d.graph.getAdjacence(f[g][0],f[g][1]),i&&(i.setData("alpha",0,"end"),i.ignore=!0);d.reposition(),d.fx.animate(a.merge(e,{modes:["edge-property:alpha","linear"],onComplete:function(){h.removeEdge(f,{type:"nothing"}),e.onComplete&&e.onComplete()}}));break;case"iter":h=this,d.fx.sequence({condition:function(){return f.length!=0},step:function(){h.removeEdge(f.shift(),{type:"nothing"}),d.labels.clearLabels()},onComplete:function(){e.onComplete()},duration:Math.ceil(e.duration/f.length)});break;default:this.doError()}},sum:function(b,c){var d=this.viz,e=a.merge(this.options,d.controller,c),f=d.root,g;d.root=c.id||d.root;switch(e.type){case"nothing":g=d.construct(b),g.eachNode(function(a){a.eachAdjacency(function(a){d.graph.addAdjacence(a.nodeFrom,a.nodeTo,a.data)})});break;case"replot":d.refresh(!0),this.sum(b,{type:"nothing"}),d.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,g=d.construct(b);var h=this.preprocessSum(g),i=h?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"];d.reposition(),e.type!="fade:con"?d.fx.animate(a.merge(e,{modes:["linear"],onComplete:function(){d.fx.animate(a.merge(e,{modes:i,onComplete:function(){e.onComplete()}}))}})):(d.graph.eachNode(function(a){a.id!=f&&a.pos.isZero()&&(a.pos.set(a.endPos),a.startPos.set(a.endPos))}),d.fx.animate(a.merge(e,{modes:["linear"].concat(i)})));break;default:this.doError()}},morph:function(b,c,d){d=d||{};var e=this.viz,f=a.merge(this.options,e.controller,c),g=e.root,h;e.root=c.id||e.root;switch(f.type){case"nothing":h=e.construct(b),h.eachNode(function(a){var b=e.graph.hasNode(a.id);a.eachAdjacency(function(a){var b=!!e.graph.getAdjacence(a.nodeFrom.id,a.nodeTo.id);e.graph.addAdjacence(a.nodeFrom,a.nodeTo,a.data);if(b){var c=e.graph.getAdjacence(a.nodeFrom.id,a.nodeTo.id);for(var d in a.data||{})c.data[d]=a.data[d]}});if(b){var c=e.graph.getNode(a.id);for(var d in a.data||{})c.data[d]=a.data[d]}}),e.graph.eachNode(function(a){a.eachAdjacency(function(a){h.getAdjacence(a.nodeFrom.id,a.nodeTo.id)||e.graph.removeAdjacence(a.nodeFrom.id,a.nodeTo.id)}),h.hasNode(a.id)||e.graph.removeNode(a.id)});break;case"replot":e.labels.clearLabels(!0),this.morph(b,{type:"nothing"}),e.refresh(!0),e.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,h=e.construct(b);var i="node-property"in d&&a.map(a.splat(d["node-property"]),function(a){return"$"+a});e.graph.eachNode(function(b){var c=h.getNode(b.id);if(!c)b.setData("alpha",1),b.setData("alpha",1,"start"),b.setData("alpha",0,"end"),b.ignore=!0;else{var d=c.data;for(var e in d)i&&a.indexOf(i,e)>-1?b.endData[e]=d[e]:b.data[e]=d[e]}}),e.graph.eachNode(function(a){if(a.ignore)return;a.eachAdjacency(function(a){if(a.nodeFrom.ignore||a.nodeTo.ignore)return;var b=h.getNode(a.nodeFrom.id),c=h.getNode(a.nodeTo.id);if(!b.adjacentTo(c)){var a=e.graph.getAdjacence(b.id,c.id);j=!0,a.setData("alpha",1),a.setData("alpha",1,"start"),a.setData("alpha",0,"end")}})});var j=this.preprocessSum(h),l=j?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"];l[0]=l[0]+("node-property"in d?":"+a.splat(d["node-property"]).join(":"):""),l[1]=(l[1]||"edge-property:alpha")+("edge-property"in d?":"+a.splat(d["edge-property"]).join(":"):""),"label-property"in d&&l.push("label-property:"+a.splat(d["label-property"]).join(":")),e.reposition?e.reposition():e.compute("end"),e.graph.eachNode(function(a){a.id!=g&&a.pos.getp().equals(k.KER)&&(a.pos.set(a.endPos),a.startPos.set(a.endPos))}),e.fx.animate(a.merge(f,{modes:[d.position||"polar"].concat(l),onComplete:function(){e.graph.eachNode(function(a){a.ignore&&e.graph.removeNode(a.id)}),e.graph.eachNode(function(a){a.eachAdjacency(function(a){a.ignore&&e.graph.removeAdjacence(a.nodeFrom.id,a.nodeTo.id)})}),f.onComplete()}}));break;default:}},contract:function(b,c){var d=this.viz;if(b.collapsed||!b.anySubnode(a.lambda(!0)))return;c=a.merge(this.options,d.config,c||{},{modes:["node-property:alpha:span","linear"]}),b.collapsed=!0,function e(a){a.eachSubnode(function(a){a.ignore=!0,a.setData("alpha",0,c.type=="animate"?"end":"current"),e(a)})}(b),c.type=="animate"?(d.compute("end"),d.rotated&&d.rotate(d.rotated,"none",{property:"end"}),function f(a){a.eachSubnode(function(a){a.setPos(b.getPos("end"),"end"),f(a)})}(b),d.fx.animate(c)):c.type=="replot"&&d.refresh()},expand:function(b,c){if(!("collapsed"in b))return;var d=this.viz;c=a.merge(this.options,d.config,c||{},{modes:["node-property:alpha:span","linear"]}),delete b.collapsed,function e(a){a.eachSubnode(function(a){delete a.ignore,a.setData("alpha",1,c.type=="animate"?"end":"current"),e(a)})}(b),c.type=="animate"?(d.compute("end"),d.rotated&&d.rotate(d.rotated,"none",{property:"end"}),d.fx.animate(c)):c.type=="replot"&&d.refresh()},preprocessSum:function(a){var b=this.viz;a.eachNode(function(a){if(!b.graph.hasNode(a.id)){b.graph.addNode(a);var c=b.graph.getNode(a.id);c.setData("alpha",0),c.setData("alpha",0,"start"),c.setData("alpha",1,"end")}});var c=!1;return a.eachNode(function(a){a.eachAdjacency(function(a){var d=b.graph.getNode(a.nodeFrom.id),e=b.graph.getNode(a.nodeTo.id);if(!d.adjacentTo(e)){var a=b.graph.addAdjacence(d,e,a.data);d.startAlpha==d.endAlpha&&e.startAlpha==e.endAlpha&&(c=!0,a.setData("alpha",0),a.setData("alpha",0,"start"),a.setData("alpha",1,"end"))}})}),c}};var q={none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,b,c,d){var e=d.getCtx();e.beginPath(),e.arc(b.x,b.y,c,0,Math.PI*2,!0),e.closePath(),e[a]()},contains:function(a,b,c){var d=a.x-b.x,e=a.y-b.y,f=d*d+e*e;return f<=c*c}},ellipse:{render:function(a,b,c,d,e){var f=e.getCtx(),g=1,h=1,i=1,j=1,k=0;c>d?(k=c/2,h=d/c,j=c/d):(k=d/2,g=c/d,i=d/c),f.save(),f.scale(g,h),f.beginPath(),f.arc(b.x*i,b.y*j,k,0,Math.PI*2,!0),f.closePath(),f[a](),f.restore()},contains:function(a,b,c,d){var e=0,f=1,g=1,h=0,i=0,j=0;return c>d?(e=c/2,g=d/c):(e=d/2,f=c/d),h=(a.x-b.x)*(1/f),i=(a.y-b.y)*(1/g),j=h*h+i*i,j<=e*e}},square:{render:function(a,b,c,d){d.getCtx()[a+"Rect"](b.x-c,b.y-c,2*c,2*c)},contains:function(a,b,c){return Math.abs(b.x-a.x)<=c&&Math.abs(b.y-a.y)<=c}},rectangle:{render:function(a,b,c,d,e){e.getCtx()[a+"Rect"](b.x-c/2,b.y-d/2,c,d)},contains:function(a,b,c,d){return Math.abs(b.x-a.x)<=c/2&&Math.abs(b.y-a.y)<=d/2}},triangle:{render:function(a,b,c,d){var e=d.getCtx(),f=b.x,g=b.y-c,h=f-c,i=b.y+c,j=f+c,k=i;e.beginPath(),e.moveTo(f,g),e.lineTo(h,i),e.lineTo(j,k),e.closePath(),e[a]()},contains:function(a,b,c){return q.circle.contains(a,b,c)}},star:{render:function(a,b,c,d){var e=d.getCtx(),f=Math.PI/5;e.save(),e.translate(b.x,b.y),e.beginPath(),e.moveTo(c,0);for(var g=0;g<9;g++)e.rotate(f),g%2==0?e.lineTo(c/.525731*.200811,0):e.lineTo(c,0);e.closePath(),e[a](),e.restore()},contains:function(a,b,c){return q.circle.contains(a,b,c)}}},r={line:{render:function(a,b,c){var d=c.getCtx();d.beginPath(),d.moveTo(a.x,a.y),d.lineTo(b.x,b.y),d.stroke()},contains:function(a,b,c,d){var e=Math.min,f=Math.max,g=e(a.x,b.x),h=f(a.x,b.x),i=e(a.y,b.y),j=f(a.y,b.y);if(c.x>=g&&c.x<=h&&c.y>=i&&c.y<=j){if(Math.abs(b.x-a.x)<=d)return!0;var k=(b.y-a.y)/(b.x-a.x)*(c.x-a.x)+a.y;return Math.abs(k-c.y)<=d}return!1}},arrow:{render:function(a,b,c,d,e){var f=e.getCtx();if(d){var g=a;a=b,b=g}var h=new m(b.x-a.x,b.y-a.y);h.$scale(c/h.norm());var i=new m(b.x-h.x,b.y-h.y),j=new m(-h.y/2,h.x/2),k=i.add(j),l=i.$add(j.$scale(-1));f.beginPath(),f.moveTo(a.x,a.y),f.lineTo(b.x,b.y),f.stroke(),f.beginPath(),f.moveTo(k.x,k.y),f.lineTo(l.x,l.y),f.lineTo(b.x,b.y),f.closePath(),f.fill()},contains:function(a,b,c,d){return r.line.contains(a,b,c,d)}},hyperline:{render:function(a,b,c,d){function j(a,b){var c=a.x*b.y-a.y*b.x,d=c,e=a.squaredNorm(),f=b.squaredNorm();if(c==0)return{x:0,y:0,ratio:-1};var g=(a.y*f-b.y*e+a.y-b.y)/c,h=(b.x*e-a.x*f+b.x-a.x)/d,i=-g/2,j=-h/2,k=(g*g+h*h)/4-1;if(k<0)return{x:0,y:0,ratio:-1};var l=Math.sqrt(k),m={x:i,y:j,ratio:l>1e3?-1:l,a:g,b:h};return m}function i(a,b){return a<b?a+Math.PI>b?!1:!0:b+Math.PI>a?!0:!1}var e=d.getCtx(),f=j(a,b);if(f.a>1e3||f.b>1e3||f.ratio<0)e.beginPath(),e.moveTo(a.x*c,a.y*c),e.lineTo(b.x*c,b.y*c),e.stroke();else{var g=Math.atan2(b.y-f.y,b.x-f.x),h=Math.atan2(a.y-f.y,a.x-f.x),i=i(g,h);e.beginPath(),e.arc(f.x*c,f.y*c,f.ratio*c,g,h,i),e.stroke()}},contains:a.lambda(!1)}};o.Plot={initialize:function(a,b){this.viz=a,this.config=a.config,this.node=a.config.Node,this.edge=a.config.Edge,this.animation=new d,this.nodeTypes=new b.Plot.NodeTypes,this.edgeTypes=new b.Plot.EdgeTypes,this.labels=a.labels},nodeHelper:q,edgeHelper:r,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(a,b,c){return a+(b-a)*c},moebius:function(a,b,c,d){var e=d.scale(-c);if(e.norm()<1){var f=e.x,g=e.y,h=a.startPos.getc().moebiusTransformation(e);a.pos.setc(h.x,h.y),e.x=f,e.y=g}},linear:function(a,b,c){var d=a.startPos.getc(!0),e=a.endPos.getc(!0);a.pos.setc(this.compute(d.x,e.x,c),this.compute(d.y,e.y,c))},polar:function(a,b,c){var d=a.startPos.getp(!0),e=a.endPos.getp(),f=e.interpolate(d,c);a.pos.setp(f.theta,f.rho)},number:function(a,b,c,d,e){var f=a[d](b,"start"),g=a[d](b,"end");a[e](b,this.compute(f,g,c))},color:function(b,c,d,e,f){var g=a.hexToRgb(b[e](c,"start")),h=a.hexToRgb(b[e](c,"end")),i=this.compute,j=a.rgbToHex([parseInt(i(g[0],h[0],d)),parseInt(i(g[1],h[1],d)),parseInt(i(g[2],h[2],d))]);b[f](c,j)},"array-number":function(a,b,c,d,e){var f=a[d](b,"start"),g=a[d](b,"end"),h=[];for(var i=0,j=f.length;i<j;i++){var k=f[i],l=g[i];if(k.length){for(var m=0,n=k.length,o=[];m<n;m++)o.push(this.compute(k[m],l[m],c));h.push(o)}else h.push(this.compute(k,l,c))}a[e](b,h)},node:function(a,b,c,d,e,f){d=this[d];if(b){var g=b.length;for(var h=0;h<g;h++){var i=b[h];this[d[i]](a,i,c,e,f)}}else for(var i in d)this[d[i]](a,i,c,e,f)},edge:function(a,b,c,d,e,f){var g=a.adjacencies;for(var h in g)this.node(g[h],b,c,d,e,f)},"node-property":function(a,b,c){this.node(a,b,c,"map","getData","setData")},"edge-property":function(a,b,c){this.edge(a,b,c,"map","getData","setData")},"label-property":function(a,b,c){this.node(a,b,c,"label","getLabelData","setLabelData")},"node-style":function(a,b,c){this.node(a,b,c,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(a,b,c){this.edge(a,b,c,"canvas","getCanvasStyle","setCanvasStyle")}},sequence:function(b){var c=this;b=a.merge({condition:a.lambda(!1),step:a.empty,onComplete:a.empty,duration:200},b||{});var d=setInterval(function(){b.condition()?b.step():(clearInterval(d),b.onComplete()),c.viz.refresh(!0)},b.duration)},prepare:function(b){var c=this.viz.graph,d={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}},e={};if(a.type(b)=="array")for(var f=0,g=b.length;f<g;f++){var h=b[f].split(":");e[h.shift()]=h}else for(var i in b)i=="position"?e[b.position]=[]:e[i]=a.splat(b[i]);return c.eachNode(function(b){b.startPos.set(b.pos),a.each(["node-property","node-style"],function(a){if(a in e){var c=e[a];for(var f=0,g=c.length;f<g;f++)b[d[a].setter](c[f],b[d[a].getter](c[f]),"start")}}),a.each(["edge-property","edge-style"],function(a){if(a in e){var c=e[a];b.eachAdjacency(function(b){for(var e=0,f=c.length;e<f;e++)b[d[a].setter](c[e],b[d[a].getter](c[e]),"start")})}})}),e},animate:function(b,c){b=a.merge(this.viz.config,b||{});var d=this,e=this.viz,f=e.graph,g=this.Interpolator,h=b.type==="nodefx"?this.nodeFxAnimation:this.animation,i=this.prepare(b.modes);b.hideLabels&&this.labels.hideLabels(!0),h.setOptions(a.extend(b,{$animating:!1,compute:function(a){f.eachNode(function(b){for(var d in i)g[d](b,i[d],a,c)}),d.plot(b,this.$animating,a),this.$animating=!0},complete:function(){b.hideLabels&&d.labels.hideLabels(!1),d.plot(b),b.onComplete()}})).start()},nodeFx:function(b){var c=this.viz,d=c.graph,e=this.nodeFxAnimation,f=a.merge(this.viz.config,{elements:{id:!1,properties:{}},reposition:!1});b=a.merge(f,b||{},{onBeforeCompute:a.empty,onAfterCompute:a.empty}),e.stopTimer();var g=b.elements.properties;if(!b.elements.id)d.eachNode(function(a){for(var b in g)a.setData(b,g[b],"end")});else{var h=a.splat(b.elements.id);a.each(h,function(a){var b=d.getNode(a);if(b)for(var c in g)b.setData(c,g[c],"end")})}var i=[];for(var j in g)i.push(j);var k=["node-property:"+i.join(":")];b.reposition&&(k.push("linear"),c.compute("end")),this.animate(a.merge(b,{modes:k,type:"nodefx"}))},plot:function(a,b){var c=this.viz,d=c.graph,e=c.canvas,f=c.root,g=this,h=e.getCtx(),i=Math.min,a=a||this.viz.controller;a.clearCanvas&&e.clear();var j=d.getNode(f);if(!j)return;var k=!!j.visited;d.eachNode(function(c){var d=c.getData("alpha");c.eachAdjacency(function(d){var f=d.nodeTo;!!f.visited===k&&c.drawn&&f.drawn&&(!b&&a.onBeforePlotLine(d),g.plotLine(d,e,b),!b&&a.onAfterPlotLine(d))}),c.drawn&&(!b&&a.onBeforePlotNode(c),g.plotNode(c,e,b),!b&&a.onAfterPlotNode(c)),!g.labelsHidden&&a.withLabels&&(c.drawn&&d>=.95?g.labels.plotLabel(e,c,a):g.labels.hideLabel(c,!1)),c.visited=!k})},plotTree:function(a,b,c){var d=this,e=this.viz,f=e.canvas,g=this.config,h=f.getCtx(),i=a.getData("alpha");a.eachSubnode(function(e){if(b.plotSubtree(a,e)&&e.exist&&e.drawn){var g=a.getAdjacency(e.id);!c&&b.onBeforePlotLine(g),d.plotLine(g,f,c),!c&&b.onAfterPlotLine(g),d.plotTree(e,b,c)}}),a.drawn?(!c&&b.onBeforePlotNode(a),this.plotNode(a,f,c),!c&&b.onAfterPlotNode(a),!b.hideLabels&&b.withLabels&&i>=.95?this.labels.plotLabel(f,a,b):this.labels.hideLabel(a,!1)):this.labels.hideLabel(a,!0)},plotNode:function(a,b,c){var d=a.getData("type"),e=this.node.CanvasStyles;if(d!="none"){var f=a.getData("lineWidth"),g=a.getData("color"),h=a.getData("alpha"),i=b.getCtx();i.save(),i.lineWidth=f,i.fillStyle=i.strokeStyle=g,i.globalAlpha=h;for(var j in e)i[j]=a.getCanvasStyle(j);this.nodeTypes[d].render.call(this,a,b,c),i.restore()}},plotLine:function(a,b,c){var d=a.getData("type"),e=this.edge.CanvasStyles;if(d!="none"){var f=a.getData("lineWidth"),g=a.getData("color"),h=b.getCtx(),i=a.nodeFrom,j=a.nodeTo;h.save(),h.lineWidth=f,h.fillStyle=h.strokeStyle=g,h.globalAlpha=Math.min(i.getData("alpha"),j.getData("alpha"),a.getData("alpha"));for(var k in e)h[k]=a.getCanvasStyle(k);this.edgeTypes[d].render.call(this,a,b,c),h.restore()}}},o.Plot3D=a.merge(o.Plot,{Interpolator:{linear:function(a,b,c){var d=a.startPos.getc(!0),e=a.endPos.getc(!0);a.pos.setc(this.compute(d.x,e.x,c),this.compute(d.y,e.y,c),this.compute(d.z,e.z,c))}},plotNode:function(a,b){if(a.getData("type")=="none")return;this.plotElement(a,b,{getAlpha:function(){return a.getData("alpha")}})},plotLine:function(a,b){if(a.getData("type")=="none")return;this.plotElement(a,b,{getAlpha:function(){return Math.min(a.nodeFrom.getData("alpha"),a.nodeTo.getData("alpha"),a.getData("alpha"))}})},plotElement:function(b,c,d){var e=c.getCtx(),f=new Matrix4,g=c.config.Scene.Lighting,h=c.canvases[0],i=h.program,j=h.camera;b.geometry||(b.geometry=new(O3D[b.getData("type")])),b.geometry.update(b);if(!b.webGLVertexBuffer){var k=[],l=[],m=[],n=0,o=b.geometry;for(var p=0,q=o.vertices,r=o.faces,s=r.length;p<s;p++){var t=r[p],u=q[t.a],v=q[t.b],w=q[t.c],x=t.d?q[t.d]:!1,y=t.normal;k.push(u.x,u.y,u.z),k.push(v.x,v.y,v.z),k.push(w.x,w.y,w.z),x&&k.push(x.x,x.y,x.z),m.push(y.x,y.y,y.z),m.push(y.x,y.y,y.z),m.push(y.x,y.y,y.z),x&&m.push(y.x,y.y,y.z),l.push(n,n+1,n+2),x?(l.push(n,n+2,n+3),n+=4):n+=3}b.webGLVertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,b.webGLVertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(k),e.STATIC_DRAW),b.webGLFaceBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,b.webGLFaceBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(l),e.STATIC_DRAW),b.webGLFaceCount=l.length,b.webGLNormalBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,b.webGLNormalBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(m),e.STATIC_DRAW)}f.multiply(j.matrix,b.geometry.matrix),e.uniformMatrix4fv(i.viewMatrix,!1,f.flatten()),e.uniformMatrix4fv(i.projectionMatrix,!1,j.projectionMatrix.flatten());var z=Matrix4.makeInvert(f);z.$transpose(),e.uniformMatrix4fv(i.normalMatrix,!1,z.flatten());var A=a.hexToRgb(b.getData("color"));A.push(d.getAlpha()),e.uniform4f(i.color,A[0]/255,A[1]/255,A[2]/255,A[3]),e.uniform1i(i.enableLighting,g.enable);if(g.enable){if(g.ambient){var B=g.ambient;e.uniform3f(i.ambientColor,B[0],B[1],B[2])}if(g.directional){var C=g.directional,A=C.color,D=C.direction,E=(new Vector3(D.x,D.y,D.z)).normalize().$scale(-1);e.uniform3f(i.lightingDirection,E.x,E.y,E.z),e.uniform3f(i.directionalColor,A[0],A[1],A[2])}}e.bindBuffer(e.ARRAY_BUFFER,b.webGLVertexBuffer),e.vertexAttribPointer(i.position,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,b.webGLNormalBuffer),e.vertexAttribPointer(i.normal,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,b.webGLFaceBuffer),e.drawElements(e.TRIANGLES,b.webGLFaceCount,e.UNSIGNED_SHORT,0)}}),o.Label={},o.Label.Native=new b({initialize:function(a){this.viz=a},plotLabel:function(a,b,c){var d=a.getCtx(),e=b.pos.getc(!0);d.font=b.getLabelData("style")+" "+b.getLabelData("size")+"px "+b.getLabelData("family"),d.textAlign=b.getLabelData("textAlign"),d.fillStyle=d.strokeStyle=b.getLabelData("color"),d.textBaseline=b.getLabelData("textBaseline"),this.renderLabel(a,b,c)},renderLabel:function(a,b,c){var d=a.getCtx(),e=b.pos.getc(!0);d.fillText(b.name,e.x,e.y+b.getData("height")/2)},hideLabel:a.empty,hideLabels:a.empty}),o.Label.DOM=new b({labelsHidden:!1,labelContainer:!1,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(a){return a in this.labels&&this.labels[a]!=null?this.labels[a]:this.labels[a]=document.getElementById(a)},hideLabels:function(a){var b=this.getLabelContainer();a?b.style.display="none":b.style.display="",this.labelsHidden=a},clearLabels:function(a){for(var b in this.labels)if(a||!this.viz.graph.hasNode(b))this.disposeLabel(b),delete this.labels[b]},disposeLabel:function(a){var b=this.getLabel(a);b&&b.parentNode&&b.parentNode.removeChild(b)},hideLabel:function(b,c){b=a.splat(b);var d=c?"":"none",e,f=this;a.each(b,function(a){var b=f.getLabel(a.id);b&&(b.style.display=d)})},fitsInCanvas:function(a,b){var c=b.getSize();return a.x>=c.width||a.x<0||a.y>=c.height||a.y<0?!1:!0}}),o.Label.HTML=new b({Implements:o.Label.DOM,plotLabel:function(a,b,c){var d=b.id,e=this.getLabel(d);if(!e&&!(e=document.getElementById(d))){e=document.createElement("div");var f=this.getLabelContainer();e.id=d,e.className="node",e.style.position="absolute",c.onCreateLabel(e,b),f.appendChild(e),this.labels[b.id]=e}this.placeLabel(e,b,c)}}),o.Label.SVG=new b({Implements:o.Label.DOM,plotLabel:function(a,b,c){var d=b.id,e=this.getLabel(d);if(!e&&!(e=document.getElementById(d))){var f="http://www.w3.org/2000/svg";e=document.createElementNS(f,"svg:text");var g=document.createElementNS(f,"svg:tspan");e.appendChild(g);var h=this.getLabelContainer();e.setAttribute("id",d),e.setAttribute("class","node"),h.appendChild(e),c.onCreateLabel(e,b),this.labels[b.id]=e}this.placeLabel(e,b,c)}});var s={construct:function(b){var c=a.type(b)=="array",d=new o(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);return c?function(b,c){var d=function(a){for(var d=0,e=c.length;d<e;d++)if(c[d].id==a)return c[d];var f={id:a,name:a};return b.addNode(f)};for(var e=0,f=c.length;e<f;e++){b.addNode(c[e]);var g=c[e].adjacencies;if(g)for(var h=0,i=g.length;h<i;h++){var j=g[h],k={};typeof g[h]!="string"&&(k=a.merge(j.data,{}),j=j.nodeTo),b.addAdjacence(c[e],d(j),k)}}}(d,b):function(a,b){a.addNode(b);if(b.children)for(var c=0,d=b.children;c<d.length;c++)a.addAdjacence(b,d[c]),arguments.callee(a,d[c])}(d,b),d},loadJSON:function(b,c){this.json=b,this.labels&&this.labels.clearLabels&&this.labels.clearLabels(!0),this.graph=this.construct(b),a.type(b)!="array"?this.root=b.id:this.root=b[c?c:0].id},toJSON:function(a){a=a||"tree";if(a=="tree"){var b={},c=this.graph.getNode(this.root),b=function e(a){var b={};b.id=a.id,b.name=a.name,b.data=a.data;var c=[];return a.eachSubnode(function(a){c.push(e(a))}),b.children=c,b}(c);return b}var b=[],d=!!this.graph.getNode(this.root).visited;return this.graph.eachNode(function(a){var c={};c.id=a.id,c.name=a.name,c.data=a.data;var e=[];a.eachAdjacency(function(a){var b=a.nodeTo;if(!!b.visited===d){var c={};c.nodeTo=b.id,c.data=a.data,e.push(c)}}),c.adjacencies=e,b.push(c),a.visited=!d}),b}},t=$jit.Layouts={},u={label:null,compute:function(b,c,d){this.initializeLabel(d);var e=this.label,f=e.style;b.eachNode(function(b){var c=b.getData("autoWidth"),d=b.getData("autoHeight");if(c||d){delete b.data.$width,delete b.data.$height,delete b.data.$dim;var g=b.getData("width"),h=b.getData("height");f.width=c?"auto":g+"px",f.height=d?"auto":h+"px",e.innerHTML=b.name;var i=e.offsetWidth,j=e.offsetHeight,k=b.getData("type");if(a.indexOf(["circle","square","triangle","star"],k)===-1)b.setData("width",i),b.setData("height",j);else{var l=i>j?i:j;b.setData("width",l),b.setData("height",l),b.setData("dim",l)}}})},initializeLabel:function(a){this.label||(this.label=document.createElement("div"),document.body.appendChild(this.label)),this.setLabelStyles(a)},setLabelStyles:function(b){a.extend(this.label.style,{visibility:"hidden",position:"absolute",width:"auto",height:"auto"}),this.label.className="jit-autoadjust-label"}};t.Radial=new b({compute:function(b){var c=a.splat(b||["current","start","end"]);u.compute(this.graph,c,this.config),this.graph.computeLevels(this.root,0,"ignore");var d=this.createLevelDistanceFunc();this.computeAngularWidths(c),this.computePositions(c,d)},computePositions:function(a,b){var c=a,d=this.graph,e=d.getNode(this.root),f=this.parent,g=this.config;for(var h=0,i=c.length;h<i;h++){var j=c[h];e.setPos(l(0,0),j),e.setData("span",Math.PI*2,j)}e.angleSpan={begin:0,end:2*Math.PI},d.eachBFS(this.root,function(a){var d=a.angleSpan.end-a.angleSpan.begin,e=a.angleSpan.begin,g=b(a),h=0,i=[],j={};a.eachSubnode(function(a){h+=a._treeAngularWidth;for(var b=0,d=c.length;b<d;b++){var e=c[b],f=a.getData("dim",e);j[e]=e in j?f>j[e]?f:j[e]:f}i.push(a)},"ignore"),f&&f.id==a.id&&i.length>0&&i[0].dist&&i.sort(function(a,b){return(a.dist>=b.dist)-(a.dist<=b.dist)});for(var k=0,m=i.length;k<m;k++){var n=i[k];if(!n._flag){var o=n._treeAngularWidth/h*d,p=e+o/2;for(var q=0,r=c.length;q<r;q++){var s=c[q];n.setPos(l(p,g),s),n.setData("span",o,s),n.setData("dim-quotient",n.getData("dim",s)/j[s],s)}n.angleSpan={begin:e,end:e+o},e+=o}}},"ignore")},setAngularWidthForNodes:function(a){this.graph.eachBFS(this.root,function(b,c){var d=b.getData("angularWidth",a[0])||5;b._angularWidth=d/c},"ignore")},setSubtreesAngularWidth:function(){var a=this;this.graph.eachNode(function(b){a.setSubtreeAngularWidth(b)},"ignore")},setSubtreeAngularWidth:function(a){var b=this,c=a._angularWidth,d=0;a.eachSubnode(function(a){b.setSubtreeAngularWidth(a),d+=a._treeAngularWidth},"ignore"),a._treeAngularWidth=Math.max(c,d)},computeAngularWidths:function(a){this.setAngularWidthForNodes(a),this.setSubtreesAngularWidth()}}),$jit.Sunburst=new b({Implements:[s,i,t.Radial],initialize:function(b){var c=$jit.Sunburst,d={interpolation:"linear",levelDistance:100,Node:{type:"multipie",height:0},Edge:{type:"none"},Label:{textAlign:"start",textBaseline:"middle"}};this.controller=this.config=a.merge(e("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),d,b);var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(f.background&&(f.background=a.merge({type:"Circles"},f.background)),this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={klass:k,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new c.Label[f.Label.type](this),this.fx=new c.Plot(this,c),this.op=new c.Op(this),this.json=null,this.root=null,this.rotated=null,this.busy=!1,this.initializeExtras()},createLevelDistanceFunc:function(){var a=this.config.levelDistance;return function(b){return(b._depth+1)*a}},refresh:function(){this.compute(),this.plot()},reposition:function(){this.compute("end")},rotate:function(a,b,c){var d=a.getPos(c.property||"current").getp(!0).theta;this.rotated=a,this.rotateAngle(-d,b,c)},rotateAngle:function(b,c,d){var e=this,f=a.merge(this.config,d||{},{modes:["polar"]}),g=d.property||(c==="animate"?"end":"current");c==="animate"&&this.fx.animation.pause(),this.graph.eachNode(function(a){var c=a.getPos(g);c.theta+=b,c.theta<0&&(c.theta+=Math.PI*2)}),c=="animate"?this.fx.animate(f):c=="replot"&&(this.fx.plot(),this.busy=!1)},plot:function(){this.fx.plot()}}),$jit.Sunburst.$extend=!0,function(c){c.Op=new b({Implements:o.Op}),c.Plot=new b({Implements:o.Plot}),c.Label={},c.Label.Native=new b({Implements:o.Label.Native,initialize:function(a){this.viz=a,this.label=a.config.Label,this.config=a.config},renderLabel:function(a,b,c){var d=b.getData("span");if(d<Math.PI/2&&Math.tan(d)*this.config.levelDistance*b._depth<10)return;var e=a.getCtx(),f=e.measureText(b.name);if(b.id==this.viz.root)var g=-f.width/2,h=0,i=0,j=0;else{var k=5,j=c.levelDistance-k,l=b.pos.clone();l.rho+=k;var m=l.getp(!0),n=l.getc(!0),g=n.x,h=n.y,o=Math.PI,p=m.theta>o/2&&m.theta<3*o/2,i=p?m.theta+o:m.theta;p?(g-=Math.abs(Math.cos(m.theta)*f.width),h+=Math.sin(m.theta)*f.width):b.id==this.viz.root&&(g-=f.width/2)}e.save(),e.translate(g,h),e.rotate(i),e.fillText(b.name,0,0),e.restore()}}),c.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz,f=this.viz.canvas,g=f.getSize(),h={x:Math.round(d.x+g.width/2),y:Math.round(d.y+g.height/2)};a.setAttribute("x",h.x),a.setAttribute("y",h.y);var i=a.getBBox();if(i){var j=a.getAttribute("x"),k=a.getAttribute("y"),l=b.pos.getp(!0),m=Math.PI,n=l.theta>m/2&&l.theta<3*m/2;n?(a.setAttribute("x",j-i.width),a.setAttribute("y",k-i.height)):b.id==e.root&&a.setAttribute("x",j-i.width/2);var o=n?l.theta+m:l.theta;b._depth&&a.setAttribute("transform","rotate("+o*360/(2*m)+" "+j+" "+k+")")}c.onPlaceLabel(a,b)}}),c.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.clone(),e=this.viz.canvas,f=b.getData("height"),g=(f||b._depth==0?f:this.viz.config.levelDistance)/2,h=e.getSize();d.rho+=g,d=d.getc(!0);var i={x:Math.round(d.x+h.width/2),y:Math.round(d.y+h.height/2)},j=a.style;j.left=i.x+"px",j.top=i.y+"px",j.display=this.fitsInCanvas(i,e)?"":"none",c.onPlaceLabel(a,b)}}),c.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1),anglecontains:function(a,b){var c=a.getData("span")/2,d=a.pos.theta,e=d-c,f=d+c;e<0&&(e+=Math.PI*2);var g=Math.atan2(b.y,b.x);return g<0&&(g+=Math.PI*2),e>f?g>e&&g<=Math.PI*2||g<f:g>e&&g<f}},pie:{render:function(a,b){var c=a.getData("span")/2,d=a.pos.theta,e=d-c,f=d+c,g=a.pos.getp(!0),h=new k(g.rho,e),i=h.getc(!0);h.theta=f;var j=h.getc(!0),l=b.getCtx();l.beginPath(),l.moveTo(0,0),l.lineTo(i.x,i.y),l.moveTo(0,0),l.lineTo(j.x,j.y),l.moveTo(0,0),l.arc(0,0,g.rho*a.getData("dim-quotient"),e,f,!1),l.fill()},contains:function(a,b){if(this.nodeTypes.none.anglecontains.call(this,a,b)){var c=Math.sqrt(b.x*b.x+b.y*b.y),d=this.config.levelDistance,e=a._depth;return c<=d*e}return!1}},multipie:{render:function(a,b){var c=a.getData("height"),d=c?c:this.config.levelDistance,e=a.getData("span")/2,f=a.pos.theta,g=f-e,h=f+e,i=a.pos.getp(!0),j=new k(i.rho,g),l=j.getc(!0);j.theta=h;var m=j.getc(!0);j.rho+=d;var n=j.getc(!0);j.theta=g;var o=j.getc(!0),p=b.getCtx();p.moveTo(0,0),p.beginPath(),p.arc(0,0,i.rho,g,h,!1),p.arc(0,0,i.rho+d,h,g,!0),p.moveTo(l.x,l.y),p.lineTo(o.x,o.y),p.moveTo(m.x,m.y),p.lineTo(n.x,n.y),p.fill(),a.collapsed&&(p.save(),p.lineWidth=2,p.moveTo(0,0),p.beginPath(),p.arc(0,0,i.rho+d+5,h-.01,g+.01,!0),p.stroke(),p.restore())},contains:function(a,b){if(this.nodeTypes.none.anglecontains.call(this,a,b)){var c=Math.sqrt(b.x*b.x+b.y*b.y),d=a.getData("height"),e=d?d:this.config.levelDistance,f=this.config.levelDistance,g=a._depth;return c>=f*g&&c<=f*g+e}return!1}},"gradient-multipie":{render:function(b,c){var d=c.getCtx(),e=b.getData("height"),f=e?e:this.config.levelDistance,g=d.createRadialGradient(0,0,b.getPos().rho,0,0,b.getPos().rho+f),h=a.hexToRgb(b.getData("color")),i=[];a.each(h,function(a){i.push(parseInt(a*.5,10))});var j=a.rgbToHex(i);g.addColorStop(0,j),g.addColorStop(1,b.getData("color")),d.fillStyle=g,this.nodeTypes.multipie.render.call(this,b,c)},contains:function(a,b){return this.nodeTypes.multipie.contains.call(this,a,b)}},"gradient-pie":{render:function(b,c){var d=c.getCtx(),e=d.createRadialGradient(0,0,0,0,0,b.getPos().rho),f=a.hexToRgb(b.getData("color")),g=[];a.each(f,function(a){g.push(parseInt(a*.5,10))});var h=a.rgbToHex(g);e.addColorStop(1,h),e.addColorStop(0,b.getData("color")),d.fillStyle=e,this.nodeTypes.pie.render.call(this,b,c)},contains:function(a,b){return this.nodeTypes.pie.contains.call(this,a,b)}}}),c.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(c,d,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(c,d,b,this.edge.epsilon)}},arrow:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.getData("dim"),f=a.data.$direction,g=f&&f.length>1&&f[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(c,d,e,g,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(c,d,b,this.edge.epsilon)}},hyperline:{render:function(a,b){var c=a.nodeFrom.pos.getc(),d=a.nodeTo.pos.getc(),e=Math.max(c.norm(),d.norm());this.edgeHelper.hyperline.render(c.$scale(1/e),d.$scale(1/e),e,b)},contains:a.lambda(!1)}})}($jit.Sunburst),$jit.RGraph=new b({Implements:[s,i,t.Radial],initialize:function(b){var c=$jit.RGraph,d={interpolation:"linear",levelDistance:100};this.controller=this.config=a.merge(e("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),d,b);var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(f.background&&(f.background=a.merge({type:"Circles"},f.background)),this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={klass:k,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new c.Label[f.Label.type](this),this.fx=new c.Plot(this,c),this.op=new c.Op(this),this.json=null,this.root=null,this.busy=!1,this.parent=!1,this.initializeExtras()},createLevelDistanceFunc:function(){var a=this.config.levelDistance;return function(b){return(b._depth+1)*a}},refresh:function(){this.compute(),this.plot()},reposition:function(){this.compute("end")},plot:function(){this.fx.plot()},getNodeAndParentAngle:function(a){var b=!1,c=this.graph.getNode(a),d=c.getParents(),e=d.length>0?d[0]:!1;if(e){var f=e.pos.getc(),g=c.pos.getc(),h=f.add(g.scale(-1));b=Math.atan2(h.y,h.x),b<0&&(b+=2*Math.PI)}return{parent:e,theta:b}},tagChildren:function(a,b){if(a.angleSpan){var c=[];a.eachAdjacency(function(a){c.push(a.nodeTo)},"ignore");var d=c.length;for(var e=0;e<d&&b!=c[e].id;e++);for(var f=(e+1)%d,g=0;b!=c[f].id;f=(f+1)%d)c[f].dist=g++}},onClick:function(b,c){if(this.root!=b&&!this.busy){this.busy=!0,this.root=b;var d=this;this.controller.onBeforeCompute(this.graph.getNode(b));var e=this.getNodeAndParentAngle(b);this.tagChildren(e.parent,b),this.parent=e.parent,this.compute("end");var f=e.theta-e.parent.endPos.theta;this.graph.eachNode(function(a){a.endPos.set(a.endPos.getp().add(l(f,0)))});var g=this.config.interpolation;c=a.merge({onComplete:a.empty},c||{}),this.fx.animate(a.merge({hideLabels:!0,modes:[g]},c,{onComplete:function(){d.busy=!1,c.onComplete()}}))}}}),$jit.RGraph.$extend=!0,function(c){c.Op=new b({Implements:o.Op}),c.Plot=new b({Implements:o.Plot}),c.Label={},c.Label.Native=new b({Implements:o.Label.Native}),c.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)};a.setAttribute("x",k.x),a.setAttribute("y",k.y),c.onPlaceLabel(a,b)}}),c.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)},l=a.style;l.left=k.x+"px",l.top=k.y+"px",l.display=this.fitsInCanvas(k,e)?"":"none",c.onPlaceLabel(a,b)}}),c.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.circle.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.circle.contains(c,b,d)}},ellipse:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");this.nodeHelper.ellipse.render("fill",c,d,e,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");return this.nodeHelper.ellipse.contains(c,b,d,e)}},square:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.square.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.square.contains(c,b,d)}},rectangle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");this.nodeHelper.rectangle.render("fill",c,d,e,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");return this.nodeHelper.rectangle.contains(c,b,d,e)}},triangle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.triangle.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.triangle.contains(c,b,d)}},star:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.star.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.star.contains(c,b,d)}}}),c.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(c,d,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(c,d,b,this.edge.epsilon)}},arrow:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.getData("dim"),f=a.data.$direction,g=f&&f.length>1&&f[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(c,d,e,g,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(c,d,b,this.edge.epsilon)}}})}($jit.RGraph)}(),define("jitSource",function(){}),define("connectionStatus",["require","jitSource"],function(a){function e(){this.graphID=0,this.domElement=undefined,this.jitGraph=undefined,this.colors=undefined}function g(a,b,c,d){var e=new f;return e.ConnectedColor=a,e.DisconnectedColor=b,e.UnknownColor=c,e.BackofficeColor=d,e}function k(a){return m(n(a),"")}function l(a){var b={};for(var c in a){var d=a[c];b[d.UniqueID]=d}return b}function m(a,b){var c=[];for(var d in a){if(!a.hasOwnProperty(d))continue;var e=a[d];if(e.Parent_uid!=b)continue;c.push(e),delete a[d],e.Clients=m(a,e.UniqueID)}return c}function n(a){var b={};for(var c in a){if(!a.hasOwnProperty(c))continue;var d=a[c];b[d.UniqueID]=d}return b}function o(a,b,c,d){if(!a)return undefined;a.empty();var e=new $jit.RGraph({injectInto:a.get(0),interpolation:"polar",levelDistance:c,withLabels:d,duration:500,background:{numberOfCircles:10,levelDistance:c,CanvasStyles:{strokeStyle:"#555"}},Navigation:{enable:!0,panning:!0,zooming:!1},Node:{overridable:!d,type:"circle",color:"#ddeeff"},Edge:{color:"#808080",lineWidth:1},onCreateLabel:function(a,b){a.onclick=function(){e.onClick(b.id,{hideLabels:!1})}},onPlaceLabel:function(a,b){a.innerHTML=b.name.replace(" ","<br/>");var c=a.style;c.display="",c.cursor="pointer",c.color="#fff",c.backgroundColor=b.data.$color,c.border="1px solid #353535",c.padding="2px 6px",c.textAlign="center",c.borderRadius="3px",c.marginTop="-8px",b._depth<=1?c.fontSize="0.9em":b._depth==2?c.fontSize="0.8em":b._depth==3?c.fontSize="0.7em":c.fontSize="0.6em",c.fontName="Actor";var d=parseInt(c.left),e=a.offsetWidth;c.left=d-e/2+"px"}});return e.loadJSON(b),e.refresh(),e}function p(a,b,c,d){if(!a)return undefined;a.empty();var e=new $jit.Sunburst({injectInto:a.get(0),levelDistance:c,withLabels:d,Navigation:{enable:!0,panning:!1,zooming:!1},Node:{overridable:!0,type:"gradient-multipie"},onPlaceLabel:function(a,b){a.innerHTML=b.name.replace(" ","<br/>");var c=a.style;c.display="",c.cursor="pointer",c.textAlign="center",c.color="#fff",c.fontWeight="bold",b._depth<=1?c.fontSize="0.9em":b._depth==2?c.fontSize="0.8em":b._depth==3?c.fontSize="0.7em":c.fontSize="0.6em",c.fontName="Actor";var d=parseInt(c.left),e=a.offsetWidth;c.left=d-e/2+"px"},Events:{enable:!1,onClick:function(a){if(!a)return}},NodeStyles:{enable:!1,type:"Native",stylesHover:{}},dummy:{}});return e.loadJSON(b),e.refresh(),e}function q(){return c++,c}function r(a,b){return a+"_"+b}a("jitSource");var b={},c=0;b.GraphTypes={RGraph:"RGraph",Sunburst:"Sunburst"};var d=b.GraphTypes,f=function(){this.ConnectedColor="#fff",this.DisconnectedColor="#f00",this.UnknownColor="#ffd84d",this.BackofficeColor="#a0ffa0"},h={connected:"Connected",disconnected:"Disconnected",unknown:"Unknown"},i={backoffice:"Backoffice",master:"Master",pos:"Pos",proxy:"Proxy"},j=b.State=function(){this.connections=undefined,this.map=undefined,this.hierarchy=undefined,this.options={rgraphColors:g("#4AA02C","#f55","#ffa21f","#027FFF"),sunburstColors:g("#5f5","#f55","#ffd84d","#027FFF")},this.graphs=[],this.items=this.connections,this.listviewSettings={sortIndex:0,sortAscending:!0,fields:["Type","Parent","Name","IP","Status"],fieldCaptions:["Type","Parent","Name","IP","Status"],itemTemplate:"tmpl/listview/templateListConnection.html",itemTemplateFormatter:{},editTemplateSetupFunction:function(a,b){},multiSelect:!1}};return j.prototype.AppendElement=function(a,b,c,f){var g=new e;g.graphID=q(),g.domElement=b;if(a==d.RGraph)g.colors=this.options.rgraphColors,g.jitGraph=o(b,this.createInfoVisDataSource(this.hierarchy,g.graphID,g.colors),c,f);else if(a==d.Sunburst)g.colors=this.options.sunburstColors,g.jitGraph=p(b,this.createInfoVisDataSource(this.hierarchy,g.graphID,g.colors),c,f);else throw new Error("Invalid graphType: "+a);this.graphs.push(g)},j.prototype.ConnectNotification=function(a){this.processNotification(a)},j.prototype.createInfoVisDataSource=function(a,b,c){var d={id:r("source",b),name:"Source",data:{$color:"#aaa"},children:this.processArrayForInfoVis(a,b,c)};return d},j.prototype.DisconnectNotification=function(a){this.processNotification(a)},j.prototype.findConnectionEntryByUniqueID=function(a){return this.map.hasOwnProperty(a)?this.map[a]:undefined},j.prototype.findConnectionEntryIndexByUniqueID=function(a){for(var b in this.connections)if(this.connections[b].UniqueID==a)return b;return-1},j.prototype.getEntryConnectionStatus=function(a){function b(a){return a?h.connected:h.disconnected}var c=this.getParent(a);if(!c)return b(a.Connected);var d=this.getEntryConnectionStatus(c);return d==h.connected?b(a.Connected):h.unknown},j.prototype.getInfoVisDataForEntry=function(a,b){var c=a.Type,d=this.getEntryConnectionStatus(a),e;return c==i.backoffice?e=b.BackofficeColor:d==h.connected?e=b.ConnectedColor:d==h.disconnected?e=b.DisconnectedColor:e=b.UnknownColor,{$color:e}},j.prototype.getParent=function(a){return this.map.hasOwnProperty(a.Parent_uid)?this.map[a.Parent_uid]:undefined},j.prototype.GetSummary=function(){return{Master:this.getSummaryForType(i.master),Backoffice:this.getSummaryForType(i.backoffice),Proxy:this.getSummaryForType(i.proxy),Pos:this.getSummaryForType(i.pos)}},j.prototype.getSummaryForType=function(a){var b={Connected:0,Disconnected:0,Unknown:0};a=a.toLowerCase();for(var c in this.connections){var d=this.connections[c];if(d.Type.toLowerCase()!=a)continue;var e=this.getEntryConnectionStatus(d);e==h.connected?b.Connected++:e==h.disconnected?b.Disconnected++:b.Unknown++}return b},j.prototype.newInfoVisObjectFromClientEntry=function(a,b,c){return{id:r(a.UniqueID,b),name:a.Name,children:[],data:this.getInfoVisDataForEntry(a,c)}},j.prototype.Load=function(a){this.connections=a,this.items=a,this.map=l(a),this.hierarchy=k(this.map);for(var b in this.graphs){var c=this.graphs[b];c.graphID=q(),c.jitGraph.loadJSON(this.createInfoVisDataSource(this.hierarchy,c.graphID,c.colors)),c.jitGraph.refresh()}},j.prototype.processArrayForInfoVis=function(a,b,c){var d=[];for(var e in a){var f=a[e],g=this.newInfoVisObjectFromClientEntry(f,b,c);g.children=this.processArrayForInfoVis(f.Clients,b,c),d.push(g)}return d},j.prototype.processNotification=function(a){function c(){for(var c in b.graphs){var d=b.graphs[c],e=d.jitGraph.graph.getNode(r(a.UniqueID,d.graphID));if(!e)return;e.name=a.Name,$.extend(e.data,b.getInfoVisDataForEntry(a,d.colors)),d.jitGraph.plot()}}function d(){for(var a in b.graphs){var c=b.graphs[a];c.graphID=q(),c.jitGraph.loadJSON(b.createInfoVisDataSource(b.hierarchy,c.graphID,c.colors)),c.jitGraph.refresh()}}function e(){var c=b.findConnectionEntryIndexByUniqueID(a.UniqueID);if(c<0)return;b.connections.splice(c,1),b.map=l(b.connections),b.hierarchy=k(b.map),d()}function f(){for(var c=b.connections.length-1;c>=0;c--){var e=b.connections[c];e.Type==i.backoffice&&e.Parent_uid==a.UniqueID&&b.connections.splice(c,1),e.UniqueID==a.UniqueID&&$.extend(e,a)}b.map=l(b.connections),b.hierarchy=k(b.map),d()}var b=this;if(a.Type==i.master&&!a.Connected){f();return}if(a.Type==i.backoffice&&!a.Connected){e();return}var g=this.findConnectionEntryByUniqueID(a.UniqueID);g?($.extend(g,a),c()):(this.connections.push(a),this.map=l(this.connections),this.hierarchy=k(this.map),d())},j.prototype.RemoveElement=function(a){a=a.get(0);for(var b in this.graphs)if(this.graphs[b].domElement.get(0)==a){this.graphs.splice(b,1);break}},j.prototype.RefreshGraphs=function(){for(var a in this.graphs){var b=this.graphs[a];b.jitGraph.canvas.resize(b.domElement.width(),b.domElement.height())}},b.NewState=function(){var a=new j;return a},b}),define("domready",[],function(){function i(a){for(var b=0,d;d=a[b];b++)d(c)}function j(){var a=d,c=e;b&&(a.length&&(d=[],i(a)),f.resourcesDone&&c.length&&(e=[],i(c)))}function k(){b||(b=!0,h&&clearInterval(h),j())}function l(a){return b?a(c):d.push(a),l}var a=typeof window!="undefined"&&window.document,b=!a,c=a?document:null,d=[],e=[],f=requirejs||require||{},g=f.resourcesReady,h;return"resourcesReady"in f&&(f.resourcesReady=function(a){g&&g(a),a&&j()}),a&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",k,!1),window.addEventListener("load",k,!1)):window.attachEvent&&(window.attachEvent("onload",k),self===self.top&&(h=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),k())}catch(a){}},30))),document.readyState==="complete"&&k()),l.withResources=function(a){return b&&f.resourcesDone?a(c):e.push(a),l},l.version="1.0.0",l.load=function(a,b,c,d){d.isBuild?c(null):l(c)},l}),function(){function i(a){var b=a.currentTarget||a.srcElement,c,g,h;if(a.type==="load"||d.test(b.readyState)){g=b.getAttribute("data-requiremodule"),f[g]=!0;for(c=0;h=e[c];c++)if(f[h.name])h.req([h.name],h.onLoad);else break;c>0&&e.splice(0,c),setTimeout(function(){b.parentNode.removeChild(b)},15)}}function j(a){var b,c,d;a.setAttribute("data-orderloaded","loaded");for(b=0;d=h[b];b++){c=g[d];if(c&&c.getAttribute("data-orderloaded")==="loaded")delete g[d],require.addScriptToDom(c);else break}b>0&&h.splice(0,b)}var a=typeof document!="undefined"&&typeof window!="undefined"&&document.createElement("script"),b=a&&(a.async||window.opera&&Object.prototype.toString.call(window.opera)==="[object Opera]"||"MozAppearance"in document.documentElement.style),c=a&&a.readyState==="uninitialized",d=/^(complete|loaded)$/,e=[],f={},g={},h=[];a=null,define("order",{version:"0.27.1",load:function(a,d,f,k){var l=d.nameToUrl(a,null),m,n;require.s.skipAsync[l]=!0,b||k.isBuild?d([a],f):c?(n=require.s.contexts._,!n.urlFetched[l]&&!n.loaded[a]&&(n.urlFetched[l]=!0,require.resourcesReady(!1),n.scriptCount+=1,m=require.attach(l,n,a,null,null,j),g[a]=m,h.push(a)),d([a],f)):d.specified(a)?d([a],f):(e.push({name:a,req:d,onLoad:f}),require.attach(l,null,a,i,"script/cache"))}})}(),function(a,b){function c(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function d(b,d){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&c(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||d:d)&&c(b)}a.ui=a.ui||{},a.ui.version||(a.extend(a.ui,{version:"1.8.18",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var f=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return d(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var c=a.attr(b,"tabindex"),e=isNaN(c);return(e||c>=0)&&d(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));c.offsetHeight,a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!!d&&!!a.element[0].parentNode)for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}}))}(jQuery),function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){return c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}}),d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new c;g.options=a.extend(!0,{},g.options),a[e][b].prototype=a.extend(!0,g,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;return e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e,f&&e.charAt(0)==="_"?h:(f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b)return h=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))}),h)}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",b),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e,f,g=this.options[b];d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent;if(f)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}}(jQuery),function(a,b){var c=!1;a(document).mouseup(function(a){c=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=b.which==1,f=typeof this.options.cancel=="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=this._mouseStart(b)!==!1;if(!this._mouseStarted)return b.preventDefault(),!0}return!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0}},_mouseMove:function(b){return!a.browser.msie||document.documentMode>=9||!!b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})}(jQuery),function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e="center",f={},g=a.fn.position,h=a.fn.offset;a.fn.position=function(b){if(!b||!b.of)return g.apply(this,arguments);b=a.extend({},b);var h=a(b.of),i=h[0],j=(b.collision||"flip").split(" "),k=b.offset?b.offset.split(" "):[0,0],l,m,n;return i.nodeType===9?(l=h.width(),m=h.height(),n={top:0,left:0}):i.setTimeout?(l=h.width(),m=h.height(),n={top:h.scrollTop(),left:h.scrollLeft()}):i.preventDefault?(b.at="left top",l=m=0,n={top:b.of.pageY,left:b.of.pageX}):(l=h.outerWidth(),m=h.outerHeight(),n=h.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" ");a.length===1&&(a=c.test(a[0])?a.concat([e]):d.test(a[0])?[e].concat(a):[e,e]),a[0]=c.test(a[0])?a[0]:e,a[1]=d.test(a[1])?a[1]:e,b[this]=a}),j.length===1&&(j[1]=j[0]),k[0]=parseInt(k[0],10)||0,k.length===1&&(k[1]=k[0]),k[1]=parseInt(k[1],10)||0,b.at[0]==="right"?n.left+=l:b.at[0]===e&&(n.left+=l/2),b.at[1]==="bottom"?n.top+=m:b.at[1]===e&&(n.top+=m/2),n.left+=k[0],n.top+=k[1],this.each(function(){var c=a(this),d=c.outerWidth(),g=c.outerHeight(),h=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,o=d+h+(parseInt(a.curCSS(this,"marginRight",!0))||0),p=g+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0),q=a.extend({},n),r;b.my[0]==="right"?q.left-=d:b.my[0]===e&&(q.left-=d/2),b.my[1]==="bottom"?q.top-=g:b.my[1]===e&&(q.top-=g/2),f.fractions||(q.left=Math.round(q.left),q.top=Math.round(q.top)),r={left:q.left-h,top:q.top-i},a.each(["left","top"],function(c,e){a.ui.position[j[c]]&&a.ui.position[j[c]][e](q,{targetWidth:l,targetHeight:m,elemWidth:d,elemHeight:g,collisionPosition:r,collisionWidth:o,collisionHeight:p,offset:k,my:b.my,at:b.at})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(q,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=a(window),e=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=e>0?b.left-e:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window),e=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=e>0?b.top-e:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]!==e){var d=a(window),f=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),g=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,h=c.at[0]==="left"?c.targetWidth:-c.targetWidth,i=-2*c.offset[0];b.left+=c.collisionPosition.left<0?g+h+i:f>0?g+h+i:0}},top:function(b,c){if(c.at[1]!==e){var d=a(window),f=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),g=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,h=c.at[1]==="top"?c.targetHeight:-c.targetHeight,i=-2*c.offset[1];b.top+=c.collisionPosition.top<0?g+h+i:f>0?g+h+i:0}}}},a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),f=parseInt(a.curCSS(b,"top",!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0,h={top:c.top-e.top+f,left:c.left-e.left+g};"using"in c?c.using.call(b,h):d.css(h)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?this.each(function(){a.offset.setOffset(this,b)}):h.call(this)}),function(){var b=document.getElementsByTagName("body")[0],c=document.createElement("div"),d,e,g,h,i;d=document.createElement(b?"div":"body"),g={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},b&&a.extend(g,{position:"absolute",left:"-1000px",top:"-1000px"});for(var j in g)d.style[j]=g[j];d.appendChild(c),e=b||document.documentElement,e.insertBefore(d,e.firstChild),c.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;",h=a(c).offset(function(a,b){return b}).offset(),d.innerHTML="",e.removeChild(d),i=h.top+h.left+(b?2e3:0),f.fractions=i>21&&i<22}()}(jQuery),function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!!this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(b),this.handle?(c.iframeFix&&a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){d._trigger("stop",b)!==!1&&d._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){return this.options.iframeFix===!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)}),c},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[b.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var c=a(b.containment),d=c[0];if(!d)return;var e=c.offset(),f=a(d).css("overflow")!="hidden";this.containment=[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;if(this.originalPosition){var h;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();h=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else h=this.containment;b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),b.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top)}if(c.grid){var j=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;g=h?j-this.offset.click.top<h[1]||j-this.offset.click.top>h[3]?j-this.offset.click.top<h[1]?j+c.grid[1]:j-c.grid[1]:j:j;var k=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=h?k-this.offset.click.left<h[0]||k-this.offset.click.left>h[2]?k-this.offset.click.left<h[0]?k+c.grid[0]:k-c.grid[0]:k:k}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"1.8.18"}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this,f=function(b){var c=this.offset.click.top,d=this.offset.click.left,e=this.positionAbs.top,f=this.positionAbs.left,g=b.height,h=b.width,i=b.top,j=b.left;return a.ui.isOver(e+c,f+d,i,j,g,h)};a.each(d.sortables,function(f){this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c){var d=a("body"),e=a(this).data("draggable").options;d.css("cursor")&&(e._cursor=d.css("cursor")),d.css("cursor",e.cursor)},stop:function(b,c){var d=a(this).data("draggable").options;d._cursor&&a("body").css("cursor",d._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(b,c){var d=a(this).data("draggable");d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"&&(d.overflowOffset=d.scrollParent.offset())},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=!1;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x")d.overflowOffset.top+d.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")d.overflowOffset.left+d.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c){var d=a(this).data("draggable"),e=d.options;d.snapElements=[],a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,j=i+d.helperProportions.height;for(var k=d.snapElements.length-1;k>=0;k--){var l=d.snapElements[k].left,m=l+d.snapElements[k].width,n=d.snapElements[k].top,o=n+d.snapElements[k].height;if(!(l-f<g&&g<m+f&&n-f<i&&i<o+f||l-f<g&&g<m+f&&n-f<j&&j<o+f||l-f<h&&h<m+f&&n-f<i&&i<o+f||l-f<h&&h<m+f&&n-f<j&&j<o+f)){d.snapElements[k].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=!1;continue}if(e.snapMode!="inner"){var p=Math.abs(n-j)<=f,q=Math.abs(o-i)<=f,r=Math.abs(l-h)<=f,s=Math.abs(m-g)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n-d.helperProportions.height,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left)}var t=p||q||r||s;if(e.snapMode!="outer"){var p=Math.abs(n-i)<=f,q=Math.abs(o-j)<=f,r=Math.abs(l-g)<=f,s=Math.abs(m-h)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o-d.helperProportions.height,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-d.margins.left)}!d.snapElements[k].snapping&&(p||q||r||s||t)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=p||q||r||s||t}}}),a.ui.plugin.add("draggable","stack",{start:function(b,c){var d=a(this).data("draggable").options,e=a.makeArray(a(d.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(!!e.length){var f=parseInt(e[0].style.zIndex)||0;a(e).each(function(a){this.style.zIndex=f+a}),this[0].style.zIndex=f+e.length}}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0,this.isout=1,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];for(var c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(b,c){b=="accept"&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;!!c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;!!c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0])return!1;var e=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return e=!0,!1}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.extend(a.ui.droppable,{version:"1.8.18"}),a.ui.intersect=function(b,c,d){if(!c.offset)return!1;var e=(b.positionAbs||b.position.absolute).left,f=e+b.helperProportions.width,g=(b.positionAbs||b.position.absolute).top,h=g+b.helperProportions.height,i=c.offset.left,j=i+c.proportions.width,k=c.offset.top,l=k+c.proportions.height;switch(d){case"fit":return i<=e&&f<=j&&k<=g&&h<=l;case"intersect":return i<e+b.helperProportions.width/2&&f-b.helperProportions.width/2<j&&k<g+b.helperProportions.height/2&&h-b.helperProportions.height/2<l;case"pointer":var m=(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,n=(b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,o=a.ui.isOver(n,m,k,i,c.proportions.height,c.proportions.width);return o;case"touch":return(g>=k&&g<=l||h>=k&&h<=l||g<k&&h>l)&&(e>=i&&e<=j||f>=i&&f<=j||e<i&&f>j);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d=a.ui.ddmanager.droppables[b.options.scope]||[],e=c?c.type:null,f=(b.currentItem||b.element).find(":data(droppable)").andSelf();a:for(var g=0;g<d.length;g++){if(d[g].options.disabled||b&&!d[g].accept.call(d[g].element[0],b.currentItem||b.element))continue;for(var h=0;h<f.length;h++)if(f[h]==d[g].element[0]){d[g].proportions.height=0;continue a}d[g].visible=d[g].element.css("display")!="none";if(!d[g].visible)continue;e=="mousedown"&&d[g]._activate.call(d[g],c),d[g].offset=d[g].element.offset(),d[g].proportions={width:d[g].element[0].offsetWidth,height:d[g].element[0].offsetHeight}}},drop:function(b,c){var d=!1;return a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){!this.options||(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parents(":not(body,html)").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var d=a.ui.intersect(b,this,this.options.tolerance),e=!d&&this.isover==1?"isout":d&&this.isover==0?"isover":null;if(!e)return;var f;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(f=a.data(g[0],"droppable"),f.greedyChild=e=="isover"?1:0)}f&&e=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,c)),this[e]=1,this[e=="isout"?"isover":"isout"]=0,this[e=="isover"?"_over":"_out"].call(this,c),f&&e=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,c))}})},dragStop:function(b,c){b.element.parents(":not(body,html)").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(jQuery),function(a,b){a.widget("ui.resizable",a.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var b=this,c=this.options;this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=c.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var d=this.handles.split(",");this.handles={};for(var e=0;e<d.length;e++){var f=a.trim(d[e]),g="ui-resizable-"+f,h=a('<div class="ui-resizable-handle '+g+'"></div>');/sw|se|ne|nw/.test(f)&&h.css({zIndex:++c.zIndex}),"se"==f&&h.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[f]=".ui-resizable-"+f,this.element.append(h)}}this._renderAxis=function(b){b=b||this.element;for(var c in this.handles){this.handles[c].constructor==String&&(this.handles[c]=a(this.handles[c],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var d=a(this.handles[c],this.element),e=0;e=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth();var f=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join("");b.css(f,e),this._proportionallyResize()}if(!a(this.handles[c]).length)continue}},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=a&&a[1]?a[1]:"se"}}),c.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").hover(function(){c.disabled||(a(this).removeClass("ui-resizable-autohide"),b._handles.show())},function(){c.disabled||b.resizing||(a(this).addClass("ui-resizable-autohide"),b._handles.hide())})),this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var c=this.element;c.after(this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_mouseCapture:function(b){var c=!1;for(var d in this.handles)a(this.handles[d])[0]==b.target&&(c=!0);return!this.options.disabled&&c},_mouseStart:function(b){var d=this.options,e=this.element.position(),f=this.element;this.resizing=!0,this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()},(f.is(".ui-draggable")||/absolute/.test(f.css("position")))&&f.css({position:"absolute",top:e.top,left:e.left}),this._renderProxy();var g=c(this.helper.css("left")),h=c(this.helper.css("top"));d.containment&&(g+=a(d.containment).scrollLeft()||0,h+=a(d.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:g,top:h},this.size=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalSize=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalPosition={left:g,top:h},this.sizeDiff={width:f.outerWidth()-f.width(),height:f.outerHeight()-f.height()},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio=typeof d.aspectRatio=="number"?d.aspectRatio:this.originalSize.width/this.originalSize.height||1;var i=a(".ui-resizable-"+this.axis).css("cursor");return a("body").css("cursor",i=="auto"?this.axis+"-resize":i),f.addClass("ui-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(b){var c=this.helper,d=this.options,e={},f=this,g=this.originalMousePosition,h=this.axis,i=b.pageX-g.left||0,j=b.pageY-g.top||0,k=this._change[h];if(!k)return!1;var l=k.apply(this,[b,i,j]),m=a.browser.msie&&a.browser.version<7,n=this.sizeDiff;this._updateVirtualBoundaries(b.shiftKey);if(this._aspectRatio||b.shiftKey)l=this._updateRatio(l,b);return l=this._respectSize(l,b),this._propagate("resize",b),c.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(l),this._trigger("resize",b,this.ui()),!1},_mouseStop:function(b){this.resizing=!1;var c=this.options,d=this;if(this._helper){var e=this._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:d.sizeDiff.height,h=f?0:d.sizeDiff.width,i={width:d.helper.width()-h,height:d.helper.height()-g},j=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,k=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;c.animate||this.element.css(a.extend(i,{top:k,left:j})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()}return a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b=this.options,c,e,f,g,h;h={minWidth:d(b.minWidth)?b.minWidth:0,maxWidth:d(b.maxWidth)?b.maxWidth:Infinity,minHeight:d(b.minHeight)?b.minHeight:0,maxHeight:d(b.maxHeight)?b.maxHeight:Infinity};if(this._aspectRatio||a)c=h.minHeight*this.aspectRatio,f=h.minWidth/this.aspectRatio,e=h.maxHeight*this.aspectRatio,g=h.maxWidth/this.aspectRatio,c>h.minWidth&&(h.minWidth=c),f>h.minHeight&&(h.minHeight=f),e<h.maxWidth&&(h.maxWidth=e),g<h.maxHeight&&(h.maxHeight=g);this._vBoundaries=h},_updateCache:function(a){var b=this.options;this.offset=this.helper.offset(),d(a.left)&&(this.position.left=a.left),d(a.top)&&(this.position.top=a.top),d(a.height)&&(this.size.height=a.height),d(a.width)&&(this.size.width=a.width)},_updateRatio:function(a,b){var c=this.options,e=this.position,f=this.size,g=this.axis;return d(a.height)?a.width=a.height*this.aspectRatio:d(a.width)&&(a.height=a.width/this.aspectRatio),g=="sw"&&(a.left=e.left+(f.width-a.width),a.top=null),g=="nw"&&(a.top=e.top+(f.height-a.height),a.left=e.left+(f.width-a.width)),a},_respectSize:function(a,b){var c=this.helper,e=this._vBoundaries,f=this._aspectRatio||b.shiftKey,g=this.axis,h=d(a.width)&&e.maxWidth&&e.maxWidth<a.width,i=d(a.height)&&e.maxHeight&&e.maxHeight<a.height,j=d(a.width)&&e.minWidth&&e.minWidth>a.width,k=d(a.height)&&e.minHeight&&e.minHeight>a.height;j&&(a.width=e.minWidth),k&&(a.height=e.minHeight),h&&(a.width=e.maxWidth),i&&(a.height=e.maxHeight);var l=this.originalPosition.left+this.originalSize.width,m=this.position.top+this.size.height,n=/sw|nw|w/.test(g),o=/nw|ne|n/.test(g);j&&n&&(a.left=l-e.minWidth),h&&n&&(a.left=l-e.maxWidth),k&&o&&(a.top=m-e.minHeight),i&&o&&(a.top=m-e.maxHeight);var p=!a.width&&!a.height;return p&&!a.left&&a.top?a.top=null:p&&!a.top&&a.left&&(a.left=null),a},_proportionallyResize:function(){var b=this.options;if(!!this._proportionallyResizeElements.length){var c=this.helper||this.element;for(var d=0;d<this._proportionallyResizeElements.length;d++){var e=this._proportionallyResizeElements[d];if(!this.borderDif){var f=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],g=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];this.borderDif=a.map(f,function(a,b){var c=parseInt(a,10)||0,d=parseInt(g[b],10)||0;return c+d})}if(!a.browser.msie||!a(c).is(":hidden")&&!a(c).parents(":hidden").length)e.css({height:c.height()-this.borderDif[0]-this.borderDif[2]||0,width:c.width()-this.borderDif[1]-this.borderDif[3]||0});else continue}}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset();if(this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var d=a.browser.msie&&a.browser.version<7,e=d?1:0,f=d?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+f,height:this.element.outerHeight()+f,position:"absolute",left:this.elementOffset.left-e+"px",top:this.elementOffset.top-e+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b,c){return{width:this.originalSize.width+b}},w:function(a,b,c){var d=this.options,e=this.originalSize,f=this.originalPosition;return{left:f.left+b,width:e.width-b}},n:function(a,b,c){var d=this.options,e=this.originalSize,f=this.originalPosition;return{top:f.top+c,height:e.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),b!="resize"&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.extend(a.ui.resizable,{version:"1.8.18"}),a.ui.plugin.add("resizable","alsoResize",{start:function(b,c){var d=a(this).data("resizable"),e=d.options,f=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};typeof e.alsoResize=="object"&&!e.alsoResize.parentNode?e.alsoResize.length?(e.alsoResize=e.alsoResize[0],f(e.alsoResize)):a.each(e.alsoResize,function(a){f(a)}):f(e.alsoResize)},resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};typeof e.alsoResize=="object"&&!e.alsoResize.nodeType?a.each(e.alsoResize,function(a,b){i(a,b)}):i(e.alsoResize)},stop:function(b,c){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","animate",{stop:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName),h=g&&a.ui.hasScroll(f[0],"left")?0:d.sizeDiff.height,i=g?0:d.sizeDiff.width,j={width:d.size.width-i,height:d.size.height-h},k=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,l=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;d.element.animate(a.extend(j,l&&k?{top:l,left:k}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var c={width:parseInt(d.element.css("width"),10),height:parseInt(d.element.css("height"),10),top:parseInt(d.element.css("top"),10),left:parseInt(d.element.css("left"),10)};f&&f.length&&a(f[0]).css({width:c.width,height:c.height}),d._updateCache(c),d._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(b,d){var e=a(this).data("resizable"),f=e.options,g=e.element,h=f.containment,i=h instanceof a?h.get(0):/parent/.test(h)?g.parent().get(0):h;if(!!i){e.containerElement=a(i);if(/document/.test(h)||h==document)e.containerOffset={left:0,top:0},e.containerPosition={left:0,top:0},e.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var j=a(i),k=[];a(["Top","Right","Left","Bottom"]).each(function(a,b){k[a]=c(j.css("padding"+b))}),e.containerOffset=j.offset(),e.containerPosition=j.position(),e.containerSize={height:j.innerHeight()-k[3],width:j.innerWidth()-k[1]};var l=e.containerOffset,m=e.containerSize.height,n=e.containerSize.width,o=a.ui.hasScroll(i,"left")?i.scrollWidth:n,p=a.ui.hasScroll(i)?i.scrollHeight:m;e.parentData={element:i,left:l.left,top:l.top,width:o,height:p}}}},resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.containerSize,g=d.containerOffset,h=d.size,i=d.position,j=d._aspectRatio||b.shiftKey,k={top:0,left:0},l=d.containerElement;l[0]!=document&&/static/.test(l.css("position"))&&(k=g),i.left<(d._helper?g.left:0)&&(d.size.width=d.size.width+(d._helper?d.position.left-g.left:d.position.left-k.left),j&&(d.size.height=d.size.width/e.aspectRatio),d.position.left=e.helper?g.left:0),i.top<(d._helper?g.top:0)&&(d.size.height=d.size.height+(d._helper?d.position.top-g.top:d.position.top),j&&(d.size.width=d.size.height*e.aspectRatio),d.position.top=d._helper?g.top:0),d.offset.left=d.parentData.left+d.position.left,d.offset.top=d.parentData.top+d.position.top;var m=Math.abs((d._helper?d.offset.left-k.left:d.offset.left-k.left)+d.sizeDiff.width),n=Math.abs((d._helper?d.offset.top-k.top:d.offset.top-g.top)+d.sizeDiff.height),o=d.containerElement.get(0)==d.element.parent().get(0),p=/relative|absolute/.test(d.containerElement.css("position"));o&&p&&(m-=d.parentData.left),m+d.size.width>=d.parentData.width&&(d.size.width=d.parentData.width-m,j&&(d.size.height=d.size.width/d.aspectRatio)),n+d.size.height>=d.parentData.height&&(d.size.height=d.parentData.height-n,j&&(d.size.width=d.size.height*d.aspectRatio))},stop:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.position,g=d.containerOffset,h=d.containerPosition,i=d.containerElement,j=a(d.helper),k=j.offset(),l=j.outerWidth()-d.sizeDiff.width,m=j.outerHeight()-d.sizeDiff.height;d._helper&&!e.animate&&/relative/.test(i.css("position"))&&a(this).css({left:k.left-h.left-g.left,width:l,height:m}),d._helper&&!e.animate&&/static/.test(i.css("position"))&&a(this).css({left:k.left-h.left-g.left,width:l,height:m})}}),a.ui.plugin.add("resizable","ghost",{start:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.size;d.ghost=d.originalElement.clone(),d.ghost.css({opacity:.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof e.ghost=="string"?e.ghost:""),d.ghost.appendTo(d.helper)},resize:function(b,c){var d=a(this).data("resizable"),e=d.options;d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(b,c){var d=a(this).data("resizable"),e=d.options;d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.size,g=d.originalSize,h=d.originalPosition,i=d.axis,j=e._aspectRatio||b.shiftKey;e.grid=typeof e.grid=="number"?[e.grid,e.grid]:e.grid;var k=Math.round((f.width-g.width)/(e.grid[0]||1))*(e.grid[0]||1),l=Math.round((f.height-g.height)/(e.grid[1]||1))*(e.grid[1]||1);/^(se|s|e)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l):/^(ne)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l,d.position.top=h.top-l):/^(sw)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l,d.position.left=h.left-k):(d.size.width=g.width+k,d.size.height=g.height+l,d.position.top=h.top-l,d.position.left=h.left-k)}});var c=function(a){return parseInt(a,10)||0},d=function(a){return!isNaN(parseInt(a,10))}}(jQuery),function(a,b){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable"),this.dragged=!1;var c;this.refresh=function(){c=a(b.options.filter,b.element[0]),c.addClass("ui-selectee"),c.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=c.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){return this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"),this._mouseDestroy(),this},_mouseStart:function(b){var c=this;this.opos=[b.pageX,b.pageY];if(!this.options.disabled){var d=this.options;this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,!b.metaKey&&!b.ctrlKey&&(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().andSelf().each(function(){var d=a.data(this,"selectable-item");if(d){var e=!b.metaKey&&!b.ctrlKey||!d.$element.hasClass("ui-selected");return d.$element.removeClass(e?"ui-unselecting":"ui-selected").addClass(e?"ui-selecting":"ui-unselecting"),d.unselecting=!e,d.selecting=e,d.selected=e,e?c._trigger("selecting",b,{selecting:d.element}):c._trigger("unselecting",b,{unselecting:d.element}),!1}})}},_mouseDrag:function(b){var c=this;this.dragged=!0;if(!this.options.disabled){var d=this.options,e=this.opos[0],f=this.opos[1],g=b.pageX,h=b.pageY;if(e>g){var i=g;g=e,e=i}if(f>h){var i=h;h=f,f=i}return this.helper.css({left:e,top:f,width:g-e,height:h-f}),this.selectees.each(function(){var i=a.data(this,"selectable-item");if(!!i&&i.element!=c.element[0]){var j=!1;d.tolerance=="touch"?j=!(i.left>g||i.right<e||i.top>h||i.bottom<f):d.tolerance=="fit"&&(j=i.left>e&&i.right<g&&i.top>f&&i.bottom<h),j?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,c._trigger("selecting",b,{selecting:i.element}))):(i.selecting&&((b.metaKey||b.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),c._trigger("unselecting",b,{unselecting:i.element}))),i.selected&&!b.metaKey&&!b.ctrlKey&&!i.startselected&&(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,c._trigger("unselecting",b,{unselecting:i.element})))}}),!1}},_mouseStop:function(b){var c=this;this.dragged=!1;var d=this.options;return a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}}),a.extend(a.ui.selectable,{version:"1.8.18"})}(jQuery),function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},destroy:function(){a.Widget.prototype.destroy.call(this),this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var b=this.items.length-1;b>=0;b--)this.items[b].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var e=null,f=this,g=a(b.target).parents().each(function(){if(a.data(this,d.widgetName+"-item")==f)return e=a(this),!1});a.data(b.target,d.widgetName+"-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var h=!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==b.target&&(h=!0)});if(!h)return!1}return this.currentItem=e,this._removeCurrentsFromItems(),!0},_mouseStart:function(b,c,d){var e=this.options,f=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),e.containment&&this._setContainment(),e.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",e.cursor)),e.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",e.opacity)),e.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",e.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(var g=this.containers.length-1;g>=0;g--)this.containers[g]._trigger("activate",b,f._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))),d!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var e=this.items.length-1;e>=0;e--){var f=this.items[e],g=f.item[0],h=this._intersectsWithPointer(f);if(!h)continue;if(g!=this.currentItem[0]&&this.placeholder[h==1?"next":"prev"]()[0]!=g&&!a.ui.contains(this.placeholder[0],g)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],g):!0)){this.direction=h==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(f))this._rearrange(b,f);else break;this._trigger("change",b,this._uiHash());break}}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(!!b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=d.placeholder.offset();d.reverting=!0,a(this.helper).animate({left:e.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){var b=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("deactivate",null,b._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,b._uiHash(this)),this.containers[c].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l=d+j>h&&d+j<i&&b+k>f&&b+k<g;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?l:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&g=="right"||f=="down"?2:1:f&&(f=="down"?2:1):!1},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&d||f=="left"&&!d:e&&(e=="down"&&c||e=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=this,d=[],e=[],f=this._connectWith();if(f&&b)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&e.push([a.isFunction(j.options.items)?j.options.items.call(j.element):a(j.options.items,j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),j])}}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var g=e.length-1;g>=0;g--)e[g][0].each(function(){d.push(this)});return a(d)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+this.widgetName+"-item)");for(var b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(b){this.items=[],this.containers=[this];var c=this.items,d=this,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}}for(var g=e.length-1;g>=0;g--){var k=e[g][1],l=e[g][0];for(var i=0,m=l.length;i<m;i++){var n=a(l[i]);n.data(this.widgetName+"-item",k),c.push({item:n,instance:k,width:0,height:0,left:0,top:0})}}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;c>=0;c--){var d=this.items[c];if(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])continue;var e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||(d.width=e.outerWidth(),d.height=e.outerHeight());var f=e.offset();d.left=f.left,d.top=f.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var c=this.containers.length-1;c>=0;c--){var f=this.containers[c].element.offset();this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight()}return this},_createPlaceholder:function(b){var c=b||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder={element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return e||(b.style.visibility="hidden"),b},update:function(a,b){if(!e||!!d.forcePlaceholderSize)b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(d.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),d.placeholder.update(c,c.placeholder)},_contactContainers:function(b){var c=null,d=null;for(var e=this.containers.length-1;e>=0;e--){if(a.ui.contains(this.currentItem[0],this.containers[e].element[0]))continue;if(this._intersectsWith(this.containers[e].containerCache)){if(c&&a.ui.contains(this.containers[e].element[0],c.element[0]))continue;c=this.containers[e],d=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0)}if(!!c)if(this.containers.length===1)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){var f=1e4,g=null,h=this.positionAbs[this.containers[d].floating?"left":"top"];for(var i=this.items.length-1;i>=0;i--){if(!a.ui.contains(this.containers[d].element[0],this.items[i].item[0]))continue;var j=this.items[i][this.containers[d].floating?"left":"top"];Math.abs(j-h)<f&&(f=Math.abs(j-h),g=this.items[i])}if(!g&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[d],g?this._rearrange(b,g,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem;return d.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(d[0].style.width==""||c.forceHelperSize)&&d.width(this.currentItem.width()),(d[0].style.height==""||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],d=a(b.containment).offset(),e=a(c).css("overflow")!="hidden";this.containment=[d.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,d.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,d.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,d.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,g=b.pageY;if(this.originalPosition){this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top));if(c.grid){var h=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1];g=this.containment?h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3]?h-this.offset.click.top<this.containment[1]?h+c.grid[1]:h-c.grid[1]:h:h;var i=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0];f=this.containment?i-this.offset.click.left<this.containment[0]||i-this.offset.click.left>this.containment[2]?i-this.offset.click.left<this.containment[0]?i+c.grid[0]:i-c.grid[0]:i:i}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)},_clear:function(b,c){this.reverting=!1;var d=[],e=this;!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS)if(this._storedCSS[f]=="auto"||this._storedCSS[f]=="static")this._storedCSS[f]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){c||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(var f=this.containers.length-1;f>=0;f--)a.ui.contains(this.containers[f].element[0],this.currentItem[0])&&!c&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[f])),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[f])))}for(var f=this.containers.length-1;f>=0;f--)c||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!c){for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.extend(a.ui.sortable,{version:"1.8.18"})}(jQuery),function(a,b){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:!0,clearStyle:!1,collapsible:!1,event:"click",fillSpace:!1,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var b=this,c=b.options;b.running=0,b.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix"),b.headers=b.element.find(c.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){c.disabled||a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){c.disabled||a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){c.disabled||a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){c.disabled||a(this).removeClass("ui-state-focus")}),b.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(c.navigation){var d=b.element.find("a").filter(c.navigationFilter).eq(0);if(d.length){var e=d.closest(".ui-accordion-header");e.length?b.active=e:b.active=d.closest(".ui-accordion-content").prev()}}b.active=b._findActive(b.active||c.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top"),b.active.next().addClass("ui-accordion-content-active"),b._createIcons(),b.resize(),b.element.attr("role","tablist"),b.headers.attr("role","tab").bind("keydown.accordion",function(a){return b._keydown(a)}).next().attr("role","tabpanel"),b.headers.not(b.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide(),b.active.length?b.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):b.headers.eq(0).attr("tabIndex",0),a.browser.safari||b.headers.find("a").attr("tabIndex",-1),c.event&&b.headers.bind(c.event.split(" ").join(".accordion ")+".accordion",function(a){b._clickHandler.call(b,a,this),a.preventDefault()})},_createIcons:function(){var b=this.options;b.icons&&(a("<span></span>").addClass("ui-icon "+b.icons.header).prependTo(this.headers),this.active.children(".ui-icon").toggleClass(b.icons.header).toggleClass(b.icons.headerSelected),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-icon").remove(),this.element.removeClass("ui-accordion-icons")},destroy:function(){var b=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex"),this.headers.find("a").removeAttr("tabIndex"),this._destroyIcons();var c=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");return(b.autoHeight||b.fillHeight)&&c.css("height",""),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b=="active"&&this.activate(c),b=="icons"&&(this._destroyIcons(),c&&this._createIcons()),b=="disabled"&&this.headers.add(this.headers.next())[c?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(b){if(!(this.options.disabled||b.altKey||b.ctrlKey)){var c=a.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(e+1)%d];break;case c.LEFT:case c.UP:f=this.headers[(e-1+d)%d];break;case c.SPACE:case c.ENTER:this._clickHandler({target:b.target},b.target),b.preventDefault()}return f?(a(b.target).attr("tabIndex",-1),a(f).attr("tabIndex",0),f.focus(),!1):!0}},resize:function(){var b=this.options,c;if(b.fillSpace){if(a.browser.msie){var d=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}c=this.element.parent().height(),a.browser.msie&&this.element.parent().css("overflow",d),this.headers.each(function(){c-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else b.autoHeight&&(c=0,this.headers.next().each(function(){c=Math.max(c,a(this).height("").height())}).height(c));return this},activate:function(a){this.options.active=a;var b=this._findActive(a)[0];return this._clickHandler({target:b},b),this},_findActive:function(b){return b?typeof b=="number"?this.headers.filter(":eq("+b+")"):this.headers.not(this.headers.not(b)):b===!1?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(b,c){var d=this.options;if(!d.disabled){if(!b.target){if(!d.collapsible)return;this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header),this.active.next().addClass("ui-accordion-content-active");var e=this.active.next(),f={options:d,newHeader:a([]),oldHeader:d.active,newContent:a([]),oldContent:e},g=this.active=a([]);this._toggle(g,e,f);return}var h=a(b.currentTarget||c),i=h[0]===this.active[0];d.active=d.collapsible&&i?!1:this.headers.index(h);if(this.running||!d.collapsible&&i)return;var j=this.active,g=h.next(),e=this.active.next(),f={options:d,newHeader:i&&d.collapsible?a([]):h,oldHeader:this.active,newContent:i&&d.collapsible?a([]):g,oldContent:e},k=this.headers.index(this.active[0])>this.headers.index(h[0]);this.active=i?a([]):h,this._toggle(g,e,f,i,k),j.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header),i||(h.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(d.icons.header).addClass(d.icons.headerSelected),h.next().addClass("ui-accordion-content-active"));return}},_toggle:function(b,c,d,e,f){var g=this,h=g.options;g.toShow=b,g.toHide=c,g.data=d;var i=function(){if(!!g)return g._completed.apply(g,arguments)};g._trigger("changestart",null,g.data),g.running=c.size()===0?b.size():c.size();if(h.animated){var j={};h.collapsible&&e?j={toShow:a([]),toHide:c,complete:i,down:f,autoHeight:h.autoHeight||h.fillSpace}:j={toShow:b,toHide:c,complete:i,down:f,autoHeight:h.autoHeight||h.fillSpace},h.proxied||(h.proxied=h.animated),h.proxiedDuration||(h.proxiedDuration=h.duration),h.animated=a.isFunction(h.proxied)?h.proxied(j):h.proxied,h.duration=a.isFunction(h.proxiedDuration)?h.proxiedDuration(j):h.proxiedDuration;var k=a.ui.accordion.animations,l=h.duration,m=h.animated;m&&!k[m]&&!a.easing[m]&&(m="slide"),k[m]||(k[m]=function(a){this.slide(a,{easing:m,duration:l||700})}),k[m](j)}else h.collapsible&&e?b.toggle():(c.hide(),b.show()),i(!0);c.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur(),b.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running,this.running||(this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""}),this.toHide.removeClass("ui-accordion-content-active"),this.toHide.length&&(this.toHide.parent()[0].className=this.toHide.parent()[0].className),this._trigger("change",null,this.data))}}),a.extend(a.ui.accordion,{version:"1.8.18",animations:{slide:function(b,c){b=a.extend({easing:"swing",duration:300},b,c);if(!b.toHide.size())b.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},b);else{if(!b.toShow.size()){b.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},b);return}var d=b.toShow.css("overflow"),e=0,f={},g={},h=["height","paddingTop","paddingBottom"],i,j=b.toShow;i=j[0].style.width,j.width(j.parent().width()-parseFloat(j.css("paddingLeft"))-parseFloat(j.css("paddingRight"))-(parseFloat(j.css("borderLeftWidth"))||0)-(parseFloat(j.css("borderRightWidth"))||0)),a.each(h,function(c,d){g[d]="hide";var e=(""+a.css(b.toShow[0],d)).match(/^([\d+-.]+)(.*)$/);f[d]={value:e[1],unit:e[2]||"px"}}),b.toShow.css({height:0,overflow:"hidden"}).show(),b.toHide.filter(":hidden").each(b.complete).end().filter(":visible").animate(g,{step:function(a,c){c.prop=="height"&&(e=c.end-c.start===0?0:(c.now-c.start)/(c.end-c.start)),b.toShow[0].style[c.prop]=e*f[c.prop].value+f[c.prop].unit},duration:b.duration,easing:b.easing,complete:function(){b.autoHeight||b.toShow.css("height",""),b.toShow.css({width:i,overflow:d}),b.complete()}})}},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1e3:200})}}})}(jQuery),function(a,b){var c=0;a.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var b=this,c=this.element[0].ownerDocument,d;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!b.options.disabled&&!b.element.propAttr("readOnly")){d=!1;var e=a.ui.keyCode;switch(c.keyCode){case e.PAGE_UP:b._move("previousPage",c);break;case e.PAGE_DOWN:b._move("nextPage",c);break;case e.UP:b._move("previous",c),c.preventDefault();break;case e.DOWN:b._move("next",c),c.preventDefault();break;case e.ENTER:case e.NUMPAD_ENTER:b.menu.active&&(d=!0,c.preventDefault());case e.TAB:if(!b.menu.active)return;b.menu.select(c);break;case e.ESCAPE:b.element.val(b.term),b.close(c);break;default:clearTimeout(b.searching),b.searching=setTimeout(function(){b.term!=b.element.val()&&(b.selectedItem=null,b.search(null,c))},b.options.delay)}}}).bind("keypress.autocomplete",function(a){d&&(d=!1,a.preventDefault())}).bind("focus.autocomplete",function(){b.options.disabled||(b.selectedItem=null,b.previous=b.element.val())}).bind("blur.autocomplete",function(a){b.options.disabled||(clearTimeout(b.searching),b.closing=setTimeout(function(){b.close(a),b._change(a)},150))}),this._initSource(),this.response=function(){return b._response.apply(b,arguments)},this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",c)[0]).mousedown(function(c){var d=b.menu.element[0];a(c.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==b.element[0]&&c.target!==d&&!a.ui.contains(d,c.target)&&b.close()})},1),setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,c){var d=c.item.data("item.autocomplete");!1!==b._trigger("focus",a,{item:d})&&/^key/.test(a.originalEvent.type)&&b.element.val(d.value)},selected:function(a,d){var e=d.item.data("item.autocomplete"),f=b.previous;b.element[0]!==c.activeElement&&(b.element.focus(),b.previous=f,setTimeout(function(){b.previous=f,b.selectedItem=e},1)),!1!==b._trigger("select",a,{item:e})&&b.element.val(e.value),b.term=b.element.val(),b.close(a),b.selectedItem=e},blur:function(a,c){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),a.fn.bgiframe&&this.menu.element.bgiframe(),b.beforeunloadHandler=function(){b.element.removeAttr("autocomplete")},a(window).bind("beforeunload",b.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),a(window).unbind("beforeunload",this.beforeunloadHandler),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="source"&&this._initSource(),b==="appendTo"&&this.menu.element.appendTo(a(c||"body",this.element[0].ownerDocument)[0]),b==="disabled"&&c&&this.xhr&&this.xhr.abort()},_initSource:function(){var b=this,d,e;a.isArray(this.options.source)?(d=this.options.source,this.source=function(b,c){c(a.ui.autocomplete.filter(d,b.term))}):typeof this.options.source=="string"?(e=this.options.source,this.source=function(d,f){b.xhr&&b.xhr.abort(),b.xhr=a.ajax({url:e,data:d,dataType:"json",context:{autocompleteRequest:++c},success:function(a,b){this.autocompleteRequest===c&&f(a)},error:function(){this.autocompleteRequest===c&&f([])}})}):this.source=this.options.source},search:function(a,b){a=a!=null?a:this.element.val(),this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)!==!1)return this._search(a)},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.source({term:a},this.response)},_response:function(a){!this.options.disabled&&a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):this.close(),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b=="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b),this.menu.deactivate(),this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(new a.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItem(b,c)})},_renderItem:function(b,c){return a("<li></li>").data("item.autocomplete",c).append(a("<a></a>").text(c.label)).appendTo(b)},_move:function(a,b){if(!this.menu.element.is(":visible"))this.search(null,b);else{if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term),this.menu.deactivate();return}this.menu[a](b)}},widget:function(){return this.menu.element}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}})}(jQuery),function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){!a(c.target).closest(".ui-menu-item a").length||(c.preventDefault(),b.select(c))}),this.refresh()},refresh:function(){var b=this,c=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");c.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,b){this.deactivate();if(this.hasScroll()){var c=b.offset().top-this.element.offset().top,d=this.element.scrollTop(),e=this.element.height();c<0?this.element.scrollTop(d+c):c>=e&&this.element.scrollTop(d+c-e+b.height())}this.active=b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",a,{item:b})},deactivate:function(){!this.active||(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,b,c){if(!this.active)this.activate(c,this.element.children(b));else{var d=this.active[a+"All"](".ui-menu-item").eq(0);d.length?this.activate(c,d):this.activate(c,this.element.children(b))}},nextPage:function(b){if(this.hasScroll()){if(!this.active||this.last()){this.activate(b,this.element.children(".ui-menu-item:first"));return}var c=this.active.offset().top,d=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c-d+a(this).height();return b<10&&b>-10});e.length||(e=this.element.children(".ui-menu-item:last")),this.activate(b,e)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll()){if(!this.active||this.first()){this.activate(b,this.element.children(".ui-menu-item:last"));return}var c=this.active.offset().top,d=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c+d-a(this).height();return b<10&&b>-10}),result.length||(result=this.element.children(".ui-menu-item:first")),this.activate(b,result)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})}(jQuery),function(a,b){var c,d,e,f,g="ui-button ui-widget ui-state-default ui-corner-all",h="ui-state-hover ui-state-active ",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",j=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},k=function(b){var c=b.name,d=b.form,e=a([]);return c&&(d?e=a(d).find("[name='"+c+"']"):e=a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",j),typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.propAttr("disabled"):this.element.propAttr("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,h=this.options,i=this.type==="checkbox"||this.type==="radio",l="ui-state-hover"+(i?"":" ui-state-active"),m="ui-state-focus";h.label===null&&(h.label=this.buttonElement.html()),this.buttonElement.addClass(g).attr("role","button").bind("mouseenter.button",function(){h.disabled||(a(this).addClass("ui-state-hover"),this===c&&a(this).addClass("ui-state-active"))}).bind("mouseleave.button",function(){h.disabled||a(this).removeClass(l)}).bind("click.button",function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus.button",function(){b.buttonElement.addClass(m)}).bind("blur.button",function(){b.buttonElement.removeClass(m)}),i&&(this.element.bind("change.button",function(){f||b.refresh()}),this.buttonElement.bind("mousedown.button",function(a){h.disabled||(f=!1,d=a.pageX,e=a.pageY)}).bind("mouseup.button",function(a){!h.disabled&&(d!==a.pageX||e!==a.pageY)&&(f=!0)})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).toggleClass("ui-state-active"),b.buttonElement.attr("aria-pressed",b.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var c=b.element[0];k(c).not(c).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(h.disabled)return!1;a(this).addClass("ui-state-active"),c=this,a(document).one("mouseup",function(){c=null})}).bind("mouseup.button",function(){if(h.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(h.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){this.element.is(":checkbox")?this.type="checkbox":this.element.is(":radio")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().filter(":last"),b="label[for='"+this.element.attr("id")+"']";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible");var c=this.element.is(":checked");c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.attr("aria-pressed",c)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(g+" "+h+" "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title"),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="disabled"?c?this.element.propAttr("disabled",!0):this.element.propAttr("disabled",!1):this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?k(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass(i),c=a("<span></span>",this.element[0].ownerDocument).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}}),a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c),a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var b=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy"),a.Widget.prototype.destroy.call(this)}})}(jQuery),function(a,b){var c="ui-dialog ui-widget ui-widget-content ui-corner-all ",d={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},e={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},f=a.attrFn||{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0,click:!0};a.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(b){var c=a(this).css(b).offset().top;c<0&&a(this).css("top",b.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.options.title=this.options.title||this.originalTitle;var b=this,d=b.options,e=d.title||"&#160;",f=a.ui.dialog.getTitleId(b.element),g=(b.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass(c+d.dialogClass).css({zIndex:d.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(c){d.closeOnEscape&&!c.isDefaultPrevented()&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE&&(b.close(c),c.preventDefault())}).attr({role:"dialog","aria-labelledby":f}).mousedown(function(a){b.moveToTop(!1,a)}),h=b.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(g),i=(b.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(g),j=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){j.addClass("ui-state-hover")},function(){j.removeClass("ui-state-hover")}).focus(function(){j.addClass("ui-state-focus")}).blur(function(){j.removeClass("ui-state-focus")}).click(function(a){return b.close(a),!1}).appendTo(i),k=(b.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(d.closeText).appendTo(j),l=a("<span></span>").addClass("ui-dialog-title").attr("id",f).html(e).prependTo(i);a.isFunction(d.beforeclose)&&!a.isFunction(d.beforeClose)&&(d.beforeClose=d.beforeclose),i.find("*").add(i).disableSelection(),d.draggable&&a.fn.draggable&&b._makeDraggable(),d.resizable&&a.fn.resizable&&b._makeResizable(),b._createButtons(d.buttons),b._isOpen=!1,a.fn.bgiframe&&g.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;return a.overlay&&a.overlay.destroy(),a.uiDialog.hide(),a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),a.uiDialog.remove(),a.originalTitle&&a.element.attr("title",a.originalTitle),a},widget:function(){return this.uiDialog},close:function(b){var c=this,d,e;if(!1!==c._trigger("beforeClose",b))return c.overlay&&c.overlay.destroy(),c.uiDialog.unbind("keypress.ui-dialog"),c._isOpen=!1,c.options.hide?c.uiDialog.hide(c.options.hide,function(){c._trigger("close",b)}):(c.uiDialog.hide(),c._trigger("close",b)),a.ui.dialog.overlay.resize(),c.options.modal&&(d=0,a(".ui-dialog").each(function(){this!==c.uiDialog[0]&&(e=a(this).css("z-index"),isNaN(e)||(d=Math.max(d,e)))}),a.ui.dialog.maxZ=d),c},isOpen:function(){return this._isOpen},moveToTop:function(b,c){var d=this,e=d.options,f;return e.modal&&!b||!e.stack&&!e.modal?d._trigger("focus",c):(e.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=e.zIndex),d.overlay&&(a.ui.dialog.maxZ+=1,d.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)),f={scrollTop:d.element.scrollTop(),scrollLeft:d.element.scrollLeft()},a.ui.dialog.maxZ+=1,d.uiDialog.css("z-index",a.ui.dialog.maxZ),d.element.attr(f),d._trigger("focus",c),d)},open:function(){if(!this._isOpen){var b=this,c=b.options,d=b.uiDialog;return b.overlay=c.modal?new a.ui.dialog.overlay(b):null,b._size(),b._position(c.position),d.show(c.show),b.moveToTop(!0),c.modal&&d.bind("keydown.ui-dialog",function(b){if(b.keyCode===a.ui.keyCode.TAB){var c=a(":tabbable",this),d=c.filter(":first"),e=c.filter(":last");if(b.target===e[0]&&!b.shiftKey)return d.focus(1),!1;if(b.target===d[0]&&b.shiftKey)return e.focus(1),!1}}),a(b.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus(),b._isOpen=!0,b._trigger("open"),b}},_createButtons:function(b){var c=this,d=!1,e=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);c.uiDialog.find(".ui-dialog-buttonpane").remove(),typeof b=="object"&&b!==null&&a.each(b,function(){return!(d=!0)}),d&&(a.each(b,function(b,d){d=a.isFunction(d)?{click:d,text:b}:d;var e=a('<button type="button"></button>').click(function(){d.click.apply(c.element[0],arguments)}).appendTo(g);a.each(d,function(a,b){a!=="click"&&(a in f?e[a](b):e.attr(a,b))}),a.fn.button&&e.button()}),e.appendTo(c.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=c.options,e=a(document),f;c.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,g){f=d.height==="auto"?"auto":a(this).height(),a(this).height(a(this).height()).addClass("ui-dialog-dragging"),c._trigger("dragStart",e,b(g))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(g,h){d.position=[h.position.left-e.scrollLeft(),h.position.top-e.scrollTop()],a(this).removeClass("ui-dialog-dragging").height(f),c._trigger("dragStop",g,b(h)),a.ui.dialog.overlay.resize()}})},_makeResizable:function(c){function d(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}c=c===b?this.options.resizable:c;var e=this,f=e.options,g=e.uiDialog.css("position"),h=typeof c=="string"?c:"n,e,s,w,se,sw,ne,nw";e.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:e.element,maxWidth:f.maxWidth,maxHeight:f.maxHeight,minWidth:f.minWidth,minHeight:e._minHeight(),handles:h,start:function(b,c){a(this).addClass("ui-dialog-resizing"),e._trigger("resizeStart",b,d(c))},resize:function(a,b){e._trigger("resize",a,d(b))},stop:function(b,c){a(this).removeClass("ui-dialog-resizing"),f.height=a(this).height(),f.width=a(this).width(),e._trigger("resizeStop",b,d(c)),a.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var c=[],d=[0,0],e;if(b){if(typeof b=="string"||typeof b=="object"&&"0"in b)c=b.split?b.split(" "):[b[0],b[1]],c.length===1&&(c[1]=c[0]),a.each(["left","top"],function(a,b){+c[a]===c[a]&&(d[a]=c[a],c[a]=b)}),b={my:c.join(" "),at:c.join(" "),offset:d.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;e=this.uiDialog.is(":visible"),e||this.uiDialog.show(),this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b)),e||this.uiDialog.hide()},_setOptions:function(b){var c=this,f={},g=!1;a.each(b,function(a,b){c._setOption(a,b),a in d&&(g=!0),a in e&&(f[a]=b)}),g&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",f)},_setOption:function(b,d){var e=this,f=e.uiDialog;switch(b){case"beforeclose":b="beforeClose";break;case"buttons":e._createButtons(d);break;case"closeText":e.uiDialogTitlebarCloseText.text(""+d);break;case"dialogClass":f.removeClass(e.options.dialogClass).addClass(c+d);break;case"disabled":d?f.addClass("ui-dialog-disabled"):f.removeClass("ui-dialog-disabled");break;case"draggable":var g=f.is(":data(draggable)");g&&!d&&f.draggable("destroy"),!g&&d&&e._makeDraggable();break;case"position":e._position(d);break;case"resizable":var h=f.is(":data(resizable)");h&&!d&&f.resizable("destroy"),h&&typeof d=="string"&&f.resizable("option","handles",d),!h&&d!==!1&&e._makeResizable(d);break;case"title":a(".ui-dialog-title",e.uiDialogTitlebar).html(""+(d||"&#160;"))}a.Widget.prototype._setOption.apply(e,arguments)},_size:function(){var b=this.options,c,d,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),b.minWidth>b.width&&(b.width=b.minWidth),c=this.uiDialog.css({height:"auto",width:b.width}).height(),d=Math.max(0,b.minHeight-c);if(b.height==="auto")if(a.support.minHeight)this.element.css({minHeight:d,height:"auto"});else{this.uiDialog.show();var f=this.element.css("height","auto").height();e||this.uiDialog.hide(),this.element.height(Math.max(f,d))}else this.element.height(Math.max(b.height-c,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),a.extend(a.ui.dialog,{version:"1.8.18",uuid:0,maxZ:0,getTitleId:function(a){var b=a.attr("id");return b||(this.uuid+=1,b=this.uuid),"ui-dialog-title-"+b},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}}),a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(b){this.instances.length===0&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(document).bind("keydown.dialog-overlay",function(c){b.options.closeOnEscape&&!c.isDefaultPrevented()&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE&&(b.close(c),c.preventDefault())}),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var c=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});return a.fn.bgiframe&&c.bgiframe(),this.instances.push(c),c},destroy:function(b){var c=a.inArray(b,this.instances);c!=-1&&this.oldInstances.push(this.instances.splice(c,1)[0]),this.instances.length===0&&a([document,window]).unbind(".dialog-overlay"),b.remove();var d=0;a.each(this.instances,function(){d=Math.max(d,this.css("z-index"))}),this.maxZ=d},height:function(){var b,c;return a.browser.msie&&a.browser.version<7?(b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),b<c?a(window).height()+"px":b+"px"):a(document).height()+"px"},width:function(){var b,c;return a.browser.msie?(b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),b<c?a(window).width()+"px":b+"px"):a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)}),b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}}),a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(a,b){var c=5;a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=d.values&&d.values.length||1,h=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(d.disabled?" ui-slider-disabled ui-disabled":"")),this.range=a([]),d.range&&(d.range===!0&&(d.values||(d.values=[this._valueMin(),this._valueMin()]),d.values.length&&d.values.length!==2&&(d.values=[d.values[0],d.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(d.range==="min"||d.range==="max"?" ui-slider-range-"+d.range:"")));for(var i=e.length;i<g;i+=1)h.push(f);this.handles=e.add(a(h.join("")).appendTo(b.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){d.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){d.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")}),this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)}),this.handles.keydown(function(d){var e=a(this).data("index.ui-slider-handle"),f,g,h,i;if(!b.options.disabled){switch(d.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:d.preventDefault();if(!b._keySliding){b._keySliding=!0,a(this).addClass("ui-state-active"),f=b._start(d,e);if(f===!1)return}}i=b.options.step,b.options.values&&b.options.values.length?g=h=b.values(e):g=h=b.value();switch(d.keyCode){case a.ui.keyCode.HOME:h=b._valueMin();break;case a.ui.keyCode.END:h=b._valueMax();break;case a.ui.keyCode.PAGE_UP:h=b._trimAlignValue(g+(b._valueMax()-b._valueMin())/c);break;case a.ui.keyCode.PAGE_DOWN:h=b._trimAlignValue(g-(b._valueMax()-b._valueMin())/c);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(g===b._valueMax())return;h=b._trimAlignValue(g+i);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(g===b._valueMin())return;h=b._trimAlignValue(g-i)}b._slide(d,e,h)}}).keyup(function(c){var d=a(this).data("index.ui-slider-handle");b._keySliding&&(b._keySliding=!1,b._stop(c,d),b._change(c,d),a(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options,d,e,f,g,h,i,j,k,l;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),d={x:b.pageX,y:b.pageY},e=this._normValueFromMouse(d),f=this._valueMax()-this._valueMin()+1,h=this,this.handles.each(function(b){var c=Math.abs(e-h.values(b));f>c&&(f=c,g=a(this),i=b)}),c.range===!0&&this.values(1)===c.min&&(i+=1,g=a(this.handles[i])),j=this._start(b,i),j===!1?!1:(this._mouseSliding=!0,h._handleIndex=i,g.addClass("ui-state-active").focus(),k=g.offset(),l=!a(b.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:b.pageX-k.left-g.width()/2,top:b.pageY-k.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,i,e),this._animateOff=!0,!0))},_mouseStart:function(a){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return this.orientation==="horizontal"?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),d<0&&(d=0),this.orientation==="vertical"&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),this.options.values.length===2&&this.options.range===!0&&(b===0&&c>d||b===1&&c<d)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c,!0))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();d=this.options.values,e=arguments[0];for(f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()}},_setOption:function(b,c){var d,e=0;a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments);switch(b){case"disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a),a},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b),b;c=this.options.values.slice();for(d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return Math.abs(c)*2>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b=this.options.range,c=this.options,d=this,e=this._animateOff?!1:c.animate,f,g={},h,i,j,k;this.options.values&&this.options.values.length?this.handles.each(function(b,i){f=(d.values(b)-d._valueMin())/(d._valueMax()-d._valueMin())*100,g[d.orientation==="horizontal"?"left":"bottom"]=f+"%",a(this).stop(1,1)[e?"animate":"css"](g,c.animate),d.options.range===!0&&(d.orientation==="horizontal"?(b===0&&d.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},c.animate),b===1&&d.range[e?"animate":"css"]({width:f-h+"%"},{queue:!1,duration:c.animate})):(b===0&&d.range.stop(1,1)[e?"animate":"css"]({bottom:f+"%"},c.animate),b===1&&d.range[e?"animate":"css"]({height:f-h+"%"},{queue:!1,duration:c.animate}))),h=f}):(i=this.value(),j=this._valueMin(),k=this._valueMax(),f=k!==j?(i-j)/(k-j)*100:0,g[d.orientation==="horizontal"?"left":"bottom"]=f+"%",this.handle.stop(1,1)[e?"animate":"css"](g,c.animate),b==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[e?"animate":"css"]({width:f+"%"},c.animate),b==="max"&&this.orientation==="horizontal"&&this.range[e?"animate":"css"]({width:100-f+"%"},{queue:!1,duration:c.animate}),b==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},c.animate),b==="max"&&this.orientation==="vertical"&&this.range[e?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:c.animate}))}}),a.extend(a.ui.slider,{version:"1.8.18"})}(jQuery),function(a,b){function c(){return++f}function d(){return++e}var e=0,f=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(a,b){if(a=="selected"){if(this.options.collapsible&&b==this.options.selected)return;this.select(b)}else this.options[a]=b,this._tabify()},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+d()},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+c());return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(c){function d(b,c){b.css("display",""),!a.support.opacity&&c.opacity&&b[0].style.removeAttribute("filter")}var e=this,f=this.options,g=/^#.+/;this.list=this.element.find("ol,ul").eq(0),this.lis=a(" > li:has(a[href])",this.list),this.anchors=this.lis.map(function(){return a("a",this)[0]}),this.panels=a([]),this.anchors.each(function(b,c){var d=a(c).attr("href"),h=d.split("#")[0],i;h&&(h===location.toString().split("#")[0]||(i=a("base")[0])&&h===i.href)&&(d=c.hash,c.href=d);if(g.test(d))e.panels=e.panels.add(e.element.find(e._sanitizeSelector(d)));else if(d&&d!=="#"){a.data(c,"href.tabs",d),a.data(c,"load.tabs",d.replace(/#.*$/,""));var j=e._tabId(c);c.href="#"+j;var k=e.element.find("#"+j);k.length||(k=a(f.panelTemplate).attr("id",j).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(e.panels[b-1]||e.list),k.data("destroy.tabs",!0)),e.panels=e.panels.add(k)}else f.disabled.push(b)}),c?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),f.selected===b?(location.hash&&this.anchors.each(function(a,b){if(b.hash==location.hash)return f.selected=a,!1}),typeof f.selected!="number"&&f.cookie&&(f.selected=parseInt(e._cookie(),10)),typeof f.selected!="number"&&this.lis.filter(".ui-tabs-selected").length&&(f.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))),f.selected=f.selected||(this.lis.length?0:-1)):f.selected===null&&(f.selected=-1),f.selected=f.selected>=0&&this.anchors[f.selected]||f.selected<0?f.selected:0,f.disabled=a.unique(f.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(a,b){return e.lis.index(a)}))).sort(),a.inArray(f.selected,f.disabled)!=-1&&f.disabled.splice(a.inArray(f.selected,f.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),f.selected>=0&&this.anchors.length&&(e.element.find(e._sanitizeSelector(e.anchors[f.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(f.selected).addClass("ui-tabs-selected ui-state-active"),e.element.queue("tabs",function(){e._trigger("show",null,e._ui(e.anchors[f.selected],e.element.find(e._sanitizeSelector(e.anchors[f.selected].hash))[0]))}),this.load(f.selected)),a(window).bind("unload",function(){e.lis.add(e.anchors).unbind(".tabs"),e.lis=e.anchors=e.panels=null})):f.selected=this.lis.index(this.lis.filter(".ui-tabs-selected")),this.element[f.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible"),f.cookie&&this._cookie(f.selected,f.cookie);for(var h=0,i;i=this.lis[h];h++)a(i)[a.inArray(h,f.disabled)!=-1&&!a(i).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");f.cache===!1&&this.anchors.removeData("cache.tabs"),this.lis.add(this.anchors).unbind(".tabs");if(f.event!=="mouseover"){var j=function(a,b){b.is(":not(.ui-state-disabled)")&&b.addClass("ui-state-"+a)},k=function(a,b){b.removeClass("ui-state-"+a)};this.lis.bind("mouseover.tabs",function(){j("hover",a(this))}),this.lis.bind("mouseout.tabs",function(){k("hover",a(this))}),this.anchors.bind("focus.tabs",function(){j("focus",a(this).closest("li"))}),this.anchors.bind("blur.tabs",function(){k("focus",a(this).closest("li"))})}var l,m;f.fx&&(a.isArray(f.fx)?(l=f.fx[0],m=f.fx[1]):l=m=f.fx);var n=m?function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.hide().removeClass("ui-tabs-hide").animate(m,m.duration||"normal",function(){d(c,m),e._trigger("show",null,e._ui(b,c[0]))})}:function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.removeClass("ui-tabs-hide"),e._trigger("show",null,e._ui(b,c[0]))},o=l?function(a,b){b.animate(l,l.duration||"normal",function(){e.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),d(b,l),e.element.dequeue("tabs")})}:function(a,b,c){e.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),e.element.dequeue("tabs")};this.anchors.bind(f.event+".tabs",function(){var b=this,c=a(b).closest("li"),d=e.panels.filter(":not(.ui-tabs-hide)"),g=e.element.find(e._sanitizeSelector(b.hash));if(c.hasClass("ui-tabs-selected")&&!f.collapsible||c.hasClass("ui-state-disabled")||c.hasClass("ui-state-processing")||e.panels.filter(":animated").length||e._trigger("select",null,e._ui(this,g[0]))===!1)return this.blur(),!1;f.selected=e.anchors.index(this),e.abort();if(f.collapsible){if(c.hasClass("ui-tabs-selected"))return f.selected=-1,f.cookie&&e._cookie(f.selected,f.cookie),e.element.queue("tabs",function(){o(b,d)}).dequeue("tabs"),this.blur(),!1;if(!d.length)return f.cookie&&e._cookie(f.selected,f.cookie),e.element.queue("tabs",function(){n(b,g)}),e.load(e.anchors.index(this)),this.blur(),!1}f.cookie&&e._cookie(f.selected,f.cookie);if(g.length)d.length&&e.element.queue("tabs",function(){o(b,d)}),e.element.queue("tabs",function(){n(b,g)}),e.load(e.anchors.index(this));else throw"jQuery UI Tabs: Mismatching fragment identifier.";a.browser.msie&&this.blur()}),this.anchors.bind("click.tabs",function(){return!1})},_getIndex:function(a){return typeof a=="string"&&(a=this.anchors.index(this.anchors.filter("[href$="+a+"]"))),a},destroy:function(){var b=this.options;return this.abort(),this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"),this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.anchors.each(function(){var b=a.data(this,"href.tabs");b&&(this.href=b);var c=a(this).unbind(".tabs");a.each(["href","load","cache"],function(a,b){c.removeData(b+".tabs")})}),this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}),b.cookie&&this._cookie(null,b.cookie),this},add:function(c,d,e){e===b&&(e=this.anchors.length);var f=this,g=this.options,h=a(g.tabTemplate.replace(/#\{href\}/g,c).replace(/#\{label\}/g,d)),i=c.indexOf("#")?this._tabId(a("a",h)[0]):c.replace("#","");h.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var j=f.element.find("#"+i);return j.length||(j=a(g.panelTemplate).attr("id",i).data("destroy.tabs",!0)),j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"),e>=this.lis.length?(h.appendTo(this.list),j.appendTo(this.list[0].parentNode)):(h.insertBefore(this.lis[e]),j.insertBefore(this.panels[e])),g.disabled=a.map(g.disabled,function(a,b){return a>=e?++a:a}),this._tabify(),this.anchors.length==1&&(g.selected=0,h.addClass("ui-tabs-selected ui-state-active"),j.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){f._trigger("show",null,f._ui(f.anchors[0],f.panels[0]))}),this.load(0)),this._trigger("add",null,this._ui(this.anchors[e],this.panels[e])),this},remove:function(b){b=this._getIndex(b);var c=this.options,d=this.lis.eq(b).remove(),e=this.panels.eq(b).remove();return d.hasClass("ui-tabs-selected")&&this.anchors.length>1&&this.select(b+(b+1<this.anchors.length?1:-1)),c.disabled=a.map(a.grep(c.disabled,function(a,c){return a!=b}),function(a,c){return a>=b?--a:a}),this._tabify(),this._trigger("remove",null,this._ui(d.find("a")[0],e[0])),this},enable:function(b){b=this._getIndex(b);var c=this.options;if(a.inArray(b,c.disabled)!=-1)return this.lis.eq(b).removeClass("ui-state-disabled"),c.disabled=a.grep(c.disabled,function(a,c){return a!=b}),this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b])),this},disable:function(a){a=this._getIndex(a);var b=this,c=this.options;return a!=c.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),c.disabled.push(a),c.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a]))),this},select:function(a){a=this._getIndex(a);if(a==-1)if(this.options.collapsible&&this.options.selected!=-1)a=this.options.selected;else return this;return this.anchors.eq(a).trigger(this.options.event+".tabs"),this},load:function(b){b=this._getIndex(b);var c=this,d=this.options,e=this.anchors.eq(b)[0],f=a.data(e,"load.tabs");this.abort();if(!f||this.element.queue("tabs").length!==0&&a.data(e,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(b).addClass("ui-state-processing");if(d.spinner){var g=a("span",e);g.data("label.tabs",g.html()).html(d.spinner)}return this.xhr=a.ajax(a.extend({},d.ajaxOptions,{url:f,success:function(f,g){c.element.find(c._sanitizeSelector(e.hash)).html(f),c._cleanup(),d.cache&&a.data(e,"cache.tabs",!0),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.success(f,g)}catch(h){}},error:function(a,f,g){c._cleanup(),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.error(a,f,b,e)}catch(g){}}})),c.element.dequeue("tabs"),this}},abort:function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("tabs",this.element.queue("tabs").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._cleanup(),this},url:function(a,b){return this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",b),this},length:function(){return this.anchors.length}}),a.extend(a.ui.tabs,{version:"1.8.18"}),a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(a,b){var c=this,d=this.options,e=c._rotate||(c._rotate=function(b){clearTimeout(c.rotation),c.rotation=setTimeout(function(){var a=d.selected;c.select(++a<c.anchors.length?a:0)},a),b&&b.stopPropagation()}),f=c._unrotate||(c._unrotate=b?function(a){t=d.selected,e()}:function(a){a.clientX&&c.rotate(null)});return a?(this.element.bind("tabsshow",e),this.anchors.bind(d.event+".tabs",f),e()):(clearTimeout(c.rotation),this.element.unbind("tabsshow",e),this.anchors.unbind(d.event+".tabs",f),delete this._rotate,delete this._unrotate),this}})}(jQuery),function($,undefined){function isArray(a){return a&&($.browser.safari&&typeof a=="object"&&a.length||a.constructor&&a.constructor.toString().match(/\Array\(\)/))}function extendRemove(a,b){$.extend(a,b);for(var c in b)if(b[c]==null||b[c]==undefined)a[c]=b[c];return a}function bindHover(a){var b="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return a.bind("mouseout",function(a){var c=$(a.target).closest(b);!c.length||c.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(c){var d=$(c.target).closest(b);!$.datepicker._isDisabledDatepicker(instActive.inline?a.parent()[0]:instActive.input[0])&&!!d.length&&(d.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),d.addClass("ui-state-hover"),d.hasClass("ui-datepicker-prev")&&d.addClass("ui-datepicker-prev-hover"),d.hasClass("ui-datepicker-next")&&d.addClass("ui-datepicker-next-hover"))})}function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend($.ui,{datepicker:{version:"1.8.18"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return extendRemove(this._defaults,a||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(a,b){var c=a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:c,input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(a,b){var c=$(a);b.append=$([]),b.trigger=$([]),c.hasClass(this.markerClassName)||(this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),$.data(a,PROP_NAME,b),b.settings.disabled&&this._disableDatepicker(a))},_attachments:function(a,b){var c=this._get(b,"appendText"),d=this._get(b,"isRTL");b.append&&b.append.remove(),c&&(b.append=$('<span class="'+this._appendClass+'">'+c+"</span>"),a[d?"before":"after"](b.append)),a.unbind("focus",this._showDatepicker),b.trigger&&b.trigger.remove();var e=this._get(b,"showOn");(e=="focus"||e=="both")&&a.focus(this._showDatepicker);if(e=="button"||e=="both"){var f=this._get(b,"buttonText"),g=this._get(b,"buttonImage");b.trigger=$(this._get(b,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:g,alt:f,title:f}):$('<button type="button"></button>').addClass(this._triggerClass).html(g==""?f:$("<img/>").attr({src:g,alt:f,title:f}))),a[d?"before":"after"](b.trigger),b.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==a[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=a[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(a[0])):$.datepicker._showDatepicker(a[0]),!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){var b=0,c=0;for(var d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort"))),b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=$(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),$.data(a,PROP_NAME,b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),b.dpDiv.css("display","block"))},_dialogDatepicker:function(a,b,c,d,e){var f=this._dialogInst;if(!f){this.uuid+=1;var g="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+g+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),f=this._dialogInst=this._newInst(this._dialogInput,!1),f.settings={},$.data(this._dialogInput[0],PROP_NAME,f)}extendRemove(f.settings,d||{}),b=b&&b.constructor==Date?this._formatDate(f,b):b,this._dialogInput.val(b),this._pos=e?e.length?e:[e.pageX,e.pageY]:null;if(!this._pos){var h=document.documentElement.clientWidth,i=document.documentElement.clientHeight,j=document.documentElement.scrollLeft||document.body.scrollLeft,k=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[h/2-100+j,i/2-150+k]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),f.settings.onSelect=c,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,f),this},_destroyDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();$.removeData(a,PROP_NAME),d=="input"?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(d=="div"||d=="span")&&b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();if(d=="input")a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().removeClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();if(d=="input")a.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().addClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b}),this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return $.data(a,PROP_NAME)}catch(b){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(a,b,c){var d=this._getInst(a);if(arguments.length==2&&typeof b=="string")return b=="defaults"?$.extend({},$.datepicker._defaults):d?b=="all"?$.extend({},d.settings):this._get(d,b):null;var e=b||{};typeof b=="string"&&(e={},e[b]=c);if(d){this._curInst==d&&this._hideDatepicker();var f=this._getDateDatepicker(a,!0),g=this._getMinMaxDate(d,"min"),h=this._getMinMaxDate(d,"max");extendRemove(d.settings,e),g!==null&&e.dateFormat!==undefined&&e.minDate===undefined&&(d.settings.minDate=this._formatDate(d,g)),h!==null&&e.dateFormat!==undefined&&e.maxDate===undefined&&(d.settings.maxDate=this._formatDate(d,h)),this._attachments($(a),d),this._autoSize(d),this._setDate(d,f),this._updateAlternate(d),this._updateDatepicker(d)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(a){var b=$.datepicker._getInst(a.target),c=!0,d=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if($.datepicker._datepickerShowing)switch(a.keyCode){case 9:$.datepicker._hideDatepicker(),c=!1;break;case 13:var e=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",b.dpDiv);e[0]&&$.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,e[0]);var f=$.datepicker._get(b,"onSelect");if(f){var g=$.datepicker._formatDate(b);f.apply(b.input?b.input[0]:null,[g,b])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(a.target,a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&$.datepicker._clearDate(a.target),c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&$.datepicker._gotoToday(a.target),c=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?1:-1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,-7,"D"),c=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?-1:1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,7,"D"),c=a.ctrlKey||a.metaKey;break;default:c=!1}else a.keyCode==36&&a.ctrlKey?$.datepicker._showDatepicker(this):c=!1;c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=$.datepicker._getInst(a.target);if($.datepicker._get(b,"constrainInput")){var c=$.datepicker._possibleChars($.datepicker._get(b,"dateFormat")),d=String.fromCharCode(a.charCode==undefined?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||d<" "||!c||c.indexOf(d)>-1}},_doKeyUp:function(a){var b=$.datepicker._getInst(a.target);if(b.input.val()!=b.lastVal)try{var c=$.datepicker.parseDate($.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,$.datepicker._getFormatConfig(b));c&&($.datepicker._setDateFromField(b),$.datepicker._updateAlternate(b),$.datepicker._updateDatepicker(b))}catch(a){$.datepicker.log(a)}return!0},_showDatepicker:function(a){a=a.target||a,a.nodeName.toLowerCase()!="input"&&(a=$("input",a.parentNode)[0]);if(!$.datepicker._isDisabledDatepicker(a)&&$.datepicker._lastInput!=a){var b=$.datepicker._getInst(a);$.datepicker._curInst&&$.datepicker._curInst!=b&&($.datepicker._curInst.dpDiv.stop(!0,!0),b&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var c=$.datepicker._get(b,"beforeShow"),d=c?c.apply(a,[a,b]):{};if(d===!1)return;extendRemove(b.settings,d),b.lastVal=null,$.datepicker._lastInput=a,$.datepicker._setDateFromField(b),$.datepicker._inDialog&&(a.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(a),$.datepicker._pos[1]+=a.offsetHeight);var e=!1;$(a).parents().each(function(){return e|=$(this).css("position")=="fixed",!e}),e&&$.browser.opera&&($.datepicker._pos[0]-=document.documentElement.scrollLeft,$.datepicker._pos[1]-=document.documentElement.scrollTop);var f={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(b),f=$.datepicker._checkOffset(b,f,e),b.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":e?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});if(!b.inline){var g=$.datepicker._get(b,"showAnim"),h=$.datepicker._get(b,"duration"),i=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(!!a.length){var c=$.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex($(a).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects[g]?b.dpDiv.show(g,$.datepicker._get(b,"showOptions"),h,i):b.dpDiv[g||"show"](g?h:null,i),(!g||!h)&&i(),b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus(),$.datepicker._curInst=b}}},_updateDatepicker:function(a){var b=this;b.maxRows=4;var c=$.datepicker._getBorders(a.dpDiv);instActive=a,a.dpDiv.empty().append(this._generateHTML(a));var d=a.dpDiv.find("iframe.ui-datepicker-cover");!d.length||d.css({left:-c[0],top:-c[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()}),a.dpDiv.find("."+this._dayOverClass+" a").mouseover();var e=this._getNumberOfMonths(a),f=e[1],g=17;a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),f>1&&a.dpDiv.addClass("ui-datepicker-multi-"+f).css("width",g*f+"em"),a.dpDiv[(e[0]!=1||e[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),a==$.datepicker._curInst&&$.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement&&a.input.focus();if(a.yearshtml){var h=a.yearshtml;setTimeout(function(){h===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml),h=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var d=a.dpDiv.outerWidth(),e=a.dpDiv.outerHeight(),f=a.input?a.input.outerWidth():0,g=a.input?a.input.outerHeight():0,h=document.documentElement.clientWidth+$(document).scrollLeft(),i=document.documentElement.clientHeight+$(document).scrollTop();return b.left-=this._get(a,"isRTL")?d-f:0,b.left-=c&&b.left==a.input.offset().left?$(document).scrollLeft():0,b.top-=c&&b.top==a.input.offset().top+g?$(document).scrollTop():0,b.left-=Math.min(b.left,b.left+d>h&&h>d?Math.abs(b.left+d-h):0),b.top-=Math.min(b.top,b.top+e>i&&i>e?Math.abs(e+g):0),b},_findPos:function(a){var b=this._getInst(a),c=this._get(b,"isRTL");while(a&&(a.type=="hidden"||a.nodeType!=1||$.expr.filters.hidden(a)))a=a[c?"previousSibling":"nextSibling"];var d=$(a).offset();return[d.left,d.top]},_hideDatepicker:function(a){var b=this._curInst;if(!(!b||a&&b!=$.data(a,PROP_NAME))&&this._datepickerShowing){var c=this._get(b,"showAnim"),d=this._get(b,"duration"),e=this,f=function(){$.datepicker._tidyDialog(b),e._curInst=null};$.effects&&$.effects[c]?b.dpDiv.hide(c,$.datepicker._get(b,"showOptions"),d,f):b.dpDiv[c=="slideDown"?"slideUp":c=="fadeIn"?"fadeOut":"hide"](c?d:null,f),c||f(),this._datepickerShowing=!1;var g=this._get(b,"onClose");g&&g.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){if(!!$.datepicker._curInst){var b=$(a.target),c=$.datepicker._getInst(b[0]);(b[0].id!=$.datepicker._mainDivId&&b.parents("#"+$.datepicker._mainDivId).length==0&&!b.hasClass($.datepicker.markerClassName)&&!b.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||b.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=c)&&$.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){var d=$(a),e=this._getInst(d[0]);this._isDisabledDatepicker(d[0])||(this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e))},_gotoToday:function(a){var b=$(a),c=this._getInst(b[0]);if(this._get(c,"gotoCurrent")&&c.currentDay)c.selectedDay=c.currentDay,c.drawMonth=c.selectedMonth=c.currentMonth,c.drawYear=c.selectedYear=c.currentYear;else{var d=new Date;c.selectedDay=d.getDate(),c.drawMonth=c.selectedMonth=d.getMonth(),c.drawYear=c.selectedYear=d.getFullYear()}this._notifyChange(c),this._adjustDate(b)},_selectMonthYear:function(a,b,c){var d=$(a),e=this._getInst(d[0]);e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(e),this._adjustDate(d)},_selectDay:function(a,b,c,d){var e=$(a);if(!$(d).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(e[0])){var f=this._getInst(e[0]);f.selectedDay=f.currentDay=$("a",d).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear))}},_clearDate:function(a){var b=$(a),c=this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(a,b){var c=$(a),d=this._getInst(c[0]);b=b!=null?b:this._formatDate(d),d.input&&d.input.val(b),this._updateAlternate(d);var e=this._get(d,"onSelect");e?e.apply(d.input?d.input[0]:null,[b,d]):d.input&&d.input.trigger("change"),d.inline?this._updateDatepicker(d):(this._hideDatepicker(),this._lastInput=d.input[0],typeof d.input[0]!="object"&&d.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),d=this._getDate(a),e=this.formatDate(c,d,this._getFormatConfig(a));$(b).each(function(){$(this).val(e)})}},noWeekends:function(a){var b=a.getDay();return[b>0&&b<6,""]},iso8601Week:function(a){var b=new Date(a.getTime());b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1},parseDate:function(a,b,c){if(a==null||b==null)throw"Invalid arguments";b=typeof b=="object"?b.toString():b+"";if(b=="")return null;var d=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;d=typeof d!="string"?d:(new Date).getFullYear()%100+parseInt(d,10);var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=-1,j=-1,k=-1,l=-1,m=!1,n=function(b){var c=s+1<a.length&&a.charAt(s+1)==b;return c&&s++,c},o=function(a){var c=n(a),d=a=="@"?14:a=="!"?20:a=="y"&&c?4:a=="o"?3:2,e=new RegExp("^\\d{1,"+d+"}"),f=b.substring(r).match(e);if(!f)throw"Missing number at position "+r;return r+=f[0].length,parseInt(f[0],10)},p=function(a,c,d){var e=$.map(n(a)?d:c,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),f=-1;$.each(e,function(a,c){var d=c[1];if(b.substr(r,d.length).toLowerCase()==d.toLowerCase())return f=c[0],r+=d.length,!1});if(f!=-1)return f+1;throw"Unknown name at position "+r},q=function(){if(b.charAt(r)!=a.charAt(s))throw"Unexpected literal at position "+r;r++},r=0;for(var s=0;s<a.length;s++)if(m)a.charAt(s)=="'"&&!n("'")?m=!1:q();else switch(a.charAt(s)){case"d":k=o("d");break;case"D":p("D",e,f);break;case"o":l=o("o");break;case"m":j=o("m");break;case"M":j=p("M",g,h);break;case"y":i=o("y");break;case"@":var t=new Date(o("@"));i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"!":var t=new Date((o("!")-this._ticksTo1970)/1e4);i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"'":n("'")?q():m=!0;break;default:q()}if(r<b.length)throw"Extra/unparsed characters found in date: "+b.substring(r);i==-1?i=(new Date).getFullYear():i<100&&(i+=(new Date).getFullYear()-(new Date).getFullYear()%100+(i<=d?0:-100));if(l>-1){j=1,k=l;for(;;){var u=this._getDaysInMonth(i,j-1);if(k<=u)break;j++,k-=u}}var t=this._daylightSavingAdjust(new Date(i,j-1,k));if(t.getFullYear()!=i||t.getMonth()+1!=j||t.getDate()!=k)throw"Invalid date";return t},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,f=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,h=function(b){var c=m+1<a.length&&a.charAt(m+1)==b;return c&&m++,c},i=function(a,b,c){var d=""+b;if(h(a))while(d.length<c)d="0"+d;return d},j=function(a,b,c,d){return h(a)?d[b]:c[b]},k="",l=!1;if(b)for(var m=0;m<a.length;m++)if(l)a.charAt(m)=="'"&&!h("'")?l=!1:k+=a.charAt(m);else switch(a.charAt(m)){case"d":k+=i("d",b.getDate(),2);break;case"D":k+=j("D",b.getDay(),d,e);break;case"o":k+=i("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":k+=i("m",b.getMonth()+1,2);break;case"M":k+=j("M",b.getMonth(),f,g);break;case"y":k+=h("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":k+=b.getTime();break;case"!":k+=b.getTime()*1e4+this._ticksTo1970;break;case"'":h("'")?k+="'":l=!0;break;default:k+=a.charAt(m)}return k},_possibleChars:function(a){var b="",c=!1,d=function(b){var c=e+1<a.length&&a.charAt(e+1)==b;return c&&e++,c};for(var e=0;e<a.length;e++)if(c)a.charAt(e)=="'"&&!d("'")?c=!1:b+=a.charAt(e);else switch(a.charAt(e)){case"d":case"m":case"y":case"@":b+="0123456789";break;case"D":case"M":return null;case"'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(e)}return b},_get:function(a,b){return a.settings[b]!==undefined?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e,f;e=f=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(c,d,g)||f}catch(h){this.log(h),d=b?"":d}a.selectedDay=e.getDate(),a.drawMonth=a.selectedMonth=e.getMonth(),a.drawYear=a.selectedYear=e.getFullYear(),a.currentDay=d?e.getDate():0,a.currentMonth=d?e.getMonth():0,a.currentYear=d?e.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var d=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},e=function(b){try{return $.datepicker.parseDate($.datepicker._get(a,"dateFormat"),b,$.datepicker._getFormatConfig(a))}catch(c){}var d=(b.toLowerCase().match(/^c/)?$.datepicker._getDate(a):null)||new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(b);while(i){switch(i[2]||"d"){case"d":case"D":g+=parseInt(i[1],10);break;case"w":case"W":g+=parseInt(i[1],10)*7;break;case"m":case"M":f+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,f));break;case"y":case"Y":e+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,f))}i=h.exec(b)}return new Date(e,f,g)},f=b==null||b===""?c:typeof b=="string"?e(b):typeof b=="number"?isNaN(b)?c:d(b):new Date(b.getTime());return f=f&&f.toString()=="Invalid Date"?c:f,f&&(f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0)),this._daylightSavingAdjust(f)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),(e!=a.selectedMonth||f!=a.selectedYear)&&!c&&this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),d=this._get(a,"showButtonPanel"),e=this._get(a,"hideIfNoPrevNext"),f=this._get(a,"navigationAsDateFormat"),g=this._getNumberOfMonths(a),h=this._get(a,"showCurrentAtPos"),i=this._get(a,"stepMonths"),j=g[0]!=1||g[1]!=1,k=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),l=this._getMinMaxDate(a,"min"),m=this._getMinMaxDate(a,"max"),n=a.drawMonth-h,o=a.drawYear;n<0&&(n+=12,o--);if(m){var p=this._daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth()-g[0]*g[1]+1,m.getDate()));p=l&&p<l?l:p;while(this._daylightSavingAdjust(new Date(o,n,1))>p)n--,n<0&&(n=11,o--)}a.drawMonth=n,a.drawYear=o;var q=this._get(a,"prevText");q=f?this.formatDate(q,this._daylightSavingAdjust(new Date(o,n-i,1)),this._getFormatConfig(a)):q;var r=this._canAdjustMonth(a,-1,o,n)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+a.id+"', -"+i+", 'M');\""+' title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>":e?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>",s=this._get(a,"nextText");s=f?this.formatDate(s,this._daylightSavingAdjust(new Date(o,n+i,1)),this._getFormatConfig(a)):s;var t=this._canAdjustMonth(a,1,o,n)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+a.id+"', +"+i+", 'M');\""+' title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>":e?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>",u=this._get(a,"currentText"),v=this._get(a,"gotoCurrent")&&a.currentDay?k:b;u=f?this.formatDate(u,v,this._getFormatConfig(a)):u;var w=a.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+dpuuid+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>",x=d?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?w:"")+(this._isInRange(a,v)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+a.id+"');\""+">"+u+"</button>":"")+(c?"":w)+"</div>":"",y=parseInt(this._get(a,"firstDay"),10);y=isNaN(y)?0:y;var z=this._get(a,"showWeek"),A=this._get(a,"dayNames"),B=this._get(a,"dayNamesShort"),C=this._get(a,"dayNamesMin"),D=this._get(a,"monthNames"),E=this._get(a,"monthNamesShort"),F=this._get(a,"beforeShowDay"),G=this._get(a,"showOtherMonths"),H=this._get(a,"selectOtherMonths"),I=this._get(a,"calculateWeek")||this.iso8601Week,J=this._getDefaultDate(a),K="";for(var L=0;L<g[0];L++){var M="";this.maxRows=4;for(var N=0;N<g[1];N++){var O=this._daylightSavingAdjust(new Date(o,n,a.selectedDay)),P=" ui-corner-all",Q="";if(j){Q+='<div class="ui-datepicker-group';if(g[1]>1)switch(N){case 0:Q+=" ui-datepicker-group-first",P=" ui-corner-"+(c?"right":"left");break;case g[1]-1:Q+=" ui-datepicker-group-last",P=" ui-corner-"+(c?"left":"right");break;default:Q+=" ui-datepicker-group-middle",P=""}Q+='">'}Q+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+P+'">'+(/all|left/.test(P)&&L==0?c?t:r:"")+(/all|right/.test(P)&&L==0?c?r:t:"")+this._generateMonthYearHeader(a,n,o,l,m,L>0||N>0,D,E)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";var R=z?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(var S=0;S<7;S++){var T=(S+y)%7;R+="<th"+((S+y+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+A[T]+'">'+C[T]+"</span></th>"}Q+=R+"</tr></thead><tbody>";var U=this._getDaysInMonth(o,n);o==a.selectedYear&&n==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,U));var V=(this._getFirstDayOfMonth(o,n)-y+7)%7,W=Math.ceil((V+U)/7),X=j?this.maxRows>W?this.maxRows:W:W;this.maxRows=X;var Y=this._daylightSavingAdjust(new Date(o,n,1-V));for(var Z=0;Z<X;Z++){Q+="<tr>";var _=z?'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(Y)+"</td>":"";for(var S=0;S<7;S++){var ba=F?F.apply(a.input?a.input[0]:null,[Y]):[!0,""],bb=Y.getMonth()!=n,bc=bb&&!H||!ba[0]||l&&Y<l||m&&Y>m;_+='<td class="'+((S+y+6)%7>=5?" ui-datepicker-week-end":"")+(bb?" ui-datepicker-other-month":"")+(Y.getTime()==O.getTime()&&n==a.selectedMonth&&a._keyEvent||J.getTime()==Y.getTime()&&J.getTime()==O.getTime()?" "+this._dayOverClass:"")+(bc?" "+this._unselectableClass+" ui-state-disabled":"")+(bb&&!G?"":" "+ba[1]+(Y.getTime()==k.getTime()?" "+this._currentClass:"")+(Y.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!bb||G)&&ba[2]?' title="'+ba[2]+'"':"")+(bc?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+a.id+"',"+Y.getMonth()+","+Y.getFullYear()+', this);return false;"')+">"+(bb&&!G?"&#xa0;":bc?'<span class="ui-state-default">'+Y.getDate()+"</span>":'<a class="ui-state-default'+(Y.getTime()==b.getTime()?" ui-state-highlight":"")+(Y.getTime()==k.getTime()?" ui-state-active":"")+(bb?" ui-priority-secondary":"")+'" href="#">'+Y.getDate()+"</a>")+"</td>",Y.setDate(Y.getDate()+1),Y=this._daylightSavingAdjust(Y)}Q+=_+"</tr>"}n++,n>11&&(n=0,o++),Q+="</tbody></table>"+(j?"</div>"+(g[0]>0&&N==g[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),M+=Q}K+=M}return K+=x+($.browser.msie&&parseInt($.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),a._keyEvent=!1,K},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i=this._get(a,"changeMonth"),j=this._get(a,"changeYear"),k=this._get(a,"showMonthAfterYear"),l='<div class="ui-datepicker-title">',m="";if(f||!i)m+='<span class="ui-datepicker-month">'+g[b]+"</span>";else{var n=d&&d.getFullYear()==c,o=e&&e.getFullYear()==c;m+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" "+">";for(var p=0;p<12;p++)(!n||p>=d.getMonth())&&(!o||p<=e.getMonth())&&(m+='<option value="'+p+'"'+(p==b?' selected="selected"':"")+">"+h[p]+"</option>");m+="</select>"}k||(l+=m+(f||!i||!j?"&#xa0;":""));if(!a.yearshtml){a.yearshtml="";if(f||!j)l+='<span class="ui-datepicker-year">'+c+"</span>";else{var q=this._get(a,"yearRange").split(":"),r=(new Date).getFullYear(),s=function(a){var b=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?r+parseInt(a,10):parseInt(a,10);return isNaN(b)?r:b},t=s(q[0]),u=Math.max(t,s(q[1]||""));t=d?Math.max(t,d.getFullYear()):t,u=e?Math.min(u,e.getFullYear()):u,a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" "+">";for(;t<=u;t++)a.yearshtml+='<option value="'+t+'"'+(t==c?' selected="selected"':"")+">"+t+"</option>";a.yearshtml+="</select>",l+=a.yearshtml,a.yearshtml=null}}return l+=this._get(a,"yearSuffix"),k&&(l+=(f||!i||!j?"&#xa0;":"")+m),l+="</div>",l},_adjustInstDate:function(a,b,c){var d=a.drawYear+(c=="Y"?b:0),e=a.drawMonth+(c=="M"?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+(c=="D"?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),(c=="M"||c=="Y")&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&b<c?c:b;return e=d&&e>d?d:e,e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return b==null?[1,1]:typeof b=="number"?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(b<0?b:e[0]*e[1]),1));return b<0&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(a,f)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!d||b.getTime()<=d.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),$.fn.datepicker=function(a){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv),$.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);return typeof a!="string"||a!="isDisabled"&&a!="getDate"&&a!="widget"?a=="option"&&arguments.length==2&&typeof arguments[1]=="string"?$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b)):this.each(function(){typeof a=="string"?$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this].concat(b)):$.datepicker._attachDatepicker(this,a)}):$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.8.18",window["DP_jQuery_"+dpuuid]=$}(jQuery),function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove(),a.Widget.prototype.destroy.apply(this,arguments)},value:function(a){return a===b?this._value():(this._setOption("value",a),this)},_setOption:function(b,c){b==="value"&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;return typeof a!="number"&&(a=0),Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change")),this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%"),this.element.attr("aria-valuenow",a)}}),a.extend(a.ui.progressbar,{version:"1.8.18"})}(jQuery),jQuery.effects||function(a,b){function c(b){return!b||typeof b=="number"||a.fx.speeds[b]?!0:typeof b=="string"&&!a.effects[b]?!0:!1}function d(b,c,d,e){typeof b=="object"&&(e=c,d=null,c=b,b=c.effect),a.isFunction(c)&&(e=c,d=null,c={});if(typeof c=="number"||a.fx.speeds[c])e=d,d=c,c={};return a.isFunction(d)&&(e=d,d=null),c=c||{},d=d||c.duration,d=a.fx.off?0:typeof d=="number"?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,e=e||c.complete,[b,c,d,e]}function e(a,b){var c={_:0},d;for(d in b)a[d]!=b[d]&&(c[d]=b[d]);return c}function f(b){var c,d;for(c in b)d=b[c],(d==null||a.isFunction(d)||c in l||/scrollbar/.test(c)||!/color/i.test(c)&&isNaN(parseFloat(d)))&&delete b[c];return b}function g(){var a=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,d;if(a&&a.length&&a[0]&&a[a[0]]){var e=a.length;while(e--)c=a[e],typeof a[c]=="string"&&(d=c.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),b[d]=a[c])}else for(c in a)typeof a[c]=="string"&&(b[c]=a[c]);return b}function h(b,c){var d;do{d=a.curCSS(b,c);if(d!=""&&d!="transparent"||a.nodeName(b,"body"))break;c="backgroundColor"}while(b=b.parentNode);return i(d)}function i(b){var c;return b&&b.constructor==Array&&b.length==3?b:(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))?[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]:(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))?[parseFloat(c[1])*2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55]:(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))?[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]:(c=/rgba\(0, 0, 0, 0\)/.exec(b))?j.transparent:j[a.trim(b).toLowerCase()]}a.effects={},a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(b,c){a.fx.step[c]=function(a){a.colorInit||(a.start=h(a.elem,c),a.end=i(a.end),a.colorInit=!0),a.elem.style[c]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var j={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},k=["add","remove","toggle"],l={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.effects.animateClass=function(b,c,d,h){return a.isFunction(d)&&(h=d,d=null),this.queue(function(){var i=a(this),j=i.attr("style")||" ",l=f(g.call(this)),m,n=i.attr("class");a.each(k,function(a,c){b[c]&&i[c+"Class"](b[c])}),m=f(g.call(this)),i.attr("class",n),i.animate(e(l,m),{queue:!1,duration:c,easing:d,complete:function(){a.each(k,function(a,c){b[c]&&i[c+"Class"](b[c])}),typeof i.attr("style")=="object"?(i.attr("style").cssText="",i.attr("style").cssText=j):i.attr("style",j),h&&h.apply(this,arguments),a.dequeue(this)}})})},a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{add:b},c,d,e]):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{remove:b},c,d,e]):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,g){return typeof d=="boolean"||d===b?e?a.effects.animateClass.apply(this,[d?{add:c}:{remove:c},e,f,g]):this._toggleClass(c,d):a.effects.animateClass.apply(this,[{toggle:c},d,e,f])},switchClass:function(b,c,d,e,f){return a.effects.animateClass.apply(this,[{add:c,remove:b},d,e,f])}}),a.extend(a.effects,{version:"1.8.18",save:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.data("ec.storage."+b[c],a[0].style[b[c]])},restore:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.css(b[c],a.data("ec.storage."+b[c]))},setMode:function(a,b){return b=="toggle"&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e=document.activeElement;return b.wrap(d),(b[0]===e||a.contains(b[0],e))&&a(e).focus(),d=b.parent(),b.css("position")=="static"?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),d.css(c).show()},removeWrapper:function(b){var c,d=document.activeElement;return b.parent().is(".ui-effects-wrapper")?(c=b.parent().replaceWith(b),(b[0]===d||a.contains(b[0],d))&&a(d).focus(),c):b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){unit=b.cssUnit(c),unit[0]>0&&(e[c]=unit[0]*d+unit[1])}),e}}),a.fn.extend({effect:function(b,c,e,f){var g=d.apply(this,arguments),h={options:g[1],duration:g[2],callback:g[3]},i=h.options.mode,j=a.effects[b];return a.fx.off||!j?i?this[i](h.duration,h.callback):this.each(function(){h.callback&&h.callback.call(this)}):j.call(this,h)},_show:a.fn.show,show:function(a){if(c(a))return this._show.apply(this,arguments);var b=d.apply(this,arguments);return b[1].mode="show",this.effect.apply(this,b)},_hide:a.fn.hide,hide:function(a){if(c(a))return this._hide.apply(this,arguments);var b=d.apply(this,arguments);return b[1].mode="hide",this.effect.apply(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(c(b)||typeof b=="boolean"||a.isFunction(b))return this.__toggle.apply(this,arguments);var e=d.apply(this,arguments);return e[1].mode="toggle",this.effect.apply(this,e)},cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}}),a.easing.jswing=a.easing.swing,a.extend(a.easing,{def:"easeOutQuad",swing:function(b,c,d,e,f){return a.easing[a.easing.def](b,c,d,e,f)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b==0?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;g||(g=e*.3*1.5);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c},easeInBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),e*(c/=f)*c*((g+1)*c-g)+d},easeOutBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),e*((c=c/f-1)*c*((g+1)*c+g)+1)+d},easeInOutBack:function(a,c,d,e,f,g){return g==b&&(g=1.70158),(c/=f/2)<1?e/2*c*c*(((g*=1.525)+1)*c-g)+d:e/2*((c-=2)*c*(((g*=1.525)+1)*c+g)+2)+d},easeInBounce:function(b,c,d,e,f){return e-a.easing.easeOutBounce(b,f-c,0,e,f)+d},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(b,c,d,e,f){return c<f/2?a.easing.easeInBounce(b,c*2,0,e,f)*.5+d:a.easing.easeOutBounce(b,c*2-f,0,e,f)*.5+e*.5+d}})}(jQuery),function(a,b){a.effects.blind=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.direction||"vertical";a.effects.save(c,d),c.show();var g=a.effects.createWrapper(c).css({overflow:"hidden"}),h=f=="vertical"?"height":"width",i=f=="vertical"?g.height():g.width();e=="show"&&g.css(h,0);var j={};j[h]=e=="show"?i:0,g.animate(j,b.duration,b.options.easing,function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}}(jQuery),function(a,b){a.effects.bounce=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"effect"),f=b.options.direction||"up",g=b.options.distance||20,h=b.options.times||5,i=b.duration||250;/show|hide/.test(e)&&d.push("opacity"),a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var j=f=="up"||f=="down"?"top":"left",k=f=="up"||f=="left"?"pos":"neg",g=b.options.distance||(j=="top"?c.outerHeight({margin:!0})/3:c.outerWidth({margin:!0})/3);e=="show"&&c.css("opacity",0).css(j,k=="pos"?-g:g),e=="hide"&&(g/=h*2),e!="hide"&&h--;if(e=="show"){var l={opacity:1};l[j]=(k=="pos"?"+=":"-=")+g,c.animate(l,i/2,b.options.easing),g/=2,h--}for(var m=0;m<h;m++){var n={},o={};n[j]=(k=="pos"?"-=":"+=")+g,o[j]=(k=="pos"?"+=":"-=")+g,c.animate(n,i/2,b.options.easing).animate(o,i/2,b.options.easing),g=e=="hide"?g*2:g/2}if(e=="hide"){var l={opacity:0};l[j]=(k=="pos"?"-=":"+=")+g,c.animate(l,i/2,b.options.easing,function(){c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})}else{var n={},o={};n[j]=(k=="pos"?"-=":"+=")+g,o[j]=(k=="pos"?"+=":"-=")+g,c.animate(n,i/2,b.options.easing).animate(o,i/2,b.options.easing,function(){a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})}c.queue("fx",function(){c.dequeue()}),c.dequeue()})}}(jQuery),function(a,b){a.effects.clip=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right","height","width"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.direction||"vertical";a.effects.save(c,d),c.show();var g=a.effects.createWrapper(c).css({overflow:"hidden"}),h=c[0].tagName=="IMG"?g:c,i={size:f=="vertical"?"height":"width",position:f=="vertical"?"top":"left"},j=f=="vertical"?h.height():h.width();e=="show"&&(h.css(i.size,0),h.css(i.position,j/2));var k={};k[i.size]=e=="show"?j:0,k[i.position]=e=="show"?0:j/2,h.animate(k,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()}})})}}(jQuery),function(a,b){a.effects.drop=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right","opacity"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.direction||"left";a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var g=f=="up"||f=="down"?"top":"left",h=f=="up"||f=="left"?"pos":"neg",i=b.options.distance||(g=="top"?c.outerHeight({margin:!0})/2:c.outerWidth({margin:!0})/2);e=="show"&&c.css("opacity",0).css(g,h=="pos"?-i:i);var j={opacity:e=="show"?1:0};j[g]=(e=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+i,c.animate(j,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}}(jQuery),function(a,b){a.effects.explode=function(b){return this.queue(function(){var c=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3,d=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3;b.options.mode=b.options.mode=="toggle"?a(this).is(":visible")?"hide":"show":b.options.mode;var e=a(this).show().css("visibility","hidden"),f=e.offset();f.top-=parseInt(e.css("marginTop"),10)||0,f.left-=parseInt(e.css("marginLeft"),10)||0;var g=e.outerWidth(!0),h=e.outerHeight(!0);for(var i=0;i<c;i++)for(var j=0;j<d;j++)e.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*(g/d),top:-i*(h/c)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:g/d,height:h/c,left:f.left+j*(g/d)+(b.options.mode=="show"?(j-Math.floor(d/2))*(g/d):0),top:f.top+i*(h/c)+(b.options.mode=="show"?(i-Math.floor(c/2))*(h/c):0),opacity:b.options.mode=="show"?0:1}).animate({left:f.left+j*(g/d)+(b.options.mode=="show"?0:(j-Math.floor(d/2))*(g/d)),top:f.top+i*(h/c)+(b.options.mode=="show"?0:(i-Math.floor(c/2))*(h/c)),opacity:b.options.mode=="show"?1:0},b.duration||500);setTimeout(function(){b.options.mode=="show"?e.css({visibility:"visible"}):e.css({visibility:"visible"}).hide(),b.callback&&b.callback.apply(e[0]),e.dequeue(),a("div.ui-effects-explode").remove()},b.duration||500)})}}(jQuery),function(a,b){a.effects.fade=function(b){return this.queue(function(){var c=a(this),d=a.effects.setMode(c,b.options.mode||"hide");c.animate({opacity:d},{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}}(jQuery),function(a,b){a.effects.fold=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.size||15,g=!!b.options.horizFirst,h=b.duration?b.duration/2:a.fx.speeds._default/2;a.effects.save(c,d),c.show();var i=a.effects.createWrapper(c).css({overflow:"hidden"}),j=e=="show"!=g,k=j?["width","height"]:["height","width"],l=j?[i.width(),i.height()]:[i.height(),i.width()],m=/([0-9]+)%/.exec(f);m&&(f=parseInt(m[1],10)/100*l[e=="hide"?0:1]),e=="show"&&i.css(g?{height:0,width:f}:{height:f,width:0});var n={},o={};n[k[0]]=e=="show"?l[0]:f,o[k[1]]=e=="show"?l[1]:0,i.animate(n,h,b.options.easing).animate(o,h,b.options.easing,function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}}(jQuery),function(a,b){a.effects.highlight=function(b){return this.queue(function(){var c=a(this),d=["backgroundImage","backgroundColor","opacity"],e=a.effects.setMode(c,b.options.mode||"show"),f={backgroundColor:c.css("backgroundColor")};e=="hide"&&(f.opacity=0),a.effects.save(c,d),c.show().css({backgroundImage:"none",backgroundColor:b.options.color||"#ffff99"}).animate(f,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),e=="show"&&!a.support.opacity&&this.style.removeAttribute("filter"),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}}(jQuery),function(a,b){a.effects.pulsate=function(b){return this.queue(function(){var c=a(this),d=a.effects.setMode(c,b.options.mode||"show");times=(b.options.times||5)*2-1,duration=b.duration?b.duration/2:a.fx.speeds._default/2,isVisible=c.is(":visible"),animateTo=0,isVisible||(c.css("opacity",0).show(),animateTo=1),(d=="hide"&&isVisible||d=="show"&&!isVisible)&&times--;for(var e=0;e<times;e++)c.animate({opacity:animateTo},duration,b.options.easing),animateTo=(animateTo+1)%2;c.animate({opacity:animateTo},duration,b.options.easing,function(){animateTo==0&&c.hide(),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}).dequeue()})}}(jQuery),function(a,b){a.effects.puff=function(b){return this.queue(function(){var c=a(this),d=a.effects.setMode(c,b.options.mode||"hide"),e=parseInt(b.options.percent,10)||150,f=e/100,g={height:c.height(),width:c.width()};a.extend(b.options,{fade:!0,mode:d,percent:d=="hide"?e:100,from:d=="hide"?g:{height:g.height*f,width:g.width*f}}),c.effect("scale",b.options,b.duration,b.callback),c.dequeue()})},a.effects.scale=function(b){return this.queue(function(){var c=a(this),d=a.extend(!0,{},b.options),e=a.effects.setMode(c,b.options.mode||"effect"),f=parseInt(b.options.percent,10)||(parseInt(b.options.percent,10)==0?0:e=="hide"?0:100),g=b.options.direction||"both",h=b.options.origin;e!="effect"&&(d.origin=h||["middle","center"],d.restore=!0);var i={height:c.height(),width:c.width()};c.from=b.options.from||(e=="show"?{height:0,width:0}:i);var j={y:g!="horizontal"?f/100:1,x:g!="vertical"?f/100:1};c.to={height:i.height*j.y,width:i.width*j.x},b.options.fade&&(e=="show"&&(c.from.opacity=0,c.to.opacity=1),e=="hide"&&(c.from.opacity=1,c.to.opacity=0)),d.from=c.from,d.to=c.to,d.mode=e,c.effect("size",d,b.duration,b.callback),c.dequeue()})},a.effects.size=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right","width","height","overflow","opacity"],e=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],g=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],j=a.effects.setMode(c,b.options.mode||"effect"),k=b.options.restore||!1,l=b.options.scale||"both",m=b.options.origin,n={height:c.height(),width:c.width()};c.from=b.options.from||n,c.to=b.options.to||n;if(m){var o=a.effects.getBaseline(m,n);c.from.top=(n.height-c.from.height)*o.y,c.from.left=(n.width-c.from.width)*o.x,c.to.top=(n.height-c.to.height)*o.y,c.to.left=(n.width-c.to.width)*o.x}var p={from:{y:c.from.height/n.height,x:c.from.width/n.width},to:{y:c.to.height/n.height,x:c.to.width/n.width}};if(l=="box"||l=="both")p.from.y!=p.to.y&&(d=d.concat(h),c.from=a.effects.setTransition(c,h,p.from.y,c.from),c.to=a.effects.setTransition(c,h,p.to.y,c.to)),p.from.x!=p.to.x&&(d=d.concat(i),c.from=a.effects.setTransition(c,i,p.from.x,c.from),c.to=a.effects.setTransition(c,i,p.to.x,c.to));(l=="content"||l=="both")&&p.from.y!=p.to.y&&(d=d.concat(g),c.from=a.effects.setTransition(c,g,p.from.y,c.from),c.to=a.effects.setTransition(c,g,p.to.y,c.to)),a.effects.save(c,k?d:e),c.show(),a.effects.createWrapper(c),c.css("overflow","hidden").css(c.from);if(l=="content"||l=="both")h=h.concat(["marginTop","marginBottom"]).concat(g),i=i.concat(["marginLeft","marginRight"]),f=d.concat(h).concat(i),c.find("*[width]").each(function(){child=a(this),k&&a.effects.save(child,f);var c={height:child.height(),width:child.width()};child.from={height:c.height*p.from.y,width:c.width*p.from.x},child.to={height:c.height*p.to.y,width:c.width*p.to.x},p.from.y!=p.to.y&&(child.from=a.effects.setTransition(child,h,p.from.y,child.from),child.to=a.effects.setTransition(child,h,p.to.y,child.to)),p.from.x!=p.to.x&&(child.from=a.effects.setTransition(child,i,p.from.x,child.from),child.to=a.effects.setTransition(child,i,p.to.x,child.to)),child.css(child.from),child.animate(child.to,b.duration,b.options.easing,function(){k&&a.effects.restore(child,f)})});c.animate(c.to,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){c.to.opacity===0&&c.css("opacity",c.from.opacity),j=="hide"&&c.hide(),a.effects.restore(c,k?d:e),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}}(jQuery),function(a,b){a.effects.shake=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"effect"),f=b.options.direction||"left",g=b.options.distance||20,h=b.options.times||3,i=b.duration||b.options.duration||140;a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var j=f=="up"||f=="down"?"top":"left",k=f=="up"||f=="left"?"pos":"neg",l={},m={},n={};l[j]=(k=="pos"?"-=":"+=")+g,m[j]=(k=="pos"?"+=":"-=")+g*2,n[j]=(k=="pos"?"-=":"+=")+g*2,c.animate(l,i,b.options.easing);for(var o=1;o<h;o++)c.animate(m,i,b.options.easing).animate(n,i,b.options.easing);c.animate(m,i,b.options.easing).animate(l,i/2,b.options.easing,function(){a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}),c.dequeue()})}}(jQuery),function(a,b){a.effects.slide=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"show"),f=b.options.direction||"left";a.effects.save(c,d),c.show(),a.effects.createWrapper(c).css({overflow:"hidden"});var g=f=="up"||f=="down"?"top":"left",h=f=="up"||f=="left"?"pos":"neg",i=b.options.distance||(g=="top"?c.outerHeight({margin:!0}):c.outerWidth({margin:!0}));e=="show"&&c.css(g,h=="pos"?isNaN(i)?"-"+i:-i:i);var j={};j[g]=(e=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+i,c.animate(j,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}}(jQuery),function(a,b){a.effects.transfer=function(b){return this.queue(function(){var c=a(this),d=a(b.options.to),e=d.offset(),f={top:e.top,left:e.left,height:d.innerHeight(),width:d.innerWidth()},g=c.offset(),h=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:g.top,left:g.left,height:c.innerHeight(),width:c.innerWidth(),position:"absolute"}).animate(f,b.duration,b.options.easing,function(){h.remove(),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}}(jQuery),define("lib/jquery-ui-1.8.18.custom.min",function(){}),function(a){a.widget("ui.selectmenu",{getter:"value",version:"1.8",eventPrefix:"selectmenu",options:{transferClasses:!0,typeAhead:"sequential",style:"dropdown",positionOptions:{my:"left top",at:"left bottom",offset:null},width:250,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null,bgImage:function(){},wrapperElement:""},_create:function(){var b=this,c=this.options,d=this.element.attr("id")||"ui-selectmenu-"+Math.random().toString(16).slice(2,10);this.ids=[d+"-button",d+"-menu"],this._safemouseup=!0,this.newelement=a('<a class="'+this.widgetBaseClass+' ui-widget ui-state-default ui-corner-all" id="'+this.ids[0]+'" role="button" href="#" tabindex="0" aria-haspopup="true" aria-owns="'+this.ids[1]+'"></a>').insertAfter(this.element),this.newelement.wrap(c.wrapperElement);var e=this.element.attr("tabindex");e&&this.newelement.attr("tabindex",e),this.newelement.data("selectelement",this.element),this.selectmenuIcon=a('<span class="'+this.widgetBaseClass+'-icon ui-icon"></span>').prependTo(this.newelement),this.newelement.prepend('<span class="'+b.widgetBaseClass+'-status" />'),a('label[for="'+d+'"]').attr("for",this.ids[0]).bind("click.selectmenu",function(){return b.newelement[0].focus(),!1}),this.newelement.bind("mousedown.selectmenu",function(a){return b._toggle(a,!0),c.style=="popup"&&(b._safemouseup=!1,setTimeout(function(){b._safemouseup=!0},300)),!1}).bind("click.selectmenu",function(){return!1}).bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.ENTER:d=!0;break;case a.ui.keyCode.SPACE:b._toggle(c);break;case a.ui.keyCode.UP:c.altKey?b.open(c):b._moveSelection(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.open(c):b._moveSelection(1);break;case a.ui.keyCode.LEFT:b._moveSelection(-1);break;case a.ui.keyCode.RIGHT:b._moveSelection(1);break;case a.ui.keyCode.TAB:d=!0;break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){return b._typeAhead(a.which,"mouseup"),!0}).bind("mouseover.selectmenu focus.selectmenu",function(){c.disabled||a(this).addClass(b.widgetBaseClass+"-focus ui-state-hover")}).bind("mouseout.selectmenu blur.selectmenu",function(){c.disabled||a(this).removeClass(b.widgetBaseClass+"-focus ui-state-hover")}),a(document).bind("mousedown.selectmenu",function(a){b.close(a)}),this.element.bind("click.selectmenu",function(){b._refreshValue()}).bind("focus.selectmenu",function(){b.newelement&&b.newelement[0].focus()}),c.width||(c.width=this.element.outerWidth()),this.newelement.width(c.width),this.element.hide(),this.list=a('<ul class="'+b.widgetBaseClass+'-menu ui-widget ui-widget-content" aria-hidden="true" role="listbox" aria-labelledby="'+this.ids[0]+'" id="'+this.ids[1]+'"></ul>').appendTo("body"),this.list.wrap(c.wrapperElement),this.list.bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.UP:c.altKey?b.close(c,!0):b._moveFocus(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.close(c,!0):b._moveFocus(1);break;case a.ui.keyCode.LEFT:b._moveFocus(-1);break;case a.ui.keyCode.RIGHT:b._moveFocus(1);break;case a.ui.keyCode.HOME:b._moveFocus(":first");break;case a.ui.keyCode.PAGE_UP:b._scrollPage("up");break;case a.ui.keyCode.PAGE_DOWN:b._scrollPage("down");break;case a.ui.keyCode.END:b._moveFocus(":last");break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:b.close(c,!0),a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.TAB:d=!0,b.close(c,!0),a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.ESCAPE:b.close(c,!0);break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){return b._typeAhead(a.which,"focus"),!0}).bind("mousedown.selectmenu mouseup.selectmenu",function(){return!1}),a(window).bind("resize.selectmenu",a.proxy(b._refreshPosition,this))},_init:function(){var b=this,c=this.options,d=[];this.element.find("option").each(function(){d.push({value:a(this).attr("value"),text:b._formatText(a(this).text()),selected:a(this).attr("selected"),disabled:a(this).attr("disabled"),classes:a(this).attr("class"),typeahead:a(this).attr("typeahead"),parentOptGroup:a(this).parent("optgroup"),bgImage:c.bgImage.call(a(this))})});var e=b.options.style=="popup"?" ui-state-active":"";this.list.html("");for(var f=0;f<d.length;f++){var g=a('<li role="presentation"'+(d[f].disabled?' class="'+this.namespace+"-state-disabled"+'"':"")+'><a href="#" tabindex="-1" role="option"'+(d[f].disabled?' aria-disabled="true"':"")+' aria-selected="false"'+(d[f].typeahead?' typeahead="'+d[f].typeahead+'"':"")+">"+d[f].text+"</a></li>").data("index",f).addClass(d[f].classes).data("optionClasses",d[f].classes||"").bind("mouseup.selectmenu",function(c){if(b._safemouseup&&!b._disabled(c.currentTarget)&&!b._disabled(a(c.currentTarget).parents("ul>li."+b.widgetBaseClass+"-group "))){var d=a(this).data("index")!=b._selectedIndex();b.index(a(this).data("index")),b.select(c),d&&b.change(c),b.close(c,!0)}return!1}).bind("click.selectmenu",function(){return!1}).bind("mouseover.selectmenu focus.selectmenu",function(c){!a(c.currentTarget).hasClass(b.namespace+"-state-disabled")&&!a(c.currentTarget).parent("ul").parent("li").hasClass(b.namespace+"-state-disabled")&&(b._selectedOptionLi().addClass(e),b._focusedOptionLi().removeClass(b.widgetBaseClass+"-item-focus ui-state-hover"),a(this).removeClass("ui-state-active").addClass(b.widgetBaseClass+"-item-focus ui-state-hover"))}).bind("mouseout.selectmenu blur.selectmenu",function(){a(this).is(b._selectedOptionLi().selector)&&a(this).addClass(e),a(this).removeClass(b.widgetBaseClass+"-item-focus ui-state-hover")});if(d[f].parentOptGroup.length){var h=b.widgetBaseClass+"-group-"+this.element.find("optgroup").index(d[f].parentOptGroup);this.list.find("li."+h).length?this.list.find("li."+h+":last ul").append(g):a(' <li role="presentation" class="'+b.widgetBaseClass+"-group "+h+(d[f].parentOptGroup.attr("disabled")?" "+this.namespace+'-state-disabled" aria-disabled="true"':'"')+'><span class="'+b.widgetBaseClass+'-group-label">'+d[f].parentOptGroup.attr("label")+"</span><ul></ul></li> ").appendTo(this.list).find("ul").append(g)}else g.appendTo(this.list);if(c.icons)for(var i in c.icons)if(g.is(c.icons[i].find)){g.data("optionClasses",d[f].classes+" "+b.widgetBaseClass+"-hasIcon").addClass(b.widgetBaseClass+"-hasIcon");var j=c.icons[i].icon||"";g.find("a:eq(0)").prepend('<span class="'+b.widgetBaseClass+"-item-icon ui-icon "+j+'"></span>'),d[f].bgImage&&g.find("span").css("background-image",d[f].bgImage)}}var k=c.style=="dropdown";this.newelement.toggleClass(b.widgetBaseClass+"-dropdown",k).toggleClass(b.widgetBaseClass+"-popup",!k),this.list.toggleClass(b.widgetBaseClass+"-menu-dropdown ui-corner-bottom",k).toggleClass(b.widgetBaseClass+"-menu-popup ui-corner-all",!k).find("li:first").toggleClass("ui-corner-top",!k).end().find("li:last").addClass("ui-corner-bottom"),this.selectmenuIcon.toggleClass("ui-icon-triangle-1-s",k).toggleClass("ui-icon-triangle-2-n-s",!k);if(c.transferClasses){var l=this.element.attr("class")||"";this.newelement.add(this.list).addClass(l)}c.style=="dropdown"?this.list.width(c.menuWidth?c.menuWidth:c.width):this.list.width(c.menuWidth?c.menuWidth:c.width-c.handleWidth),this.list.css("height","auto");var m=this.list.height();if(c.maxHeight&&c.maxHeight<m)this.list.height(c.maxHeight);else{var n=a(window).height()/3;n<m&&this.list.height(n)}this._optionLis=this.list.find("li:not(."+b.widgetBaseClass+"-group)"),this.element.attr("disabled")===!0?this.disable():this.enable(),this.index(this._selectedIndex()),window.setTimeout(function(){b._refreshPosition()},200)},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").removeAttr("aria-disabled").unbind(".selectmenu"),a(window).unbind(".selectmenu"),a(document).unbind(".selectmenu"),a("label[for="+this.newelement.attr("id")+"]").attr("for",this.element.attr("id")).unbind(".selectmenu"),this.options.wrapperElement?(this.newelement.find(this.options.wrapperElement).remove(),this.list.find(this.options.wrapperElement).remove()):(this.newelement.remove(),this.list.remove()),this.element.show(),a.Widget.prototype.destroy.apply(this,arguments)},_typeAhead:function(b,d){var e=this,f=!1,g=String.fromCharCode(b).toUpperCase();c=g.toLowerCase();if(e.options.typeAhead=="sequential"){window.clearTimeout("ui.selectmenu-"+e.selectmenuId);var h=typeof e._prevChar=="undefined"?"":e._prevChar.join("");function i(b,c,g){f=!0,a(b).trigger(d),typeof e._prevChar=="undefined"?e._prevChar=[g]:e._prevChar[e._prevChar.length]=g}this.list.find("li a").each(function(b){if(!f){var d=a(this).attr("typeahead")||a(this).text();d.indexOf(h+g)==0?i(this,b,g):d.indexOf(h+c)==0&&i(this,b,c)}}),window.setTimeout(function(a){e._prevChar=undefined},1e3,e)}else{e._prevChar||(e._prevChar=["",0]);var f=!1;function j(b,c){f=!0,a(b).trigger(d),e._prevChar[1]=c}this.list.find("li a").each(function(b){if(!f){var d=a(this).text();if(d.indexOf(g)==0||d.indexOf(c)==0)e._prevChar[0]==g?e._prevChar[1]<b&&j(this,b):j(this,b)}}),this._prevChar[0]=g}},_uiHash:function(){var b=this.index();return{index:b,option:a("option",this.element).get(b),value:this.element[0].value}},open:function(a){var b=this;this.newelement.attr("aria-disabled")!="true"&&(this._closeOthers(a),this.newelement.addClass("ui-state-active"),b.options.wrapperElement?this.list.parent().appendTo("body"):this.list.appendTo("body"),this.list.addClass(b.widgetBaseClass+"-open").attr("aria-hidden",!1).find("li:not(."+b.widgetBaseClass+"-group):eq("+this._selectedIndex()+") a")[0].focus(),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"),this._refreshPosition(),this._trigger("open",a,this._uiHash()))},close:function(a,b){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.list.attr("aria-hidden",!0).removeClass(this.widgetBaseClass+"-open"),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),b&&this.newelement.focus(),this._trigger("close",a,this._uiHash()))},change:function(a){this.element.trigger("change"),this._trigger("change",a,this._uiHash())},select:function(a){if(this._disabled(a.currentTarget))return!1;this._trigger("select",a,this._uiHash())},_closeOthers:function(b){a("."+this.widgetBaseClass+".ui-state-active").not(this.newelement).each(function(){a(this).data("selectelement").selectmenu("close",b)}),a("."+this.widgetBaseClass+".ui-state-hover").trigger("mouseout")},_toggle:function(a,b){this.list.is("."+this.widgetBaseClass+"-open")?this.close(a,b):this.open(a)},_formatText:function(a){return this.options.format?this.options.format(a):a},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetBaseClass+"-item-focus")},_moveSelection:function(a,b){if(!this.options.disabled){var c=parseInt(this._selectedOptionLi().data("index")||0,10),d=c+a;d<0&&(d=0),d>this._optionLis.size()-1&&(d=this._optionLis.size()-1);if(d===b)return!1;if(this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled"))a>0?++a:--a,this._moveSelection(a,d);else return this._optionLis.eq(d).trigger("mouseup")}},_moveFocus:function(a,b){if(!isNaN(a))var c=parseInt(this._focusedOptionLi().data("index")||0,10),d=c+a;else var d=parseInt(this._optionLis.filter(a).data("index"),10);d<0&&(d=0),d>this._optionLis.size()-1&&(d=this._optionLis.size()-1);if(d===b)return!1;var e=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this._focusedOptionLi().find("a:eq(0)").attr("id",""),this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled")?(a>0?++a:--a,this._moveFocus(a,d)):this._optionLis.eq(d).find("a:eq(0)").attr("id",e).focus(),this.list.attr("aria-activedescendant",e)},_scrollPage:function(a){var b=Math.floor(this.list.outerHeight()/this.list.find("li:first").outerHeight());b=a=="up"?-b:b,this._moveFocus(b)},_setOption:function(a,b){this.options[a]=b,a=="disabled"&&(this.close(),this.element.add(this.newelement).add(this.list)[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").attr("aria-disabled",b))},disable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!0):b=="optgroup"?this._disableOptgroup(a):this._disableOption(a)},enable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!1):b=="optgroup"?this._enableOptgroup(a):this._enableOption(a)},_disabled:function(b){return a(b).hasClass(this.namespace+"-state-disabled")},_disableOption:function(a){var b=this._optionLis.eq(a);b&&(b.addClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!0),this.element.find("option").eq(a).attr("disabled","disabled"))},_enableOption:function(a){var b=this._optionLis.eq(a);b&&(b.removeClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!1),this.element.find("option").eq(a).removeAttr("disabled"))},_disableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);b&&(b.addClass(this.namespace+"-state-disabled").attr("aria-disabled",!0),this.element.find("optgroup").eq(a).attr("disabled","disabled"))},_enableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);b&&(b.removeClass(this.namespace+"-state-disabled").attr("aria-disabled",!1),this.element.find("optgroup").eq(a).removeAttr("disabled"))},index:function(b){if(!arguments.length)return this._selectedIndex();if(!this._disabled(a(this._optionLis[b])))this.element[0].selectedIndex=b,this._refreshValue();else return!1},value:function(a){if(arguments.length)this.element[0].value=a,this._refreshValue();else return this.element[0].value},_refreshValue:function(){var a=this.options.style=="popup"?" ui-state-active":"",b=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this.list.find("."+this.widgetBaseClass+"-item-selected").removeClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","false").attr("id",""),this._selectedOptionLi().addClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","true").attr("id",b);var c=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"",d=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(c).data("optionClasses",d).addClass(d).find("."+this.widgetBaseClass+"-status").html(this._selectedOptionLi().find("a:eq(0)").html()),this.list.attr("aria-activedescendant",b)},_refreshPosition:function(){var a=this.options;if(a.style=="popup"&&!a.positionOptions.offset)var b=this._selectedOptionLi(),c="0 -"+(b.outerHeight()+b.offset().top-this.list.offset().top);var d=this.element.zIndex();d&&this.list.css({zIndex:d}),this.list.position({of:a.positionOptions.of||this.newelement,my:a.positionOptions.my,at:a.positionOptions.at,offset:a.positionOptions.offset||c,collision:a.positionOptions.collision||"flip"})}})}(jQuery),define("plugins-modded/jquery.ui.selectmenu",function(){}),function(a,b,c){typeof a.SteelUnderpants=="undefined"&&(a.SteelUnderpants={});var d={triStateCheckbox:"TriStateCheckbox",checked:"Checked",mixed:"Mixed",disabled:"Disabled"},e={clicked:"clicked",checked:"checked",enabled:"enabled"};a.SteelUnderpants.TriStateCheckbox=function(a){function h(a,b){!a||a==="false"?g.className=d.triStateCheckbox+" "+d.triStateCheckbox+(f.enabled?"":d.disabled):a==="mixed"?g.className=d.triStateCheckbox+" "+d.triStateCheckbox+d.mixed+(f.enabled?"":d.disabled):g.className=d.triStateCheckbox+" "+d.triStateCheckbox+d.checked+(f.enabled?"":d.disabled)}function i(a,b){if(typeof a=="undefined")return f.checked;if(b||!(f.checked===a||f.checked&&a==="true"||!f.checked&&a==="false"))!a||a==="false"?(f.checked=!1,g.setAttribute("aria-checked","false")):a==="mixed"?(f.checked="mixed",g.setAttribute("aria-checked","false")):(f.checked=!0,g.setAttribute("aria-checked","true")),h(f.checked,f.enabled),b||c(g).trigger(e.checked)}function j(a,b){if(typeof a=="undefined")return f.enabled;if(b||a!=f.enabled)a?(f.enabled=!0,g.setAttribute("aria-disabled","false")):(f.enabled=!1,g.setAttribute("aria-disabled","true")),h(f.checked,f.enabled),b||c(g).trigger(e.enabled)}var f={checked:!1,enabled:!0,tabIndex:-1};c.extend(f,a);var g=b.createElement("a");return g.setAttribute("role","checkbox"),g.setAttribute("aria-checked",f.checked.toString()),g.setAttribute("aria-disabled",(!f.enabled).toString()),g.setAttribute("tabindex",f.tabIndex.toString()),g.className=d.triStateCheckbox,c(g).bind("click.internal",function(){f.enabled&&g.checked(f.checked==="mixed"||!f.checked)}).bind("keypress.internal",function(a){f.enabled&&a.charCode==32&&g.checked(f.checked==="mixed"||!f.checked)})[0],i(f.checked,!0),j(f.enabled,!0),g.checked=function(a){return i(a,!1)},g.enabled=function(a){return j(a,!1)},g}}(window,document,jQuery),define("lib/TriStateCheckbox",function(){}),function(a,b){function m(b,c,d,e){var h={data:e||(c?c.data:{}),_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:u,nest:v,wrap:w,html:x,update:y};return b&&a.extend(h,b,{nodes:[],parent:c}),d&&(h.tmpl=d,h._ctnt=h._ctnt||h.tmpl(a,h),h.key=++j,(l.length?g:f)[j]=h),h}function n(b,c,e){var f,g=e?a.map(e,function(a){return typeof a=="string"?b.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+d+'="'+b.key+'" $2'):a:n(a,b,a._ctnt)}):b;return c?g:(g=g.join(""),g.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(b,c,d,e){f=a(d).get(),t(f),c&&(f=o(c).concat(f)),e&&(f=f.concat(o(e)))}),f?f:o(g))}function o(b){var c=document.createElement("div");return c.innerHTML=b,a.makeArray(c.childNodes)}function p(b){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(b,c,d,e,f,g,h){var i=a.tmpl.tag[d],j,k,l;if(!i)throw"Template command not found: "+d;return j=i._default||[],g&&!/\w$/.test(f)&&(f+=g,g=""),f?(f=r(f),h=h?","+r(h)+")":g?")":"",k=g?f.indexOf(".")>-1?f+g:"("+f+").call($item"+h:f,l=g?k:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):l=k=j.$1||"null",e=r(e),"');"+i[c?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(l).split("$1").join(k).split("$2").join(e?e.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(a,b,c,d){return d=d?","+d+")":c?")":"",d?"("+b+").call($item"+d:a}):j.$2||"")+"_.push('"})+"');}return _;")}function q(b,c){b._wrap=n(b,!0,a.isArray(c)?c:[e.test(c)?c:a(c).html()]).join("")}function r(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(a){var b=document.createElement("div");return b.appendChild(a.cloneNode(!0)),b.innerHTML}function t(b){function p(b){function p(a){a+=c,n=i[a]=i[a]||m(n,f[n.parent.key+c]||n.parent,null,!0)}var e,h=b,l,n,o;if(o=b.getAttribute(d)){while(h.parentNode&&(h=h.parentNode).nodeType===1&&!(e=h.getAttribute(d)));e!==o&&(h=h.parentNode?h.nodeType===11?0:h.getAttribute(d)||0:0,(n=f[o])||(n=g[o],n=m(n,f[h]||g[h],null,!0),n.key=++j,f[j]=n),k&&p(o)),b.removeAttribute(d)}else k&&(n=a.data(b,"tmplItem"))&&(p(n.key),f[n.key]=n,h=a.data(b.parentNode,"tmplItem"),h=h?h.key:0);if(n){l=n;while(l&&l.key!=h)l.nodes.push(b),l=l.parent;delete n._ctnt,delete n._wrap,a.data(b,"tmplItem",n)}}var c="_"+k,e,h,i={},l,n,o;for(l=0,n=b.length;l<n;l++){if((e=b[l]).nodeType!==1)continue;h=e.getElementsByTagName("*");for(o=h.length-1;o>=0;o--)p(h[o]);p(e)}}function u(a,b,c,d){if(!a)return l.pop();l.push({_:a,tmpl:b,item:this,data:c,options:d})}function v(b,c,d){return a.tmpl(a.template(b),c,d,this)}function w(b,c){var d=b.options||{};return d.wrapped=c,a.tmpl(a.template(b.tmpl),b.data,d,b.item)}function x(b,c){var d=this._wrap;return a.map(a(a.isArray(d)?d.join(""):d).filter(b||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function y(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]),a(b).remove()}var c=a.fn.domManip,d="_tmplitem",e=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,f={},g={},h,i={key:0,data:{}},j=0,k=0,l=[];a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var e=[],g=a(d),i,j,l,m,n=this.length===1&&this[0].parentNode;h=f||{};if(n&&n.nodeType===11&&n.childNodes.length===1&&g.length===1)g[c](this[0]),e=this;else{for(j=0,l=g.length;j<l;j++)k=j,i=(j>0?this.clone(!0):this).get(),a.fn[c].apply(a(g[j]),i),e=e.concat(i);k=0,e=this.pushStack(e,b,g.selector)}return m=h,h=null,a.tmpl.complete(m),e}}),a.fn.extend({tmpl:function(b,c,d){return a.tmpl(this[0],b,c,d)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(b,d,e,g){if(b[0]&&b[0].nodeType){var i=a.makeArray(arguments),j=b.length,l=0,m;while(l<j&&!(m=a.data(b[l++],"tmplItem")));j>1&&(i[0]=[a.makeArray(b)]),m&&k&&(i[2]=function(b){a.tmpl.afterManip(this,b,e)}),c.apply(this,i)}else c.apply(this,arguments);return k=0,h||a.tmpl.complete(f),this}}),a.extend({tmpl:function(b,c,d,e){var h,j=!e;if(j)e=i,b=a.template[b]||a.template(null,b),g={};else if(!b)return b=e.tmpl,f[e.key]=e,e.nodes=[],e.wrapped&&q(e,e.wrapped),a(n(e,null,e.tmpl(a,e)));return b?(typeof c=="function"&&(c=c.call(e||{})),d&&d.wrapped&&q(d,d.wrapped),h=a.isArray(c)?a.map(c,function(a){return a?m(d,e,b,a):null}):[m(d,e,b,c)],j?a(n(e,null,h)):h):[]},tmplItem:function(b){var c;b instanceof a&&(b=b[0]);while(b&&b.nodeType===1&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode));return c||i},template:function(b,c){return c?(typeof c=="string"?c=p(c):c instanceof a&&(c=c[0]||{}),c.nodeType&&(c=a.data(c,"tmpl")||a.data(c,"tmpl",p(c.innerHTML))),typeof b=="string"?a.template[b]=c:c):b?typeof b!="string"?a.template(null,b):a.template[b]||a.template(null,e.test(b)?b:a(b)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(a){f={}},afterManip:function(c,d,e){var f=d.nodeType===11?a.makeArray(d.childNodes):d.nodeType===1?[d]:[];e.call(c,d),t(f),k++}})}(jQuery),define("lib/jquery.tmpl",function(){}),function(a){a.fn.autoResize=function(b){var c=a.extend({onResize:function(){},animate:!0,animateDuration:150,animateCallback:function(){},extraSpace:20,limit:1e3},b);return this.filter("textarea").each(function(){var b=a(this).css({resize:"none","overflow-y":"hidden"}),d=b.height(),e=220,f=function(){var c=["height","width","lineHeight","textDecoration","letterSpacing"],d={};return a.each(c,function(a,c){d[c]=b.css(c)}),b.clone().removeAttr("id").removeAttr("name").css({position:"absolute",top:0,left:-9999}).css(d).attr("tabIndex","-1").insertBefore(b)}(),g=null,h=function(){f.width(e),f.height(0).val(a(this).val()).scrollTop(1e4);var h=Math.max(f.scrollTop(),d)+c.extraSpace,i=a(this).add(f);if(g===h)return;g=h;if(h>=c.limit){a(this).css("overflow-y","");return}c.onResize.call(this),c.animate&&b.css("display")==="block"?i.stop().animate({height:h},c.animateDuration,c.animateCallback):i.height(h)};b.unbind(".dynSiz").bind("keyup.dynSiz",h).bind("keydown.dynSiz",h).bind("change.dynSiz",h)}),this}}(jQuery),define("lib/jquery.autoresize",function(){}),function(a){a.titleAlert=function(b,c){a.titleAlert._running&&a.titleAlert.stop(),a.titleAlert._settings=c=a.extend({},a.titleAlert.defaults,c);if(c.requireBlur&&a.titleAlert.hasFocus)return;c.originalTitleInterval=c.originalTitleInterval||c.interval,a.titleAlert._running=!0,a.titleAlert._initialText=document.title,document.title=b;var d=!0,e=function(){if(!a.titleAlert._running)return;d=!d,document.title=d?b:a.titleAlert._initialText,a.titleAlert._intervalToken=setTimeout(e,d?c.interval:c.originalTitleInterval)};a.titleAlert._intervalToken=setTimeout(e,c.interval),c.stopOnMouseMove&&a(document).mousemove(function(b){a(this).unbind(b),a.titleAlert.stop()}),c.duration>0&&(a.titleAlert._timeoutToken=setTimeout(function(){a.titleAlert.stop()},c.duration))},a.titleAlert.defaults={interval:500,originalTitleInterval:null,duration:0,stopOnFocus:!0,requireBlur:!1,stopOnMouseMove:!1},a.titleAlert.stop=function(){clearTimeout(a.titleAlert._intervalToken),clearTimeout(a.titleAlert._timeoutToken),document.title=a.titleAlert._initialText,a.titleAlert._timeoutToken=null,a.titleAlert._intervalToken=null,a.titleAlert._initialText=null,a.titleAlert._running=!1,a.titleAlert._settings=null},a.titleAlert.hasFocus=!0,a.titleAlert._running=!1,a.titleAlert._intervalToken=null,a.titleAlert._timeoutToken=null,a.titleAlert._initialText=null,a.titleAlert._settings=null,a.titleAlert._focus=function(){a.titleAlert.hasFocus=!0;if(a.titleAlert._running&&a.titleAlert._settings.stopOnFocus){var b=a.titleAlert._initialText;a.titleAlert.stop(),setTimeout(function(){if(a.titleAlert._running)return;document.title=".",document.title=b},1e3)}},a.titleAlert._blur=function(){a.titleAlert.hasFocus=!1},a(window).bind("focus",a.titleAlert._focus),a(window).bind("blur",a.titleAlert._blur)}(jQuery),define("lib/jquery.titlealert",function(){}),function(a){a.fn.drag=function(b,c,d){var e=typeof b=="string"?b:"",g=a.isFunction(b)?b:a.isFunction(c)?c:null;return e.indexOf("drag")!==0&&(e="drag"+e),d=(b==g?c:d)||{},g?this.bind(e,d,g):this.trigger(e)};var b=a.event,c=b.special,d=c.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",livekey:"livedrag",add:function(c){var e=a.data(this,d.datakey),g=c.data||{};e.related+=1,!e.live&&c.selector&&(e.live=!0,b.add(this,"draginit."+d.livekey,d.delegate)),a.each(d.defaults,function(a){g[a]!==undefined&&(e[a]=g[a])})},remove:function(){a.data(this,d.datakey).related-=1},setup:function(){if(!a.data(this,d.datakey)){var c=a.extend({related:0},d.defaults);a.data(this,d.datakey,c),b.add(this,"mousedown",d.init,c),this.attachEvent&&this.attachEvent("ondragstart",d.dontstart)}},teardown:function(){a.data(this,d.datakey).related||(a.removeData(this,d.datakey),b.remove(this,"mousedown",d.init),b.remove(this,"draginit",d.delegate),d.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",d.dontstart))},init:function(e){var g=e.data,j;if(!(g.which>0&&e.which!=g.which)&&!a(e.target).is(g.not))if(!g.handle||!!a(e.target).closest(g.handle,e.currentTarget).length){g.propagates=1,g.interactions=[d.interaction(this,g)],g.target=e.target,g.pageX=e.pageX,g.pageY=e.pageY,g.dragging=null,j=d.hijack(e,"draginit",g);if(g.propagates)return(j=d.flatten(j))&&j.length&&(g.interactions=[],a.each(j,function(){g.interactions.push(d.interaction(this,g))})),g.propagates=g.interactions.length,g.drop!==!1&&c.drop&&c.drop.handler(e,g),d.textselect(!1),b.add(document,"mousemove mouseup",d.handler,g),!1}},interaction:function(b,c){return{drag:b,callback:new d.callback,droppable:[],offset:a(b)[c.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(a){var e=a.data;switch(a.type){case!e.dragging&&"mousemove":if(Math.pow(a.pageX-e.pageX,2)+Math.pow(a.pageY-e.pageY,2)<Math.pow(e.distance,2))break;a.target=e.target,d.hijack(a,"dragstart",e),e.propagates&&(e.dragging=!0);case"mousemove":if(e.dragging){d.hijack(a,"drag",e);if(e.propagates){e.drop!==!1&&c.drop&&c.drop.handler(a,e);break}a.type="mouseup"};case"mouseup":b.remove(document,"mousemove mouseup",d.handler),e.dragging&&(e.drop!==!1&&c.drop&&c.drop.handler(a,e),d.hijack(a,"dragend",e)),d.textselect(!0),e.click===!1&&e.dragging&&(jQuery.event.triggered=!0,setTimeout(function(){jQuery.event.triggered=!1},20),e.dragging=!1)}},delegate:function(c){var e=[],g,h=a.data(this,"events")||{};return a.each(h.live||[],function(h,j){j.preType.indexOf("drag")===0&&(g=a(c.target).closest(j.selector,c.currentTarget)[0])&&(b.add(g,j.origType+"."+d.livekey,j.origHandler,j.data),a.inArray(g,e)<0&&e.push(g))}),e.length?a(e).bind("dragend."+d.livekey,function(){b.remove(this,"."+d.livekey)}):!1},hijack:function(c,e,g,h,j){if(g){var k={event:c.originalEvent,type:c.type},l=e.indexOf("drop")?"drag":"drop",m,n=h||0,o,p;h=isNaN(h)?g.interactions.length:h,c.type=e,c.originalEvent=null,g.results=[];do if(o=g.interactions[n])if(e==="dragend"||!o.cancelled)p=d.properties(c,g,o),o.results=[],a(j||o[l]||g.droppable).each(function(h,j){m=(p.target=j)?b.handle.call(j,c,p):null,m===!1?(l=="drag"&&(o.cancelled=!0,g.propagates-=1),e=="drop"&&(o[l][h]=null)):e=="dropinit"&&o.droppable.push(d.element(m)||j),e=="dragstart"&&(o.proxy=a(d.element(m)||o.drag)[0]),o.results.push(m),delete c.result;if(e!=="dropinit")return m}),g.results[n]=d.flatten(o.results),e=="dropinit"&&(o.droppable=d.flatten(o.droppable)),e=="dragstart"&&!o.cancelled&&p.update();while(++n<h);return c.type=k.type,c.originalEvent=k.event,d.flatten(g.results)}},properties:function(a,b,c){var e=c.callback;return e.drag=c.drag,e.proxy=c.proxy||c.drag,e.startX=b.pageX,e.startY=b.pageY,e.deltaX=a.pageX-b.pageX,e.deltaY=a.pageY-b.pageY,e.originalX=c.offset.left,e.originalY=c.offset.top,e.offsetX=a.pageX-(b.pageX-e.originalX),e.offsetY=a.pageY-(b.pageY-e.originalY),e.drop=d.flatten((c.drop||[]).slice()),e.available=d.flatten((c.droppable||[]).slice()),e},element:function(a){if(a&&(a.jquery||a.nodeType==1))return a},flatten:function(b){return a.map(b,function(b){return b&&b.jquery?a.makeArray(b):b&&b.length?d.flatten(b):b})},textselect:function(b){a(document)[b?"unbind":"bind"]("selectstart",d.dontstart).attr("unselectable",b?"off":"on").css("MozUserSelect",b?"":"none")},dontstart:function(){return!1},callback:function(){}};d.callback.prototype={update:function(){c.drop&&this.available.length&&a.each(this.available,function(a){c.drop.locate(this,a)})}},c.draginit=c.dragstart=c.dragend=d}(jQuery),define("lib/jquery.event.drag-2.0.min",function(){}),$.fn.sortElements=function(){var a=[].sort;return function(b,c){c=c||function(){return this};var d=this.map(function(){var a=c.call(this),b=a.parentNode,d=b.insertBefore(document.createTextNode(""),a.nextSibling);return function(){if(b===this)throw new Error("You can't sort elements if any one is a descendant of another.");b.insertBefore(this,d),b.removeChild(d)}});return a.call(this,b).each(function(a){d[a].call(c.call(this))})}}(),function($){$.layout={version:"1.3.rc29.15",revision:.032915,language:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpenTip:"Not enough room to show this pane.",pane:"pane",selector:"selector",errButton:"Error Adding Button \n\nInvalid ",errContainerMissing:"UI Layout Initialization Error\n\nThe specified layout-container does not exist.",errCenterPaneMissing:"UI Layout Initialization Error\n\nThe center-pane element does not exist.\n\nThe center-pane is a required element.",errContainerHeight:"UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!"},browser:{mozilla:!!$.browser.mozilla,webkit:!!$.browser.webkit||!!$.browser.safari,msie:!!$.browser.msie,isIE6:!!$.browser.msie&&$.browser.version==6,boxModel:!1},scrollbarWidth:function(){return window.scrollbarWidth||$.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||$.layout.getScrollbarSize("height")},getScrollbarSize:function(a){var b=$('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),c={width:b.width()-b[0].clientWidth,height:b.height()-b[0].clientHeight};return b.remove(),window.scrollbarWidth=c.width,window.scrollbarHeight=c.height,a.match(/^(width|height)$/i)?c[a]:c},showInvisibly:function(a,b){if(!a)return{};a.jquery||(a=$(a));var c={display:a.css("display"),visibility:a.css("visibility")};return b||c.display=="none"?(a.css({display:"block",visibility:"hidden"}),c):{}},getElementDimensions:function(a){var b={},c=b.css={},d={},e,f,g=$.layout.cssNum,h=a.offset();return b.offsetLeft=h.left,b.offsetTop=h.top,$.each("Left,Right,Top,Bottom".split(","),function(g,h){e=c["border"+h]=$.layout.borderWidth(a,h),f=c["padding"+h]=$.layout.cssNum(a,"padding"+h),d[h]=e+f,b["inset"+h]=f}),b.offsetWidth=a.innerWidth(),b.offsetHeight=a.innerHeight(),b.outerWidth=a.outerWidth(),b.outerHeight=a.outerHeight(),b.innerWidth=Math.max(0,b.outerWidth-d.Left-d.Right),b.innerHeight=Math.max(0,b.outerHeight-d.Top-d.Bottom),c.width=a.width(),c.height=a.height(),c.top=g(a,"top",!0),c.bottom=g(a,"bottom",!0),c.left=g(a,"left",!0),c.right=g(a,"right",!0),b},getElementCSS:function(a,b){var c={},d=a[0].style,e=b.split(","),f="Top,Bottom,Left,Right".split(","),g="Color,Style,Width".split(","),h,i,j,k,l,m;for(k=0;k<e.length;k++){h=e[k];if(h.match(/(border|padding|margin)$/))for(l=0;l<4;l++){i=f[l];if(h=="border")for(m=0;m<3;m++)j=g[m],c[h+i+j]=d[h+i+j];else c[h+i]=d[h+i]}else c[h]=d[h]}return c},cssWidth:function(a,b){var c=$.layout.borderWidth,d=$.layout.cssNum;if(b<=0)return 0;if(!$.layout.browser.boxModel)return b;var e=b-c(a,"Left")-c(a,"Right")-d(a,"paddingLeft")-d(a,"paddingRight");return Math.max(0,e)},cssHeight:function(a,b){var c=$.layout.borderWidth,d=$.layout.cssNum;if(b<=0)return 0;if(!$.layout.browser.boxModel)return b;var e=b-c(a,"Top")-c(a,"Bottom")-d(a,"paddingTop")-d(a,"paddingBottom");return Math.max(0,e)},cssNum:function(a,b,c){a.jquery||(a=$(a));var d=$.layout.showInvisibly(a),e=$.curCSS(a[0],b,!0),f=c&&e=="auto"?e:parseInt(e,10)||0;return a.css(d),f},borderWidth:function(a,b){a.jquery&&(a=a[0]);var c="border"+b.substr(0,1).toUpperCase()+b.substr(1);return $.curCSS(a,c+"Style",true)=="none"?0:parseInt($.curCSS(a,c+"Width",!0),10)||0},isMouseOverElem:function(a,b){var c=$(b||this),d=c.offset(),e=d.top,f=d.left,g=f+c.outerWidth(),h=e+c.outerHeight(),i=a.pageX,j=a.pageY;return $.layout.browser.msie&&i<0&&j<0||i>=f&&i<=g&&j>=e&&j<=h}},$.fn.layout=function(opts){function keyDown(a){if(!a)return!0;var b=a.keyCode;if(b<33)return!0;var c={38:"north",40:"south",37:"west",39:"east"},d=a.altKey,e=a.shiftKey,f=a.ctrlKey,g=f&&b>=37&&b<=40,h,i,j,k;return g&&options[c[b]].enableCursorHotkey?k=c[b]:(f||e)&&$.each(_c.borderPanes.split(","),function(a,c){h=options[c],i=h.customHotkey,j=h.customHotkeyModifier;if(e&&j=="SHIFT"||f&&j=="CTRL"||f&&e)if(i&&b==(isNaN(i)||i<=9?i.toUpperCase().charCodeAt(0):i))return k=c,!1}),!k||!$Ps[k]||!options[k].closable||state[k].isHidden?!0:(toggle(k),a.stopPropagation(),a.returnValue=!1,!1)}function allowOverflow(a){if(!isInitialized())return;this&&this.tagName&&(a=this);var b;isStr(a)?b=$Ps[a]:$(a).data("layoutRole")?b=$(a):$(a).parents().each(function(){if($(this).data("layoutRole"))return b=$(this),!1});if(!b||!b.length)return;var c=b.data("layoutEdge"),d=state[c];d.cssSaved&&resetOverflow(c);if(d.isSliding||d.isResizing||d.isClosed){d.cssSaved=!1;return}var e={zIndex:_c.zIndex.pane_normal+2},f={},g=b.css("overflow"),h=b.css("overflowX"),i=b.css("overflowY");g!="visible"&&(f.overflow=g,e.overflow="visible"),h&&!h.match(/visible|auto/)&&(f.overflowX=h,e.overflowX="visible"),i&&!i.match(/visible|auto/)&&(f.overflowY=h,e.overflowY="visible"),d.cssSaved=f,b.css(e),$.each(_c.allPanes.split(","),function(a,b){b!=c&&resetOverflow(b)})}function resetOverflow(a){if(!isInitialized())return;this&&this.tagName&&(a=this);var b;isStr(a)?b=$Ps[a]:$(a).data("layoutRole")?b=$(a):$(a).parents().each(function(){if($(this).data("layoutRole"))return b=$(this),!1});if(!b||!b.length)return;var c=b.data("layoutEdge"),d=state[c],e=d.cssSaved||{};!d.isSliding&&!d.isResizing&&b.css("zIndex",_c.zIndex.pane_normal),b.css(e),d.cssSaved=!1}function getBtn(a,b,c){var d=$(a),e=options.showErrorMessages;if(!d.length)e&&alert(lang.errButton+lang.selector+": "+a);else if(_c.borderPanes.indexOf(b)==-1)e&&alert(lang.errButton+lang.pane+": "+b);else{var f=options[b].buttonClass+"-"+c;return d.addClass(f+" "+f+"-"+b).data("layoutName",options.name),d}return null}function bindButton(a,b,c){switch(b.toLowerCase()){case"toggle":addToggleBtn(a,c);break;case"open":addOpenBtn(a,c);break;case"close":addCloseBtn(a,c);break;case"pin":addPinBtn(a,c);break;case"toggle-slide":addToggleBtn(a,c,!0);break;case"open-slide":addOpenBtn(a,c,!0)}}function addToggleBtn(a,b,c){var d=getBtn(a,b,"toggle");d&&d.click(function(a){toggle(b,!!c),a.stopPropagation()})}function addOpenBtn(a,b,c){var d=getBtn(a,b,"open");d&&d.attr("title",lang.Open).click(function(a){open(b,!!c),a.stopPropagation()})}function addCloseBtn(a,b){var c=getBtn(a,b,"close");c&&c.attr("title",lang.Close).click(function(a){close(b),a.stopPropagation()})}function addPinBtn(a,b){var c=getBtn(a,b,"pin");if(c){var d=state[b];c.click(function(a){setPinState($(this),b,d.isSliding||d.isClosed),d.isSliding||d.isClosed?open(b):close(b),a.stopPropagation()}),setPinState(c,b,!d.isClosed&&!d.isSliding),_c[b].pins.push(a)}}function syncPinBtns(a,b){$.each(_c[a].pins,function(c,d){setPinState($(d),a,b)})}function setPinState(a,b,c){var d=a.attr("pin");if(d&&c==(d=="down"))return;var e=options[b].buttonClass+"-pin",f=e+"-"+b,g=e+"-up "+f+"-up",h=e+"-down "+f+"-down";a.attr("pin",c?"down":"up").attr("title",c?lang.Unpin:lang.Pin).removeClass(c?g:h).addClass(c?h:g)}function isCookiesEnabled(){return navigator.cookieEnabled!=0}function getCookie(a){var b=$.extend({},options.cookie,a||{}),c=b.name||options.name||"Layout",d=document.cookie,e=d?d.split(";"):[],f;for(var g=0,h=e.length;g<h;g++){f=$.trim(e[g]).split("=");if(f[0]==c)return decodeJSON(decodeURIComponent(f[1]))}return""}function saveCookie(a,b){var c=$.extend({},options.cookie,b||{}),d=c.name||options.name||"Layout",e="",f="",g=!1;return c.expires.toUTCString?f=c.expires:typeof c.expires=="number"&&(f=new Date,c.expires>0?f.setDate(f.getDate()+c.expires):(f.setYear(1970),g=!0)),f&&(e+=";expires="+f.toUTCString()),c.path&&(e+=";path="+c.path),c.domain&&(e+=";domain="+c.domain),c.secure&&(e+=";secure"),g?(state.cookie={},document.cookie=d+"="+e):(state.cookie=getState(a||c.keys),document.cookie=d+"="+encodeURIComponent(encodeJSON(state.cookie))+e),$.extend({},state.cookie)}function deleteCookie(){saveCookie("",{expires:-1})}function loadCookie(a){var b=getCookie(a);return b&&(state.cookie=$.extend({},b),loadState(b)),b}function loadState(a,b){a=_transformData(a),$.extend(!0,options,a);if(state.initialized){var c,d,e,f,g,h=!b;$.each(_c.allPanes.split(","),function(b,c){d=a[c];if(typeof d!="object")return;e=d.size,g=d.initClosed,f=d.initHidden,(e>0||e=="auto")&&sizePane(c,e),f===!0?hide(c,h):g===!1?open(c,!1,h):g===!0?close(c,!1,h):f===!1&&show(c,!1,h)})}}function getState(a){var b={},c={isClosed:"initClosed",isHidden:"initHidden"},d,e,f,g;a||(a=options.cookie.keys),$.isArray(a)&&(a=a.join(",")),a=a.replace(/__/g,".").split(",");for(var h=0,i=a.length;h<i;h++){d=a[h].split("."),e=d[0],f=d[1];if(_c.allPanes.indexOf(e)<0)continue;g=state[e][f];if(g==undefined)continue;f=="isClosed"&&state[e].isSliding&&(g=!0),(b[e]||(b[e]={}))[c[f]?c[f]:f]=g}return b}function encodeJSON(a){function b(a){var c=[],d=0,e,f,g;for(e in a)f=a[e],g=typeof f,g=="string"?f='"'+f+'"':g=="object"&&(f=b(f)),c[d++]='"'+e+'":'+f;return"{"+c.join(",")+"}"}return b(a)}function decodeJSON(a){try{return window.eval("("+a+")")||{}}catch(b){return{}}}var lang=$.layout.language,options={name:"",containerClass:"ui-layout-container",scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,autoBindCustomButtons:!1,zIndex:null,initPanes:!0,showErrorMessages:!0,defaults:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:lang.Close,togglerTip_closed:lang.Open,togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskIframesOnResize:!0,resizeNestedLayout:!0,resizeWhileDragging:!1,resizeContentWhileDragging:!1,noRoomToOpenTip:lang.noRoomToOpenTip,resizerTip:lang.Resize,sliderTip:lang.Slide,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:$.layout.browser.webkit,preventPrematureSlideClose:!1,showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"none",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,triggerEventsOnLoad:!1,triggerEventsWhileDragging:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0},useStateCookie:!1,cookie:{name:"",autoSave:!0,autoLoad:!0,domain:"",path:"",expires:"",secure:!1,keys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden"}},effects={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},state={id:"layout"+(new Date).getTime(),initialized:!1,container:{},north:{},south:{},east:{},west:{},center:{},cookie:{}},_c={allPanes:"north,south,west,east,center",borderPanes:"north,south,west,east",altSide:{north:"south",south:"north",east:"west",west:"east"},hidden:{visibility:"hidden"},visible:{visibility:"visible"},zIndex:{pane_normal:1,resizer_normal:2,iframe_mask:2,pane_sliding:100,pane_animate:1e3,resizer_drag:1e4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"Top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"},pins:[]},south:{side:"Bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"},pins:[]},east:{side:"Right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"},pins:[]},west:{side:"Left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"},pins:[]},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},timer={data:{},set:function(a,b,c){timer.clear(a),timer.data[a]=setTimeout(b,c)},clear:function(a){var b=timer.data;b[a]&&(clearTimeout(b[a]),delete b[a])}},isStr=function(a){try{return typeof a=="string"||typeof a=="object"&&a.constructor.toString().match(/string/i)!==null}catch(b){return!1}},str=function(a){return isStr(a)?$.trim(a):a==undefined||a==null?"":a},min=function(a,b){return Math.min(a,b)},max=function(a,b){return Math.max(a,b)},_transformData=function(a){var b,c={cookie:{},defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}};return a=a||{},a.effects||a.cookie||a.defaults||a.north||a.south||a.west||a.east||a.center?c=$.extend(!0,c,a):$.each(a,function(a,d){b=a.split("__");if(!b[1]||c[b[0]])c[b[1]?b[0]:"defaults"][b[1]?b[1]:b[0]]=d}),c},_queue=function(a,b,c){function e(f){var g=_c[f];if(!g.doCallback)g.doCallback=!0,g.callback=a+","+b+","+(c?1:0);else{d.push(f);var h=g.callback.split(",")[1];h!=b&&!$.inArray(h,d)>=0&&e(h)}}var d=[];$.each(_c.borderPanes.split(","),function(a,b){if(_c[b].isMoving)return e(b),!1})},_dequeue=function(a){var b=_c[a];_c.isLayoutBusy=!1,delete b.isMoving;if(!b.doCallback||!b.callback)return;b.doCallback=!1;var c=b.callback.split(","),d=c[2]>0?!0:!1;c[0]=="open"?open(c[1],d):c[0]=="close"&&close(c[1],d),b.doCallback||(b.callback=null)},_execCallback=function(pane,v_fn){if(!v_fn)return;var fn;try{if(typeof v_fn=="function")fn=v_fn;else{if(!isStr(v_fn))return;if(v_fn.match(/,/)){var args=v_fn.split(",");fn=eval(args[0]);if(typeof fn=="function"&&args.length>1)return fn(args[1])}else fn=eval(v_fn)}if(typeof fn=="function")return pane&&$Ps[pane]?fn(pane,$Ps[pane],state[pane],options[pane],options.name):fn(Instance,state,options,options.name)}catch(ex){}},_fixIframe=function(a){if($.layout.browser.mozilla)return;var b=$Ps[a];state[a].tagName=="IFRAME"?b.css(_c.hidden).css(_c.visible):b.find("IFRAME").css(_c.hidden).css(_c.visible)},cssW=function(a,b){var c=isStr(a),d=c?$Ps[a]:$(a);return d.length?(isNaN(b)&&(b=c?getPaneSize(a):d.outerWidth()),$.layout.cssWidth(d,b)):0},cssH=function(a,b){var c=isStr(a),d=c?$Ps[a]:$(a);return d.length?(isNaN(b)&&(b=c?getPaneSize(a):d.outerHeight()),$.layout.cssHeight(d,b)):0},cssSize=function(a,b){return _c[a].dir=="horz"?cssH(a,b):cssW(a,b)},cssMinDims=function(a){var b=_c[a].dir,c={minWidth:1001-cssW(a,1e3),minHeight:1001-cssH(a,1e3)};return b=="horz"&&(c.minSize=c.minHeight),b=="vert"&&(c.minSize=c.minWidth),c},setOuterWidth=function(a,b,c){var d=a,e;isStr(a)?d=$Ps[a]:a.jquery||(d=$(a)),e=cssW(d,b),d.css({width:e}),e>0?c&&d.data("autoHidden")&&d.innerHeight()>0&&(d.show().data("autoHidden",!1),$.layout.browser.mozilla||d.css(_c.hidden).css(_c.visible)):c&&!d.data("autoHidden")&&d.hide().data("autoHidden",!0)},setOuterHeight=function(a,b,c){var d=a,e;isStr(a)?d=$Ps[a]:a.jquery||(d=$(a)),e=cssH(d,b),d.css({height:e,visibility:"visible"}),e>0&&d.innerWidth()>0?c&&d.data("autoHidden")&&(d.show().data("autoHidden",!1),$.layout.browser.mozilla||d.css(_c.hidden).css(_c.visible)):c&&!d.data("autoHidden")&&d.hide().data("autoHidden",!0)},setOuterSize=function(a,b,c){_c[pane].dir=="horz"?setOuterHeight(a,b,c):setOuterWidth(a,b,c)},_parseSize=function(a,b,c){c||(c=_c[a].dir),isStr(b)&&b.match(/%/)&&(b=parseInt(b,10)/100);if(b===0)return 0;if(b>=1)return parseInt(b,10);if(b>0){var d=options,e;return c=="horz"?e=sC.innerHeight-($Ps.north?d.north.spacing_open:0)-($Ps.south?d.south.spacing_open:0):c=="vert"&&(e=sC.innerWidth-($Ps.west?d.west.spacing_open:0)-($Ps.east?d.east.spacing_open:0)),Math.floor(e*b)}if(a=="center")return 0;var f=$Ps[a],g=c=="horz"?"height":"width",h=$.layout.showInvisibly(f),i=f.css(g);return f.css(g,"auto"),b=g=="height"?f.outerHeight():f.outerWidth(),f.css(g,i).css(h),b},getPaneSize=function(a,b){var c=$Ps[a],d=options[a],e=state[a],f=b?d.spacing_open:0,g=b?d.spacing_closed:0;return!c||e.isHidden?0:e.isClosed||e.isSliding&&b?g:_c[a].dir=="horz"?c.outerHeight()+f:c.outerWidth()+f},setSizeLimits=function(a,b){if(!isInitialized())return;var c=options[a],d=state[a],e=_c[a],f=e.dir,g=e.side.toLowerCase(),h=e.sizeType.toLowerCase(),i=b!=undefined?b:d.isSliding,j=$Ps[a],k=c.spacing_open,l=_c.altSide[a],m=state[l],n=$Ps[l],o=!n||m.isVisible===!1||m.isSliding?0:f=="horz"?n.outerHeight():n.outerWidth(),p=(!n||m.isHidden?0:options[l][m.isClosed!==!1?"spacing_closed":"spacing_open"])||0,q=f=="horz"?sC.innerHeight:sC.innerWidth,r=cssMinDims("center"),s=f=="horz"?max(options.center.minHeight,r.minHeight):max(options.center.minWidth,r.minWidth),t=q-k-(i?0:_parseSize("center",s,f)+o+p),u=d.minSize=max(_parseSize(a,c.minSize),cssMinDims(a).minSize),v=d.maxSize=min(c.maxSize?_parseSize(a,c.maxSize):1e5,t),w=d.resizerPosition={},x=sC.insetTop,y=sC.insetLeft,z=sC.innerWidth,A=sC.innerHeight,B=c.spacing_open;switch(a){case"north":w.min=x+u,w.max=x+v;break;case"west":w.min=y+u,w.max=y+v;break;case"south":w.min=x+A-v-B,w.max=x+A-u-B;break;case"east":w.min=y+z-v-B,w.max=y+z-u-B}},calcNewCenterPaneDims=function(){var a={top:getPaneSize("north",!0),bottom:getPaneSize("south",!0),left:getPaneSize("west",!0),right:getPaneSize("east",!0),width:0,height:0};return a.width=sC.innerWidth-a.left-a.right,a.height=sC.innerHeight-a.bottom-a.top,a.top+=sC.insetTop,a.bottom+=sC.insetBottom,a.left+=sC.insetLeft,a.right+=sC.insetRight,a},elDims=function(a){return $.layout.getElementDimensions(a)},elCSS=function(a,b){return $.layout.getElementCSS(a,b)},getHoverClasses=function(a,b){var c=$(a),d=c.data("layoutRole"),e=c.data("layoutEdge"),f=options[e],g=f[d+"Class"],h="-"+e,i="-open",j="-closed",k="-sliding",l="-hover ",m=c.hasClass(g+j)?j:i,n=m==j?i:j,o=g+l+(g+h+l)+(g+m+l)+(g+h+m+l);return b&&(o+=g+n+l+(g+h+n+l)),d=="resizer"&&c.hasClass(g+k)&&(o+=g+k+l+(g+h+k+l)),$.trim(o)},addHover=function(a,b){var c=$(b||this);a&&c.data("layoutRole")=="toggler"&&a.stopPropagation(),c.addClass(getHoverClasses(c))},removeHover=function(a,b){var c=$(b||this);c.removeClass(getHoverClasses(c,!0))},onResizerEnter=function(a){$("body").disableSelection(),addHover(a,this)},onResizerLeave=function(a,b){var c=b||this,d=$(c).data("layoutEdge"),e=d+"ResizerLeave";timer.clear(d+"_openSlider"),timer.clear(e),b?state[d].isResizing||$("body").enableSelection():(removeHover(a,this),timer.set(e,function(){onResizerLeave(a,c)},200))},_create=function(){initOptions();var a=options;return $.layout.browser.boxModel=$.support.boxModel,a.useStateCookie&&a.cookie.autoLoad&&loadCookie(),state.creatingLayout=!0,!1===_execCallback(null,a.onload_start)?"cancel":(_initContainer(),initHotkeys(),a.autoBindCustomButtons&&initButtons(),$(window).bind("unload."+sID,unload),a.initPanes&&_initLayoutElements(),delete state.creatingLayout,state.initialized)},isInitialized=function(){return state.initialized||state.creatingLayout?!0:_initLayoutElements()},_initLayoutElements=function(){var a=options;if(!$N.is(":visible"))return!1;if(!getPane("center").length)return a.showErrorMessages&&alert(lang.errCenterPaneMissing),!1;state.creatingLayout=!0,$.extend(sC,elDims($N)),initPanes(),sizeContent();if(a.scrollToBookmarkOnLoad){var b=self.location;b.hash&&b.replace(b.hash)}return a.resizeWithWindow&&!$N.data("layoutRole")&&$(window).bind("resize."+sID,windowResize),delete state.creatingLayout,state.initialized=!0,_execCallback(null,a.onload_end||a.onload),!0},windowResize=function(){var a=Number(options.resizeWithWindowDelay);a<10&&(a=100),timer.clear("winResize"),timer.set("winResize",function(){timer.clear("winResize"),timer.clear("winResizeRepeater");var a=elDims($N);(a.innerWidth!==sC.innerWidth||a.innerHeight!==sC.innerHeight)&&resizeAll()},a),timer.data.winResizeRepeater||setWindowResizeRepeater()},setWindowResizeRepeater=function(){var a=Number(options.resizeWithWindowMaxDelay);a>0&&timer.set("winResizeRepeater",function(){setWindowResizeRepeater(),resizeAll()},a)},unload=function(){var a=options;state.cookie=getState(),_execCallback(null,a.onunload_start),a.useStateCookie&&a.cookie.autoSave&&saveCookie(),_execCallback(null,a.onunload_end||a.onunload)},_initContainer=function(){var a=sC.tagName=$N[0].tagName,b=options,c=a=="BODY",d="overflow,position,margin,padding,border",e={},f="hidden",g=$N.is(":visible");sC.selector=$N.selector.split(".slice")[0],sC.ref=a+"/"+sC.selector,$N.data("layout",Instance).data("layoutContainer",sID).addClass(b.containerClass);if(!$N.data("layoutCSS")){if(c){e=$.extend(elCSS($N,d),{height:$N.css("height"),overflow:$N.css("overflow"),overflowX:$N.css("overflowX"),overflowY:$N.css("overflowY")});var h=$("html");h.data("layoutCSS",{height:"auto",overflow:h.css("overflow"),overflowX:h.css("overflowX"),overflowY:h.css("overflowY")})}else e=elCSS($N,d+",top,bottom,left,right,width,height,overflow,overflowX,overflowY");$N.data("layoutCSS",e)}try{if(c)$("html").css({height:"100%",overflow:f,overflowX:f,overflowY:f}),$("body").css({position:"relative",height:"100%",overflow:f,overflowX:f,overflowY:f,margin:0,padding:0,border:"none"}),$.extend(sC,elDims($N));else{e={overflow:f,overflowX:f,overflowY:f};var i=$N.css("position"),j=$N.css("height");!$N.data("layoutRole")&&(!i||!i.match(/fixed|absolute|relative/))&&(e.position="relative"),$N.css(e),g&&($.extend(sC,elDims($N)),b.showErrorMessages&&sC.innerHeight<2&&alert(lang.errContainerHeight.replace(/CONTAINER/,sC.ref)))}}catch(k){}},initHotkeys=function(a){if(!a||a=="all")a=_c.borderPanes;$.each(a.split(","),function(a,b){var c=options[b];if(c.enableCursorHotkey||c.customHotkey)return $(document).bind("keydown."+sID,keyDown),!1})},initOptions=function(){function h(b){for(var c in a)b[c]!=undefined&&(b[a[c]]=b[c],delete b[c])}opts=_transformData(opts);var a={applyDefaultStyles:"applyDemoStyles"};h(opts.defaults),$.each(_c.allPanes.split(","),function(a,b){h(opts[b])}),opts.effects&&($.extend(effects,opts.effects),delete opts.effects),$.extend(options.cookie,opts.cookie);var b="name,containerClass,zIndex,scrollToBookmarkOnLoad,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onload_start,onload_end,onunload,onunload_start,onunload_end,autoBindCustomButtons,useStateCookie,showErrorMessages";$.each(b.split(","),function(a,b){opts[b]!==undefined?options[b]=opts[b]:opts.defaults[b]!==undefined&&(options[b]=opts.defaults[b],delete opts.defaults[b])}),$.each("paneSelector,resizerCursor,customHotkey".split(","),function(a,b){delete opts.defaults[b]}),$.extend(!0,options.defaults,opts.defaults),_c.center=$.extend(!0,{},_c.panes,_c.center);var c=options.zIndex;if(c===0||c>0)_c.zIndex.pane_normal=c,_c.zIndex.resizer_normal=c+1,_c.zIndex.iframe_mask=c+1;$.extend(options.center,opts.center);var d=$.extend(!0,{},options.defaults,opts.defaults,options.center),e="paneClass,contentSelector,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,onresize,onresize_start,onresize_end,resizeNestedLayout,resizeContentWhileDragging,findNestedContent,onsizecontent,onsizecontent_start,onsizecontent_end".split(",");$.each(e,function(a,b){options.center[b]=d[b]});var f,g=options.defaults;$.each(_c.borderPanes.split(","),function(a,b){_c[b]=$.extend(!0,{},_c.panes,_c[b]),f=options[b]=$.extend(!0,{},options.defaults,options[b],opts.defaults,opts[b]),f.paneClass||(f.paneClass="ui-layout-pane"),f.resizerClass||(f.resizerClass="ui-layout-resizer"),f.togglerClass||(f.togglerClass="ui-layout-toggler"),$.each(["_open","_close",""],function(a,c){var d="fxName"+c,e="fxSpeed"+c,h="fxSettings"+c;f[d]=opts[b][d]||opts[b].fxName||opts.defaults[d]||opts.defaults.fxName||f[d]||f.fxName||g[d]||g.fxName||"none";var i=f[d];if(i=="none"||!$.effects||!$.effects[i]||!effects[i]&&!f[h]&&!f.fxSettings)i=f[d]="none";var j=effects[i]||{},k=j.all||{},l=j[b]||{};f[h]=$.extend({},k,l,g.fxSettings||{},g[h]||{},f.fxSettings,f[h],opts.defaults.fxSettings,opts.defaults[h]||{},opts[b].fxSettings,opts[b][h]||{}),f[e]=opts[b][e]||opts[b].fxSpeed||opts.defaults[e]||opts.defaults.fxSpeed||f[e]||f[h].duration||f.fxSpeed||f.fxSettings.duration||g.fxSpeed||g.fxSettings.duration||l.duration||k.duration||"normal"})})},getPane=function(a){var b=options[a].paneSelector;if(b.substr(0,1)==="#")return $N.find(b).eq(0);var c=$N.children(b).eq(0);return c.length?c:$N.children("form:first").children(b).eq(0)},initPanes=function(){$.each(_c.allPanes.split(","),function(a,b){addPane(b,!0)}),initHandles(),$.each(_c.borderPanes.split(","),function(a,b){$Ps[b]&&state[b].isVisible&&(setSizeLimits(b),makePaneFit(b))}),sizeMidPanes("center"),setTimeout(function(){$.each(_c.allPanes.split(","),function(a,b){var c=options[b];$Ps[b]&&state[b].isVisible&&(c.triggerEventsOnLoad&&_execCallback(b,c.onresize_end||c.onresize),resizeNestedLayout(b))})},50),options.showErrorMessages&&$N.innerHeight()<2&&alert(lang.errContainerHeight.replace(/CONTAINER/,sC.ref))},addPane=function(a,b){if(!b&&!isInitialized())return;var c=options[a],d=state[a],e=_c[a],f=d.fx,g=e.dir,h=c.spacing_open||0,i=a=="center",j={},k=$Ps[a],l,m,n;k?removePane(a):$Cs[a]=!1,k=$Ps[a]=getPane(a);if(!k.length){$Ps[a]=!1;return}if(!k.data("layoutCSS")){var o="position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border";k.data("layoutCSS",elCSS(k,o))}k.data("parentLayout",Instance).data("layoutRole","pane").data("layoutEdge",a).css(e.cssReq).css("zIndex",_c.zIndex.pane_normal).css(c.applyDemoStyles?e.cssDemo:{}).addClass(c.paneClass+" "+c.paneClass+"-"+a).bind("mouseenter."+sID,addHover).bind("mouseleave."+sID,removeHover),initContent(a,!1),i||(l=d.size=_parseSize(a,c.size),m=_parseSize(a,c.minSize)||1,n=_parseSize(a,c.maxSize)||1e5,l>0&&(l=max(min(l,n),m)),d.isClosed=!1,d.isSliding=!1,d.isResizing=!1,d.isHidden=!1),d.tagName=k[0].tagName,d.edge=a,d.noRoom=!1,d.isVisible=!0;switch(a){case"north":j.top=sC.insetTop,j.left=sC.insetLeft,j.right=sC.insetRight;break;case"south":j.bottom=sC.insetBottom,j.left=sC.insetLeft,j.right=sC.insetRight;break;case"west":j.left=sC.insetLeft;break;case"east":j.right=sC.insetRight;break;case"center":}g=="horz"?j.height=max(1,cssH(a,l)):g=="vert"&&(j.width=max(1,cssW(a,l))),k.css(j),g!="horz"&&sizeMidPanes(a,!0),c.initClosed&&c.closable&&!c.initHidden?close(a,!0,!0):c.initHidden||c.initClosed?hide(a):d.noRoom||k.css("display","block"),k.css("visibility","visible"),c.showOverflowOnHover&&k.hover(allowOverflow,resetOverflow),state.initialized&&(initHandles(a),initHotkeys(a),resizeAll(),d.isVisible&&(c.triggerEventsOnLoad&&_execCallback(a,c.onresize_end||c.onresize),resizeNestedLayout(a)))},initHandles=function(a){if(!a||a=="all")a=_c.borderPanes;$.each(a.split(","),function(a,b){var c=$Ps[b];$Rs[b]=!1,$Ts[b]=!1;if(!c)return;var d=options[b],e=state[b],f=_c[b],g=d.resizerClass,h=d.togglerClass,i=f.side.toLowerCase(),j=e.isVisible?d.spacing_open:d.spacing_closed,k="-"+b,l=e.isVisible?"-open":"-closed",m=$Rs[b]=$("<div></div>"),n=d.closable?$Ts[b]=$("<div></div>"):!1;!e.isVisible&&d.slidable&&m.attr("title",d.sliderTip).css("cursor",d.sliderCursor),m.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-resizer":"").data("parentLayout",Instance).data("layoutRole","resizer").data("layoutEdge",b).css(_c.resizers.cssReq).css("zIndex",_c.zIndex.resizer_normal).css(d.applyDemoStyles?_c.resizers.cssDemo:{}).addClass(g+" "+g+k).appendTo($N),n&&(n.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-toggler":"").data("parentLayout",Instance).data("layoutRole","toggler").data("layoutEdge",b).css(_c.togglers.cssReq).css(d.applyDemoStyles?_c.togglers.cssDemo:{}).addClass(h+" "+h+k).appendTo(m),d.togglerContent_open&&$("<span>"+d.togglerContent_open+"</span>").data("layoutRole","togglerContent").data("layoutEdge",b).addClass("content content-open").css("display","none").appendTo(n),d.togglerContent_closed&&$("<span>"+d.togglerContent_closed+"</span>").data("layoutRole","togglerContent").data("layoutEdge",b).addClass("content content-closed").css("display","none").appendTo(n),enableClosable(b)),initResizable(b),e.isVisible?setAsOpen(b):(setAsClosed(b),bindStartSlidingEvent(b,!0))}),sizeHandles("all")},initContent=function(a,b){if(!isInitialized())return;var c=options[a],d=c.contentSelector,e=$Ps[a],f;d&&(f=$Cs[a]=c.findNestedContent?e.find(d).eq(0):e.children(d).eq(0)),f&&f.length?(f.data("layoutCSS")||f.data("layoutCSS",elCSS(f,"height")),f.css(_c.content.cssReq),c.applyDemoStyles&&(f.css(_c.content.cssDemo),e.css(_c.content.cssDemoPane)),state[a].content={},b!==!1&&sizeContent(a)):$Cs[a]=!1},initButtons=function(){var a="ui-layout-button-",b;$.each("toggle,open,close,pin,toggle-slide,open-slide".split(","),function(c,d){$.each(_c.borderPanes.split(","),function(c,e){$("."+a+d+"-"+e).each(function(){b=$(this).data("layoutName")||$(this).attr("layoutName"),(b==undefined||b==options.name)&&bindButton(this,d,e)})})})},initResizable=function(a){var b=typeof $.fn.draggable=="function",c,d;if(!a||a=="all")a=_c.borderPanes;$.each(a.split(","),function(a,d){var e=options[d],f=state[d],g=_c[d],h=g.dir=="horz"?"top":"left",i,j;if(!b||!$Ps[d]||!e.resizable)return e.resizable=!1,!0;var k=$Ps[d],l=$Rs[d],m=e.resizerClass,n=m+"-drag",o=m+"-"+d+"-drag",p=m+"-dragging",q=m+"-"+d+"-dragging",r=m+"-dragging-limit",s=m+"-"+d+"-dragging-limit",t=!1;f.isClosed||l.attr("title",e.resizerTip).css("cursor",e.resizerCursor),l.bind("mouseenter."+sID,onResizerEnter).bind("mouseleave."+sID,onResizerLeave),l.draggable({containment:$N[0],axis:g.dir=="horz"?"y":"x",delay:0,distance:1,helper:"clone",opacity:e.resizerDragOpacity,addClasses:!1,zIndex:_c.zIndex.resizer_drag,start:function(a,b){e=options[d],f=state[d],j=e.resizeWhileDragging;if(!1===_execCallback(d,e.ondrag_start))return!1;_c.isLayoutBusy=!0,f.isResizing=!0,timer.clear(d+"_closeSlider"),setSizeLimits(d),i=f.resizerPosition,l.addClass(n+" "+o),t=!1,c=$(e.maskIframesOnResize===!0?"iframe":e.maskIframesOnResize).filter(":visible");var g,h=0;c.each(function(){g="ui-layout-mask-"+ ++h,$(this).data("layoutMaskID",g),$('<div id="'+g+'" class="ui-layout-mask ui-layout-mask-'+d+'"/>').css({background:"#fff",opacity:"0.001",zIndex:_c.zIndex.iframe_mask,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css($(this).position()).appendTo(this.parentNode)}),$("body").disableSelection()},drag:function(a,b){t||(b.helper.addClass(p+" "+q).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),t=!0,f.isSliding&&$Ps[d].css("zIndex",_c.zIndex.pane_sliding));var c=0;b.position[h]<i.min?(b.position[h]=i.min,c=-1):b.position[h]>i.max&&(b.position[h]=i.max,c=1),c?(b.helper.addClass(r+" "+s),window.defaultStatus="Panel has reached its "+(c>0&&d.match(/north|west/)||c<0&&d.match(/south|east/)?"maximum":"minimum")+" size"):(b.helper.removeClass(r+" "+s),window.defaultStatus=""),j&&u(a,b,d)},stop:function(a,b){$("body").enableSelection(),window.defaultStatus="",l.removeClass(n+" "+o),f.isResizing=!1,_c.isLayoutBusy=!1,u(a,b,d,!0)}});var u=function(a,b,d,f){var g=b.position,h=_c[d],i,j,k=0;switch(d){case"north":i=g.top;break;case"west":i=g.left;break;case"south":i=sC.offsetHeight-g.top-e.spacing_open;break;case"east":i=sC.offsetWidth-g.left-e.spacing_open}if(f){$("div.ui-layout-mask").each(function(){this.parentNode.removeChild(this)});if(!1===_execCallback(d,e.ondrag_end||e.ondrag))return!1}else c.each(function(){$("#"+$(this).data("layoutMaskID")).css($(this).position()).css({width:this.offsetWidth+"px",height:this.offsetHeight+"px"})});j=i-sC["inset"+h.side],manualSizePane(d,j)}})},destroy=function(){$(window).unbind("."+sID),$(document).unbind("."+sID),$.each(_c.allPanes.split(","),function(a,b){removePane(b,!1,!0)}),$N.removeData("layout").removeData("layoutContainer").removeClass(options.containerClass),!$N.data("layoutEdge")&&$N.data("layoutCSS")&&$N.css($N.data("layoutCSS")).removeData("layoutCSS"),sC.tagName=="BODY"&&($N=$("html")).data("layoutCSS")&&$N.css($N.data("layoutCSS")).removeData("layoutCSS"),unload()},removePane=function(a,b,c){if(!isInitialized())return;if(!$Ps[a])return;var d=$Ps[a],e=$Cs[a],f=$Rs[a],g=$Ts[a],h="-open",i="-sliding",j="-closed",k=options[a].paneClass,l=k+"-"+a,m=[k,k+h,k+j,k+i,l,l+h,l+j,l+i];$.merge(m,getHoverClasses(d,!0)),!!d&&!!d.length&&(b&&!d.data("layoutContainer")&&(!e||!e.length||!e.data("layoutContainer"))?d.remove():(d.removeClass(m.join(" ")).removeData("layoutParent").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+sID),d.data("layoutContainer")||d.css(d.data("layoutCSS")).removeData("layoutCSS"),e&&e.length&&!e.data("layoutContainer")&&e.css(e.data("layoutCSS")).removeData("layoutCSS"))),g&&g.length&&g.remove(),f&&f.length&&f.remove(),$Ps[a]=$Cs[a]=$Rs[a]=$Ts[a]=!1,c||(resizeAll(),state[a]={})},hide=function(a,b){if(!isInitialized())return;var c=options[a],d=state[a],e=$Ps[a],f=$Rs[a];if(!e||d.isHidden)return;if(state.initialized&&!1===_execCallback(a,c.onhide_start))return;d.isSliding=!1,f&&f.hide(),!state.initialized||d.isClosed?(d.isClosed=!0,d.isHidden=!0,d.isVisible=!1,e.hide(),sizeMidPanes(_c[a].dir=="horz"?"all":"center"),(state.initialized||c.triggerEventsOnLoad)&&_execCallback(a,c.onhide_end||c.onhide)):(d.isHiding=!0,close(a,!1,b))},show=function(a,b,c,d){if(!isInitialized())return;var e=options[a],f=state[a],g=$Ps[a],h=$Rs[a];if(!g||!f.isHidden)return;if(!1===_execCallback(a,e.onshow_start))return;f.isSliding=!1,f.isShowing=!0,b===!1?close(a,!0):open(a,!1,c,d)},toggle=function(a,b){if(!isInitialized())return;isStr(a)||(a.stopImmediatePropagation(),a=$(this).data("layoutEdge"));var c=state[str(a)];c.isHidden?show(a):c.isClosed?open(a,!!b):close(a)},_closePane=function(a,b){var c=$Ps[a],d=state[a];c.hide(),d.isClosed=!0,d.isVisible=!1},close=function(a,b,c,d){function n(){if(i.isClosed){bindStartSlidingEvent(a,!0);var b=_c.altSide[a];state[b].noRoom&&(setSizeLimits(b),makePaneFit(b)),!d&&(state.initialized||h.triggerEventsOnLoad)&&(k||_execCallback(a,h.onclose_end||h.onclose),k&&_execCallback(a,h.onshow_end||h.onshow),l&&_execCallback(a,h.onhide_end||h.onhide))}_dequeue(a)}if(!state.initialized&&$Ps[a]){_closePane(a);return}if(!isInitialized())return;var e=$Ps[a],f=$Rs[a],g=$Ts[a],h=options[a],i=state[a],j=!c&&!i.isClosed&&h.fxName_close!="none",k=i.isShowing,l=i.isHiding,m=i.isSliding;delete i.isShowing,delete i.isHiding;if(!e||!h.closable&&!k&&!l)return;if(!b&&i.isClosed&&!k)return;if(_c.isLayoutBusy){_queue("close",a,b);return}if(!k&&!1===_execCallback(a,h.onclose_start))return;_c[a].isMoving=!0,_c.isLayoutBusy=!0,i.isClosed=!0,i.isVisible=!1,l?i.isHidden=!0:k&&(i.isHidden=!1),i.isSliding?bindStopSlidingEvents(a,!1):sizeMidPanes(_c[a].dir=="horz"?"all":"center",!1),setAsClosed(a),j?(lockPaneForFX(a,!0),e.hide(h.fxName_close,h.fxSettings_close,h.fxSpeed_close,function(){lockPaneForFX(a,!1),n()})):(e.hide(),n())},setAsClosed=function(a){var b=$Ps[a],c=$Rs[a],d=$Ts[a],e=options[a],f=state[a],g=_c[a].side.toLowerCase(),h="inset"+_c[a].side,i=e.resizerClass,j=e.togglerClass,k="-"+a,l="-open",m="-sliding",n="-closed";c.css(g,sC[h]).removeClass(i+l+" "+i+k+l).removeClass(i+m+" "+i+k+m).addClass(i+n+" "+i+k+n).unbind("dblclick."+sID),e.resizable&&typeof $.fn.draggable=="function"&&c.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title",""),d&&(d.removeClass(j+l+" "+j+k+l).addClass(j+n+" "+j+k+n).attr("title",e.togglerTip_closed),d.children(".content-open").hide(),d.children(".content-closed").css("display","block")),syncPinBtns(a,!1),state.initialized&&sizeHandles("all")},open=function(a,b,c,d){function l(){i.isVisible&&(_fixIframe(a),i.isSliding||sizeMidPanes(_c[a].dir=="vert"?"center":"all",!1),setAsOpen(a)),_dequeue(a)}if(!isInitialized())return;var e=$Ps[a],f=$Rs[a],g=$Ts[a],h=options[a],i=state[a],j=!c&&i.isClosed&&h.fxName_open!="none",k=i.isShowing;delete i.isShowing;if(!e||!h.resizable&&!h.closable&&!k)return;if(i.isVisible&&!i.isSliding)return;if(i.isHidden&&!k){show(a,!0);return}if(_c.isLayoutBusy){_queue("open",a,b);return}setSizeLimits(a,b);if(!1===_execCallback(a,h.onopen_start))return;setSizeLimits(a,b);if(i.minSize>i.maxSize){syncPinBtns(a,!1),!d&&h.noRoomToOpenTip&&alert(h.noRoomToOpenTip);return}_c[a].isMoving=!0,_c.isLayoutBusy=!0,b?bindStopSlidingEvents(a,!0):i.isSliding?bindStopSlidingEvents(a,!1):h.slidable&&bindStartSlidingEvent(a,!1),i.noRoom=!1,makePaneFit(a),i.isVisible=!0,i.isClosed=!1,k&&(i.isHidden=!1),j?(lockPaneForFX(a,!0),e.show(h.fxName_open,h.fxSettings_open,h.fxSpeed_open,function(){lockPaneForFX(a,!1),l()})):(e.show(),l())},setAsOpen=function(a,b){var c=$Ps[a],d=$Rs[a],e=$Ts[a],f=options[a],g=state[a],h=_c[a].side.toLowerCase(),i="inset"+_c[a].side,j=f.resizerClass,k=f.togglerClass,l="-"+a,m="-open",n="-closed",o="-sliding";d.css(h,sC[i]+getPaneSize(a)).removeClass(j+n+" "+j+l+n).addClass(j+m+" "+j+l+m),g.isSliding?d.addClass(j+o+" "+j+l+o):d.removeClass(j+o+" "+j+l+o),f.resizerDblClickToggle&&d.bind("dblclick",toggle),removeHover(0,d),f.resizable&&typeof $.fn.draggable=="function"?d.draggable("enable").css("cursor",f.resizerCursor).attr("title",f.resizerTip):g.isSliding||d.css("cursor","default"),e&&(e.removeClass(k+n+" "+k+l+n).addClass(k+m+" "+k+l+m).attr("title",f.togglerTip_open),removeHover(0,e),e.children(".content-closed").hide(),e.children(".content-open").css("display","block")),syncPinBtns(a,!g.isSliding),$.extend(g,elDims(c)),state.initialized&&(sizeHandles("all"),sizeContent(a,!0)),!b&&(state.initialized||f.triggerEventsOnLoad)&&c.is(":visible")&&(_execCallback(a,f.onopen_end||f.onopen),g.isShowing&&_execCallback(a,f.onshow_end||f.onshow),state.initialized&&(_execCallback(a,f.onresize_end||f.onresize),resizeNestedLayout(a)))},slideOpen=function(a){function f(a){d.isClosed?_c[c].isMoving||open(c,!0):bindStopSlidingEvents(c,!0)}if(!isInitialized())return;var b=isStr(a)?null:a,c=b?$(this).data("layoutEdge"):a,d=state[c],e=options[c].slideDelay_open;b&&b.stopImmediatePropagation(),d.isClosed&&b&&b.type=="mouseenter"&&e>0?timer.set(c+"_openSlider",f,e):f()},slideClose=function(a){function g(){e.isClosed?bindStopSlidingEvents(c,!1):_c[c].isMoving||close(c)}if(!isInitialized())return;var b=isStr(a)?null:a,c=b?$(this).data("layoutEdge"):a,d=options[c],e=state[c],f=_c[c].isMoving?1e3:300;if(e.isClosed||e.isResizing)return;if(d.slideTrigger_close=="click")g();else{if(d.preventQuickSlideClose&&_c.isLayoutBusy)return;if(d.preventPrematureSlideClose&&b&&$.layout.isMouseOverElem(b,$Ps[c]))return;b?timer.set(c+"_closeSlider",g,max(d.slideDelay_close,f)):g()}},slideToggle=function(a){toggle(a,!0)},lockPaneForFX=function(a,b){var c=$Ps[a];if(b)c.css({zIndex:_c.zIndex.pane_animate}),a=="south"?c.css({top:sC.insetTop+sC.innerHeight-c.outerHeight()}):a=="east"&&c.css({left:sC.insetLeft+sC.innerWidth-c.outerWidth()});else{c.css({zIndex:state[a].isSliding?_c.zIndex.pane_sliding:_c.zIndex.pane_normal}),a=="south"?c.css({top:"auto"}):a=="east"&&c.css({left:"auto"});var d=options[a];$.layout.browser.msie&&d.fxOpacityFix&&d.fxName_open!="slide"&&c.css("filter")&&c.css("opacity")==1&&c[0].style.removeAttribute("filter")}},bindStartSlidingEvent=function(a,b){var c=options[a],d=$Ps[a],e=$Rs[a],f=c.slideTrigger_open.toLowerCase();if(!e||b&&!c.slidable)return;f.match(/mouseover/)?f=c.slideTrigger_open="mouseenter":f.match(/click|dblclick|mouseenter/)||(f=c.slideTrigger_open="click"),e[b?"bind":"unbind"](f+"."+sID,slideOpen).css("cursor",b?c.sliderCursor:"default").attr("title",b?c.sliderTip:"")},bindStopSlidingEvents=function(a,b){function j(b){timer.clear(a+"_closeSlider"),b.stopPropagation()}var c=options[a],d=state[a],e=_c.zIndex,f=c.slideTrigger_close.toLowerCase(),g=b?"bind":"unbind",h=$Ps[a],i=$Rs[a];d.isSliding=b,timer.clear(a+"_closeSlider"),b&&bindStartSlidingEvent(a,!1),h.css("zIndex",b?e.pane_sliding:e.pane_normal),i.css("zIndex",b?e.pane_sliding:e.resizer_normal),f.match(/click|mouseleave/)||(f=c.slideTrigger_close="mouseleave"),i[g](f,slideClose),f=="mouseleave"&&(h[g]("mouseleave."+sID,slideClose),i[g]("mouseenter."+sID,j),h[g]("mouseenter."+sID,j)),b?f=="click"&&!c.resizable&&(i.css("cursor",b?c.sliderCursor:"default"),i.attr("title",b?c.togglerTip_open:"")):timer.clear(a+"_closeSlider")},makePaneFit=function(a,b,c,d){var e=options[a],f=state[a],g=_c[a],h=$Ps[a],i=$Rs[a],j=g.dir=="vert",k=!1;if(a=="center"||j&&f.noVerticalRoom)k=f.maxHeight>0,k&&f.noRoom?(h.show(),i&&i.show(),f.isVisible=!0,f.noRoom=!1,j&&(f.noVerticalRoom=!1),_fixIframe(a)):!k&&!f.noRoom&&(h.hide(),i&&i.hide(),f.isVisible=!1,f.noRoom=!0);if(a!="center")if(f.minSize<=f.maxSize){k=!0;if(f.size>f.maxSize)sizePane(a,f.maxSize,c,d);else if(f.size<f.minSize)sizePane(a,f.minSize,c,d);else if(i&&h.is(":visible")){var l=g.side.toLowerCase(),m=f.size+sC["inset"+g.side];$.layout.cssNum(i,l)!=m&&i.css(l,m)}f.noRoom&&(f.wasOpen&&e.closable?e.autoReopen?open(a,!1,!0,!0):f.noRoom=!1:show(a,f.wasOpen,!0,!0))}else f.noRoom||(f.noRoom=!0,f.wasOpen=!f.isClosed&&!f.isSliding,f.isClosed||(e.closable?close(a,!0,!0):hide(a,!0)))},manualSizePane=function(a,b,c){if(!isInitialized())return;var d=options[a],e=d.resizeWhileDragging&&!_c.isLayoutBusy;d.autoResize=!1,sizePane(a,b,c,e)},sizePane=function(a,b,c,d){if(!isInitialized())return;var e=options[a],f=state[a],g=$Ps[a],h=$Rs[a],i=_c[a].side.toLowerCase(),j=_c[a].sizeType.toLowerCase(),k="inset"+_c[a].side,l=_c.isLayoutBusy&&!e.triggerEventsWhileDragging,m;setSizeLimits(a),m=f.size,b=_parseSize(a,b),b=max(b,_parseSize(a,e.minSize)),b=min(b,f.maxSize);if(b<f.minSize){makePaneFit(a,!1,c);return}if(!d&&b==m)return;!c&&state.initialized&&f.isVisible&&_execCallback(a,e.onresize_start),g.css(j,max(1,cssSize(a,b))),f.size=b,$.extend(f,elDims(g)),h&&g.is(":visible")&&h.css(i,b+sC[k]),sizeContent(a),!c&&!l&&state.initialized&&f.isVisible&&(_execCallback(a,e.onresize_end||e.onresize),resizeNestedLayout(a)),c||(f.isSliding||sizeMidPanes(_c[a].dir=="horz"?"all":"center",l,d),sizeHandles("all"));var n=_c.altSide[a];b<m&&state[n].noRoom&&(setSizeLimits(n),makePaneFit(n,!1,c))},sizeMidPanes=function(a,b,c){if(!a||a=="all")a="east,west,center";$.each(a.split(","),function(a,d){if(!$Ps[d])return;var e=options[d],f=state[d],g=$Ps[d],h=$Rs[d],i=d=="center",j=!0,k={},l=calcNewCenterPaneDims();$.extend(f,elDims(g));if(d=="center"){if(!c&&f.isVisible&&l.width==f.outerWidth&&l.height==f.outerHeight)return!0;$.extend(f,cssMinDims(d),{maxWidth:l.width,maxHeight:l.height}),k=l,k.width=cssW(d,k.width),k.height=cssH(d,k.height),j=k.width>0&&k.height>0;if(!j&&!state.initialized&&e.minWidth>0){var m=e.minWidth-f.outerWidth,n=options.east.minSize||0,o=options.west.minSize||0,p=state.east.size,q=state.west.size,r=p,s=q;m>0&&state.east.isVisible&&p>n&&(r=max(p-n,p-m),m-=p-r),m>0&&state.west.isVisible&&q>o&&(s=max(q-o,q-m),m-=q-s);if(m==0){p!=n&&sizePane("east",r,!0),q!=o&&sizePane("west",s,!0),sizeMidPanes("center",b,c);return}}}else{f.isVisible&&!f.noVerticalRoom&&$.extend(f,elDims(g),cssMinDims(d));if(!c&&!f.noVerticalRoom&&l.height==f.outerHeight)return!0;k.top=l.top,k.bottom=l.bottom,k.height=cssH(d,l.height),f.maxHeight=max(0,k.height),j=f.maxHeight>0,j||(f.noVerticalRoom=!0)}j?(!b&&state.initialized&&_execCallback(d,e.onresize_start),g.css(k),f.noRoom&&!f.isClosed&&!f.isHidden&&makePaneFit(d),f.isVisible&&($.extend(f,elDims(g)),state.initialized&&sizeContent(d))):!f.noRoom&&f.isVisible&&makePaneFit(d);if(!f.isVisible)return!0;if(d=="center"){var t=$.layout.browser,u=t.isIE6||t.msie&&!t.boxModel;$Ps.north&&(u||state.north.tagName=="IFRAME")&&$Ps.north.css("width",cssW($Ps.north,sC.innerWidth)),$Ps.south&&(u||state.south.tagName=="IFRAME")&&$Ps.south.css("width",cssW($Ps.south,sC.innerWidth))}!b&&state.initialized&&(_execCallback(d,e.onresize_end||e.onresize),resizeNestedLayout(d))})},resizeAll=function(){if(!state.initialized){_initLayoutElements();return}var a=sC.innerWidth,b=sC.innerHeight;if(!$N.is(":visible:"))return;$.extend(state.container,elDims($N));if(!sC.outerHeight)return;if(!1===_execCallback(null,options.onresizeall_start))return!1;var c=sC.innerHeight<b,d=sC.innerWidth<a,e,f,g,h;$.each(["south","north","east","west"],function(a,b){if(!$Ps[b])return;g=state[b],f=options[b],h=_c[b].dir,f.autoResize&&g.size!=f.size?sizePane(b,f.size,!0,!0):(setSizeLimits(b),makePaneFit(b,!1,!0,!0))}),sizeMidPanes("all",!0,!0),sizeHandles("all"),f=options,$.each(_c.allPanes.split(","),function(a,b){e=$Ps[b];if(!e)return;state[b].isVisible&&(_execCallback(b,f[b].onresize_end||f[b].onresize),resizeNestedLayout(b))}),_execCallback(null,f.onresizeall_end||f.onresizeall)},resizeNestedLayout=function(a){var b=$Ps[a],c=$Cs[a],d="layoutContainer";options[a].resizeNestedLayout&&(b.data(d)?b.layout().resizeAll():c&&c.data(d)&&c.layout().resizeAll())},sizeContent=function(a,b){if(!isInitialized())return;if(!a||a=="all")a=_c.allPanes;$.each(a.split(","),function(a,c){function j(a){return max(g.css.paddingBottom,parseInt(a.css("marginBottom"),10)||0)}function k(){var a=options[c].contentIgnoreSelector,b=e.nextAll().not(a||":lt(0)"),d=b.filter(":visible"),f=d.filter(":last");h={top:e[0].offsetTop,height:e.outerHeight(),numFooters:b.length,hiddenFooters:b.length-d.length,spaceBelow:0},h.spaceAbove=h.top,h.bottom=h.top+h.height,f.length?h.spaceBelow=f[0].offsetTop+f.outerHeight()-h.bottom+j(f):h.spaceBelow=j(e)}var d=$Ps[c],e=$Cs[c],f=options[c],g=state[c],h=g.content;if(!d||!e||!d.is(":visible"))return!0;if(!1===_execCallback(null,f.onsizecontent_start))return;if(!_c.isLayoutBusy||h.top==undefined||b||f.resizeContentWhileDragging)k(),h.hiddenFooters>0&&d.css("overflow")=="hidden"&&(d.css("overflow","visible"),k(),d.css("overflow","hidden"));var i=g.innerHeight-(h.spaceAbove-g.css.paddingTop)-(h.spaceBelow-g.css.paddingBottom);if(!e.is(":visible")||h.height!=i)setOuterHeight(e,i,!0),h.height=i;state.initialized&&(_execCallback(c,f.onsizecontent_end||f.onsizecontent),resizeNestedLayout(c))})},sizeHandles=function(a){if(!a||a=="all")a=_c.borderPanes;$.each(a.split(","),function(a,b){var c=options[b],d=state[b],e=$Ps[b],f=$Rs[b],g=$Ts[b],h;if(!e||!f)return;var i=_c[b].dir,j=d.isClosed?"_closed":"_open",k=c["spacing"+j],l=c["togglerAlign"+j],m=c["togglerLength"+j],n,o,p={};if(k==0){f.hide();return}!d.noRoom&&!d.isHidden&&f.show(),i=="horz"?(n=e.outerWidth(),d.resizerLength=n,f.css({width:max(1,cssW(f,n)),height:max(0,cssH(f,k)),left:$.layout.cssNum(e,"left")})):(n=e.outerHeight(),d.resizerLength=n,f.css({height:max(1,cssH(f,n)),width:max(0,cssW(f,k)),top:sC.insetTop+getPaneSize("north",!0)})),removeHover(c,f);if(g){if(m==0||d.isSliding&&c.hideTogglerOnSlide){g.hide();return}g.show();if(!(m>0)||m=="100%"||m>n)m=n,o=0;else if(isStr(l))switch(l){case"top":case"left":o=0;break;case"bottom":case"right":o=n-m;break;case"middle":case"center":default:o=Math.floor((n-m)/2)}else{var q=parseInt(l,10);l>=0?o=q:o=n-m+q}if(i=="horz"){var r=cssW(g,m);g.css({width:max(0,r),height:max(1,cssH(g,k)),left:o,top:0}),g.children(".content").each(function(){h=$(this),h.css("marginLeft",Math.floor((r-h.outerWidth())/2))})}else{var s=cssH(g,m);g.css({height:max(0,s),width:max(1,cssW(g,k)),top:o,left:0}),g.children(".content").each(function(){h=$(this),h.css("marginTop",Math.floor((s-h.outerHeight())/2))})}removeHover(0,g)}!state.initialized&&(c.initHidden||d.noRoom)&&(f.hide(),g&&g.hide())})},enableClosable=function(a){if(!isInitialized())return;var b=$Ts[a],c=options[a];if(!b)return;c.closable=!0,b.bind("click."+sID,function(b){b.stopPropagation(),toggle(a)}).bind("mouseenter."+sID,addHover).bind("mouseleave."+sID,removeHover).css("visibility","visible").css("cursor","pointer").attr("title",state[a].isClosed?c.togglerTip_closed:c.togglerTip_open).show()},disableClosable=function(a,b){if(!isInitialized())return;var c=$Ts[a];if(!c)return;options[a].closable=!1,state[a].isClosed&&open(a,!1,!0),c.unbind("."+sID).css("visibility",b?"hidden":"visible").css("cursor","default").attr("title","")},enableSlidable=function(a){if(!isInitialized())return;var b=$Rs[a],c=options[a];if(!b||!b.data("draggable"))return;options[a].slidable=!0,s.isClosed&&bindStartSlidingEvent(a,!0)},disableSlidable=function(a){if(!isInitialized())return;var b=$Rs[a];if(!b)return;options[a].slidable=!1,state[a].isSliding?close(a,!1,!0):(bindStartSlidingEvent(a,!1),b.css("cursor","default").attr("title",""),removeHover(null,b[0]))},enableResizable=function(a){if(!isInitialized())return;var b=$Rs[a],c=options[a];if(!b||!b.data("draggable"))return;c.resizable=!0,b.draggable("enable").bind("mouseenter."+sID,onResizerEnter).bind("mouseleave."+sID,onResizerLeave),state[a].isClosed||b.css("cursor",c.resizerCursor).attr("title",c.resizerTip)},disableResizable=function(a){if(!isInitialized())return;var b=$Rs[a];if(!b||!b.data("draggable"))return;options[a].resizable=!1,b.draggable("disable").unbind("."+sID).css("cursor","default").attr("title",""),removeHover(null,b[0])},swapPanes=function(a,b){function g(a){var b=$Ps[a],c=$Cs[a];return b?{pane:a,P:b?b[0]:!1,C:c?c[0]:!1,state:$.extend({},state[a]),options:$.extend({},options[a])}:!1}function h(a,b){if(!a)return;var c=a.P,d=a.C,e=a.pane,g=_c[b],h=g.side.toLowerCase(),i="inset"+g.side,j=$.extend({},state[b]),k=options[b],l={resizerCursor:k.resizerCursor},m,n,o;$.each("fxName,fxSpeed,fxSettings".split(","),function(a,b){l[b]=k[b],l[b+"_open"]=k[b+"_open"],l[b+"_close"]=k[b+"_close"]}),$Ps[b]=$(c).data("layoutEdge",b).css(_c.hidden).css(g.cssReq),$Cs[b]=d?$(d):!1,options[b]=$.extend({},a.options,l),state[b]=$.extend({},a.state),m=new RegExp(k.paneClass+"-"+e,"g"),c.className=c.className.replace(m,k.paneClass+"-"+b),initHandles(b),g.dir!=_c[e].dir?(n=f[b]||0,setSizeLimits(b),n=max(n,state[b].minSize),manualSizePane(b,n,!0)):$Rs[b].css(h,sC[i]+(state[b].isVisible?getPaneSize(b):0)),a.state.isVisible&&!j.isVisible?setAsOpen(b,!0):(setAsClosed(b),bindStartSlidingEvent(b,!0)),a=null}if(!isInitialized())return;state[a].edge=b,state[b].edge=a;var c=!1;!1===_execCallback(a,options[a].onswap_start)&&(c=!0),!c&&!1===_execCallback(b,options[b].onswap_start)&&(c=!0);if(c){state[a].edge=a,state[b].edge=b;return}var d=g(a),e=g(b),f={};f[a]=d?d.state.size:0,f[b]=e?e.state.size:0,$Ps[a]=!1,$Ps[b]=!1,state[a]={},state[b]={},$Ts[a]&&$Ts[a].remove(),$Ts[b]&&$Ts[b].remove(),$Rs[a]&&$Rs[a].remove(),$Rs[b]&&$Rs[b].remove(),$Rs[a]=$Rs[b]=$Ts[a]=$Ts[b]=!1,h(d,b),h(e,a),d=e=f=null,$Ps[a]&&$Ps[a].css(_c.visible),$Ps[b]&&$Ps[b].css(_c.visible),resizeAll(),_execCallback(a,options[a].onswap_end||options[a].onswap),_execCallback(b,options[b].onswap_end||options[b].onswap);return},$N=$(this).eq(0);if(!$N.length)return options.showErrorMessages&&alert(lang.errContainerMissing),null;if($N.data("layoutContainer")&&$N.data("layout"))return $N.data("layout");var $Ps={},$Cs={},$Rs={},$Ts={},sC=state.container,sID=state.id,Instance={options:options,state:state,container:$N,panes:$Ps,contents:$Cs,resizers:$Rs,togglers:$Ts,toggle:toggle,hide:hide,show:show,open:open,close:close,slideOpen:slideOpen,slideClose:slideClose,slideToggle:slideToggle,initContent:initContent,sizeContent:sizeContent,sizePane:manualSizePane,swapPanes:swapPanes,resizeAll:resizeAll,initPanes:isInitialized,destroy:destroy,addPane:addPane,removePane:removePane,setSizeLimits:setSizeLimits,bindButton:bindButton,addToggleBtn:addToggleBtn,addOpenBtn:addOpenBtn,addCloseBtn:addCloseBtn,addPinBtn:addPinBtn,allowOverflow:allowOverflow,resetOverflow:resetOverflow,encodeJSON:encodeJSON,decodeJSON:decodeJSON,getState:getState,getCookie:getCookie,saveCookie:saveCookie,deleteCookie:deleteCookie,loadCookie:loadCookie,loadState:loadState,cssWidth:cssW,cssHeight:cssH,enableClosable:enableClosable,disableClosable:disableClosable,enableSlidable:enableSlidable,disableSlidable:disableSlidable,enableResizable:enableResizable,disableResizable:disableResizable};return _create()==="cancel"?null:Instance}}(jQuery),define("lib/jquery.layout",function(){}),function(a){function c(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",b.wheelDelta&&(e=b.wheelDelta/120),b.detail&&(e=-b.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),a.event.dispatch.apply(this,d)}var b=["DOMMouseScroll","mousewheel"];a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],c,!1);else this.onmousewheel=c},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],c,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),define("lib/jquery.mousewheel",function(){}),function(a,b,c){a.fn.jScrollPane=function(b){function d(b,d){function T(d){var f,q,r,t,u,w,x=!1,y=!1;e=d;if(g===c)u=b.scrollTop(),w=b.scrollLeft(),b.css({overflow:"hidden",padding:0}),h=b.innerWidth()+L,i=b.innerHeight(),b.width(h),g=a('<div class="jspPane" />').css("padding",K).append(b.children()),j=a('<div class="jspContainer" />').css({width:h+"px",height:i+"px"}).append(g).appendTo(b);else{b.css("width",""),x=e.stickToBottom&&bp(),y=e.stickToRight&&bq(),t=b.innerWidth()+L!=h||b.outerHeight()!=i,t&&(h=b.innerWidth()+L,i=b.innerHeight(),j.css({width:h+"px",height:i+"px"}));if(!t&&M==k&&g.outerHeight()==l){b.width(h);return}M=k,g.css("width",""),b.width(h),j.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}g.css("overflow","auto"),d.contentWidth?k=d.contentWidth:k=g[0].scrollWidth,l=g[0].scrollHeight,g.css("overflow",""),m=k/h,n=l/i,o=n>1,p=m>1,!p&&!o?(b.removeClass("jspScrollable"),g.css({top:0,width:j.width()-L}),bs(),bv(),bx(),bc(),bz()):(b.addClass("jspScrollable"),f=e.maintainPosition&&(s||v),f&&(q=bn(),r=bo()),U(),W(),Y(),f&&(bl(y?k-h:q,!1),bk(x?l-i:r,!1)),bu(),br(),bB(),e.enableKeyboardNavigation&&bw(),e.clickOnTrack&&bb(),by(),e.hijackInternalLinks&&bA()),e.autoReinitialise&&!J?J=setInterval(function(){T(e)},e.autoReinitialiseDelay):!e.autoReinitialise&&J&&clearInterval(J),u&&b.scrollTop(0)&&bk(u,!1),w&&b.scrollLeft(0)&&bl(w,!1),b.trigger("jsp-initialised",[p||o])}function U(){o&&(j.append(a('<div class="jspVerticalBar" />').append(a('<div class="jspCap jspCapTop" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragTop" />'),a('<div class="jspDragBottom" />'))),a('<div class="jspCap jspCapBottom" />'))),w=j.find(">.jspVerticalBar"),x=w.find(">.jspTrack"),q=x.find(">.jspDrag"),e.showArrows&&(B=a('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",_(0,-1)).bind("click.jsp",bt),C=a('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",_(0,1)).bind("click.jsp",bt),e.arrowScrollOnHover&&(B.bind("mouseover.jsp",_(0,-1,B)),C.bind("mouseover.jsp",_(0,1,C))),Z(x,e.verticalArrowPositions,B,C)),z=i,j.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){z-=a(this).outerHeight()}),q.hover(function(){q.addClass("jspHover")},function(){q.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",bt),q.addClass("jspActive");var c=b.pageY-q.position().top;return a("html").bind("mousemove.jsp",function(a){be(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",bd),!1}),V())}function V(){x.height(z+"px"),s=0,y=e.verticalGutter+x.outerWidth(),g.width(h-y-L);try{w.position().left===0&&g.css("margin-left",y+"px")}catch(a){}}function W(){p&&(j.append(a('<div class="jspHorizontalBar" />').append(a('<div class="jspCap jspCapLeft" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragLeft" />'),a('<div class="jspDragRight" />'))),a('<div class="jspCap jspCapRight" />'))),D=j.find(">.jspHorizontalBar"),E=D.find(">.jspTrack"),t=E.find(">.jspDrag"),e.showArrows&&(H=a('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",_(-1,0)).bind("click.jsp",bt),I=a('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",_(1,0)).bind("click.jsp",bt),e.arrowScrollOnHover&&(H.bind("mouseover.jsp",_(-1,0,H)),I.bind("mouseover.jsp",_(1,0,I))),Z(E,e.horizontalArrowPositions,H,I)),t.hover(function(){t.addClass("jspHover")},function(){t.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",bt),t.addClass("jspActive");var c=b.pageX-t.position().left;return a("html").bind("mousemove.jsp",function(a){bg(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",bd),!1}),F=j.innerWidth(),X())}function X(){j.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){F-=a(this).outerWidth()}),E.width(F+"px"),v=0}function Y(){if(p&&o){var b=E.outerHeight(),c=x.outerWidth();z-=b,a(D).find(">.jspCap:visible,>.jspArrow").each(function(){F+=a(this).outerWidth()}),F-=c,i-=c,h-=b,E.parent().append(a('<div class="jspCorner" />').css("width",b+"px")),V(),X()}p&&g.width(j.outerWidth()-L+"px"),l=g.outerHeight(),n=l/i,p&&(G=Math.ceil(1/m*F),G>e.horizontalDragMaxWidth?G=e.horizontalDragMaxWidth:G<e.horizontalDragMinWidth&&(G=e.horizontalDragMinWidth),t.width(G+"px"),u=F-G,bh(v)),o&&(A=Math.ceil(1/n*z),A>e.verticalDragMaxHeight?A=e.verticalDragMaxHeight:A<e.verticalDragMinHeight&&(A=e.verticalDragMinHeight),q.height(A+"px"),r=z-A,bf(s))}function Z(a,b,c,d){var e="before",f="after",g;b=="os"&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==e?f=b:b==f&&(e=b,g=c,c=d,d=g),a[e](c)[f](d)}function _(a,b,c){return function(){return ba(a,b,this,c),this.blur(),!1}}function ba(b,c,d,g){d=a(d).addClass("jspActive");var h,i,j=!0,k=function(){b!==0&&f.scrollByX(b*e.arrowButtonSpeed),c!==0&&f.scrollByY(c*e.arrowButtonSpeed),i=setTimeout(k,j?e.initialDelay:e.arrowRepeatFreq),j=!1};k(),h=g?"mouseout.jsp":"mouseup.jsp",g=g||a("html"),g.bind(h,function(){d.removeClass("jspActive"),i&&clearTimeout(i),i=null,g.unbind(h)})}function bb(){bc(),o&&x.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d=a(this),g=d.offset(),h=b.pageY-g.top-s,j,k=!0,m=function(){var a=d.offset(),c=b.pageY-a.top-A/2,g=i*e.scrollPagePercent,o=r*g/(l-i);if(h<0)s-o>c?f.scrollByY(-g):be(c);else if(h>0)s+o<c?f.scrollByY(g):be(c);else{n();return}j=setTimeout(m,k?e.initialDelay:e.trackClickRepeatFreq),k=!1},n=function(){j&&clearTimeout(j),j=null,a(document).unbind("mouseup.jsp",n)};return m(),a(document).bind("mouseup.jsp",n),!1}}),p&&E.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d=a(this),g=d.offset(),i=b.pageX-g.left-v,j,l=!0,m=function(){var a=d.offset(),c=b.pageX-a.left-G/2,g=h*e.scrollPagePercent,o=u*g/(k-h);if(i<0)v-o>c?f.scrollByX(-g):bg(c);else if(i>0)v+o<c?f.scrollByX(g):bg(c);else{n();return}j=setTimeout(m,l?e.initialDelay:e.trackClickRepeatFreq),l=!1},n=function(){j&&clearTimeout(j),j=null,a(document).unbind("mouseup.jsp",n)};return m(),a(document).bind("mouseup.jsp",n),!1}})}function bc(){E&&E.unbind("mousedown.jsp"),x&&x.unbind("mousedown.jsp")}function bd(){a("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),q&&q.removeClass("jspActive"),t&&t.removeClass("jspActive")}function be(a,b){if(!o)return;a<0?a=0:a>r&&(a=r),b===c&&(b=e.animateScroll),b?f.animate(q,"top",a,bf):(q.css("top",a),bf(a))}function bf(a){a===c&&(a=q.position().top),j.scrollTop(0),s=a;var d=s===0,e=s==r,f=a/r,h=-f*(l-i);if(N!=d||P!=e)N=d,P=e,b.trigger("jsp-arrow-change",[N,P,O,Q]);bi(d,e),g.css("top",h),b.trigger("jsp-scroll-y",[-h,d,e]).trigger("scroll")}function bg(a,b){if(!p)return;a<0?a=0:a>u&&(a=u),b===c&&(b=e.animateScroll),b?f.animate(t,"left",a,bh):(t.css("left",a),bh(a))}function bh(a){a===c&&(a=t.position().left),j.scrollTop(0),v=a;var d=v===0,e=v==u,f=a/u,i=-f*(k-h);if(O!=d||Q!=e)O=d,Q=e,b.trigger("jsp-arrow-change",[N,P,O,Q]);bj(d,e),g.css("left",i),b.trigger("jsp-scroll-x",[-i,d,e]).trigger("scroll")}function bi(a,b){e.showArrows&&(B[a?"addClass":"removeClass"]("jspDisabled"),C[b?"addClass":"removeClass"]("jspDisabled"))}function bj(a,b){e.showArrows&&(H[a?"addClass":"removeClass"]("jspDisabled"),I[b?"addClass":"removeClass"]("jspDisabled"))}function bk(a,b){var c=a/(l-i);be(c*r,b)}function bl(a,b){var c=a/(k-h);bg(c*u,b)}function bm(b,c,d){var f,g,k,l=0,m=0,n,o,p,q,r,s;try{f=a(b)}catch(t){return}g=f.outerHeight(),k=f.outerWidth(),j.scrollTop(0),j.scrollLeft(0);while(!f.is(".jspPane")){l+=f.position().top,m+=f.position().left,f=f.offsetParent();if(/^body|html$/i.test(f[0].nodeName))return}n=bo(),p=n+i,l<n||c?r=l-e.verticalGutter:l+g>p&&(r=l-i+g+e.verticalGutter),r&&bk(r,d),o=bn(),q=o+h,m<o||c?s=m-e.horizontalGutter:m+k>q&&(s=m-h+k+e.horizontalGutter),s&&bl(s,d)}function bn(){return-g.position().left}function bo(){return-g.position().top}function bp(){var a=l-i;return a>20&&a-bo()<10}function bq(){var a=k-h;return a>20&&a-bn()<10}function br(){j.unbind(S).bind(S,function(a,b,c,d){var g=v,h=s;return f.scrollBy(c*e.mouseWheelSpeed,-d*e.mouseWheelSpeed,!1),g==v&&h==s})}function bs(){j.unbind(S)}function bt(){return!1}function bu(){g.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){bm(a.target,!1)})}function bv(){g.find(":input,a").unbind("focus.jsp")}function bw(){function k(){var a=v,b=s;switch(c){case 40:f.scrollByY(e.keyboardSpeed,!1);break;case 38:f.scrollByY(-e.keyboardSpeed,!1);break;case 34:case 32:f.scrollByY(i*e.scrollPagePercent,!1);break;case 33:f.scrollByY(-i*e.scrollPagePercent,!1);break;case 39:f.scrollByX(e.keyboardSpeed,!1);break;case 37:f.scrollByX(-e.keyboardSpeed,!1)}return d=a!=v||b!=s,d}var c,d,h=[];p&&h.push(D[0]),o&&h.push(w[0]),g.focus(function(){b.focus()}),b.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(b){if(b.target!==this&&(!h.length||!a(b.target).closest(h).length))return;var e=v,f=s;switch(b.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=b.keyCode,k();break;case 35:bk(l-i),c=null;break;case 36:bk(0),c=null}return d=b.keyCode==c&&e!=v||f!=s,!d}).bind("keypress.jsp",function(a){return a.keyCode==c&&k(),!d}),e.hideFocus?(b.css("outline","none"),"hideFocus"in j[0]&&b.attr("hideFocus",!0)):(b.css("outline",""),"hideFocus"in j[0]&&b.attr("hideFocus",!1))}function bx(){b.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function by(){if(location.hash&&location.hash.length>1){var b,c,d=escape(location.hash);try{b=a(d)}catch(e){return}b.length&&g.find(d)&&(j.scrollTop()===0?c=setInterval(function(){j.scrollTop()>0&&(bm(d,!0),a(document).scrollTop(j.position().top),clearInterval(c))},50):(bm(d,!0),a(document).scrollTop(j.position().top)))}}function bz(){a("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function bA(){bz(),a("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var a=this.href.split("#"),b;if(a.length>1){b=a[1];if(b.length>0&&g.find("#"+b).length>0)return bm("#"+b,!0),!1}})}function bB(){var a,b,c,d,e,g=!1;j.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(f){var h=f.originalEvent.touches[0];a=bn(),b=bo(),c=h.pageX,d=h.pageY,e=!1,g=!0}).bind("touchmove.jsp",function(h){if(!g)return;var i=h.originalEvent.touches[0],j=v,k=s;return f.scrollTo(a+c-i.pageX,b+d-i.pageY),e=e||Math.abs(c-i.pageX)>5||Math.abs(d-i.pageY)>5,j==v&&k==s}).bind("touchend.jsp",function(a){g=!1}).bind("click.jsp-touchclick",function(a){if(e)return e=!1,!1})}function bC(){var a=bo(),c=bn();b.removeClass("jspScrollable").unbind(".jsp"),b.replaceWith(R.append(g.children())),R.scrollTop(a),R.scrollLeft(c)}var e,f=this,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=!0,O=!0,P=!1,Q=!1,R=b.clone(!1,!1).empty(),S=a.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";K=b.css("paddingTop")+" "+b.css("paddingRight")+" "+b.css("paddingBottom")+" "+b.css("paddingLeft"),L=(parseInt(b.css("paddingLeft"),10)||0)+(parseInt(b.css("paddingRight"),10)||0),a.extend(f,{reinitialise:function(b){b=a.extend({},e,b),T(b)},scrollToElement:function(a,b,c){bm(a,b,c)},scrollTo:function(a,b,c){bl(a,c),bk(b,c)},scrollToX:function(a,b){bl(a,b)},scrollToY:function(a,b){bk(a,b)},scrollToPercentX:function(a,b){bl(a*(k-h),b)},scrollToPercentY:function(a,b){bk(a*(l-i),b)},scrollBy:function(a,b,c){f.scrollByX(a,c),f.scrollByY(b,c)},scrollByX:function(a,b){var c=bn()+Math[a<0?"floor":"ceil"](a),d=c/(k-h);bg(d*u,b)},scrollByY:function(a,b){var c=bo()+Math[a<0?"floor":"ceil"](a),d=c/(l-i);be(d*r,b)},positionDragX:function(a,b){bg(a,b)},positionDragY:function(a,b){be(a,b)},animate:function(a,b,c,d){var f={};f[b]=c,a.animate(f,{duration:e.animateDuration,easing:e.animateEase,queue:!1,step:d})},getContentPositionX:function(){return bn()},getContentPositionY:function(){return bo()},getContentWidth:function(){return k},getContentHeight:function(){return l},getPercentScrolledX:function(){return bn()/(k-h)},getPercentScrolledY:function(){return bo()/(l-i)},getIsScrollableH:function(){return p},getIsScrollableV:function(){return o},getContentPane:function(){return g},scrollToBottom:function(a){be(r,a)},hijackInternalLinks:function(){bA()},destroy:function(){bC()}}),T(d)}return b=a.extend({},a.fn.jScrollPane.defaults,b),a.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){b[this]=b[this]||b.speed}),this.each(function(){var c=a(this),e=c.data("jsp");e?e.reinitialise(b):(e=new d(c,b),c.data("jsp",e))})},a.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this),define("lib/jquery.jscrollpane",function(){}),function(a){a.idleTimer=function(b,c){var d=!1,e=!0,f=3e4,g="mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove";c=c||document;var h=function(b){typeof b=="number"&&(b=undefined);var d=a.data(b||c,"idleTimerObj");d.idle=!d.idle;var g=+(new Date)-d.olddate;d.olddate=+(new Date);if(d.idle&&g<f){d.idle=!1,clearTimeout(a.idleTimer.tId),e&&(a.idleTimer.tId=setTimeout(h,f));return}var i=jQuery.Event(a.data(c,"idleTimer",d.idle?"idle":"active")+".idleTimer");a(c).trigger(i)},i=function(b){var c=a.data(b,"idleTimerObj")||{};c.enabled=!1,clearTimeout(c.tId),a(b).off(".idleTimer")},j=function(){var b=a.data(this,"idleTimerObj");clearTimeout(b.tId),b.enabled&&(b.idle&&h(this),b.tId=setTimeout(h,b.timeout))},k=a.data(c,"idleTimerObj")||{};k.olddate=k.olddate||+(new Date);if(typeof b=="number")f=b;else{if(b==="destroy")return i(c),this;if(b==="getElapsedTime")return+(new Date)-k.olddate}a(c).on(a.trim((g+" ").split(" ").join(".idleTimer ")),j),k.idle=d,k.enabled=e,k.timeout=f,k.tId=setTimeout(h,k.timeout),a.data(c,"idleTimer","active"),a.data(c,"idleTimerObj",k)},a.fn.idleTimer=function(b){return this[0]&&a.idleTimer(b,this[0]),this}}(jQuery),define("lib/jquery.idle-timer",function(){}),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=typeof location!="undefined"&&location.href,e=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,g=d&&(location.port||undefined),h=[];define("text",[],function(){var i,j,k;return typeof window!="undefined"&&window.navigator&&window.document?j=function(a,b){var c=i.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(a){c.readyState===4&&b(c.responseText)},c.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node?(k=require.nodeRequire("fs"),j=function(a,b){b(k.readFileSync(a,"utf8"))}):typeof Packages!="undefined"&&(j=function(a,b){var c="utf-8",d=new java.io.File(a),e=java.lang.System.getProperty("line.separator"),f=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(d),c)),g,h,i="";try{g=new java.lang.StringBuffer,h=f.readLine(),h&&h.length()&&h.charAt(0)===65279&&(h=h.substring(1)),g.append(h);while((h=f.readLine())!==null)g.append(e),g.append(h);i=String(g.toString())}finally{f.close()}b(i)}),i={version:"1.0.2",strip:function(a){if(a){a=a.replace(b,"");var d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var b,c,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(c=0;c<3;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw new Error("createXhr(): XMLHttpRequest not available");return b},get:j,parseName:function(a){var b=!1,c=a.indexOf("."),d=a.substring(0,c),e=a.substring(c+1,a.length);return c=e.indexOf("!"),c!==-1&&(b=e.substring(c+1,e.length),b=b==="strip",e=e.substring(0,c)),{moduleName:d,ext:e,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,c,d){var e=i.xdRegExp.exec(a),f,g,h;return e?(f=e[2],g=e[3],g=g.split(":"),h=g[1],g=g[0],(!f||f===b)&&(!g||g===c)&&(!h&&!g||h===d)):!0},finishLoad:function(a,b,c,d,e){c=b?i.strip(c):c,e.isBuild&&(h[a]=c),d(c)},load:function(a,b,c,h){if(h.isBuild&&!h.inlineText){c();return}var j=i.parseName(a),k=j.moduleName+"."+j.ext,l=b.toUrl(k),m=h&&h.text&&h.text.useXhr||i.useXhr;!d||m(l,e,f,g)?i.get(l,function(b){i.finishLoad(a,j.strip,b,c,h)}):b([k],function(a){i.finishLoad(j.moduleName+"."+j.ext,j.strip,a,c,h)})},write:function(a,b,c,d){if(b in h){var e=i.jsEscape(h[b]);c.asModule(a+"!"+b,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,b,c,d,e){var f=i.parseName(b),g=f.moduleName+"."+f.ext,h=c.toUrl(f.moduleName+"."+f.ext)+".js";i.load(g,c,function(b){var c=function(a){return d(h,a)};c.asModule=function(a,b){return d.asModule(a,h,b)},i.write(a,g,c,e)},e)}},i})}(),define("text!../tmpl/components/forgot_password.html",[],function(){return'<div style="font-size:12pt;">\r\n\t<div>No problem ... just enter your email address below and an email with instructions on resetting your password will be sent right out to you.</div>\r\n\t<input style=\'margin-top:12px;width:240px;\' id="email"/>\r\n</div>'}),define("text!objects/../../tmpl/listview/templateListViewWrapper.html",[],function(){return'<div id="list_view" style="position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;">\r\n\t<div id="lv_body" style="padding:2px;border-width:0;position:absolute;top:48px;left:0;right:8px;bottom:80px;overflow:auto;"></div>\r\n\t<div id="lv_header" style="padding:2px;border-bottom:5px solid #c0c0c0;position:absolute;top:0;left:0;right:0;height:36px;"></div>\r\n\t<div id="lv_footer" style="padding:6px;border-top:5px solid #c0c0c0;position:absolute;bottom:0;left:0;right:0;height:60px;overflow: hidden;"></div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/components/colorpicker.html",[],function(){return'<div id="color_picker" style="display:none;">\r\n<table id="colorchart" style=\'cursor:  pointer;border-radius:2px;width:440px;height:270px;padding:0;\' cellpadding="4" cellspacing="0">\r\n<tr>\r\n\t<td style="border-top-left-radius:4px;background-color:#F5A9A9;"></td>\r\n\t<td style="background-color:#F5BCA9;"></td>\r\n\t<td style="background-color:#F5D0A9;"></td>\r\n\t<td style="background-color:#F3E2A9;"></td>\r\n\t<td style="background-color:#F2F5A9;"></td>\r\n\t<td style="background-color:#E1F5A9;"></td>\r\n\t<td style="background-color:#D0F5A9;"></td>\r\n\t<td style="background-color:#BCF5A9;"></td>\r\n\t<td style="background-color:#A9F5A9;"></td>\r\n\t<td style="background-color:#A9F5BC;"></td>\r\n\t<td style="background-color:#A9F5D0;"></td>\r\n\t<td style="background-color:#A9F5E1;"></td>\r\n\t<td style="background-color:#A9F5F2;"></td>\r\n\t<td style="background-color:#A9E2F3;"></td>\r\n\t<td style="background-color:#A9D0F5;"></td>\r\n\t<td style="background-color:#A9BCF5;"></td>\r\n\t<td style="background-color:#A9A9F5;"></td>\r\n\t<td style="background-color:#BCA9F5;"></td>\r\n\t<td style="background-color:#D0A9F5;"></td>\r\n\t<td style="background-color:#E2A9F3;"></td>\r\n\t<td style="background-color:#F5A9F2;"></td>\r\n\t<td style="background-color:#F5A9E1;"></td>\r\n\t<td style="background-color:#F5A9D0;"></td>\r\n\t<td style="background-color:#F5A9BC;"></td>\r\n\t<td style="border-top-right-radius:4px;background-color:#E6E6E6;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#F78181;"></td>\r\n\t<td style="background-color:#F79F81;"></td>\r\n\t<td style="background-color:#F7BE81;"></td>\r\n\t<td style="background-color:#F5DA81;"></td>\r\n\t<td style="background-color:#F3F781;"></td>\r\n\t<td style="background-color:#D8F781;"></td>\r\n\t<td style="background-color:#BEF781;"></td>\r\n\t<td style="background-color:#9FF781;"></td>\r\n\t<td style="background-color:#81F781;"></td>\r\n\t<td style="background-color:#81F79F;"></td>\r\n\t<td style="background-color:#81F7BE;"></td>\r\n\t<td style="background-color:#81F7D8;"></td>\r\n\t<td style="background-color:#81F7F3;"></td>\r\n\t<td style="background-color:#81DAF5;"></td>\r\n\t<td style="background-color:#81BEF7;"></td>\r\n\t<td style="background-color:#819FF7;"></td>\r\n\t<td style="background-color:#8181F7;"></td>\r\n\t<td style="background-color:#9F81F7;"></td>\r\n\t<td style="background-color:#BE81F7;"></td>\r\n\t<td style="background-color:#DA81F5;"></td>\r\n\t<td style="background-color:#F781F3;"></td>\r\n\t<td style="background-color:#F781D8;"></td>\r\n\t<td style="background-color:#F781BE;"></td>\r\n\t<td style="background-color:#F7819F;"></td>\r\n\t<td style="background-color:#D8D8D8;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#FA5858;"></td>\r\n\t<td style="background-color:#FA8258;"></td>\r\n\t<td style="background-color:#FAAC58;"></td>\r\n\t<td style="background-color:#F7D358;"></td>\r\n\t<td style="background-color:#F4FA58;"></td>\r\n\t<td style="background-color:#D0FA58;"></td>\r\n\t<td style="background-color:#ACFA58;"></td>\r\n\t<td style="background-color:#82FA58;"></td>\r\n\t<td style="background-color:#58FA58;"></td>\r\n\t<td style="background-color:#58FA82;"></td>\r\n\t<td style="background-color:#58FAAC;"></td>\r\n\t<td style="background-color:#58FAD0;"></td>\r\n\t<td style="background-color:#58FAF4;"></td>\r\n\t<td style="background-color:#58D3F7;"></td>\r\n\t<td style="background-color:#58ACFA;"></td>\r\n\t<td style="background-color:#5882FA;"></td>\r\n\t<td style="background-color:#5858FA;"></td>\r\n\t<td style="background-color:#8258FA;"></td>\r\n\t<td style="background-color:#AC58FA;"></td>\r\n\t<td style="background-color:#D358F7;"></td>\r\n\t<td style="background-color:#FA58F4;"></td>\r\n\t<td style="background-color:#FA58D0;"></td>\r\n\t<td style="background-color:#FA58AC;"></td>\r\n\t<td style="background-color:#FA5882;"></td>\r\n\t<td style="background-color:#BDBDBD;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#FE2E2E;"></td>\r\n\t<td style="background-color:#FE642E;"></td>\r\n\t<td style="background-color:#FE9A2E;"></td>\r\n\t<td style="background-color:#FACC2E;"></td>\r\n\t<td style="background-color:#F7FE2E;"></td>\r\n\t<td style="background-color:#C8FE2E;"></td>\r\n\t<td style="background-color:#9AFE2E;"></td>\r\n\t<td style="background-color:#64FE2E;"></td>\r\n\t<td style="background-color:#2EFE2E;"></td>\r\n\t<td style="background-color:#2EFE64;"></td>\r\n\t<td style="background-color:#2EFE9A;"></td>\r\n\t<td style="background-color:#2EFEC8;"></td>\r\n\t<td style="background-color:#2EFEF7;"></td>\r\n\t<td style="background-color:#2ECCFA;"></td>\r\n\t<td style="background-color:#2E9AFE;"></td>\r\n\t<td style="background-color:#2E64FE;"></td>\r\n\t<td style="background-color:#2E2EFE;"></td>\r\n\t<td style="background-color:#642EFE;"></td>\r\n\t<td style="background-color:#9A2EFE;"></td>\r\n\t<td style="background-color:#CC2EFA;"></td>\r\n\t<td style="background-color:#FE2EF7;"></td>\r\n\t<td style="background-color:#FE2EC8;"></td>\r\n\t<td style="background-color:#FE2E9A;"></td>\r\n\t<td style="background-color:#FE2E64;"></td>\r\n\t<td style="background-color:#A4A4A4;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#FF0000;"></td>\r\n\t<td style="background-color:#FF4000;"></td>\r\n\t<td style="background-color:#FF8000;"></td>\r\n\t<td style="background-color:#FFBF00;"></td>\r\n\t<td style="background-color:#FFFF00;"></td>\r\n\t<td style="background-color:#BFFF00;"></td>\r\n\t<td style="background-color:#80FF00;"></td>\r\n\t<td style="background-color:#40FF00;"></td>\r\n\t<td style="background-color:#00FF00;"></td>\r\n\t<td style="background-color:#00FF40;"></td>\r\n\t<td style="background-color:#00FF80;"></td>\r\n\t<td style="background-color:#00FFBF;"></td>\r\n\t<td style="background-color:#00FFFF;"></td>\r\n\t<td style="background-color:#00BFFF;"></td>\r\n\t<td style="background-color:#0080FF;"></td>\r\n\t<td style="background-color:#0040FF;"></td>\r\n\t<td style="background-color:#0000FF;"></td>\r\n\t<td style="background-color:#4000FF;"></td>\r\n\t<td style="background-color:#8000FF;"></td>\r\n\t<td style="background-color:#BF00FF;"></td>\r\n\t<td style="background-color:#FF00FF;"></td>\r\n\t<td style="background-color:#FF00BF;"></td>\r\n\t<td style="background-color:#FF0080;"></td>\r\n\t<td style="background-color:#FF0040;"></td>\r\n\t<td style="background-color:#848484;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#DF0101;"></td>\r\n\t<td style="background-color:#DF3A01;"></td>\r\n\t<td style="background-color:#DF7401;"></td>\r\n\t<td style="background-color:#DBA901;"></td>\r\n\t<td style="background-color:#D7DF01;"></td>\r\n\t<td style="background-color:#A5DF00;"></td>\r\n\t<td style="background-color:#74DF00;"></td>\r\n\t<td style="background-color:#3ADF00;"></td>\r\n\t<td style="background-color:#01DF01;"></td>\r\n\t<td style="background-color:#01DF3A;"></td>\r\n\t<td style="background-color:#01DF74;"></td>\r\n\t<td style="background-color:#01DFA5;"></td>\r\n\t<td style="background-color:#01DFD7;"></td>\r\n\t<td style="background-color:#01A9DB;"></td>\r\n\t<td style="background-color:#0174DF;"></td>\r\n\t<td style="background-color:#013ADF;"></td>\r\n\t<td style="background-color:#0101DF;"></td>\r\n\t<td style="background-color:#3A01DF;"></td>\r\n\t<td style="background-color:#7401DF;"></td>\r\n\t<td style="background-color:#A901DB;"></td>\r\n\t<td style="background-color:#DF01D7;"></td>\r\n\t<td style="background-color:#DF01A5;"></td>\r\n\t<td style="background-color:#DF0174;"></td>\r\n\t<td style="background-color:#DF013A;"></td>\r\n\t<td style="background-color:#6E6E6E;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#B40404;"></td>\r\n\t<td style="background-color:#B43104;"></td>\r\n\t<td style="background-color:#B45F04;"></td>\r\n\t<td style="background-color:#B18904;"></td>\r\n\t<td style="background-color:#AEB404;"></td>\r\n\t<td style="background-color:#86B404;"></td>\r\n\t<td style="background-color:#5FB404;"></td>\r\n\t<td style="background-color:#31B404;"></td>\r\n\t<td style="background-color:#04B404;"></td>\r\n\t<td style="background-color:#04B431;"></td>\r\n\t<td style="background-color:#04B45F;"></td>\r\n\t<td style="background-color:#04B486;"></td>\r\n\t<td style="background-color:#04B4AE;"></td>\r\n\t<td style="background-color:#0489B1;"></td>\r\n\t<td style="background-color:#045FB4;"></td>\r\n\t<td style="background-color:#0431B4;"></td>\r\n\t<td style="background-color:#0404B4;"></td>\r\n\t<td style="background-color:#3104B4;"></td>\r\n\t<td style="background-color:#5F04B4;"></td>\r\n\t<td style="background-color:#8904B1;"></td>\r\n\t<td style="background-color:#B404AE;"></td>\r\n\t<td style="background-color:#B40486;"></td>\r\n\t<td style="background-color:#B4045F;"></td>\r\n\t<td style="background-color:#B40431;"></td>\r\n\t<td style="background-color:#585858;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#8A0808;"></td>\r\n\t<td style="background-color:#8A2908;"></td>\r\n\t<td style="background-color:#8A4B08;"></td>\r\n\t<td style="background-color:#886A08;"></td>\r\n\t<td style="background-color:#868A08;"></td>\r\n\t<td style="background-color:#688A08;"></td>\r\n\t<td style="background-color:#4B8A08;"></td>\r\n\t<td style="background-color:#298A08;"></td>\r\n\t<td style="background-color:#088A08;"></td>\r\n\t<td style="background-color:#088A29;"></td>\r\n\t<td style="background-color:#088A4B;"></td>\r\n\t<td style="background-color:#088A68;"></td>\r\n\t<td style="background-color:#088A85;"></td>\r\n\t<td style="background-color:#086A87;"></td>\r\n\t<td style="background-color:#084B8A;"></td>\r\n\t<td style="background-color:#08298A;"></td>\r\n\t<td style="background-color:#08088A;"></td>\r\n\t<td style="background-color:#29088A;"></td>\r\n\t<td style="background-color:#4B088A;"></td>\r\n\t<td style="background-color:#6A0888;"></td>\r\n\t<td style="background-color:#8A0886;"></td>\r\n\t<td style="background-color:#8A0868;"></td>\r\n\t<td style="background-color:#8A084B;"></td>\r\n\t<td style="background-color:#8A0829;"></td>\r\n\t<td style="background-color:#424242;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#610B0B;"></td>\r\n\t<td style="background-color:#61210B;"></td>\r\n\t<td style="background-color:#61380B;"></td>\r\n\t<td style="background-color:#5F4C0B;"></td>\r\n\t<td style="background-color:#5E610B;"></td>\r\n\t<td style="background-color:#4B610B;"></td>\r\n\t<td style="background-color:#38610B;"></td>\r\n\t<td style="background-color:#21610B;"></td>\r\n\t<td style="background-color:#0B610B;"></td>\r\n\t<td style="background-color:#0B6121;"></td>\r\n\t<td style="background-color:#0B6138;"></td>\r\n\t<td style="background-color:#0B614B;"></td>\r\n\t<td style="background-color:#0B615E;"></td>\r\n\t<td style="background-color:#0B4C5F;"></td>\r\n\t<td style="background-color:#0B3861;"></td>\r\n\t<td style="background-color:#0B2161;"></td>\r\n\t<td style="background-color:#0B0B61;"></td>\r\n\t<td style="background-color:#210B61;"></td>\r\n\t<td style="background-color:#380B61;"></td>\r\n\t<td style="background-color:#4C0B5F;"></td>\r\n\t<td style="background-color:#610B5E;"></td>\r\n\t<td style="background-color:#610B4B;"></td>\r\n\t<td style="background-color:#610B38;"></td>\r\n\t<td style="background-color:#610B21;"></td>\r\n\t<td style="background-color:#2E2E2E;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#3B0B0B;"></td>\r\n\t<td style="background-color:#3B170B;"></td>\r\n\t<td style="background-color:#3B240B;"></td>\r\n\t<td style="background-color:#3A2F0B;"></td>\r\n\t<td style="background-color:#393B0B;"></td>\r\n\t<td style="background-color:#2E3B0B;"></td>\r\n\t<td style="background-color:#243B0B;"></td>\r\n\t<td style="background-color:#173B0B;"></td>\r\n\t<td style="background-color:#0B3B0B;"></td>\r\n\t<td style="background-color:#0B3B17;"></td>\r\n\t<td style="background-color:#0B3B24;"></td>\r\n\t<td style="background-color:#0B3B2E;"></td>\r\n\t<td style="background-color:#0B3B39;"></td>\r\n\t<td style="background-color:#0B2F3A;"></td>\r\n\t<td style="background-color:#0B243B;"></td>\r\n\t<td style="background-color:#0B173B;"></td>\r\n\t<td style="background-color:#0B0B3B;"></td>\r\n\t<td style="background-color:#170B3B;"></td>\r\n\t<td style="background-color:#240B3B;"></td>\r\n\t<td style="background-color:#2F0B3A;"></td>\r\n\t<td style="background-color:#3B0B39;"></td>\r\n\t<td style="background-color:#3B0B2E;"></td>\r\n\t<td style="background-color:#3B0B24;"></td>\r\n\t<td style="background-color:#3B0B17;"></td>\r\n\t<td style="background-color:#1C1C1C;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="background-color:#2A0A0A;"></td>\r\n\t<td style="background-color:#2A120A;"></td>\r\n\t<td style="background-color:#2A1B0A;"></td>\r\n\t<td style="background-color:#29220A;"></td>\r\n\t<td style="background-color:#292A0A;"></td>\r\n\t<td style="background-color:#222A0A;"></td>\r\n\t<td style="background-color:#1B2A0A;"></td>\r\n\t<td style="background-color:#122A0A;"></td>\r\n\t<td style="background-color:#0A2A0A;"></td>\r\n\t<td style="background-color:#0A2A12;"></td>\r\n\t<td style="background-color:#0A2A1B;"></td>\r\n\t<td style="background-color:#0A2A22;"></td>\r\n\t<td style="background-color:#0A2A29;"></td>\r\n\t<td style="background-color:#0A2229;"></td>\r\n\t<td style="background-color:#0A1B2A;"></td>\r\n\t<td style="background-color:#0A122A;"></td>\r\n\t<td style="background-color:#0A0A2A;"></td>\r\n\t<td style="background-color:#120A2A;"></td>\r\n\t<td style="background-color:#1B0A2A;"></td>\r\n\t<td style="background-color:#220A29;"></td>\r\n\t<td style="background-color:#2A0A29;"></td>\r\n\t<td style="background-color:#2A0A22;"></td>\r\n\t<td style="background-color:#2A0A1B;"></td>\r\n\t<td style="background-color:#2A0A12;"></td>\r\n\t<td style="background-color:#151515;"></td>\r\n</tr>\r\n<tr>\r\n\t<td style="border-bottom-left-radius:4px;background-color:#190707;"></td>\r\n\t<td style="background-color:#190B07;"></td>\r\n\t<td style="background-color:#191007;"></td>\r\n\t<td style="background-color:#181407;"></td>\r\n\t<td style="background-color:#181907;"></td>\r\n\t<td style="background-color:#141907;"></td>\r\n\t<td style="background-color:#101907;"></td>\r\n\t<td style="background-color:#0B1907;"></td>\r\n\t<td style="background-color:#071907;"></td>\r\n\t<td style="background-color:#07190B;"></td>\r\n\t<td style="background-color:#071910;"></td>\r\n\t<td style="background-color:#071914;"></td>\r\n\t<td style="background-color:#071918;"></td>\r\n\t<td style="background-color:#071418;"></td>\r\n\t<td style="background-color:#071019;"></td>\r\n\t<td style="background-color:#070B19;"></td>\r\n\t<td style="background-color:#070719;"></td>\r\n\t<td style="background-color:#0B0719;"></td>\r\n\t<td style="background-color:#100719;"></td>\r\n\t<td style="background-color:#140718;"></td>\r\n\t<td style="background-color:#190718;"></td>\r\n\t<td style="background-color:#190714;"></td>\r\n\t<td style="background-color:#190710;"></td>\r\n\t<td style="background-color:#19070B;"></td>\r\n\t<td style="border-bottom-right-radius:4px;background-color:#000000;"></td>\r\n</tr>\r\n</table>\r\n</div>\r\n'}),define("text!objects/../../tmpl/components/toolbox.html",[],function(){return"<div class='collab_chatbox' style='border-radius:2px;z-index:50000;position:absolute;left:0;top:0;'>\r\n\t<div id='header' style='white-space:nowrap; overflow: hidden; position: absolute;left:22px;right:22px;top:4px;height:22px;'>\r\n\t\t<span id='caption_text' style='font-weight:bold;margin-left:4px; width:100%;'></span>\r\n\t</div>\r\n\t<img id=\"toolbox_icon\" src=\"./img/gear.png\" style=\"position:absolute;left:6px;top:6px;width:14px;height:14px;\" alt=''/>\r\n\t<img id=\"close_window\" src=\"./img/window-close.gif\" style=\"position:absolute;right:8px;top:8px;\" alt=''/>\r\n\t<div id=\"body\" style=\"width:100%;position:absolute;top:24px;left:4px;right:4px;bottom:4px;border-radius:1px;border:1px solid #393939;overflow:auto;\">\r\n\t</div>\r\n</div>"}),define("objects/schema/component_classes",["require","general_functions","utilities","coreglobals","objects/schema/models","text!../../../tmpl/listview/templateListViewWrapper.html","text!../../../tmpl/components/colorpicker.html","text!../../../tmpl/components/toolbox.html"],function(a){var b=a("general_functions"),c=a("utilities"),d=a("coreglobals"),e=a("objects/schema/models"),f={},g=a("text!../../../tmpl/listview/templateListViewWrapper.html"),h=a("text!../../../tmpl/components/colorpicker.html"),i=f.ButtonList=function(a,b){this.$container=undefined,this.$wrapper=undefined,this.$filter=undefined,this.clickHandler=a,this.getCaptionFunction=b};i.prototype.Filter=function(){console.log("filtering");var a=this,b=this.$filter.val().trim().toLowerCase();b==""?this.$container.find(".small-list-item").show():this.$container.find(".small-list-item").each(function(a,c){var d=$(c).data("caption");d.indexOf(b)==-1?$(c).hide():$(c).show()}),this.Resize()},i.prototype.Load=function(a,c){var d=this;this.$wrapper=$(a),this.$wrapper.html(""),this.$filter=$("<input type='text' style='font-size:10pt;margin-bottom:12px;' placeholder='type here to filter ...'/>"),this.$filter.appendTo(this.$wrapper),this.$filter.keyup(function(){d.Filter()}),this.$container=$("<div>").appendTo(this.$wrapper),this.$container.html(""),$.each(c,function(a,c){var e=d.getCaptionFunction(c),f=$("<span class='small-list-item'>"+e+"</span>").data("caption",e.toLowerCase());f.click(function(){b.CallFunction(d.clickHandler,[c])}),d.$container.append(f)}),d.Sort(),d.Resize()},i.prototype.Sort=function(){if(!this.$container)return;this.$container.children().sortElements(function(a,b){var c=$(a).text(),d=$(b).text();return c>d?1:-1})},i.prototype.Resize=function(){if(!this.$container)return;this.$container.find(".small-list-item").css("width","");var a=0;this.$container.children().each(function(b,c){$(c).width()>a&&(a=$(c).width())}),this.$container.children().css("width",a)};var j=f.ColorPicker=function(){};j.prototype.ShowDialog=function(a,c,d){var e=this,f=$(h);f.find("#colorchart td").each(function(a,b){$(b).css("border","1px solid "+$(b).css("background-color"));var c=e.rgbToHex($(b).css("background-color"));$(b).attr("id","color_"+c.toUpperCase())}),f.find("#color_"+a.toUpperCase()).css("border","1px solid #fff"),f.find("#colorchart").find("td").mouseenter(function(){var a=e.rgbToHex($(this).css("background-color")),b=e.getForegroundColor(a);$(this).css("border","1px solid "+b)}).mouseleave(function(){var b=e.rgbToHex($(this).css("background-color"));a.toUpperCase()!=b.toUpperCase()&&$(this).css("border","1px solid "+$(this).css("background-color"))}).unbind("click").click(function(){var a=e.rgbToHex($(this).css("background-color"));$(f).dialog("close"),b.CallFunction(c,[a])}),f.dialog({zIndex:1e5,modal:!0,resizable:!1,width:470,title:"Pick Color",buttons:{Cancel:function(){$(this).dialog("close"),b.CallFunction(d)}}})},j.prototype.rgbToHex=function(a){var b=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete b[0];for(var c=1;c<=3;++c)b[c]=parseInt(b[c]).toString(16),b[c].length==1&&(b[c]="0"+b[c]);return b.join("")},j.prototype.hexToR=function(a){return parseInt(this.cutHex(a).substring(0,2),16)},j.prototype.hexToG=function(a){return parseInt(this.cutHex(a).substring(2,4),16)},j.prototype.hexToB=function(a){return parseInt(this.cutHex(a).substring(4,6),16)},j.prototype.cutHex=function(a){return a.charAt(0)=="#"?a.substring(1,7):a},j.prototype.rgbFromHex=function(a){var b={r:this.hexToR(a),g:this.hexToG(a),b:this.hexToB(a)};return b},j.prototype.getForegroundColor=function(a){var b=a.replace("#",""),c=this.rgbFromHex(b),d=.3*c.r+.6*c.g+.1*c.b;return d<120?"#fff":"#303030"},j.prototype.hexFromRGB=function(a,b,c){var d=[a.toString(16),b.toString(16),c.toString(16)];return $.each(d,function(a,b){b.length===1&&(d[a]="0"+b)}),d.join("").toUpperCase()};var k=f.ExtendedDropDownSettings=function(){this.fieldID="UniqueID",this.fieldDisplay="Name",this.model=undefined,this.filter={},this.SelectedID=undefined,this.unboundItems=[],this.$container=undefined},l=f.ExtendedDropDown=function(a,b){if(!a)throw new Error("ExtendedDropDown requires a selectbox to bind to");this.$container=$(a),$.extend(!0,this,new k),$.extend(!0,this,b)};l.prototype.Load=function(){function b(){a.$container.data("selectmenu")&&a.$container.selectmenu("destroy"),a.$container.html("");for(var b=0;b<a.unboundItems.length;b++)a.$container.append($("<option></option>").attr("value",a.unboundItems[b].id).text(a.unboundItems[b].id));if(a.model){var d=a.model.GetItems(a.filter);for(var b=0;b<d.length;b++)a.$container.append($("<option></option>").attr("value",d[b][a.fieldID]).text(d[b][a.fieldDisplay]))}c(),a.SetSelectedID(a.SelectedID),a.$container.selectmenu()}function c(){a.$container.children().sortElements(function(a,b){var c=$(a).text(),d=$(b).text();return c>d?1:-1})}var a=this;b()},l.prototype.SetSelectedID=function(a){this.SelectedID=a,this.$container.val(this.SelectedID)},l.prototype.AddUnboundItem=function(a,b){this.unboundItems.push({id:a,display:b})};var m=f.FilterBox=function(a){this.LinkCaption="Filter ...",this.Watermark="Type here to filter ...",this.ShowingLink=!0,this.Width=200,this.$container=$("<div style='vertical-align: middle; position: relative;border:1px solid #ff0000;'></div>").appendTo($(a)),this.$textbox=undefined,this.$clearIcon=undefined,this.$displayLink=undefined,this.$displayNormal=undefined,this.$toggleLink=undefined};m.prototype.Clear=function(){this.$textbox.val("")},m.prototype.Load=function(){var a=this;this.$container.html("").css({width:this.Width+22+"px"}),this.$container.css({"font-size":"9pt","font-weight":"normal","text-align":"left",height:"30px","vertical-align":"middle"}),this.$displayNormal=$("<div style='position:relative;'></div>").appendTo(this.$container),this.$textbox=$("<input type='text'/>").appendTo(this.$displayNormal),this.$textbox.css({width:this.Width+"px","padding-right":"16px"}),this.$textbox.blur(function(){a.Hide()}),this.$clearIcon=$("<img src='./img/window-close.gif' class='filter-box'/>").appendTo(this.$displayNormal),this.$clearIcon.css({left:this.Width+6+"px",cursor:"pointer"}),this.$clearIcon.click(function(){a.Clear()}),this.$displayLink=$("<div></div>").appendTo(this.$container),this.$toggleLink=$("<div style='margin-top:6px;padding-left:8px;'></div>").appendTo(this.$displayLink),this.$toggleLink.click(function(b){a.Show()}),this.Hide()},m.prototype.GetDomElement=function(){return this.$container},m.prototype.Hide=function(){this.$toggleLink.html(this.LinkCaption),this.$displayLink.show(),this.$displayNormal.hide(),this.ShowingLink=!0},m.prototype.Show=function(){this.$textbox.attr("placeholder",this.Watermark),this.$displayLink.hide(),this.$displayNormal.show(),this.ShowingLink=!1,this.$textbox.focus()},m.prototype.Toggle=function(){this.ShowingLink=!this.ShowingLink,this.ShowingLink?this.Hide():this.Show()},f.ListViewFilterMode={Simple:0,Advanced:1},f.ListViewSelectedState=function(a){this.ListViewState={},this.ListViewState.selectedIds=new Array(a)},f.ListViewFilterSettings=function(){this.mode=f.ListViewFilterMode.Simple},f.ListViewState=function(){this.filterText="",this.selectedIds=[]};var n=f.ListView=function(a,b,c){if(!b||!a||!c)throw new Error("Model, container and template must all be set on ListView");this.model=b,this.$container=$(a),this.itemTemplate=c,this.keyField="UniqueID",this.sortIndex=0,this.sortAscending=!0,this.SortFunction=undefined,this.multiSelect=!1,this.fields=[],this.fieldCaptions=[],this.itemTemplateFormatter=undefined,this.filterSettings=new f.ListViewFilterSettings,this.FilterFunction=undefined,this.AddNew=undefined,this.Delete=undefined,this.BeforeSelectionChanged=undefined,this.SelectionChanged=undefined,this.StateChanged=undefined,this.State=new f.ListViewState,this.SelectedItems=[],this.$header=undefined,this.$footer=undefined,this.$body=undefined,this.$innerBody=undefined,this.jsp=undefined,this.loadingDetailsOverlayContainer=undefined};n.prototype.Load=function(){function f(b){if($(b.target).attr("id")=="ui-active-menuitem")return;a.menuVisible=!1,a.menu.hide()}var a=this;a.$container.html(""),a.$container.append(g),a.$header=a.$container.find("#lv_header"),a.$footer=a.$container.find("#lv_footer"),a.jsp=a.$container.find("#lv_body").data("jsp"),a.$body=a.$container.find("#lv_body"),a.$body.jScrollPane(),this.jsp=this.$body.data("jsp"),this.$innerBody=this.jsp.getContentPane(),a.$footer.append("<div id='summary'></div>");var c=$("<input id='filtertext' type='text' placeholder='type to filter...' style='font-size:11pt;float:left;margin-left:6px;margin-top:4px;margin-bottom:0;width:90px;'/>").appendTo(a.$header).keyup(function(){a.State.filterText=$(this).val(),a.triggerStateChanged(),$(this).val()==""?a.$header.find("#clearfilter").fadeOut():a.$header.find("#clearfilter").fadeIn(),a.filter($(this).val())});a.State.filterText&&c.val(a.State.filterText);var d=$("<span id='clearfilter' title='Clear this filter' class='ui-icon ui-icon-close' style='display:none;cursor:  pointer;float:left;margin-left:-18px;margin-top:10px;'></span>").appendTo(a.$header).click(function(){a.$header.find("#filtertext").val(""),a.$header.find("#clearfilter").fadeOut(),a.filter($(this).val())}),e="<button style='width:32px;' id='checkall'>Select All</button>";a.$header.append("<span style='float:right;'><button id='btn'>Name</button><button style='width:26px;' id='dd'>Change Sort Field</button></span>"),a.$footer.prepend("<div id='foot_tools'><button style='width:32px;' id='addnew'>Add New</button><button style='width:32px;' id='delete'>Delete</button>"+e+"<button style='width:32px;' id='checknone'>Select None</button></div>"),a.$footer.find("#checkall").button({text:!1,icons:{primary:"ui-icon-circle-check"}}).click(function(){a.$body.find(".vp_widget_visible").addClass("vp_widget_selected").find("#mselect>div").removeClass("ui-icon-circle-check").addClass("ui-icon-circle-minus"),a.selectionChanged()}),a.$footer.find("#addnew").button({text:!1,icons:{primary:"ui-icon-circle-plus"}}).click(function(){function c(b){a.State.selectedIds=[b[a.keyField]],a.bindItems(),a.$body.find(".vp_widget_selected").removeClass("vp_widget_selected"),a.$body.find("#"+b[a.keyField]).addClass("vp_widget_selected"),a.selectionChanged()}function d(){}b.CallFunction(a.AddNew,[c,d])}),a.$footer.find("#delete").button({text:!1,icons:{primary:"ui-icon-circle-close"}}).click(function(){function d(){a.bindItems(),a.selectionChanged()}function e(){}var c=[];a.$body.find(".vp_widget_selected").each(function(a,b){c.push($(b).tmplItem().data)}),b.CallFunction(a.Delete,[c,d,e])}),a.$footer.find("#checknone").button({text:!1,icons:{primary:"ui-icon-circle-minus"}}).click(function(){a.$body.find(".vp_widget_visible").removeClass("vp_widget_selected").find("#mselect>div").removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-check"),a.selectionChanged()}),a.$header.find("#btn").button({icons:{primary:"ui-icon-circle-triangle-s"}}).click(function(){a.sortAscending=!a.sortAscending,a.sort()}),a.$header.find("#dd").button({text:!1,icons:{primary:"ui-icon-triangle-1-s"}}).click(function(b){b.stopPropagation();if(!a.menuVisible){var c=a.$header.find("#btn").left,d=a.$header.find("#btn").top+a.$header.find("#btn").height(),e=a.$header.find("#dd").left+20;$(a.menu).css("width",e-c+"px").css("left",c).css("top",d),a.menu.fadeIn(),a.menuVisible=!0}else a.menu.fadeOut(),a.menuVisible=!1}).parent().buttonset(),a.$footer.find("#foot_tools").buttonset(),$(document).unbind("mousedown",f).bind("mousedown",f),a.multiSelect||a.$footer.find("#checkall").button("disable"),a.$footer.find("#checknone").button("disable"),a.menu=$("<ul style='z-index:25000;'></ul>"),$.each(a.fieldCaptions,function(b,c){$(a.menu).append("<li data-index='"+b+"'><a href='#'>"+c+"</a></li>")}),a.$container.append(a.menu),$(a.menu).menu({selected:function(b,c){a.sortIndex=$(c.item).attr("data-index"),a.menu.hide(),a.menuVisible=!1,a.sort()}}).addClass("ui-widget-header").css("width","120px").css("position","absolute").css("top","34px").css("right","3px").css("font-size","10pt").hide(),a.bindItems()},n.prototype.bindItems=function(){var a=this,b=a.model.GetItems(),c=[];a.$body.find(".vp_widget").each(function(d,e){var f=!1,g=$(e).attr("id");$.each(b,function(b,c){if(g==c[a.keyField])return f=!0,!1}),f||c.push($(e))}),$.each(c,function(b,c){$(c).fadeOut(225,function(){$(c).remove(),a.selectionChanged(),a.update()})});for(var d=0;d<b.length;d++){var e=a.$body.find("#"+b[d][a.keyField]);if(e.length==0)e=$.tmpl(a.itemTemplate,b[d],a.itemTemplateFormatter),e.attr("id",b[d][a.keyField]),e.find("#mselect").remove(),e.addClass("vp_widget_visible"),a.$innerBody.append(e),$.inArray(b[d][a.keyField],a.State.selectedIds)>-1&&e.addClass("vp_widget_selected"),$(e).click(function(b){a.$body.find(".vp_widget").removeClass("vp_widget_selected").find("#mselect>div").removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-check"),$(this).toggleClass("vp_widget_selected"),$(this).hasClass("vp_widget_selected")?$(this).find("#mselect>div").removeClass("ui-icon-circle-check").addClass("ui-icon-circle-minus"):$(this).find("#mselect>div").removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-check"),a.selectionChanged(),a.update()}),a.checkMultiSelect(e);else{var f=$.tmpl(a.itemTemplate,b[d],a.itemTemplateFormatter);e.html(f.html()),e.find("#mselect").remove(),e.addClass("vp_widget_visible"),a.checkMultiSelect(e)}}a.filter(),a.sort(),a.selectionChanged()},n.prototype.checkMultiSelect=function(a){var b=this;b.multiSelect&&(a.find("#mselect").remove(),a.append("<div id='mselect' style='padding:0;width:32px;position:absolute;right:0;top:0;bottom:0;' class='vp-multiselect-bar'><div style='position:absolute;top:50%;right:50%;margin-top:-8px;' class='ui-icon ui-icon-circle-check'></div></div>"),$(a).find("#mselect").click(function(a){$(this).parent().toggleClass("vp_widget_selected"),$(this).parent().hasClass("vp_widget_selected")?$(this).parent().find("#mselect>div").removeClass("ui-icon-circle-check").addClass("ui-icon-circle-minus"):$(this).parent().find("#mselect>div").removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-check"),a.stopPropagation(),b.selectionChanged()}))},n.prototype.selectionChanged=function(){var a=this,c=[],d=[];a.$body.find(".vp_widget_selected").each(function(b,e){c.push($(e).tmplItem().data),d.push($(e).tmplItem().data[a.keyField])});if(b.ArraysAreEqual(d,a.last_selectedIds))return;a.BeforeSelectionChanged?a.BeforeSelectionChanged(a.last_selected,c,function(){a.applySelection(d,c)},function(){a.$body.find(".vp_widget").removeClass("vp_widget_selected").find("#mselect>div").removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-check");if(a.last_selected)for(var b=0;b<a.last_selected.length;b++)a.$body.find("#"+a.last_selected[b][a.keyField]).addClass("vp_widget_selected").find("#mselect>div").removeClass("ui-icon-circle-check").addClass("ui-icon-circle-minus")}):a.applySelection(d,c)},n.prototype.applySelection=function(a,b){var c=this;c.loadingDetailsOverlayContainer&&c.loadingDetailsOverlayContainer.find("#load_details").hide(),c.last_selectedIds=a,c.last_selected=b;if(c.model.hasDetails){var e=0;$.each(b,function(a,b){(!b.Detail||b.Detail==null)&&e++});if(e==0){c.State.selectedIds=a,c.triggerStateChanged(),c.TriggerSelectionChanged(b);return}var f=window.setTimeout(function(){c.loadingDetailsOverlayContainer&&c.loadingDetailsOverlayContainer.find("#load_details").length==0&&c.loadingDetailsOverlayContainer.append("<div id='load_details' class='listview-overlay' style='display:none;'><div class='spinner-white'></div></div>"),c.loadingDetailsOverlayContainer.find("#load_details").show()},d.WAIT_SPINNER_TIMEOUT);$.each(b,function(d,g){g.Detail||c.model.getDetails(g.UniqueID,function(){e-=1,e<=0&&(window.clearTimeout(f),c.loadingDetailsOverlayContainer&&c.loadingDetailsOverlayContainer.find("#load_details").hide(),c.State.selectedIds=a,c.triggerStateChanged(),c.TriggerSelectionChanged(b))},function(){window.clearTimeout(f),c.loadingDetailsOverlayContainer&&c.loadingDetailsOverlayContainer.find("#load_details").hide()})})}else c.State.selectedIds=a,c.triggerStateChanged(),c.TriggerSelectionChanged(b);c.update()},n.prototype.update=function(){var a=this,b=a.model.GetItems().length,c=a.$body.find(".vp_widget_selected.vp_widget_visible").length,d=a.$body.find(".vp_widget_selected.vp_widget_hidden").length,e=a.$body.find(".vp_widget_visible").length,f="Viewing <b>"+e+"</b> of <b>"+b+"</b> items ... ",g="";c==0&&d==0?g+="No items are selected":c>0&&d==0?g+="<b>"+c+"</b> items are selected":d>0&&c==0?g+="<b>"+d+"</b> hidden items are selected":c>0&&d>0&&(g+="<b>"+c+"</b> visible and ",g+="<b>"+d+"</b> hidden items are selected"),g=g.replace("<b>1</b> items are","<b>1</b> item is"),g=g.replace("<b>1</b> hidden items are","<b>1</b> hidden item is"),g=g.replace("<b>0</b> items are","<b>No</b> items are"),g=g.replace("<b>0</b>","No"),c>0&&d>0&&(g=g.replace(" is "," are ")),a.$footer.find("#summary").html(f+g),a.$body.find(".vp_widget_selected").length==0?a.$footer.find("#checknone").button("disable"):a.$footer.find("#checknone").button("enable"),a.multiSelect?a.$footer.find("#checkall").button("enable"):a.$footer.find("#checkall").button("disable"),d+c>0?a.Delete?a.$footer.find("#delete").button("enable"):a.$footer.find("#delete").button("disable"):a.$footer.find("#delete").button("disable"),a.AddNew?a.$footer.find("#addnew").button("enable"):a.$footer.find("#addnew").button("disable")},n.prototype.filter=function(){var a=this,c=a.$header.find("#filtertext").val();if(c==undefined||c==null||c==""){a.$body.find(".vp_widget").removeClass("vp_widget_hidden").addClass("vp_widget_visible"),a.Resize(),a.update();return}c=c.toLowerCase(),a.$innerBody.find(".vp_widget").each(function(d,e){var f=$(e).tmplItem().data,g=!1;$.each(a.fields,function(d,e){var h=undefined;a.FilterFunction?h=a.FilterFunction(f,e):h=b.GetNotatedValue(f,e),h!=undefined&&c!=undefined&&h.toLowerCase().indexOf(c.toLowerCase())>=0&&(g=!0)}),g||a.fields.length==0?$(e).addClass("vp_widget_visible").removeClass("vp_widget_hidden"):$(e).addClass("vp_widget_hidden").removeClass("vp_widget_visible")}),a.$body.find(".vp_widget_hidden").css("display","none"),a.$body.find(".vp_widget_visible").css("display","block"),a.Resize(),a.update()},n.prototype.sort=function(){var a=this;a.sortAscending?a.$header.find("#btn").button("option",{icons:{primary:"ui-icon-circle-triangle-n"}}):a.$header.find("#btn").button("option",{icons:{primary:"ui-icon-circle-triangle-s"}});var c=a.fields[a.sortIndex];a.SortFunction?a.$innerBody.children().not("ul").sortElements(function(b,d){var e=$(b).tmplItem().data,f=$(d).tmplItem().data;return a.SortFunction(e,f,c,a.sortAscending)}):a.$innerBody.children().not("ul").sortElements(function(d,e){var f=b.ToString(b.GetNotatedValue($(d).tmplItem().data,c)).toString().toLowerCase(),g=b.ToString(b.GetNotatedValue($(e).tmplItem().data,c)).toString().toLowerCase();return a.sortAscending?f>g?1:-1:f<g?1:-1}),a.$header.find("#btn").find(".ui-button-text").html(a.fieldCaptions[a.sortIndex]),a.$body.find(".vp_widget_selected").length>0&&!a.jsp},n.prototype.triggerStateChanged=function(){var a=this;b.CallFunction(a.StateChanged,[a.State])},n.prototype.SetState=function(a){$.extend(!0,this.State,a)},n.prototype.TriggerSelectionChanged=function(a){a&&(this.SelectedItems=a),b.CallFunction(this.SelectionChanged,[this.SelectedItems])},n.prototype.Resize=function(){if(this.jsp){var a=this.$container.height()-100,b=this.$container.width();if(a<=0)return;this.$container.find(".jspContainer").css("width","100%").css("height",a),this.jsp.reinitialise()}},f.SaveAsYouGoStatus={Success:0,Failure:1,Ignore:2};var o=f.SaveAsYouGoPanel=function(a,b){this.$container=$(a),this.jsp=undefined,this.keyField="UniqueID",this.selectedItems=undefined,this.editPanelTemplateFormatter=undefined,this.editPanelTemplate=b,this.CommonFieldsObject=undefined,this.FieldChangedFunction=undefined,this.$container.jScrollPane(),this.jsp=this.$container.data("jsp"),this.$body=this.jsp.getContentPane()};o.prototype._processNetworkChangeNotification=function(a){var c=this;if(c.selectedItems.length==1)$.each(a.changes,function(a,b){var d=c.$container.find("[name='"+a+"']");$(d).selectmenu("destroy"),d.val(b),c.CommonFieldsObject[a]=b,d.is("select")&&$(d).selectmenu("destroy").selectmenu()});else{var d={};b.GetCommonFields(d,c.selectedItems),$.each(a.changes,function(a,e){var f=b.GetNotatedValue(c.CommonFieldsObject,a),g=b.GetNotatedValue(d,a),h=c.$container.find("[name='"+a+"']");g=="xxx_variable_xxx"?h.val("").attr("placeholder","variable ..."):h.val(g),h.is("select")&&h.selectmenu("destroy").selectmenu()})}},o.prototype.ApplyNetworkChangedItem=function(a){return c.IsEmptyObject(a.changes)?!1:c.ItemInArrayHasFieldWithValue(this.selectedItems,this.keyField,a.id)?(this._processNetworkChangeNotification(a),!0):!1},o.prototype.Resize=function(){if(this.jsp){var a=this.$container.height(),b=this.$container.width();if(a<=0)return;this.$container.find(".jspContainer").css("width","100%").css("height",a),this.jsp.reinitialise()}},o.prototype.SetSelectedItems=function(a){var c=this;c.selectedItems=a;var d={};if(a.length==0)return c.$container.hide(),c.CommonFieldsObject=undefined,c.CommonFieldsObject;if(a.length==1){$.extend(!0,d,a[0]);var e=$.tmpl(c.editPanelTemplate,d,c.editPanelTemplateFormatter);c.$body.html("").append(e),c.$container.find(".multi_edit").hide(),c.$container.find(".single-edit-only").show()}else{b.GetCommonFields(d,a);var e=$.tmpl(c.editPanelTemplate,d,c.editPanelTemplateFormatter);c.$body.html("").append(e),c.$container.find(".multi_edit").show(),c.$container.find(".single-edit-only").hide(),c.$container.find("input,select,textarea").each(function(a,b){$(b).val()=="xxx_variable_xxx"&&$(b).val("").attr("placeholder","variable ...")}),c.$container.find("span").each(function(a,b){$(b).text()=="xxx_variable_xxx"&&$(b).text("variable ...")})}return c.CommonFieldsObject=d,c.$container.show(),c.$container.find("input[type=text],select,textarea").change(function(){var a=this;if($(a).closest(".no-sayg").length>0)return;var d=$("<img style='margin-left:5px;vertical-align: middle;' src='./img/ajax-loader-small.gif'/>");$(this).data("working",d),$(this).is("select")?$(this).next().after(d):$(this).after(d);if(!c.FieldChangedFunction){console.log("No FieldChangedFunction assigned for the SaveAsYouGoPanel");return}var e=$(this).attr("name"),g=b.GetPartialUpdateObject(e,$(this).val());c.FieldChangedFunction(e,g,function(b){c.CommonFieldsObject[e]=g[e],$(a).data("working")!=undefined&&$(a).data("working").remove(),$(a).data("complete")!=undefined&&$(a).data("complete").remove();if(b==f.SaveAsYouGoStatus.Ignore)return;var d=undefined;b==f.SaveAsYouGoStatus.Success?d=$("<img style='margin-left:5px;vertical-align: middle;' src='./img/icons/icon-accept.png'/>"):b==f.SaveAsYouGoStatus.Failure&&(d=$("<img style='cursor:  pointer;margin-left:5px;vertical-align: middle;' src='./img/icons/icon-error.png'/>"),d.click(function(){alert("Show some cool error details here and allow the user to do some stuff"),$(d).fadeOut()})),$(a).data("complete",d),$(a).is("select")?$(a).next().after(d):$(a).after(d),$(d).fadeIn(750,function(){$(d).delay(1e3).fadeOut()})})}),this.Resize(),c.CommonFieldsObject};var p=f.ToolBox=function(b,c,d){var e=this;this.$contents=$(c),this.$body=$(a("text!../../../tmpl/components/toolbox.html")),this.StateChanged=undefined,this.jsp=undefined,this.State={top:0,left:0,width:260,height:400,visible:!1},d&&this.SetState(d),this.$body.find("#caption_text").text(b),this.$body.find("#body").append(this.$contents),this.$body.hide().appendTo("body"),this.$body.draggable({handle:"#header",stop:function(a,b){e.State.left=e.$body.position().left,e.State.top=e.$body.position().top,e.TriggerStateChanged()}}),this.$body.resizable({start:function(a,b){e.$body.find("#body").hide()},stop:function(a,b){e.State.height=e.$body.height(),e.State.width=e.$body.width(),e.TriggerStateChanged(),e.$body.find("#body").show(),e.Resize()},minHeight:80,minWidth:80}),this.$body.find("#close_window").click(function(){e.Hide(!0)}),this.$body.find("#body").jScrollPane(),this.jsp=this.$body.find("#body").data("jsp"),this.ApplyState()};p.prototype.ApplyState=function(){this.$body.css("width",this.State.width+"px"),this.$body.css("height",this.State.height+"px"),this.$body.css("top",this.State.top+"px"),this.$body.css("left",this.State.left+"px"),this.State.visible?this.Show():this.Hide()},p.prototype.SetState=function(a){$.extend(!0,this.State,a),this.ApplyState()},p.prototype.Show=function(a){this.$body.show(),this.Resize();if(!a)return;this.State.visible=!0,this.TriggerStateChanged()},p.prototype.Hide=function(a){this.$body.hide();if(!a)return;this.State.visible=!1,this.TriggerStateChanged()},p.prototype.Resize=function(){this.jsp&&this.jsp.reinitialise()},p.prototype.Toggle=function(){this.State.visible=!this.State.visible,this.State.visible?this.Show(!0):this.Hide(!0)},p.prototype.TriggerStateChanged=function(){b.CallFunction(this.StateChanged,[this.State])};var q=f.TreeView=function(a){this.$container=$(a),this.keyField="UniqueID",this.nodeTemplate="",this.nodeIndent="23px",this.toggleSelector="",this.classExpanded="ui-icon-folder-open",this.classCollapsed="ui-icon-folder-collapsed"};q.prototype.Load=function(){var a=this;a.$container.html("");var b=$("<div id='ul_root' class='treeview-control'></div>");b.css("padding-left",a.nodeIndent),a.$container.append(b)},q.prototype.AddNode=function(a,b,c){var d=this,e="root";b&&(e=b[d.keyField]);var f=$("<div style='margin:1px;margin-right:0;' class='treeview-node'></div>");f.attr("id","li_"+a[d.keyField]);var g=$.tmpl(d.nodeTemplate,a);g.addClass(c),g.attr("id",a[d.keyField]),f.append(g),g.find(d.toggleSelector).click(function(){d.ToggleNode(a)});var h=$("<div></div>");return h.css("padding-left",d.nodeIndent),h.attr("id","ul_"+a[d.keyField]),f.append(h),d.$container.find("#ul_"+e).append(f),g.data("item",a),g},q.prototype.ToggleNode=function(a){var b=this.$container.find("#ul_"+a[this.keyField]),c=this.$container.find("#li_"+a[this.keyField]),d=b.css("display");d=="none"?(b.show(),c.find(this.toggleSelector).removeClass(this.classCollapsed).addClass(this.classExpanded)):(b.hide(),c.find(this.toggleSelector).addClass(this.classCollapsed).removeClass(this.classExpanded))},q.prototype.RemoveNode=function(a){var b=this;b.$container.find("#li_"+a[b.keyField]).remove()},q.prototype.MoveNode=function(a,b,c){this.$container.find("#li_"+a[this.keyField]).appendTo(this.$container.find("#ul_"+b[this.keyField]))},q.prototype.NodeChildCount=function(a){var b=this.$container.find("#ul_"+a[this.keyField]).children();return b?b.length:0};var r=f.UIChatBox=function(){this.ID="",this.Caption="",this.Expanded=!1,this.Floating=!1,this.$element=undefined,this.$header=undefined,this.$body=undefined,this.$footer=undefined,this.ShowingAlert=!1,this.onClickFunction=undefined,this.onCloseFunction=undefined,this.onPositionChangedFunction=undefined,this.onDockChangedFunction=undefined,this.$lastMessageRow=undefined};r.prototype.AddMessage=function(a){var b=this.$bodyTable;if(b.find("#"+a.UniqueID).length>0)return;var d=$("<tr></tr>");d.attr("id",a.UniqueID),d.data("message",a),b.append(d);if(a.Kind=="User"){var f=$("<td style='width:30px;border-bottom:1px dotted #393939;padding:4px;'><img style='width:24px;height:24px;' src='"+c.CreateGravatarMarkup(e.Accounts.GetItemByKey(a.Account_uid),24)+"'/></td>"),g=$("<td style='border-bottom:1px dotted #393939;padding:4px;'>"+a.Value+"</td>");d.append(f),d.append(g)}else{var h=$("<td colspan='2' style='border-bottom:1px dotted #393939;padding:4px;font-size:8pt;color:#909090;'>"+a.Value+"</td>");d.append(h)}this.$lastMessageRow=d},r.prototype.AddMessages=function(){var a=this,b=e.Conversations.GetItemByKey(this.ID);$.each(b.Messages,function(b,c){a.AddMessage(c)}),this.Sort(),this.Resize(),this.jsp&&this.$lastMessageRow&&this.jsp.scrollToElement(this.$lastMessageRow)},r.prototype.getCaptionForConversation=function(a){var b="",c=a.Accounts.length>2;for(var f=0;f<a.Accounts.length;f++){var g=a.Accounts[f];if(g.UniqueID==d.CurrentAccountID)continue;var h=e.Accounts.GetItemByKey(g.UniqueID);if(!h)continue;c?b+=h.Name.split(" ")[0]+", ":b+=h.Name+", "}return b!=""&&(b=b.substring(0,b.length-2)),b=b.replace(/,\s([^,]+)$/," and $1"),b},r.prototype.GetDomElement=function(){return this.$element},r.prototype.GetPosition=function(){if(!this.Floating)return undefined;var a={};return a.Top=this.$element.position().top,a.Left=this.$element.position().left,a},r.prototype.Resize=function(){this.$element.find(".jspContainer").css({width:this.$body.width(),height:this.$body.height()}),this.jsp.reinitialise(),this.jsp.scrollToBottom()},r.prototype.SetAlert=function(a){if(this.ShowingAlert==a)return;this.ShowingAlert=a,a?(d.Plong.Play(),this.$element.addClass("chatbox-alert")):(e.Conversations.MarkAllRead(this.ID),this.$element.removeClass("chatbox-alert"))},r.prototype.SetDocked=function(){this.Floating=!1,this.$min.hide(),this.$element.addClass("chatbox-active"),this.$element.css({top:"",left:"",bottom:"0"})},r.prototype.SetExpandedCollapsed=function(a){if(this.Floating)return;a?(this.Expanded=!0,this.$element.addClass("chatbox-active"),this.$element.removeClass("chatbox-alert"),this.$element.draggable("enable"),this.$textbox.focus(),this.Resize()):(this.Expanded=!1,this.$element.removeClass("chatbox-active"),this.$element.draggable("disable"))},r.prototype.SetFloating=function(){this.Floating=!0,this.$min.show(),this.$element.addClass("chatbox-active"),this.$element.css({right:"",bottom:""})},r.prototype.SetPosition=function(a){if(!a||!this.Floating)return;this.$element.css({left:a.Left,top:a.Top}),this.SetFloating()},r.prototype.Sort=function(){this.$bodyTable.find("tr").sortElements(function(a,b){var c=new Date($(a).data("message").DateTimeMilliseconds),d=new Date($(b).data("message").DateTimeMilliseconds);return c>d?1:-1})},r.prototype.UpdateCaption=function(){var a=this.getCaptionForConversation(this.Conversation);this.$caption.html(a)};var s=f.NewUIChatBox=function(a,b,c,d,f){var g=new r;g.ID=a.UniqueID,g.Caption=g.getCaptionForConversation(a),g.onClickFunction=b,g.onCloseFunction=c,g.onPositionChangedFunction=d,g.onDockChangedFunction=f,g.$element=$("<div class='chatbox-wrapper'>"),g.$element.css("position","absolute"),g.$header=$("<div class='chatbox-header'>"),g.$element.append(g.$header);var h=$("<div class='chatbox-icon'>");g.$caption=$("<div class='chatbox-caption'>").html(g.Caption),g.$min=$("<img src='img/desc.gif' class='chatbox-min'/>");var i=$("<img src='img/window-close.gif' class='chatbox-close'/>");g.$header.append(h),g.$header.append(g.$caption),g.$header.append(g.$min),g.$header.append(i),g.$header.click(function(){g.onClickFunction(g.ID)}),i.click(function(a){a.stopPropagation(),g.onCloseFunction(g.ID)}),g.$min.click(function(a,b){a.stopPropagation(),g.SetDocked(),g.onDockChangedFunction(g.ID,!0)}),g.$body=$("<div class='chatbox-body'>");var j=$("<div class='chatbox-body-guts'></div>").appendTo(g.$body);return j.jScrollPane(),g.jsp=j.data("jsp"),g.$innerBody=g.jsp.getContentPane(),g.$element.append(g.$body),g.$bodyTable=$("<table style='width:100%;' cellspacing='0'></table>").appendTo(g.$innerBody),e.Conversations.getDetails(a.UniqueID,function(a,b){g.AddMessages()}),g.$footer=$("<div class='chatbox-footer'>"),g.$element.append(g.$footer),g.$textbox=$("<textarea class='chatbox-textbox'>"),g.$footer.append(g.$textbox),g.$textbox.autoResize({animate:!1,onResize:function(){var a=g.$textbox.height();a>40&&g.$footer.height(a+8)}}).focus(function(){g.SetAlert(!1),g.$element.css("z-index","600000")}).blur(function(){g.$element.css("z-index","")}).keyup(function(a){g.SetAlert(!1);if(a.keyCode=="13"){var b=g.$textbox.val().trim();if(b==""){g.$textbox.val(""),g.$textbox.height(""),g.$footer.height("40px");return}e.Conversations.SendMessage(g.ID,b),g.$textbox.val(""),g.$textbox.height(""),g.$footer.height("40px")}}),g.$element.draggable({handle:".chatbox-header",containment:"window",scroll:!1,distance:8,start:function(a,b){a.stopPropagation(),g.SetFloating(),g.onDockChangedFunction(g.ID,!1)},stop:function(a,b){g.onPositionChangedFunction(g.ID)}}),g.$element.droppable({drop:function(a,b){var c=$(b.draggable).data("account");e.Conversations.AddParticipant(g.ID,c.UniqueID)}}),g},t=f.UIChatManager=function(){this.Boxes=[],this.onClickFunction=undefined,this.onCloseFunction=undefined,this.onPositionChangedFunction=undefined};t.prototype.AddChatBox=function(a){var b=this.findChatBox(a);if(b>-1)return this.Boxes[b];var c=e.Conversations.GetItemByKey(a);if(!c)return;var d=s(c,this.onClickFunction,this.onCloseFunction,this.onPositionChangedFunction,this.onDockChangedFunction);return d.Conversation=c,d.$element.appendTo("body"),this.Boxes.push(d),this.PositionBoxes(),d},t.prototype.AddChatBoxFromState=function(a){var b=this.AddChatBox(a.id);if(!b)return;a.floating?(b.SetFloating(),b.SetPosition(a.position)):b.SetDocked(),b.SetExpandedCollapsed(a.expanded)},t.prototype.findChatBox=function(a){for(var b=0;b<this.Boxes.length;b++)if(this.Boxes[b].ID==a)return b;return-1},t.prototype.findChatBoxWithAccount=function(a){for(var b=0;b<this.Boxes.length;b++){var c=this.Boxes[b].Conversation;for(var d=0;d<c.Accounts.length;d++)if(c.Accounts[d].UniqueID==a&&c.Accounts.length==2)return c.UniqueID}return-1},t.prototype.GetState=function(){var a=[];for(var b=0;b<this.Boxes.length;b++)a.push({id:this.Boxes[b].ID,expanded:this.Boxes[b].Expanded,floating:this.Boxes[b].Floating,position:this.Boxes[b].GetPosition()});return a},t.prototype.getRemoveChatBox=function(a){this.RemoveChatBox(a)},t.prototype.getSetActiveBox=function(a){this.SetActiveBox(a)},t.prototype.PositionBoxes=function(){var a=220;for(var b=0;b<this.Boxes.length;b++){var c=this.Boxes[b];c.Floating||(c.GetDomElement().css({right:a,bottom:0,top:"",left:""}),a=a+c.GetDomElement().width()+8)}},t.prototype.RemoveChatBox=function(a){var b=this.findChatBox(a);if(b<0)return;var c=this.Boxes.splice(b,1)[0];c.$element.remove(),this.PositionBoxes()},t.prototype.SetActiveBox=function(a){var b=this.findChatBox(a);if(b!=-1&&this.Boxes[b].Floating)return;for(var c=0;c<this.Boxes.length;c++)this.Boxes[c].Expanded&&this.Boxes[c].ID!=a&&this.Boxes[c].SetExpandedCollapsed(!1);b!=-1&&(this.Boxes[b].SetExpandedCollapsed(!0),this.Boxes[b].Resize()),this.stateChangedFunction(),this.PositionBoxes()},t.prototype.UpdateCaptions=function(){for(var a=0;a<this.Boxes.length;a++)this.Boxes[a].UpdateCaption()},f.NewUIChatManager=function(a){var b=new t;return b.stateChangedFunction=a,b.onClickFunction=function(a){b.getSetActiveBox(a),b.stateChangedFunction()},b.onCloseFunction=function(a){b.getRemoveChatBox(a),b.stateChangedFunction()},b.onPositionChangedFunction=function(a){b.PositionBoxes(),b.stateChangedFunction()},b.onDockChangedFunction=function(a,c){c&&b.getSetActiveBox(a),b.PositionBoxes(),b.stateChangedFunction()},$(window).resize(function(){b.PositionBoxes()}),b};var u=f.UICollaboratorManager=function(a){var b=this;this.Caption="Collaborators",this.Expanded=!1,this.StateChangedFunction=a,this.$element=$("<div class='chatbox-wrapper'>"),this.$element.css({position:"absolute",bottom:"0",right:"4px",width:"208px"}),this.$header=$("<div class='chatbox-header'>"),this.$element.append(this.$header),this.$caption=$("<div class='chatbox-caption' style='text-align:center;margin-left:8px;margin-right:8px;'>").html(this.Caption),this.$header.append(this.$caption),this.$body=$("<div class='chatbox-body'>"),this.$guts=$("<div class='chatbox-body-guts'></div>").appendTo(this.$body),this.$guts.jScrollPane(),this.jsp=this.$guts.data("jsp"),this.$innerBody=this.jsp.getContentPane(),this.$element.append(this.$body),this.$bodyTable=$("<table style='width:100%;' cellspacing='0'></table>").appendTo(this.$innerBody),this.$body.appendTo(this.$element),this.$element.appendTo("body").show(),this.$body.css("height","234px"),this.$header.click(function(){b.Expanded=!b.Expanded,b.SetExpanded(b.Expanded),b.StateChangedFunction()}),$.idleTimer(3e5),$(document).bind("idle.idleTimer",function(){b.SetStatus("Idle")}),$(document).bind("active.idleTimer",function(){b.SetStatus("Online")}),this.UpdateCollaborators(),this.Resize()};return u.prototype.AddCollaborator=function(a){if(a==undefined)return;var b=this.$bodyTable;if(b.find("#"+a.Account_uid).length>0){b.find("#"+a.Account_uid).find("#online_status").attr("src",this.getStatusIcon(a));return}var f=$("<tr></tr>");f.attr("id",a.Account_uid),f.addClass("collab-row");var g=e.Accounts.GetItemByKey(a.Account_uid);f.data("collaborator",a),f.data("account",g),b.append(f),f.append("<td style='border-bottom:1px dotted #393939;width:18px;'><img src='"+c.CreateGravatarMarkup(e.Accounts.GetItemByKey(a.Account_uid),16)+"' style='width:16px;height:16px;'/></td>");var h=$("<td id='collab_caption' style='border-bottom:1px dotted #393939;padding:4px;font-size:8pt;color:#909090;'>"+e.GetTemplatedAccountName(a.Account_uid)+"</td>");f.append(h),f.append("<td style='padding-top:4px;border-bottom:1px dotted #393939;width:16px;'><img id='online_status' src='' style='width:12px;height:12px;'/></td>"),f.find("#online_status").attr("src",this.getStatusIcon(a)),this.$lastMessageRow=f,f.draggable({distance:8,containment:"window",scroll:!1,helper:function(){var b=$("<div class='collab-icon'></div>");return b.append("<img style='width:60px;height:60px;' src='"+c.CreateGravatarMarkup(e.Accounts.GetItemByKey(a.Account_uid),60)+"'/><br/>"),b.append("<span>"+e.GetTemplatedAccountName(a.Account_uid)+"</span>"),b.appendTo("body")}}),f.click(function(){var a=d.ChatManager.findChatBoxWithAccount(g.UniqueID);if(a!=-1){var b=d.ChatManager.AddChatBox(a);d.ChatManager.SetActiveBox(b.ID)}else e.Conversations.StartChat(new Array(g.UniqueID),function(a){var b=d.ChatManager.AddChatBox(a.UniqueID);d.ChatManager.SetActiveBox(b.ID)})})},u.prototype.getStatusIcon=function(a){return a.Status=="Online"?"./img/collab_online.png":a.Status=="Idle"?"./img/collab_idle.png":"./img/collab_offline.png"},u.prototype.getStatusIndex=function(a){switch(a.Status){case"Online":return"00";case"Idle":return"01";default:return"02"}},u.prototype.Resize=function(){this.$element.find(".jspContainer").css({width:this.$body.width(),height:this.$body.height()}),this.jsp.reinitialise()},u.prototype.SetCaption=function(a){this.$caption.html(a)},u.prototype.SetExpanded=function(a){a==undefined&&(a=!1),this.Expanded=a,this.Expanded?(this.$body.show(),this.Resize()):this.$body.hide()},u.prototype.SetStatus=function(a){if(d.CollaborationStatus==a)return;d.CollaborationStatus=a,e.Collaborators.ChangeStatus(a)},u.prototype.Sort=function(){var a=this;this.$bodyTable.find("tr").sortElements(function(b,c){var d=a.getStatusIndex($(b).data("collaborator"))+"_"+$(b).data("account").Name,e=a.getStatusIndex($(c).data("collaborator"))+"_"+$(c).data("account").Name;return d>e?1:-1})},u.prototype.UpdateAccountName=function(a){var b=this.$bodyTable;b.find("#"+a.UniqueID).find("#collab_caption").html(a.Name)},u.prototype.UpdateAccountNames=function(){var a=this;$.each(e.Accounts.GetItems(),function(b,c){a.UpdateAccountName(c)})},u.prototype.UpdateCollaborators=function(){var a=this,b=0,c=0,d=e.Collaborators.GetItems();$.each(d,function(d,e){e.Status=="Online"&&b++,e.Status=="Idle"&&c++,a.AddCollaborator(e)});var f="";if(d.length==0)f="No Collaborators";else{d.length==1?f="1 Collaborator":f=d.length+" Collaborators";var g=b+c;g==0?f+=", None Online":f+=", "+g+" Online"}this.SetCaption(f),this.Sort()},f}),define("core",["require","coreglobals","objects/schema/models","objects/schema/model_utils","master_api","general_functions","posConnection","objects/schema/component_classes","utilities","objects/schema/audio","formstuff","text!../tmpl/components/forgot_password.html"],function(a){function L(){this.$rightArrow=undefined,this.$leftArrow=undefined}function M(){var a=new L,b="display:block; position:absolute; top:0; left:0; width:24px; height:24px; z-index:1000000;";return a.$rightArrow=$(i.FormatString('<img src="img/widgetDragArrowRight.png" style="{0}"/>',b)),a.$leftArrow=$(i.FormatString('<img src="img/widgetDragArrowLeft.png" style="{0}"/>',b)),a}function P(a){var b=bg(a.ID);if(b>=0)return;var c=k.NewFavorite(a.ID,a.Name);u.push(c),cz(a.ID,!0),cD(),$(document).trigger("favoriteAdded",c)}function Q(a){var b=bj(a.ID);if(b>=0){var c=y.splice(b,1);y.unshift(c[0])}else{var d=k.NewRecentItem(a.ID,a.Name);y.unshift(d)}y.length>5&&y.pop(),$(document).trigger("recentItemsUpdated",[y])}function R(a,b){var c=!1;if(o[a]==undefined||o[a].length==0)o[a]=[],c=!0;for(var d=0;d<o[a].length;d++)if(i.FunctionsAreSame(o[a][d],b))return console.warn("Readded subscription: "+a),!1;return o[a].push(b),c}function S(a){var b=a.NameSpace.split("."),c=b[1],d=undefined;$("#navigation_menu").children().each(function(a,b){$(b).attr("name")=="nav_"+c&&(d=$(b).find("div").first())});if(d==undefined){var e=$("<div class='navigation-group' name='nav_"+c+"'><span>"+c+"</span></div>");$("#navigation_menu").append(e),d=$("<div class='nav-items' style='padding-bottom:8px;'></div>"),$(e).append(d)}var f=$("<span class='navigation-item'></span>").html(a.Name).attr("data-keywords",a.Keywords+","+b[1]);$(f).click(function(){$("#navigation_panel").css("top",38+ -1*$("#navigation_panel").height()),N(a.ID,!1)}),$(d).append(f),$(d).children().sortElements(function(a,b){var c=$(a).text(),d=$(b).text();return c>d?1:-1})}function T(a){if(!a)return;var b=a.GetBaseFormDescription();C.AddButton(b.ID,b.Name),cA()}function U(){var a=c.Accounts.GetItems();for(var b=0;b<a.length;b++)if(m.UniqueID==a[b].UniqueID){$.extend(!0,m,a[b]),cI();break}}function V(){var a=bi(r.GetBaseFormDescription().ID),b=-1;a.Index>0?b=a.Index-1:b=a.Index+1,a.Index>w.length-1&&(b=-1);var c=w[b];Q(a.UIForm.GetBaseFormDescription()),W(a.Index),cv(a.UIForm),r=c,c?(cC(c),C.SetActiveButton(c.GetBaseFormDescription().ID)):cn(!1)}function W(a){var b=w[a],c=b.GetCurrentForm();w.splice(a,1),X(b,0),b.UIWindow.GetDomElement().remove()}function X(a,b){var c=a.GetCurrentForm();c&&(c.Hide(),a.UIWindow.CollaborationPopup.Hide(),Z(c.Description));for(var d=a.FormCrumbs.length-1;d>=b;d--){var e=a.FormCrumbs[d];a.FormCrumbs.splice(d,1);if(!e.Form)continue;e.Form.Unload(),e.Form.GetContents().remove(),e.Form.UnbindRequires()}}function Y(a){c.Collaborators.EnterForm(a.ID)}function Z(a){c.Collaborators.LeaveForm(a.ID)}function _(){var a=new g.ConnectionParams;a.URI="/backofficesocket",a.OnConnect=br,a.OnConnectFailed=bs,a.OnDisconnect=bt,a.OnMessage=bI,b.PosConnection.Connect(a)}function ba(a,b,c,d){function e(){var d=a.CreateInstance();if(!d.LoadAsync){d.Load(b),d.BindRequires(a.requiredModels),i.CallFunction(c,[d]);return}d.LoadAsync(b,function(){d.BindRequires(a.requiredModels),i.CallFunction(c,[d])})}function f(){i.CallFunction(d)}a.LoadRequires(e,f)}function bb(a){e.AutoLogin(a,function(a){cs(a)},function(a,b){cM(),$("txt_email").focus()})}function bc(){var a=$("#txt_email").val(),b=$("#txt_password").val();e.Login(a,b,function(a){$("#loading_logo").show(),$("#login_container").hide(),cs(a)},function(a,b){f.DialogError(a,b)})}function bd(){e.Logout(function(a){i.LocalStorage.Set("sessionToken",""),window.location.reload()},f.DialogError)}function be(){var b=$(a("text!../tmpl/components/forgot_password.html")),c=b.find("#email");b.dialog({width:320,modal:!0,resizable:!1,title:"Forgot Your Password?",buttons:{"Send Instructions":function(){if(c.val().trim()==""){f.DialogAlert("You must provide an email address to request your password","Invalid Email",!0);return}bf(c.val().trim().toLowerCase()),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})}function bf(a){function b(){f.DialogAlert("Instructions on how to reset your password have been sent to <b>"+a+"</b>","Forgot Password",!1)}e.ForgotPassword(a,b,f.DialogError)}function bg(a){for(var b=0;b<u.length;b++)if(u[b].guid==a)return b;return-1}function bh(a){for(var b in v){if(!v.hasOwnProperty(b))continue;if(v[b].ID==a)return v[b]}return undefined}function bi(a){for(var b=0;b<w.length;b++){var c=w[b];if(c.GetBaseFormDescription().ID==a)return{Index:b,UIForm:c}}return undefined}function bj(a){for(var b=0;b<y.length;b++)if(y[b].guid==a)return b;return-1}function bk(a,b){for(var c=0;c<a.length;c++)if(a[c].Widget.ID==b)return c;return-1}function bl(a){if(a.keyCode==27){cy("collapsed");return}var b=$("#nav-search").val().toLowerCase();$("#navigation_menu").find(".navigation-item").each(function(a,b){$(b).removeClass("navigation-item-last-child")}),$("#navigation_menu").find(".navigation-item").each(function(a,c){var d=$(c).attr("data-keywords").toLowerCase();b==""||d.indexOf(b)>-1?$(c).removeClass("nav-hidden").addClass("nav-visible").fadeIn():$(c).addClass("nav-hidden").removeClass("nav-visible").fadeOut()}),$("#navigation_menu").find(".navigation-group").each(function(a,b){$(b).find(".nav-visible:last").addClass("navigation-item-last-child"),$(b).find(".nav-visible").length==0?$(b).fadeOut():$(b).fadeIn()})}function bm(){function c(){a.collaborationState=b.CollabManager.Expanded}function d(){a.conversationStates=b.ChatManager.GetState()}function e(){for(var b=0;b<u.length;b++)a.favorites.push(u[b].GetPersistObject())}function f(){a.eastPaneClosed=z,a.westPaneClosed=A}function g(){for(var b=0;b<w.length;b++)a.openForms.push(w[b].GetPersistObject());r&&(a.activeFormID=r.GetBaseFormDescription().ID)}function h(){for(var b=0;b<y.length;b++)a.recentItems.push(y[b].GetPersistObject())}function j(a,b){for(var c=0;c<b.UIWidgets.length;c++){var d=b.UIWidgets[c];a.push(d.GetPersistObject())}}function l(){for(var b in G){if(!G.hasOwnProperty(b))continue;var c=G[b];if(i.IsEmptyObject(c))continue;a.widgetStates[b]=c}}var a=undefined;return a=new k.PersistedDesktopLayout,f(),j(a.eastWidgets,D),j(a.westWidgets,E),l(),e(),h(),g(),d(),c(),a}function bn(a){var b="<img style='height:19px;' src='img/emoticons/{1}.png'/>";return b=b.replace("{1}",a),b}function bo(){return $('<div style="color:red;">There was an error loading the form</div>')}function bp(a){var b=D.GetUIWidgetDropInfo(a);return b.Found?b:(b=E.GetUIWidgetDropInfo(a),b)}function bq(){return $('<div><div class="spinner-white"></div></div>')}function br(){$("#network_dead").hide(),$("#network_live").show()}function bs(){}function bt(){b.Authenticated=!1,$("#network_live").hide(),$("#network_dead").show()}function bu(){i.LocalStorage.Set("sessionToken",""),i.LocalStorage.Set("redirectReason","Session Expired"),window.location.reload()}function bv(a){i.LocalStorage.Set("sessionToken",""),i.LocalStorage.Set("redirectReason",a),window.location.reload()}function bw(a){X(r,a+1),r.UIWindow.UIBreadBar.RemoveBreadCrumbs(a),r.UIWindow.UIBreadBar.SetCurrentName(r.GetCurrentFormDescription().Name),cB(r);var b=r.GetCurrentForm();b&&(Y(b.Description),b.GetContents().show(),b.Resize(),b.Show()),cx()}function bx(){V(),cx()}function by(){r.UIWindow.CollaborationPopup.Show()}function bz(){r.Maximized=!r.Maximized,cn(r.Maximized),cx()}function bA(){var a=r.GetBaseFormDescription(),b=bg(a.ID);b>=0?cu(a.ID):P(a),cx()}function bB(a,b){if(!r)return;var d=r.GetCurrentForm();if(!d)return;var e=d.Description;if(a!=e.ID)return;r.UIWindow.ClearCollaborators();if(!b||b.length==0)return;for(var f=0;f<b.length;f++){var g=c.Accounts.GetItemByKey(b[f]);g&&r.UIWindow.AddCollaborator(g)}}function bC(){if(x)return;z=!0,cx()}function bD(){if(x)return;z=!1,r&&(r.Maximized=!1),cx()}function bE(){D.Resize()}function bF(){if(x)return;A=!0,cx()}function bG(){if(x)return;A=!1,r&&(r.Maximized=!1),cx()}function bH(){E.Resize()}function bI(a,c){f.LogMessage("Received Network Message: "+c.Action);switch(c.Action){case"AuthenticateBackofficeClient":f.LogMessage("Master requesting authentication"),e.ValidateSession(function(){var a={};a.ResponseID=c.RequestID,a.Ok=!0,a.SessionToken=e.GetCurrentToken(),b.PosConnection.SendMessage(a),f.LogMessage("Authentication response sent")},function(){bu()});break;case"AuthenticatedNotification":cq(c);break;case"NotificationsNotification":$.each(c.Notifications,function(b,c){bI(a,c)});break;case"ChangeConversationNotification":case"CollaboratorChangeNotification":case"CollaboratorEnterNotification":case"CollaboratorLeaveNotification":case"ChangeLocationFloorChartNotification":case"ChangeOrgStructureNotification":case"ConnectNotification":case"DeleteAccountNotification":case"DeleteBOGroupNotification":case"DeleteLocationNotification":case"DeleteLocationFloorChartNotification":case"DeleteOrganizationNotification":case"DeleteOrgStructureNotification":case"DeletePosUserNotification":case"DeletePosUserJobPositionNotification":case"DeleteUserNotification":case"DisconnectNotification":case"NewAccountNotification":case"NewBOGroupNotification":case"NewLocationNotification":case"NewLocationFloorChartNotification":case"NewOrganizationNotification":case"NewOrgStructureNotification":case"NewPosUserJobPositionNotification":case"NewUserNotification":case"SessionExpiredNotification":case"SetBOGroupPermissionNotification":case"SetPosGroupPermissionNotification":case"UpdateAccountNotification":case"UpdateBOGroupNotification":case"UpdateJobPositionNotification":case"UpdateLocationNotification":case"UpdateLocationFloorChartNotification":case"UpdateOrganizationNotification":case"UpdateOrgStructureNotification":case"UpdateUserNotification":cH(c.Action,c);break;default:console.warn("Received unexpected master message: "+JSON.stringify(c)),f.LogMessage("<span style='font-weight:bold;color:orange;'>RECEIVED UNEXPECTED MASTER MESSAGE:</span>"+JSON.stringify(c))}}function bJ(a){if(r.GetBaseFormDescription().ID==a){V();return}var b=bi(a);W(b.Index),cv(b.UIForm),cx()}function bK(a){var b=bi(a);cG(b.UIForm),cx()}function bL(a){a.Widget.FireUnload(),a.RemoveFromPanel(),F.AddUIWidget(a),a.SetStyleFixed(),a.ShowIcon(),F.Sort(),cx()}function bM(a){function b(b,c){if(!b)return;a.Widget.FireFormActivated(c)}N(a.Widget.FormDescription.ID,!1,k.NewFormState(),b)}function bN(a,b){I.AppendToBody(),I.Hide(),H=a;var c=a.GetRect();J=a.UIWindow.GetDomElement().clone(!1),$("body").append(J),J.find(".ui-icon").css("display","none"),J.css("position","absolute"),J.css("z-index","1000000"),J.offset({left:c.Left,top:c.Top}),J.width(c.GetWidth()),J.height(c.GetHeight()),H.ShowHideDragState(!0),K=i.NewPoint(b.pageX,b.pageY),$(document).bind("mousemove",bO),$(document).bind("mouseup",bP)}function bO(a){var b=i.NewPoint(a.pageX-K.X,a.pageY-K.Y);K.Move(b);var c=J.offset();J.offset({top:c.top+b.Y,left:c.left+b.X});var d=bp(i.NewPoint(a.pageX,a.pageY));!d.UIWidgetPanel||d.UIWidget==H?I.Hide():(I.Show(),I.Position(d))}function bP(a){I.RemoveFromBody(),J.remove(),$(document).unbind("mousemove",bO),$(document).unbind("mouseup",bP),H.ShowHideDragState(!1);var b=bp(i.NewPoint(a.pageX,a.pageY));if(!b.UIWidgetPanel)return;if(b.UIWidget==H||b.InsertBeforeUIWidget==H||b.PrevInsertBeforeUIWidget==H)return;H.Widget.FireUnload(),H.RemoveFromPanel(),b.UIWidgetPanel.InsertUIWidget(H,b.InsertBeforeUIWidget),H.SetStyleFloat(),H.Widget.FireLoad(G[H.Widget.ID]),H.ShowContents(),H.Widget.FireResize(),cx()}function bQ(){E.Resize(),D.Resize(),C.Resize(),cw(r)}function bR(a){if(!a)return;var b=a.GetBaseFormDescription(),c=a.GetCurrentForm();c&&(c.Hide(),Z(c.Description)),a.UIWindow.GetDomElement().hide(),a.UIWindow.CollaborationPopup.Hide()}function bS(){U(),t&&ct(),bV(),t=!0}function bT(a,b){bv(b)}function bU(){if(t)return;c.Users.BindChanged(cp),c.Accounts.BindChanged(co),c.Collaborators.BindChanged(cJ),c.Collaborators.Bind("CollaboratorLocationMapChanged",bB),d.LoadModels([c.Accounts,c.Users,c.Conversations,c.Collaborators],bS,bT)}function bV(){if(t)return;$("#login_container").hide(),$("#layout_outer").show(),I=M();var a=cd();bW(),ck(),bX(),cJ(),b_(a),ce(a),b$(a),cm(),cl(),ca(),cg(),cj(a),cf(a),bY(a),bZ(a),ch(),cb(a,function(){$("#loading_logo").hide(),p.resizeAll()})}function bW(){b.Plong=j.NewAudioStream("wav/plong")}function bX(){$(window).resize(bQ)}function bY(a){function c(){cx()}b.ChatManager=h.NewUIChatManager(c);if(a.conversationStates)for(var d=0;d<a.conversationStates.length;d++)b.ChatManager.AddChatBoxFromState(a.conversationStates[d])}function bZ(a){b.CollabManager=new h.UICollaboratorManager(function(){cx()}),b.CollabManager.SetExpanded(a.collaborationState)}function b$(a){z=a.eastPaneClosed,A=a.westPaneClosed,q=$("#layout_outer").layout({resizeWithWindow:!0,north__size:60,north__resizable:!1,north__slidable:!1,north__togglerLength_open:0,south__size:28,south__resizable:!1,south__slidable:!1,south__togglerLength_open:0,south__spacing_open:2}),p=$("#layout_inner").layout({resizeWithWindow:!0,south__size:180,east__size:260,east__minSize:260,west__size:260,west__minSize:260,east__initClosed:z,west__initClosed:A,west__onresize:bH,east__onresize:bE,center__onresize:bQ,west__onclose_end:bF,west__onopen_end:bG,east__onclose_end:bC,east__onopen_end:bD,triggerEventsOnLoad:!1,resizeWhileDragging:!0,triggerEventsWhileDragging:!1})}function b_(a){for(var b=0;b<a.favorites.length;b++){var c=bh(a.favorites[b].guid);if(!c)continue;u.push(k.NewFavorite(c.ID,c.Name))}cD()}function ca(){for(var a in v){if(!v.hasOwnProperty(a))continue;var b=v[a];if(!b.CanActivate)continue;S(b)}cE()}function cb(a,b){function e(){c++;if(c<=d){cc(a.openForms[c],e);return}var f=bi(a.activeFormID);f&&cG(f.UIForm),i.CallFunction(b)}var c,d;c=-1,d=a.openForms.length-1,e()}function cc(a,b){function e(){c++;if(c>d){i.CallFunction(b,[!0]);return}var f=a.FormCrumbs[c],g=bh(f.FormDescriptionID);O(g,f.State,e)}function f(f){if(!f){i.CallFunction(b,[!1]);return}c=0,d=a.FormCrumbs.length-1,e()}var c,d,g=a.FormCrumbs[0];N(g.FormDescriptionID,a.Maximized,g.State,f)}function cd(){var a=new k.PersistedDesktopLayout;return m.Desktops.length==0?(s="",a):(s=m.Desktops[0].UniqueID,$.extend(a,m.Desktops[0].Layout),a)}function ce(a){for(var b=0;b<a.recentItems.length;b++){var c=bh(a.recentItems[b].guid);if(!c)continue;y.push(k.NewRecentItem(c.ID,c.Name))}}function cf(a){$.each(a.west.widgets,function(a,b){$("#widget-selector").children().each(function(a,c){$(c).attr("name")==b.id&&($("#widgets-west").append(c),$.extend($(c).data("widget").settings,b.settings),$(c).find(".widget-content").css("display","block"),$(c).find(".widget-icon").css("display","none"),$(c).data("widget").start())})}),$.each(a.east.widgets,function(a,b){$("#widget-selector").children().each(function(a,c){$(c).attr("name")==b.id&&($("#widgets-east").append(c),$.extend($(c).data("widget").settings,b.settings),$(c).find(".widget-content").css("display","block"),$(c).find(".widget-icon").css("display","none"),$(c).data("widget").start())})})}function cg(){cy("collapsed");var a=!0,c=undefined;$("#nav-search").keyup(bl),$(window).keyup(function(a){a.altKey&&a.keyCode=="78"&&(cy("expanded"),$("#nav-search").focus())}),$("#navigation_panel").click(function(){a=!a,a?cy("collapsed"):cy("expanded")}).mouseleave(function(){a=!0,cy("collapsed"),window.clearInterval(c)}).mouseenter(function(){cy("hilite"),c=window.setTimeout(function(){a=!1,cy("expanded")},1100)}),$("#my_account").click(function(){N(b.FORM_MY_ACCOUNT,!1)}),$("#chk_remember").change(function(){i.LocalStorage.Set("email",this.checked?m.Email:"")}),$("#chk_remember").attr("checked",n?"checked":null),$("#chk_forceAjax").change(function(){b.ForceAjax=this.checked}),$("#chk_logWebsocket").change(function(){b.PosConnection.LogMessages=this.checked})}function ch(){for(var a=0;a<m.UnreadConversations.length;a++){var d=b.ChatManager.AddChatBox(m.UnreadConversations[a]);d.SetAlert(!0)}c.Conversations.BindChanged(cL),c.Conversations.Bind("NewMessageReceived",cK),c.Conversations.Bind("ParticipantsChanged",function(a){b.ChatManager.UpdateCaptions()})}function ci(a){var b=k.NewUIWidget(a),c=new k.UIWindowSettings;return c.CallbackData=b,c.Close=bL,a.FormDescription.CanActivate&&(c.Plus=bM),c.TitleBarMouseDown=bN,c.Title=a.Name,b.UIWindow=k.NewUIWindow(c),b}function cj(a){function c(){for(var a=b.length-1;a>=0;a--){var c=b[a];F.AddUIWidget(c),c.SetStyleFixed(),c.ShowIcon(),b.splice(a,1)}F.Sort()}function d(a,c){for(var d=0;d<a.length;d++){var e=bk(b,a[d].id);if(e<0)continue;var f=b[e];c.AddUIWidget(f),f.SetStyleFloat(),f.Widget.FireLoad(G[f.Widget.ID]),f.ShowContents(),f.Widget.FireResize(),b.splice(e,1)}}function e(){for(var c in v){if(!v.hasOwnProperty(c))continue;var d=v[c];for(var e=0;e<d.widgets.length;e++){var f=d.widgets[e];if(!f.ID)continue;var g=a.widgetStates[f.ID];G[f.ID]=g?g:{},b.push(ci(f))}}}var b=[];e(),d(a.eastWidgets,D),d(a.westWidgets,E),c()}function ck(){C=k.NewUITaskBar($("#taskbar"),bK,bJ)}function cl(){D=k.NewUIWidgetPanel($("#widgets-east")),E=k.NewUIWidgetPanel($("#widgets-west"))}function cm(){F=k.NewUIWidgetPanel($("#widget-selector")),l.UIWidgetPanelSelector=F}function cn(a){x=!0,z||a?p.close("east"):p.open("east"),A||a?p.close("west"):p.open("west"),x=!1}function co(){U(),b.ChatManager&&b.ChatManager.UpdateCaptions(),b.CollabManager&&b.CollabManager.UpdateAccountNames()}function cp(){}function cq(a){b.Authenticated=!0,l.ApiVersion=a.APIVersion,l.AddSubscription("SessionExpiredNotification",bu),bU()}function cr(a){var b=a;return b=b.replace(":-D",bn(3)),b=b.replace(":=D",bn(3)),b=b.replace(":-d",bn(3)),b=b.replace(":=d",bn(3)),b=b.replace(":)~",bn(4)),b=b.replace(":-P",bn(4)),b=b.replace(":=P",bn(4)),b=b.replace(":-p",bn(4)),b=b.replace(":=p",bn(4)),b=b.replace(":-)",bn(1)),b=b.replace(":=)",bn(1)),b=b.replace(";-)",bn(2)),b=b.replace(";=)",bn(2)),b=b.replace(":d",bn(3)),b=b.replace(":D",bn(3)),b=b.replace(":P",bn(4)),b=b.replace(":p",bn(4)),b=b.replace(":)",bn(1)),b=b.replace(";)",bn(2)),b=b.replace(":)",bn(1)),b}function cs(a){m=a.Account,b.CurrentAccountID=m.UniqueID,_()}function ct(){var a=[];for(var b in o){if(!o.hasOwnProperty(b))continue;if(o.length==0)continue;a.push(b)}cF(a)}function cu(a){var b=bg(a);if(b<0)return;u.splice(b,1),cz(a,!1),$(document).trigger("favoriteRemoved",a)}function cv(a){if(!a)return;C.RemoveButton(a.GetBaseFormDescription().ID),cA()}function cw(a){if(!a)return;var b=a.GetCurrentForm();b&&b.Resize()}function cx(){function a(){B=undefined;var a=bm();s?e.UpdateDesktops([s],{Layout:a},undefined,function(a,b){console.warn(i.FormatString("Error saving desktop. Code:{0}. Message:{1}",a,b))}):e.NewDesktop({Account_uid:m.UniqueID,Name:"Main Desktop",Layout:a},function(a){m.DefaultDesktop_uid=a.Desktop.UniqueID,m.CurrentDesktop_uid=a.Desktop.UniqueID,s=a.Desktop.UniqueID})}window.clearTimeout(B),B=window.setTimeout(a,1e3)}function cy(a,b){switch(a.toLowerCase()){case"hidden":$("#navigation_panel").stop().animate({top:-1.1*$("#navigation_panel").height()},350);break;case"collapsed":$("#navigation_panel").stop().animate({top:38+ -1*$("#navigation_panel").height()},350,b);break;case"expanded":$("#navigation_panel").stop().animate({top:0},350);break;case"hilite":$("#navigation_panel").stop().animate({top:38+ -1*$("#navigation_panel").height()},150)}}function cz(a,b){var c=bi(a);if(!c)return;c.UIForm.UIWindow.SetPinState(b)}function cA(){C.Buttons.length>=2?(C.Show(),$("#active-form").css("bottom","34px")):(C.Hide(),$("#active-form").css("bottom","4px"))}function cB(a){a.UIWindow.UIBreadBar.Crumbs.length==0?a.UIWindow.HideBreadBar():a.UIWindow.ShowBreadBar()}function cC(a){if(!a)return;a.UIWindow.GetDomElement().show();var b=a.GetBaseFormDescription(),c=bg(b.ID);cz(b.ID,c>=0),cw(a),cn(a.Maximized);var d=a.GetCurrentForm();d&&(Y(d.Description),d.Show(),d.Resize())}function cD(){u.sort(function(a,b){return i.CompareStringsForSort(a.title,b.title)})}function cE(){$("#navigation_menu").children().sortElements(function(a,b){var c=$(a).find("span:first").text(),d=$(b).find("span:first").text();return c>d?1:-1})}function cF(a){e.SubscribeToNotifications(a,undefined,function(b,c){console.warn(i.FormatString("Error subscribing to notifications [{0}]. Code: {1}. Message: {2}",a,b,c))})}function cG(a){if(a==r)return;bR(r),r=a,cC(a),C.SetActiveButton(a.GetBaseFormDescription().ID)}function cH(a,b){var c=this;if(o[a]==undefined||o[a].length==0)return;for(var d=0;d<o[a].length;d++)o[a][d](b)}function cI(){$("#lbl_username").html(m.Name),$("#txt_edit_name").val(m.Name),$("#lbl_email").html(m.Email),$("#txt_edit_email").val(m.Email),$("#img_avatar").attr("src",i.CreateGravatarMarkup(m,30)),$("#img_edit_avatar").attr("src",i.CreateGravatarMarkup(m,120))}function cJ(){b.CollabManager&&b.CollabManager.UpdateCollaborators()}function cK(a,c){if(c.Account_uid==b.CurrentAccountID)return;var d=b.ChatManager.findChatBox(a.UniqueID),e=undefined;d==-1?e=b.ChatManager.AddChatBox(a.UniqueID):e=b.ChatManager.Boxes[d],e.ShowingAlert||e.SetAlert(!0),e.Sort()}function cL(){for(var a=0;a<b.ChatManager.Boxes.length;a++){var c=b.ChatManager.Boxes[a];c.AddMessages()}}function cM(){$("#loading_logo").hide(),$("#login_container").show();var a=i.LocalStorage.Get("redirectReason");a&&(i.LocalStorage.Set("redirectReason",""),$("#expired_box").html(a).css("display","block"))}var b=a("coreglobals"),c=a("objects/schema/models"),d=a("objects/schema/model_utils"),e=a("master_api"),f=a("general_functions"),g=a("posConnection"),h=a("objects/schema/component_classes"),i=a("utilities"),j=a("objects/schema/audio"),k=a("formstuff"),l={},m=undefined,n,o={},p=undefined,q=undefined,r=undefined,s="",t=!1,u=[],v={},w=[],x=!1,y=[],z=!1,A=!1,B=undefined,C=undefined,D=undefined,E=undefined,F=undefined,G={},H=undefined,I=undefined,J=undefined,K={};l.ApiVersion="",l.WebsiteVersion="a107",l.UIWidgetPanelSelector=F,l.Favorites=u,l.FormDescriptions=v,l.RecentItems=y,L.prototype.AppendToBody=function(){$("body").append(this.$rightArrow),$("body").append(this.$leftArrow)},L.prototype.Hide=function(){this.$rightArrow.hide(),this.$leftArrow.hide()},L.prototype.Position=function(a){var b,c,d,e=a.UIWidgetPanel.GetRect();b=e.Left,c=e.Right;if(a.PrevInsertBeforeUIWidget)d=a.PrevInsertBeforeUIWidget.GetRect().Bottom;else if(a.UIWidget)d=e.Top;else if(a.UIWidgetPanel.UIWidgets.length==0)d=e.Top;else{var f=a.UIWidgetPanel.UIWidgets[a.UIWidgetPanel.UIWidgets.length-1];d=f.GetRect().Bottom}this.$rightArrow.offset({left:b-12,top:d-6}),this.$leftArrow.offset({left:c-24+12,top:d-6})},L.prototype.RemoveFromBody=function(){this.$rightArrow.remove(),this.$leftArrow.remove()},L.prototype.Show=function(){this.$rightArrow.show(),this.$leftArrow.show()},l.AddFormDescription=function(a){if(!a.InternalName)throw new Error("No InternalName on the "+a.Name+" form.");v[a.InternalName]=a},l.AddSubscription=function(a,c){var d=R(a,c);d&&b.Authenticated&&cF([a])},b.AddSubscription=l.AddSubscription,l.AddSubscriptions=function(a){var c=[];for(var d=0;d<a.length;d++){var e=a[d];R(e.NotificationName,e.Callback)&&c.push(e.NotificationName)}c.length>0&&b.Authenticated&&cF(c)},b.AddSubscriptions=l.AddSubscriptions,l.NetworkChangeNotification=function(a,b){if(!r||!r.GetCurrentForm())return;if(r.GetCurrentForm().Description.ID==a.ID){var d=c.Accounts.GetItems({EmailHash:b.remoteUser.EmailHash});if(!d||d.length==0)return;var e=d[0];e&&r.UIWindow.SetCollaborationState("hilite")}},l.RemoveFavorite=function(a){cu(a),cx()};var N=l.ShowForm=function(a,c,d,e){function m(a){clearTimeout(l),j.SetContents(a.GetContents()),h.Form=a,cC(g),i.CallFunction(e,[!0,a]),cx()}function n(){clearTimeout(l),j.SetContents(bo()),i.CallFunction(e,[!1]),cx()}function o(){j.SetContents(bq()),l=undefined}var f=undefined,g=undefined,h=undefined,j=undefined,l=undefined;if(!a){console.warn("showForm called with an empty id, fix this."),i.CallFunction(e,[!1]);return}var p=bi(a);if(p){cG(p.UIForm),i.CallFunction(e,[!0,p.UIForm.GetCurrentForm()]),cx();return}f=bh(a);if(!f){console.error("Error in showForm. Form '"+a+"' not not found"),i.CallFunction(e,[!1]);return}var q=new k.UIWindowSettings;q.Close=bx,q.Size=bz,q.Pin=bA,q.BreadBarOnClick=bw,q.Collaboration=by,q.Title=f.Name,j=k.NewUIWindow(q),g=k.NewUIForm(),g.BaseFormDescription=f,g.UIWindow=j,g.Maximized=c,h=k.NewUIFormCrumb(),h.FormDescription=f,h.State=d?d:k.NewFormState(),g.AddUIFormCrumb(h),w.push(g),bR(r),r=g,l=window.setTimeout(o,b.WAIT_SPINNER_TIMEOUT),T(g),C.SetActiveButton(g.GetBaseFormDescription().ID),$("#active-form").append(g.UIWindow.GetDomElement()),ba(f,h.State,m,n)},O=l.NavigateToForm=function(a,c,d){function m(a){clearTimeout(l),j&&j.remove(),g.AppendContents(a.GetContents()),h.Form=a,h.Form.Resize(),h.Form.Show(),Y(h.Form.Description),i.CallFunction(d,[!0]),cx()}function n(){clearTimeout(l),g.AppendContents(bo()),i.CallFunction(d,[!1]),cx()}function o(){j=bq(),g.AppendContents(j),l=undefined}var e=undefined,f=undefined,g=undefined,h=undefined,j=undefined,l=undefined;e=r.GetCurrentForm(),f=r.GetCurrentFormDescription(),g=r.UIWindow;var p=r.FormCrumbs.length-1;h=k.NewUIFormCrumb(),h.FormDescription=a,h.State=c?c:k.NewFormState(),r.AddUIFormCrumb(h),g.UIBreadBar.AddBreadCrumb(f.Name),g.UIBreadBar.SetCurrentName(a.Name),cB(r),e&&(r.UIWindow.CollaborationPopup.Hide(),Z(e.Description),e.Hide(),e.GetContents().hide()),l=window.setTimeout(o,b.WAIT_SPINNER_TIMEOUT),ba(a,h.State,m,n)};return l.Start=function(){b.PosConnection=new g.Connection,$("button,input:button").button(),$("select").selectmenu(),$("#txt_email,#txt_password").keydown(function(a){a.keyCode=="13"&&bc()}),$("#cmdLogin").click(bc),$("#logout").click(bd),$("#forgot_password").click(be),n=i.LocalStorage.Get("email");var a=i.LocalStorage.Get("sessionToken");a?bb(a):(cM(),n?($("#txt_email").val(n),$("#txt_password").focus()):$("txt_email").focus())},l.StateChanged=function(){cx()},l.WidgetContentsChanged=function(){D.ShowHideScrollers(),E.ShowHideScrollers()},l}),define("objects/forms/about",["require","core","objects/schema/form_classes","utilities"],function(a){function f(){}var b=a("core"),c=a("objects/schema/form_classes"),d=a("utilities"),e=new c.FormDescription;e.ID="f27577f2-1cf7-4591-8383-6b46e7af3f38",e.Name="About",e.InternalName="about",e.NameSpace="extended.Tools.About",e.Keywords="about,information,developer,pos,emagine,emagine pos",e.CanActivate=!0,e.UITemplate=undefined,e.InstanceClass=f,f.prototype.Load=function(a){this.$contents=$(d.FormatString('<div style="text-align: center;vertical-align: middle;font-size:12pt;font-weight:bold;">api version: {0}<br/>ui version: {1}</div>',b.ApiVersion,b.WebsiteVersion))};var g=new c.Widget;return g.ID=e.ID+".0",g.Icon="img/widgets/widget-about.png",g.Name="About",g.Load=function(a){this.$contents=$(d.FormatString('<div style="text-align: center;vertical-align: middle;font-size:12pt;font-weight:bold;">api version: {0}<br/>ui version: {1}</div>',b.ApiVersion,b.WebsiteVersion))},e.AddWidget(g),e}),define("objects/forms/docman",["require","core","objects/schema/models","objects/schema/form_classes","utilities"],function(a){function g(){}var b=a("core"),c=a("objects/schema/models"),d=a("objects/schema/form_classes"),e=a("utilities"),f=new d.FormDescription;f.ID="9e261c22-5a54-4fcc-a1c2-8c03f44966a9",f.Name="Document Manager",f.InternalName="docman",f.NameSpace="extended.Tools.Document Manager",f.Keywords="documents,manager",f.CanActivate=!0,f.UITemplate=undefined,f.InstanceClass=g,f.RequireModel(c.Accounts,function(){}),g.prototype.Show=function(){},g.prototype.Load=function(a){this.$contents=$("<div></div>");var b=this.$contents.append("<table style='cursor:pointer!important;font-size:10pt;width:100%;' cellpadding='4'></table>");b.append("<tr><td></td><td style='border-bottom:1px dotted #606060;font-size:12pt;padding:6px;'>Document</td><td style='border-bottom:1px dotted #606060;font-size:12pt;padding:6px;'>Last Updated</td><td style='border-bottom:1px dotted #606060;font-size:12pt;padding:6px;'>Owner</td></tr>");var d=b.append("<tr style='cursor: pointer;'></tr>");d.append("<td style='font-size:12pt;padding:6px;'><img src='docman/doc.png'/></td>"),d.append("<td style='font-size:12pt;padding:6px;'><a href='docman/policies.doc' >Policies & Procedures (Editable)</a></td>"),d.append("<td style='font-size:12pt;padding:6px;'>December 18, 2011</td>");var f=c.Accounts.GetItems()[0];d.append("<td style='font-size:12pt;padding:6px;'><img src='"+e.CreateGravatarMarkup(f,20)+"' style='margin-right:12px;'/>"+f.Name+"</td>");var g=b.append("<tr style='cursor: pointer;'></tr>");g.append("<td style='font-size:12pt;padding:6px;'><img src='docman/pdf.png'/></td>"),g.append("<td style='font-size:12pt;padding:6px;'><a target='_blank'  href='docman/policies.pdf' >Policies & Procedures</a></td>"),g.append("<td style='font-size:12pt;padding:6px;'>December 20, 2011</td>"),f=c.Accounts.GetItems()[2],g.append("<td style='font-size:12pt;padding:6px;'><img src='"+e.CreateGravatarMarkup(f,20)+"' style='margin-right:12px;'/>"+f.Name+"</td>")};var h=new d.Widget;return h.ID=f.ID+".0",h.Icon="img/widgets/widget-about.png",h.Name="Document Manager",h.Load=function(a){this.$contents=$("<div></div>");var b=this.$contents.append("<table style='cursor:pointer!important;font-size:10pt;width:100%;' cellpadding='4'></table>"),c=b.append("<tr style='cursor: pointer;'></tr>");c.append("<td style='font-size:10pt;padding:2px;'><img src='./docman/doc.png'/></td>"),c.append("<td style='font-size:10pt;padding:2px;'><a href='./docman/policies.doc' >Policies & Procedures (Editable)</a></td>");var d=b.append("<tr style='cursor: pointer;'></tr>");d.append("<td style='font-size:10pt;padding:2px;'><img src='./docman/pdf.png'/></td>"),d.append("<td style='font-size:10pt;padding:2px;'><a target='_blank'  href='./docman/policies.pdf' >Policies & Procedures</a></td>")},f.AddWidget(h),f}),define("objects/forms/managerslog",["require","core","objects/schema/models","objects/schema/form_classes","utilities"],function(a){function h(){}var b=a("core"),c=a("objects/schema/models"),d=a("objects/schema/form_classes"),e=a("utilities"),f=[];f.push({datetime:new Date,user:"c70ead82-c393-447a-a367-8f5ce950c890",notes:[{category:"Customer Issues",note:"Some lady was screaming that there was a hair in her soup"},{category:"Staff Issues",note:"larry got mad at a customer"},{category:"Inventory Issues",note:"we ran out of chicken"},{category:"POS Issues",note:"our new system is awesome"}]});var g=new d.FormDescription;g.ID="ef91d817-998c-4f12-85eb-65d42476800a",g.Name="Managers Log",g.InternalName="managerslog",g.NameSpace="extended.Tools.Managers Log",g.Keywords="log,manager",g.CanActivate=!0,g.UITemplate=undefined,g.InstanceClass=h,g.RequireModel(c.Accounts,function(){}),h.prototype.Show=function(){},h.prototype.Load=function(a){f[0].user=c.Accounts.GetItems()[0].UniqueID,this.$contents=$("<div></div>");if(a.item!=undefined){var b=f[a.item];this.$contents.append("<h3>Daily Manager Log Entry</h3>"),this.$contents.append("<h4><img src='"+e.CreateGravatarMarkup(c.Accounts.GetItemByKey(b.user),20)+"' style='margin-right:12px;'/>"+c.Accounts.GetItemByKey(b.user).Name+" - "+e.FormatDateTime(new Date(b.datetime),"dddd, mmmm d, yyyy")+"</h4>");var d=$("<table style='width;100%;'></table>").appendTo(this.$contents);for(var g=0;g<b.notes.length;g++){var h=$("<tr></tr>").appendTo(d);h.append("<td style='font-weight: bold;padding:4px;'>"+b.notes[g].category+"</td>"),h.append("<td style='font-weight: normal;padding:4px;'>"+b.notes[g].note+"</td>")}}};var i=new d.Widget;return i.ID=g.ID+".0",i.Icon="img/widgets/widget-about.png",i.Name="Daily Manager Log",i.Load=function(a){f[0].user=c.Accounts.GetItems()[0].UniqueID,this.$contents=$("<div></div>");var d=this.$contents.append("<table style='font-size:10pt;width:100%;' cellpadding='4'></table>");for(var g=0;g<f.length;g++){var h=d.append("<tr style='cursor: pointer;'></tr>");h.append("<td style='font-size:10pt;padding:2px;'>"+e.FormatDateTime(f[g].datetime,"m/d/yyyy")+"</td>"),h.append("<td style='font-size:10pt;padding:2px;'>"+c.Accounts.GetItemByKey(f[g].user).Name+"</td>"),h.data("itemIndex",g),h.mouseover(function(){$(this).css("font-weight","bold"),$(this).css("cursor","pointer")}),h.mouseout(function(){$(this).css("font-weight","normal")}),h.click(function(){var a=$(this).data("itemIndex");b.ShowForm(b.FormDescriptions.managerslog.ID,!1,{item:a})})}},g.AddWidget(i),g}),define("objects/forms/widgetselector",["require","core","coreglobals","objects/schema/form_classes"],function(a){function g(){}var b=a("core"),c=a("coreglobals"),d=a("objects/schema/form_classes"),e=new d.FormDescription,f=undefined;return e.ID=c.FORM_WIDGET_SELECTOR,e.InternalName="widgetselector",e.Name="Widget Selector",e.NameSpace="core.Tools.Widget Selector",e.Keywords="widget",e.CanActivate=!0,e.InstanceClass=g,g.prototype.Load=function(){f||(f=$("#widget-selector-body")),this.$contents=f},g.prototype.Resize=function(){b.UIWidgetPanelSelector.Resize()},g.prototype.Unload=function(){this.$contents=$("<div></div>"),f.appendTo("#hidden-stuff")},e}),define("objects/forms/test_dtm",["require","core","objects/schema/form_classes","objects/schema/models","utilities"],function(a){function g(a,b){console.log("form_test_dtm organizationsChanged")}function h(){}var b=a("core"),c=a("objects/schema/form_classes"),d=a("objects/schema/models"),e=a("utilities"),f=new c.FormDescription;f.ID="5ba5410d-176c-494e-9012-d1f54e5d6258",f.InternalName="test_dtm",f.Name="DTM Test Form",f.NameSpace="extended.Testing.DTM",f.Keywords="test,dtm,dan",f.CanActivate=!0,f.UITemplate="",f.InstanceClass=h,f.RequireModel(d.Organizations,g),h.prototype.Hide=function(){},h.prototype.Load=function(a){var c=$("<div><a>Click to navigate to Organizations.</a></div>");this.$contents=$('<div style="text-align: center;vertical-align: middle;font-size:12pt;font-weight:bold;">Dan\'s Test Form</div>'),this.$contents.append("<br/><br/>"),this.$contents.append(c),c.click(function(){b.NavigateToForm(b.FormDescriptions.organizations,undefined)})},h.prototype.Resize=function(){console.log("test_dtm resize")},h.prototype.Show=function(){},h.prototype.Unload=function(){};var i=new c.Widget;return i.ID=f.ID+".0",i.Name="Dan's Widget",i.Load=function(a){console.log("test_dtm.0 load"),this.state=a,a.DTMValue||(a.DTMValue=(new Date).toString()),this.$contents=$(e.FormatString("<div>This is Dan's Widget.<br/>{0}</div>",a.DTMValue)),b.StateChanged()},i.Unload=function(a){console.log("test_dtm.0 unload")},f.AddWidget(i),f}),define("objects/forms/test_dtm2",["require","core","objects/schema/form_classes","objects/schema/models"],function(a){function f(a,b){console.log("form_test_dtm organizationsChanged")}function g(){}var b=a("core"),c=a("objects/schema/form_classes"),d=a("objects/schema/models"),e=new c.FormDescription;e.ID="0f2955e8-f2c6-4336-944f-02c9476e39e7",e.InternalName="test_dtm2",e.Name="DTM Test Form 2",e.NameSpace="extended.Testing.DTM",e.Keywords="test,dtm,dan",e.CanActivate=!0,e.UITemplate="",e.InstanceClass=g,e.RequireModel(d.Organizations,f),g.prototype.Hide=function(){},g.prototype.Load=function(a){var c=$("<div><a>Click to navigate to Organizations.</a></div>");this.$contents=$('<div style="text-align: center;vertical-align: middle;font-size:12pt;font-weight:bold;">Dan\'s Test Form</div>'),this.$contents.append("<br/><br/>"),this.$contents.append(c),c.click(function(){b.NavigateToForm(b.FormDescriptions.organizations,undefined)})},g.prototype.Resize=function(){console.log("test_dtm resize")},g.prototype.Show=function(){},g.prototype.Unload=function(){};var h=new c.Widget;return h.ID=e.ID+".0",h.Name="Dan's Widget 2",h.Load=function(){},e.AddWidget(h),e}),define("objects/forms/test_tyler",["require","core","objects/schema/component_classes","objects/schema/form_classes","objects/schema/models","utilities"],function(a){function h(){}var b=a("core"),c=a("objects/schema/component_classes"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("utilities"),g=new d.FormDescription;return g.ID="052c78b3-81d2-4de0-b24b-4c3777f0c99b",g.InternalName="test_tyler",g.Name="Tyler Test Form",g.NameSpace="extended.Testing.Tyler",g.Keywords="test,tyler",g.CanActivate=!0,g.UITemplate="",g.InstanceClass=h,g.RequireModel(e.Accounts,undefined),g.RequireModel(e.Conversations,undefined),h.prototype.Load=function(){this.$contents=$('<div style="text-align: center;vertical-align: middle;font-size:12pt;font-weight:bold;">Tyler\'s Test Form</div>');var a=$("<div style='width:120px;'></div>").appendTo(this.$contents),b=new c.FilterBox(a);b.Load()},g}),define("text!objects/../../tmpl/forms/accounts.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel">\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/accounts.html",[],function(){return'<div class="multi_edit">\r\n\tThere are multiple Accounts selected. Any changes that you make will be applied to all selected Accounts.\r\n</div>\r\n<div class="ui-widget-header ui-widget-content ui-corner-top" style="padding:7px 10px;">General Information</div>\r\n<div class="ui-widget ui-widget-content ui-corner-bottom" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr class="single-edit-only">\r\n\t\t\t<td style="width:90px;"><span class="ui-dialog-title">Email</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Email" value="${Email}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr class="single-edit-only">\r\n\t\t\t<td><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr class="single-edit-only">\r\n\t\t\t<td><span class="ui-dialog-title">Type</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<select id="cboType" name="Type" value="${Type}">\r\n\t\t\t\t\t<option value="Admin">Admin</option>\r\n\t\t\t\t\t<option value="Reseller">Reseller</option>\r\n\t\t\t\t\t<option value="Standard">Standard</option>\r\n\t\t\t\t</select>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td></td>\r\n\t\t\t<td>\r\n\t\t\t\t<button id="reset_password">Reset Password</button>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>'}),define("text!objects/../../tmpl/listview/templateListAccount.html",[],function(){return'<div class="vp_widget" id="${UniqueID}">\r\n    <table  style="width:100%;padding:0;">\r\n        <tr>\r\n            <td style="width:48px;background-image:url(\'http://www.gravatar.com/avatar/${EmailHash}?d=mm&s=48&r=g\');background-repeat: no-repeat;background-position: top center;">\r\n            </td>\r\n            <td style="text-align: left;vertical-align: text-top;padding:3px;">\r\n                <span style="font-weight:bold;font-size:12pt;">${Email}</span><br/>\r\n                <span>${Name}</span><br/>\r\n                <span>${Type}</span>\r\n            </td>\r\n            <td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n            </td>\r\n\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/accounts",["require","general_functions","objects/schema/form_classes","objects/schema/models","utilities","core","objects/schema/component_classes","text!../../../tmpl/forms/accounts.html","text!../../../tmpl/editpanels/accounts.html","text!../../../tmpl/listview/templateListAccount.html","text!../../../tmpl/listview/templateListAccount.html"],function(a){function i(a,b){console.log("formDesc_accounts accounts changed"),a.listview.bindItems(),b.IsNetworkUpdate()&&a.saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&f.NetworkChangeNotification(h,b.NetworkChangeObject)}function j(){this.listview=undefined,this.saygpanel=undefined,this.$editpanel=undefined,this.$mainLayout=undefined,this.selected=undefined}var b=a("general_functions"),c=a("objects/schema/form_classes"),d=a("objects/schema/models"),e=a("utilities"),f=a("core"),g=a("objects/schema/component_classes"),h=new c.FormDescription;return h.ID="ad732348-3133-428f-9e07-3cf4ff029ecb",h.InternalName="accounts",h.Name="Accounts",h.NameSpace="base.Administrative.Accounts",h.Keywords="accounts,admin,account",h.CanActivate=!0,h.UITemplate=a("text!../../../tmpl/forms/accounts.html"),h.viewmodel=d.Accounts,h.InstanceClass=j,h.RequireModel(d.Accounts,i),j.prototype.Load=function(c){this.state=c;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.saygpanel=new g.SaveAsYouGoPanel(this.$editpanel,a("text!../../../tmpl/editpanels/accounts.html")),this.saygpanel.FieldChangedFunction=function(a,c,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,c,function(){d(g.SaveAsYouGoStatus.Success)},function(a,c){d(g.SaveAsYouGoStatus.Failure),b.DialogError(c)})},this.listview=new g.ListView(this.$contents.find("#list_view"),d.Accounts,a("text!../../../tmpl/listview/templateListAccount.html")),this.listview.SetState(this.state.ListViewState),this.listview.sortIndex=0,this.listview.sortAscending=!0,this.listview.fields=["Email","Name","Type"],this.listview.fieldCaptions=["Email","Name","Type"],this.listview.itemTemplate=a("text!../../../tmpl/listview/templateListAccount.html"),this.listview.itemTemplateFormatter={},this.listview.multiSelect=!0,this.listview.AddNew=function(a,b){h.viewmodel.AddNew({},a,b)},this.listview.Delete=function(a,c,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> accounts";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> account"),b.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,c,d)},d)},this.listview.SelectionChanged=function(a){i.selected=i.saygpanel.SetSelectedItems(a),i.$editpanel.find("button").button();if(e.IsEmptyObject(i.selected))return;b.SetDropDownList(i.$contents.find("#cboType"),{GetItems:function(){return[{UniqueID:"Admin",Name:"Admin"},{UniqueID:"Reseller",Name:"Reseller"},{UniqueID:"Standard",Name:"Standard"}]}},i.selected.Type),i.$contents.find("#reset_password").click(function(){$.each(i.listview.SelectedItems,function(a,b){h.viewmodel.ResetPassword(b)}),i.listview.SelectedItems.length>1?b.DialogAlert("The passwords for these "+i.listview.SelectedItems.length+" accounts have been reset, and notification emails have been sent to the account holders.","Reset Password"):b.DialogAlert("The password for <b>"+i.listview.SelectedItems[0].Email+"</b> has been reset, and a notification email has been sent to the account holder.","Reset Password")}),i.saygpanel.Resize()},this.listview.StateChanged=function(a){i.state.ListViewState=a,f.StateChanged(i)},this.listview.Load()},j.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize()},h}),define("text!objects/../../tmpl/forms/bogroups.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div style="overflow:auto;">\r\n\t\t\t<div id="edit_panel">\r\n\t\t\t</div>\r\n\t\t\t<div id="edit_panel_details" style="display:none;">\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t</div>\r\n\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/bogroups.html",[],function(){return'<div class="multi_edit">\r\n\tThere are multiple Groups selected. Any changes that you make will be applied to all selected Groups.\r\n</div>\r\n<div class="ui-widget-header ui-widget-content single-edit-only" style="padding:7px 10px;">General Information</div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Advanced</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Organization<img id=\'jump_orgs\' class=\'jump-button\' title=\'Jump to Organizations\' alt=\'Edit Organizations\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<span id="Organization_uid" style=\'font-weight: bold;\'>${$item.GetOrganizationName($item.data.Organization_uid)}</span>\r\n\t\t\t\t<!--<select id="cboOrg" name="Organization_uid"></select>-->\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td>Color</td>\r\n\t\t\t<td>\r\n\t\t\t\t<div name="Color2" style="border-radius:2px;width:48px;height:48px;color:#${Color};background-color:#${Color}"></div>\r\n\t\t\t\t<input readonly="true" name="Color" maxlength="6" style=\'visibility:hidden;height:0px;cursor:  pointer;user-select:none;-moz-user-select:none;-webkit-user-select:none;width:0px;color:#${Color};background-color:#${Color};text-align: center;\' type="text" value="${Color}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Permissions</div>\r\n<div id=\'permission_table\' class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<div style=\'margin:12px;\' class=\'no-sayg\'>\r\n\t\t<input type=\'text\' id=\'perm_filter\' style=\'margin-left:-3px;margin-bottom:12px;width:240px;\' placeholder=\'type here to filter permissions ...\'/>\r\n\t</div>\r\n</div>\r\n\r\n'}),define("text!objects/../../tmpl/listview/templateListBOGroup.html",[],function(){return'<div class="vp_widget" id="${UniqueID}" >\r\n    <table style="width:100%;padding:0;">\r\n        <tr>\r\n\t\t\t<td style=\'width:8px;background-color:#${Color};\'>\r\n\r\n        </td>\r\n            <td style="vertical-align: text-top;padding:3px;">\r\n                <div style="font-weight:bold;font-size:12pt;">\r\n                    ${Name}\r\n                </div>\r\n                <div>${$item.GetOrganizationName($item.data.Organization_uid)}</div>\r\n            </td>\r\n            <td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/bogroups",["require","master_api","general_functions","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/bogroups.html","text!../../../tmpl/editpanels/bogroups.html","text!../../../tmpl/listview/templateListBOGroup.html"],function(a){function i(){this.selected=undefined,this.elem=undefined,this.listview=undefined,this.$editpanel=undefined,this.saygpanel=undefined,this.selectedColor="#ff0000",this.lastfilter="",this.$mainLayout=undefined,this.$cp=undefined,this.colorPicker=new f.ColorPicker}function j(a,b){console.log("form_bogroups bogroups changed"),a.listview.bindItems(),b.IsNetworkUpdate()&&saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&g.NetworkChangeNotification(h,b.NetworkChangeObject),a.updateSaygLabels()}function k(a,b){a.listview.bindItems(),a.updateSaygLabels()}function l(a,b){}var b=a("master_api"),c=a("general_functions"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("objects/schema/component_classes"),g=a("core"),h=new d.FormDescription;return i.prototype.refreshSwatch=function(){var a=this.$cp.find("#red").slider("value"),b=this.$cp.find("#green").slider("value"),c=this.$cp.find("#blue").slider("value"),d=this.colorPicker.hexFromRGB(a,b,c);this.selectedColor=d,this.$cp.find("#swatch").css("background-color","#"+d)},i.prototype.updateSaygLabels=function(){if(!this.saygpanel||!this.$editpanel||!this.selected)return;this.selected.Organization_uid!="xxx_variable_xxx"&&this.$editpanel.find("#Organization_uid").text(e.GetTemplatedOrganizationName(this.selected.Organization_uid))},h.ID="2a9fe252-c5cb-44df-bd34-9e5aebe30994",h.UITemplate=a("text!../../../tmpl/forms/bogroups.html"),h.Name="Backoffice Permissions",h.InternalName="bogroups",h.NameSpace="base.Backoffice.Backoffice Permissions",h.Keywords="security,permissions,users,groups,pos",h.CanActivate=!0,h.InstanceClass=i,h.viewmodel=e.BOGroups,h.RequireModel(e.BOGroups,j),h.RequireModel(e.Organizations,k),h.RequireModel(e.BOPermissions,l),i.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize()},i.prototype.Load=function(d){this.state=d;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.$cp=this.$contents.find("#color_picker"),i.saygpanel=new f.SaveAsYouGoPanel(i.$editpanel,a("text!../../../tmpl/editpanels/bogroups.html")),i.saygpanel.FieldChangedFunction=function(a,b,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,b,function(){d(f.SaveAsYouGoStatus.Success)},function(a,b){d(f.SaveAsYouGoStatus.Failure),c.DialogError(b)})},i.saygpanel.editPanelTemplateFormatter={GetOrganizationName:e.GetTemplatedOrganizationName},i.listview=new f.ListView(i.$contents.find("#list_view"),e.BOGroups,a("text!../../../tmpl/listview/templateListBOGroup.html")),i.listview.SetState(i.state.ListViewState),i.listview.sortIndex=0,i.listview.sortAscending=!0,i.listview.fields=["Name","OrganizationName"],i.listview.fieldCaptions=["Name","Organization"],i.listview.loadingDetailsOverlayContainer=i.$contents.find(".ui-layout-center").first(),i.listview.itemTemplateFormatter={FullAddress:function(a){return c.FormatAddress(a)},GetOrganizationName:e.GetTemplatedOrganizationName},i.listview.multiSelect=!0,i.listview.FilterFunction=function(a,b){switch(b.toLowerCase()){case"organizationname":return e.GetTemplatedOrganizationName(a.Organization_uid);default:return c.GetNotatedValue(a,b)}},this.listview.SortFunction=function(a,b,d,f){var g=c.ToString(c.GetNotatedValue(a,d)).toString().toLowerCase(),h=c.ToString(c.GetNotatedValue(b,d)).toString().toLowerCase();switch(d.toLowerCase()){case"organizationname":g=e.GetTemplatedOrganizationName(a.Organization_uid),h=e.GetTemplatedOrganizationName(b.Organization_uid)}return f?g>h?1:-1:g<h?1:-1},i.listview.AddNew=function(a,b){var d={};c.AddNewWithOrganization(e,h.viewmodel,"New Permission Group","Which Organization would you like to create a new Permission Group for?",d,a,b)},i.listview.Delete=function(a,b,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> permission groups";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> permission groups"),c.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,b,d)},d)},i.listview.SelectionChanged=function(a){function d(){var b=$("<table style='border-radius:2px;width:48px;height:48px;' cellspacing='0' cellpadding='0'></table>"),c=$("<tr></tr>");$.each(a,function(a,b){c.append("<td style='background-color:#"+b.Color+";'>&nbsp;</td>")}),b.append(c),i.$editpanel.find("[name=Color2]").html("").append(b)}i.selected=i.saygpanel.SetSelectedItems(a),i.$editpanel.find("button").button(),i.$editpanel.find("#perm_filter").keyup(function(){var a=$(this).val().toLowerCase().trim();i.$editpanel.find(".perm-item").each(function(b,c){a==""||$(c).text().toLowerCase().indexOf(a)!=-1?$(c).closest("tr").show():$(c).closest("tr").hide()}),i.$editpanel.find(".perm_group").each(function(a,b){var c=$(b).find("table:first"),d=!1;c.find("tr").each(function(a,b){$(b).css("display")!="none"&&(d=!0)}),d?$(b).show():$(b).hide()}),i.lastfilter=a}).val(i.lastfilter).trigger("keyup"),d(),i.$editpanel.find("[name=Color]").change(function(){$(this).css("background-color","#"+$(this).val()),$(this).css("color",i.colorPicker.getForegroundColor($(this).val())),i.$editpanel.find("[name=Color2]").html("").css("background-color","#"+$(this).val()),i.$editpanel.find("[name=Color2]").html("").css("color",i.colorPicker.getForegroundColor($(this).val())),d()}),i.$editpanel.find("[name=Color2]").click(function(){i.colorPicker.ShowDialog(i.selected.Color,function(b){$.each(a,function(a,c){c.Color=b}),i.$editpanel.find("[name=Color]").val(b).css("background-color","#"+b).trigger("change").css("color","#"+b),d()})}),$.each(e.BOPermissions.GetItems(),function(a,b){var c=i.$editpanel.find(".category_"+b.Header.replace(" ",""));if(c.length==0){var d=$("<div class='perm_group' style='padding:7px 10px;'><div style='font-weight:bold;border-bottom:1px dotted #808080;'>"+b.Header+"</div></div>");i.$editpanel.find("#permission_table").append(d),c=$("<div class='category_"+b.Header.replace(" ","")+" no-sayg' style='margin-bottom: 2px;'><table style='width:98%;margin:4px;font-size:11pt;'></table></div>").appendTo(d)}var e=$("<tr></tr>").appendTo(c.find("table"));e.append("<td style='width:90px;'><span class='ui-dialog-title perm-item' style='min-width:170px;white-space: nowrap;'>"+b.Name+"</span></td>");var f=undefined;switch(b.Kind.toLowerCase()){case"bool":f=$("<span id='"+a+"'></span>");break;default:}var g=$("<td></td>").appendTo(e);g.append(f)}),i.$editpanel.find(".perm_group").sortElements(function(a,b){var c=$(a).first("div").text(),d=$(b).first("div").text();return c>d?1:-1}),i.$editpanel.find(".perm_group").each(function(a,b){$(b).find("table>tbody>tr").sortElements(function(a,b){var c=$(a).first("td").first("span").text(),d=$(b).first("td").first("span").text();return c>d?1:-1})}),$(h.viewmodel).unbind("permissionChanged").bind("permissionChanged",function(b,c){var d=!1;$.each(a,function(a,b){b.UniqueID==c.id&&(d=!0)});if(d){var e=i.$editpanel,f=$(e).closest(".formDesc-object").data(c.remote);f||(f=$("<img title='Change made remotely by "+c.remote+"' style='display:none;margin-left:5px;vertical-align: top;border-radius:2px;' src='"+c.image.replace("s=24","s=18")+"'/>"),$(e).closest(".formDesc-object").data(c.remote,f),$(e).closest(".formDesc-object").find(".formDesc-collab-status").append(f).show(),$(f).stop().css("opacity",1).fadeIn(750).delay(8e3).fadeOut(750,function(){$(e).closest(".formDesc-object").data(c.remote,!1),$(f).remove(),$(e).closest(".formDesc-object").find(".formDesc-collab-status").children().length==0&&$(e).closest(".formDesc-object").find(".formDesc-collab-status").hide()})),i.listview.TriggerSelectionChanged()}}),$.each(e.BOPermissions.GetItems(),function(d,e){var f=e.UniqueID,g="";switch(e.Kind.toLowerCase()){case"bool":g="BoolValue";break;default:}var h=undefined;$.each(a,function(a,b){var c=b.Detail.Permissions[f];c==undefined&&(c=e.Default);if(c[g]!=h)if(h==undefined)h=c[g];else return h=null,!1});var j=i.$editpanel.find("#"+d);switch(e.Kind.toLowerCase()){case"bool":h==null&&(h="mixed");var k=new SteelUnderpants.TriStateCheckbox({enabled:!0,checked:h,tabIndex:1});$(k).bind("checked",function(){var d={Kind:"Bool",BoolValue:k.checked()},e=new Array;$.each(a,function(a,b){e.push(b.UniqueID)});if(!$(j).data("working")){var g=$("<img style='margin-left:5px;vertical-align: middle;' src='./img/ajax-loader-small.gif'/>");$(j).data("working",g),$(j).after(g)}b.SetBOGroupsPermission(e,f,d,function(b){$.each(a,function(a,b){b.Detail.Permissions[f]=d}),$(j).data("working")!=undefined&&$(j).data("working").remove(),$(j).data("success")!=undefined&&$(j).data("success").remove();var c=$("<img style='margin-left:5px;vertical-align: middle;' src='./img/icons/icon-accept.png'/>");$(j).data("success",c),$(j).is("select")?$(j).next().after(c):$(j).after(c),$(c).fadeIn(750,function(){$(c).delay(1e3).fadeOut()})},c.DialogError)}),j.append(k);break;default:}}),i.$editpanel.find(".permissions").change(function(){var d=e.BOPermissions.GetItemByKey($(this).attr("id")),f={};switch(d.Kind.toLowerCase()){case"bool":f.Kind="Bool",f.BoolValue=!1,$(this).attr("checked")=="checked"&&(f.BoolValue=!0);break;default:}var g=$(this).attr("id"),h=new Array;$.each(a,function(a,b){h.push(b.UniqueID)}),b.SetBOGroupsPermission(h,g,f,function(b){$.each(a,function(a,b){b.Detail.Permissions[g]=f})},c.DialogError)}),i.$editpanel.find("#jump_orgs").click(function(){var a=c.CreateSubFormLinkState(i.selected.Organization_uid);g.NavigateToForm(g.FormDescriptions.organizations,a)}),i.saygpanel.Resize()},i.listview.StateChanged=function(a){i.state.ListViewState=a,g.StateChanged(i)},i.listview.Load()},h}),define("text!objects/../../tmpl/forms/conversations.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel">\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/listview/templateListConversation.html",[],function(){return"<div class=\"vp_widget\" id=\"${UniqueID}\">\r\n    <table  style=\"width:100%;padding:0;\">\r\n        <tr>\r\n            <td style=\"display:none;width:48px;background-image:url('http://www.gravatar.com/avatar/${EmailHash}?d=mm&s=48&r=g');background-repeat: no-repeat;background-position: top center;\">\r\n            </td>\r\n            <td style=\"text-align: left;vertical-align: text-top;padding:3px;\">\r\n\t\t\t\t<div style='font-weight:bold;max-height:32px;text-overflow: ellipsis;overflow:hidden; margin-bottom:3px;'>${$item.LastMessage($item.data)}</div>\r\n                <div style='font-size:8pt;color:#808080;'>${Caption}</div>\r\n\t\t\t\t<div style='font-size:8pt;color:#808080;font-style:italic;font-weight:bold;'>${$item.Collaborators($item.data)}</div>\r\n\t\t\t\t<div style='font-size:8pt;color:#808080;font-style:italic;'>${$item.LastUpdatedString($item.data)}</div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>"}),define("objects/forms/conversations",["require","utilities","objects/schema/form_classes","objects/schema/models","core","coreglobals","objects/schema/component_classes","text!../../../tmpl/forms/conversations.html","text!../../../tmpl/listview/templateListConversation.html"],function(a){function i(a,b){a.listview.TriggerSelectionChanged()}function j(a,b){console.log("form_conversations conversations changed"),a.listview.TriggerSelectionChanged()}function k(){this.listview=undefined,this.saygpanel=undefined,this.$editpanel=undefined,this.$mainLayout=undefined,this.selected=undefined}function l(a){var b="",c=a.Accounts.length>2;for(var e=0;e<a.Accounts.length;e++){var g=a.Accounts[e];if(g.UniqueID==f.CurrentAccountID)continue;var h=d.Accounts.GetItemByKey(g.UniqueID);if(!h)continue;c?b+=h.Name.split(" ")[0]+", ":b+=h.Name+", "}return b!=""&&(b=b.substring(0,b.length-2)),b=b.replace(/,\s([^,]+)$/," and $1"),b}var b=a("utilities"),c=a("objects/schema/form_classes"),d=a("objects/schema/models"),e=a("core"),f=a("coreglobals"),g=a("objects/schema/component_classes"),h=new c.FormDescription;return h.ID="d63c163a-2ed6-4015-abc3-4fbd894f023d",h.Name="Conversations",h.InternalName="conversations",h.NameSpace="extended.Tools.Conversations",h.Keywords="conversations,discussions,chats,messages,text",h.CanActivate=!0,h.UITemplate=a("text!../../../tmpl/forms/conversations.html"),h.InstanceClass=k,h.viewmodel=d.Conversations,h.RequireModel(d.Conversations,j),h.RequireModel(d.Accounts,i),k.prototype.Load=function(c){this.state=c;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize()}}),i.listview=new g.ListView(i.$contents.find("#list_view"),d.Conversations,a("text!../../../tmpl/listview/templateListConversation.html")),i.listview.SetState(this.state.ListViewState),i.listview.sortIndex=0,i.listview.sortAscending=!1,i.listview.fields=["LastUpdated","Caption"],i.listview.fieldCaptions=["Last Updated","Collaborator(s)"],i.listview.loadingDetailsOverlayContainer=i.$contents.find(".ui-layout-center").first(),i.listview.itemTemplateFormatter={LastUpdatedString:function(a){var c=1;for(var d=0;d<a.Messages.length;d++)a.Messages[d].DateTimeMilliseconds>c&&(c=a.Messages[d].DateTimeMilliseconds);return b.FormatDateTime(new Date(c),"mmmm d, yyyy h:MM:ss TT")},LastMessage:function(a){var b="";return a.Messages&&a.Messages.length>0&&(b=a.Messages[a.Messages.length-1].Value),b},Collaborators:function(a){return l(a)}},i.listview.multiSelect=!1,i.listview.SelectionChanged=function(a){if(b.IsEmptyArray(a)){i.$editpanel.hide();return}i.$editpanel.html("");var c=$("<button>Open Chat Session</button>");c.click(function(){var b=f.ChatManager.AddChatBox(a[0].UniqueID);f.ChatManager.SetActiveBox(b.ID)}),i.$editpanel.append(c),c.button();for(var e=a[0].Messages.length-1;e>=0;e--){var g=d.Accounts.GetItemByKey(a[0].Messages[e].Account_uid);if(g!=undefined){var h=$("<div style='padding:4px;border-bottom:1px dotted #c0c0c0;'></div>");h.append("<table cellspacing='0' cellpadding='4'></table>"),h.find("table").append("<tr></tr>"),h.find("tr").append("<td style='width:36px;height:36px;'><img src='"+b.CreateGravatarMarkup(g,36)+"'/></td>"),h.find("tr").append("<td><span style='font-weight: bold;'>"+a[0].Messages[e].Value+"</span><br/><span style='font-size:8pt;font-style:italic;color:#808080;'>"+g.Name+" at "+b.FormatDateTime(new Date(a[0].Messages[e].DateTimeMilliseconds),"mmmm d, yyyy h:MM:ss TT")+"</span></td>"),i.$editpanel.append(h)}}i.$editpanel.show()},i.listview.StateChanged=function(a){i.state.ListViewState=a,e.StateChanged(i)},i.listview.Load()},k.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize()},h}),define("text!objects/../../tmpl/forms/favorites.html",[],function(){return""}),define("objects/forms/favorites",["require","core","objects/schema/form_classes","utilities","text!../../../tmpl/forms/favorites.html"],function(a){function f(){}var b=a("core"),c=a("objects/schema/form_classes"),d=a("utilities"),e=new c.FormDescription;e.ID="8e9ad96b-84e3-4a04-ac0b-69681cf818a5",e.Name="Favorites",e.InternalName="favorites",e.NameSpace="extended.General.Favorites",e.Keywords="favorites,bookmarks,saves,remember",e.UITemplate=a("text!../../../tmpl/forms/favorites.html"),e.CanActivate=!1,e.InstanceClass=f,f.prototype.Load=function(a){};var g=new c.Widget;g.ID=e.ID+".0",g.Name="Favorites",g.Icon="img/widgets/widget-favorite.png",g.Load=function(){var a=this;this.$contents=$("<div></div>"),this.loadFavoritesIntoDom(b.Favorites),$(document).bind("favoriteAdded",function(c,d){a.loadFavoritesIntoDom(b.Favorites),b.WidgetContentsChanged()}),$(document).bind("favoriteRemoved",function(c,d){a.loadFavoritesIntoDom(b.Favorites),b.WidgetContentsChanged()})},g.loadFavoritesIntoDom=function(a){var c=this;while(this.$contents.children().length>0)this.$contents.children().last().remove();$.each(a,function(a,e){var f=$(d.FormatString('<div class="favorite" id="{0}">{1}</div>',e.guid,e.title)),g=$('<img id="" style="float:right;margin-right: 4px;margin-top:4px;" src="img/window-close.gif"/>');f.append(g),$(g).click(function(){b.RemoveFavorite(e.guid)}),$(f).click(function(){b.ShowForm(e.guid,!1)}),c.$contents.append(f)})},e.AddWidget(g);var h=new c.Widget;return h.ID=e.ID+".1",h.Name="Recently Viewed",h.Icon="img/widgets/widget-recent.png",h.Load=function(){var a=this;this.$contents=$("<div></div>"),this.loadRecentItemsIntoDom(b.RecentItems),$(document).bind("recentItemsUpdated",function(c,d){a.loadRecentItemsIntoDom(b.RecentItems),b.WidgetContentsChanged()})},h.loadRecentItemsIntoDom=function(a){var c=this;while(this.$contents.children().length>0)this.$contents.children().last().remove();$.each(a,function(a,e){var f=$(d.FormatString('<div class="favorite" id="{0}">{1}</div>',e.guid,e.title));$(f).click(function(){b.ShowForm(e.guid,!1)}),c.$contents.append(f)})},e.AddWidget(h),e}),define("text!objects/../../tmpl/forms/floorcharts.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel">\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t\t<div class="ui-layout-center " style="height:100%;padding:2px;position:relative;border-width:0;">\r\n\t\t\t<div class="inner-scroller lv_body">\r\n\t\t\t\t<div id="lv_body"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div id="lv_header" class="ui-layout-north" style="padding:2px;border-width:0;"></div>\r\n\t\t<div id="lv_footer" class="ui-layout-south" style="padding:6px;border-width:0;overflow: hidden;"></div>\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/floorcharts.html",[],function(){return'<div style=\'overflow-x: hidden;\'>\r\n\t<div id="fc-text">\r\n\t\t<div class="ui-widget-header ui-widget-content ui-corner-top" style="padding:7px 10px;">General Information\r\n\t\t</div>\r\n\t\t<div class="ui-widget ui-widget-content ui-corner-bottom" style="margin-bottom: 12px;">\r\n\t\t\t<table style="margin:4px;font-size:11pt;">\r\n\t\t\t\t<tr class="xsingle-edit-only">\r\n\t\t\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Location<img id=\'jump_locations\' class=\'jump-button\' title=\'Jump to Locations\' alt=\'Edit Locations\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<select style=\'display:none;\' id="cboLocation" name="Location_uid"></select>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td></td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<button id="edit_fc">Edit Floor Chart</button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td></td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div id="fc-box" style="position:relative;width:180px;height:120px;margin-bottom: 2px;">\r\n\t\t\t\t\t\t\t<div id="fc" class="floor-chart" style=\'background-image: url("img/bg.jpg");\'></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n</div>'}),define("text!objects/../../tmpl/listview/templateListFC.html",[],function(){return'<div class="vp_widget" id="${UniqueID}" >\r\n    <table style="width:100%;padding:0;">\r\n        <tr>\r\n            <td style="vertical-align: text-top;padding:3px;">\r\n                <div style="font-weight:bold;font-size:12pt;">\r\n                    ${Name}\r\n                </div>\r\n                <div>${$item.GetOrganizationName($item.data.Organization_uid)}</div>\r\n                <div>${$item.GetLocationName($item.data.Location_uid)}</div>\r\n            </td>\r\n            <!--<td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n            </td>-->\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/floorcharts",["require","general_functions","utilities","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/floorcharts.html","text!../../../tmpl/editpanels/floorcharts.html","text!../../../tmpl/listview/templateListFC.html"],function(a){function i(){this.listview=undefined,this.$editpanel=undefined,this.saygpanel=undefined,this.selected=undefined}function j(a,b){console.log("form_floorcharts floorcharts changed"),a.listview.bindItems(),b.IsNetworkUpdate()&&a.saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&g.NetworkChangeNotification(h,b.NetworkChangeObject)}function k(a,b){a.listview.bindItems()}function l(a,b){a.listview.bindItems()}var b=a("general_functions"),c=a("utilities"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("objects/schema/component_classes"),g=a("core"),h=new d.FormDescription;return h.ID="676f522e-d4fd-4439-9425-bd72a447b4c6",h.UITemplate=a("text!../../../tmpl/forms/floorcharts.html"),h.Name="Floor Charts",h.InternalName="floorcharts",h.NameSpace="base.Point of Sale.Floor Charts",h.Keywords="seating,floor charts,table layout",h.CanActivate=!0,h.InstanceClass=i,h.viewmodel=e.FloorCharts,h.RequireModel(e.Organizations,l),h.RequireModel(e.FloorCharts,j),h.RequireModel(e.Locations,k),i.prototype.Show=function(){this.listview&&this.listview.TriggerSelectionChanged()},i.prototype.Load=function(d){this.state=d;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.saygpanel=new f.SaveAsYouGoPanel(this.$editpanel,a("text!../../../tmpl/editpanels/floorcharts.html")),this.saygpanel.FieldChangedFunction=function(a,c,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,c,function(){d(f.SaveAsYouGoStatus.Success)},function(a,c){d(f.SaveAsYouGoStatus.Failure),b.DialogError(c)})},this.saygpanel.editPanelTemplateFormatter={GetOrganizationName:e.GetTemplatedOrganizationName,GetLocationName:e.GetTemplatedLocationName},this.listview=new f.ListView(this.$contents.find("#list_view"),e.FloorCharts,a("text!../../../tmpl/listview/templateListFC.html")),this.listview.SetState(this.state.ListViewState),this.listview.sortIndex=0,this.listview.sortAscending=!0,this.listview.loadingDetailsOverlayContainer=this.$contents.find(".ui-layout-center").first(),this.listview.fields=["Name","OrganizationName","LocationName"],this.listview.fieldCaptions=["Name","Organization","Location"],this.listview.itemTemplateFormatter={FullAddress:function(a){return b.FormatAddress(a)},GetOrganizationName:e.GetTemplatedOrganizationName,GetLocationName:e.GetTemplatedLocationName},this.listview.multiSelect=!1,this.listview.AddNew=function(a,c){var d={};b.AddNewWithOrganization(e,h.viewmodel,"New Floor Chart","Which Organization would you like to create a new Floor Chart for?",d,a,c)},this.listview.Delete=function(a,c,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> floor charts";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> floor chart"),b.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,c,d)},d)},this.listview.FilterFunction=function(a,c){switch(c.toLowerCase()){case"organizationname":return e.GetTemplatedOrganizationName(a.Organization_uid);case"locationname":return e.GetTemplatedLocationName(a.Location_uid);default:return b.GetNotatedValue(a,c)}},this.listview.SortFunction=function(a,c,d,f){var g=b.ToString(b.GetNotatedValue(a,d)).toString().toLowerCase(),h=b.ToString(b.GetNotatedValue(c,d)).toString().toLowerCase();switch(d.toLowerCase()){case"organizationname":g=e.GetTemplatedOrganizationName(a.Organization_uid),h=e.GetTemplatedOrganizationName(c.Organization_uid);break;case"locationname":g=e.GetTemplatedLocationName(a.Location_uid),h=e.GetTemplatedLocationName(c.Location_uid)}return f?g>h?1:-1:g<h?1:-1},this.listview.SelectionChanged=function(a){i.selected=i.saygpanel.SetSelectedItems(a),i.$editpanel.find("button").button();if(c.IsEmptyObject(i.selected))return;b.SetDropDownList(i.$contents.find("#cboLocation"),e.Locations,i.selected.Location_uid,{Organization_uid:i.selected.Organization_uid}),i.$editpanel.find("#jump_locations").click(function(){var a=b.CreateSubFormLinkState(i.selected.Location_uid);g.NavigateToForm(g.FormDescriptions.locations,a)}),i.$editpanel.find("#edit_fc").click(function(){g.NavigateToForm(g.FormDescriptions.floorchart_editor,{id:i.selected.UniqueID})}),i.selected.floorchartObject.AppendElement(i.$editpanel.find("#fc")),i.selected.floorchartObject.SetScaling(i.$contents.find("#fc"),!0)},this.listview.StateChanged=function(a){i.state.ListViewState=a,g.StateChanged(i)},this.listview.Load()},i.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize()},h}),define("text!objects/../../tmpl/forms/floorchart_editor.html",[],function(){return'<div class="form-template">\r\n\t<div id="fc2" class="floor-chart" style=\'background-image: url("img/bg.jpg");\'></div>\r\n\t<button id="cmdtoolbox" style="z-index:50000;position:absolute;right:32px;top:6px;">Toolbox</button>\r\n\t<div id="toolbox" title="Floor Chart Toolbox" style="width:300px;overflow-x: hidden;">\r\n\t\t<div id="fc-tools" style="padding:3px;width;100%;height:100%;">\r\n\t\t\t<div class="toolSection">\r\n\t\t\t\t<div style=\'font-size:10pt;font-weight:bold;border-bottom:1px dotted #404040;\'>Shapes</div>\r\n\t\t\t\t<div id="drag_shapes">\r\n\t\t\t\t\t<img src=\'img/shape-ellipse.png\' class=\'Shape Ellipse\'/>\r\n\t\t\t\t\t<img src=\'img/shape-roundy.png\' class=\'Shape RoundRect\'/>\r\n\t\t\t\t\t<img src=\'img/shape-square.png\' class=\'Shape Rect\'/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="toolSection">\r\n\t\t\t\t<div style=\'font-size:10pt;font-weight:bold;border-bottom:1px dotted #404040;\'>Tables</div>\r\n\t\t\t\t<div id="drag_tables">\r\n\t\t\t\t\t<img src=\'img/table-round.png\' class=\'Table Ellipse\'/>\r\n\t\t\t\t\t<img src=\'img/table-roundy.png\' class=\'Table RoundRect\'/>\r\n\t\t\t\t\t<img src=\'img/table-square.png\' class=\'Table Rect\'/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="toolSection">\r\n\t\t\t\t<div style=\'font-size:10pt;font-weight:bold;border-bottom:1px dotted #404040;\'>Change Selected To:</div>\r\n\t\t\t\t<div id="changeShapeRadioButtons">\r\n\t\t\t\t\t<button id="changeShapeEllipse">Ellipse</button>\r\n\t\t\t\t\t<button id="changeShapeRoundRect">Roundy</button>\r\n\t\t\t\t\t<button id="changeShapeSquare">Square</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="toolSection">\r\n\t\t\t\t<button id="deleteSelected">Delete Selected</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="toolSection">\r\n\t\t\t\t<button id="rotateSelected">Rotate Selected</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="toolSection">\r\n\t\t\t\t<div style=\'font-size:10pt;font-weight:bold;border-bottom:1px dotted #404040;\'>Snap To Grid:</div>\r\n\t\t\t\t<div id="snapToGridRadioButtons">\r\n\t\t\t\t\t<button id="snapLeftTop">Left-Top</button>\r\n\t\t\t\t\t<button id="snapRightBottom">Right-Bottom</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n\r\n'}),define("objects/forms/floorchart_editor",["require","general_functions","floorchart/posFloorChart","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/floorchart_editor.html"],function(a){function i(){this.$toolbox=undefined,this.toolbox=undefined,this.floorChart=undefined}function j(a,b){}var b=a("general_functions"),c=a("floorchart/posFloorChart"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("objects/schema/component_classes"),g=a("core"),h=new d.FormDescription;return h.ID="6d14116e-c969-4a17-a0dc-440470353e10",h.Name="Floor Chart Editor",h.InternalName="floorchart_editor",h.NameSpace="extended.General.About",h.Keywords="about,information,developer,pos,emagine,emagine pos",h.CanActivate=!1,h.InstanceClass=i,h.UITemplate=a("text!../../../tmpl/forms/floorchart_editor.html"),h.RequireModel(e.FloorCharts,j),i.prototype.Hide=function(){this.toolbox&&this.toolbox.Hide()},i.prototype.Show=function(){this.toolbox&&this.state.ToolBoxState&&this.state.ToolBoxState.visible&&this.toolbox.Show()},i.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"});var a=this.$contents.closest(".ui-widget-content").height(),b=this.$contents.closest(".ui-widget-content").width();this.$contents.find("#fc2").css({width:b+"px",height:a-12+"px"}),this.floorChart&&this.floorChart.Adjust()},i.prototype.loadToolbox=function(){var a=this;this.$toolbox.find("#addShapeRadioButtons").buttonset(),this.$toolbox.find("#addShapeEllipse").click(function(){a.handleAddShape("Ellipse")}),this.$toolbox.find("#addShapeRoundRect").click(function(){a.handleAddShape("RoundRect")}),this.$toolbox.find("#addShapeSquare").click(function(){a.handleAddShape("Rect")}),this.$toolbox.find("#addTableRadioButtons").buttonset(),this.$toolbox.find("#addTableEllipse").click(function(){a.handleAddTable("Ellipse")}),this.$toolbox.find("#addTableRoundRect").click(function(){a.handleAddTable("RoundRect")}),this.$toolbox.find("#addTableSquare").click(function(){a.handleAddTable("Rect")}),this.$toolbox.find("#changeShapeRadioButtons").buttonset(),this.$toolbox.find("#changeShapeEllipse").click(function(){a.handleChangeShape("Ellipse")}),this.$toolbox.find("#changeShapeRoundRect").click(function(){a.handleChangeShape("RoundRect")}),this.$toolbox.find("#changeShapeSquare").click(function(){a.handleChangeShape("Rect")}),this.$toolbox.find("#deleteSelected").button().click(function(){a.handleDeleteSelected()}),this.$toolbox.find("#rotateSelected").button().click(function(){a.handleRotateSelected()}),this.$toolbox.find("#exportJson").button().click(function(){a.handleExportJson()}),this.$toolbox.find("#snapToGridRadioButtons").buttonset(),this.$toolbox.find("#snapLeftTop").click(function(){a.handleSnapLeftTop()}),this.$toolbox.find("#snapRightBottom").click(function(){a.handleSnapRightBottom()}),this.$toolbox.find("#drag_tables,#drag_shapes").children().draggable({helper:function(a,b){return $(a.target).css("z-index","50000").clone(!1).appendTo("body").show()},cursorAt:{top:2,left:2}}),this.$toolbox.find("#drag_test").children().draggable({helper:"clone",cursorAt:{top:2,left:2}})},i.prototype.updateDisplay=function(){var a=this;this.$contents.find("button").button(),this.$contents.find("#cmdtoolbox").click(function(){a.toolbox.Toggle()}),this.floorChart.AppendElement(this.$contents.find("#fc2")),this.floorChart.SetScaling(this.$contents.find("#fc2"),!1),this.floorChart.SetEditing(this.$contents.find("#fc2"),!0),this.floorChart.Adjust(),this.loadToolbox(),this.$contents.find("#fc2").droppable({over:function(a,b){},drop:function(b,c){var d=b.originalEvent.clientX-$(this).offset().left,e=b.originalEvent.clientY-$(this).offset().top,f={X:d,Y:e};$(c.draggable).hasClass("Table")&&($(c.draggable).hasClass("RoundRect")&&a.handleAddTable("RoundRect",f),$(c.draggable).hasClass("Rect")&&a.handleAddTable("Rect",f),$(c.draggable).hasClass("Ellipse")&&a.handleAddTable("Ellipse",f)),$(c.draggable).hasClass("Shape")&&($(c.draggable).hasClass("RoundRect")&&a.handleAddShape("RoundRect",f),$(c.draggable).hasClass("Rect")&&a.handleAddShape("Rect",f),$(c.draggable).hasClass("Ellipse")&&a.handleAddShape("Ellipse",f))}})},i.prototype.Load=function(a){this.state=a;var b=this;this.$contents=$(h.UITemplate),$(e.FloorCharts).bind("changeObjectReceived",function(a,b){}),this.$toolbox=this.$contents.find("#toolbox"),this.toolbox=new f.ToolBox("Floor Chart Tools",this.$toolbox,this.state.ToolBoxState),this.toolbox.StateChanged=function(a){b.state.ToolBoxState=a,g.StateChanged(b)};var c=e.FloorCharts.GetItemByKey(this.state.id);c.Detail==null?e.FloorCharts.getDetails(this.state.id,function(){b.floorChart=c.floorchartObject,b.updateDisplay()}):(this.floorChart=c.floorchartObject,this.updateDisplay())},i.prototype.handleAddTable=function(a,b){this.floorChart.AddTable(a,b)},i.prototype.handleAddShape=function(a,b){this.floorChart.AddShape(a,b)},i.prototype.handleChangeEvent=function(a,b){},i.prototype.handleDeleteSelected=function(){this.floorChart.DeleteSelectedObjects()},i.prototype.handleExportJson=function(){var a=this.floorChart.ExportToJson()},i.prototype.handleChangeShape=function(a){this.floorChart.ChangeSelectedObjectsShape(a)},i.prototype.handleResize=function(){this.floorChart.Adjust()},i.prototype.handleRotateSelected=function(){this.floorChart.RotateSelectedObjects(45)},i.prototype.handleSnapLeftTop=function(){this.floorChart.SnapLeftTopSelectedObjects()},i.prototype.handleSnapRightBottom=function(){this.floorChart.SnapRightBottomSelectedObjects()},i.prototype.handleToggleEditing=function(){this.editing=!this.editing,this.floorChart.SetEditing(this.editing)},h}),define("text!objects/../../tmpl/forms/jobpositions.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel">\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/jobpositions.html",[],function(){return'<div class="multi_edit">\r\n\tThere are multiple Job Positions selected. Any changes that you make will be applied to all selected Job Positions.\r\n</div>\r\n<div class="ui-widget-header ui-widget-content single-edit-only" style="padding:7px 10px;">General Information</div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Organization</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Organization<img id=\'jump_orgs\' class=\'jump-button\' title=\'Jump to Organizations\' alt=\'Edit Organizations\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<span id="Organization_uid" style=\'font-weight: bold;\'>${$item.GetOrganizationName($item.data.Organization_uid)}</span>\r\n\t\t\t\t<!--<select id="cboOrg" name="Organization_uid"></select>-->\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Initial Settings</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr id=\'pos_group_warning\' style=\'display:none;\'>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">POS Permissions</span></td>\r\n\t\t\t<td style=\'font-size:10pt;font-style:italic;color:#ff0000;\'>Job Positions from multiple organizations are selected, therefore POS Permissions assignment cannot be done</td>\r\n\t\t</tr>\r\n\t\t<tr id=\'pos_group\'>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">POS Permissions<img id=\'jump_group\' class=\'jump-button\' title=\'Jump to POS Permission\' alt=\'Edit POS Permissions\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<select style=\'display:none;\' id="cboGroup" name="InitialPosGroup_uid"></select>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Pay Rate</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:60px;text-align:right;" type="text" name="InitialPayRateStr" value="${InitialPayRateStr}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>'}),define("text!objects/../../tmpl/listview/templateListJobPosition.html",[],function(){return'<div class="vp_widget" id="${UniqueID}" >\r\n    <table style="width:100%;padding:0;">\r\n        <tr>\r\n            <td style="vertical-align: text-top;padding:3px;">\r\n                <div style="font-weight:bold;font-size:12pt;">\r\n                    ${Name}\r\n                </div>\r\n\t\t\t\t<div>${$item.GetOrganizationName($item.data.Organization_uid)}</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span style="background-color:#${$item.GetInitialPosGroupColor($item.data.InitialPosGroup_uid)};width:6px;height:14px;">&nbsp;</span>\r\n\t\t\t\t\t<span style="font-size:8pt;">${$item.GetInitialPosGroupName($item.data.InitialPosGroup_uid)}</span>\r\n\t\t\t\t</div>\r\n                <div>\r\n                </div>\r\n            </td>\r\n            <td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/jobpositions",["require","general_functions","utilities","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/jobpositions.html","text!../../../tmpl/editpanels/jobpositions.html","text!../../../tmpl/listview/templateListJobPosition.html","text!../../../tmpl/listview/templateListJobPosition.html"],function(a){function i(){this.selected=undefined,this.listview=undefined,this.$editpanel=undefined,this.saygpanel=undefined}function j(a,b){console.log("form_jobpositions jobpositions changed"),a.listview.bindItems(),b.IsNetworkUpdate()&&saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&g.NetworkChangeNotification(h,b.NetworkChangeObject),a.updateSaygLabels()}function k(a,b){a.listview.bindItems(),a.updateSaygLabels()}function l(a,b){a.listview.bindItems()}var b=a("general_functions"),c=a("utilities"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("objects/schema/component_classes"),g=a("core"),h=new d.FormDescription;return i.prototype.updateSaygLabels=function(){if(!this.saygpanel||!this.$editpanel||!this.selected)return;this.selected.Organization_uid!="xxx_variable_xxx"&&this.$editpanel.find("#Organization_uid").text(e.GetTemplatedOrganizationName(this.selected.Organization_uid))},h.ID="673c8af2-b060-4cf4-b90f-27386aca878f",h.UITemplate=a("text!../../../tmpl/forms/jobpositions.html"),h.Name="Job Positions",h.InternalName="jobpositions",h.NameSpace="base.Point of Sale.Job Positions",h.Keywords="JobPositions,admin,Job Position",h.CanActivate=!0,h.InstanceClass=i,h.viewmodel=e.JobPositions,h.RequireModel(e.JobPositions,j),h.RequireModel(e.Organizations,k),h.RequireModel(e.PosGroups,l),i.prototype.Load=function(d){this.state=d;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.saygpanel=new f.SaveAsYouGoPanel(this.$editpanel,a("text!../../../tmpl/editpanels/jobpositions.html")),this.saygpanel.FieldChangedFunction=function(a,c,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,c,function(){d(f.SaveAsYouGoStatus.Success)},function(a,c){d(f.SaveAsYouGoStatus.Failure),b.DialogError(c)})},i.saygpanel.editPanelTemplateFormatter={GetOrganizationName:e.GetTemplatedOrganizationName},this.listview=new f.ListView(this.$contents.find("#list_view"),e.JobPositions,a("text!../../../tmpl/listview/templateListJobPosition.html")),this.listview.SetState(this.state.ListViewState),this.listview.sortIndex=0,this.listview.sortAscending=!0,this.listview.fields=["Name","OrganizationName"],this.listview.fieldCaptions=["Name","Organization"],this.listview.itemTemplate=a("text!../../../tmpl/listview/templateListJobPosition.html"),this.listview.itemTemplateFormatter={FullAddress:function(a){return b.FormatAddress(a)},GetOrganizationName:e.GetTemplatedOrganizationName,GetInitialPosGroupColor:e.GetTemplatedInitialPosGroupColor,GetInitialPosGroupName:e.GetTemplatedInitialPosGroupName},this.listview.multiSelect=!0,this.listview.FilterFunction=function(a,c){switch(c.toLowerCase()){case"organizationname":return e.GetTemplatedOrganizationName(a.Organization_uid);default:return b.GetNotatedValue(a,c)}},this.listview.SortFunction=function(a,c,d,f){var g=b.ToString(b.GetNotatedValue(a,d)).toString().toLowerCase(),h=b.ToString(b.GetNotatedValue(c,d)).toString().toLowerCase();switch(d.toLowerCase()){case"organizationname":g=e.GetTemplatedOrganizationName(a.Organization_uid),h=e.GetTemplatedOrganizationName(c.Organization_uid)}return f?g>h?1:-1:g<h?1:-1},this.listview.AddNew=function(a,c){var d={};b.AddNewWithOrganization(e,h.viewmodel,"New Job Position","Which Organization would you like to create a new Job Position for?",d,a,c)},this.listview.Delete=function(a,c,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> job positions";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> job position"),b.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,c,d)},d)},this.listview.SelectionChanged=function(a){i.selected=i.saygpanel.SetSelectedItems(a);if(c.IsEmptyObject(i.selected))return;b.SetDropDownList(i.$contents.find("#cboGroup"),e.PosGroups,i.selected.InitialPosGroup_uid,{Organization_uid:i.selected.Organization_uid},!1),i.$editpanel.find("#jump_orgs").click(function(){var a=b.CreateSubFormLinkState(i.selected.Organization_uid);g.NavigateToForm(g.FormDescriptions.organizations,a)}),i.$editpanel.find("#jump_group").click(function(){var a=b.CreateSubFormLinkState(i.listview.SelectedItems[0].InitialPosGroup_uid);g.NavigateToForm(g.FormDescriptions.posgroups,a)}),a.length>1&&(i.$editpanel.find("#cboGroup").each(function(a,b){$(b).children().each(function(a,b){$(b).attr("value")==""&&$(b).html($(b).html().replace("None","Variable"))})}),i.$editpanel.find("#cboGroup").selectmenu()),i.selected.Organization_uid=="xxx_variable_xxx"?(i.$editpanel.find("#pos_group_warning").show(),i.$editpanel.find("#pos_group").hide()):(i.$editpanel.find("#pos_group_warning").hide(),i.$editpanel.find("#pos_group").show()),i.saygpanel.Resize()},this.listview.StateChanged=function(a){i.state.ListViewState=a,g.StateChanged(i)},this.listview.Load()},i.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize()},h}),define("text!objects/../../tmpl/forms/locations.html",[],function(){return'<div class="form-template">\r\n    <div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel">\r\n\t\t</div>\r\n    </div>\r\n    <div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n    </div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/locations.html",[],function(){return'<div class="multi_edit">\r\n\tThere are multiple Locations selected. Any changes that you make will be applied to all selected Locations.\r\n</div>\r\n<div class="ui-widget-header ui-widget-content single-edit-only" style="padding:7px 10px;">General Information</div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Organization</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Organization<img id=\'jump_orgs\' class=\'jump-button\' title=\'Jump to Organizations\' alt=\'Edit Organizations\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<span id="Organization_uid" style=\'font-weight: bold;\'>${$item.GetOrganizationName($item.data.Organization_uid)}</span>\r\n\t\t\t\t<!--<select id="cboOrg" name="Organization_uid"></select>-->\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr class=\'single-edit-only\'>\r\n\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Primary Floor Chart<img id=\'jump_charts\' class=\'jump-button\' title=\'Jump to Floor Charts\' alt=\'\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<select style=\'display:none;\' id="cboFloorChart" name="PrimaryFloorChart_uid"></select>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Address</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Street</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.Street1" value="${Address.Street1}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Suite / Apartment</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.Street2" value="${Address.Street2}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">City</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.City" value="${Address.City}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">State</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:120px;" type="text" name="Address.State" value="${Address.State}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Zip</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:90px;" type="text" name="Address.Zip" value="${Address.Zip}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Phone</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:120px;" type="text" name="Address.Phone" value="${Address.Phone}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>'}),define("text!objects/../../tmpl/listview/templateListLocation.html",[],function(){return'<div class="vp_widget" id="${UniqueID}" >\r\n    <table style="width:100%;padding:0;">\r\n        <tr>\r\n            <td style="vertical-align: text-top;padding:3px;">\r\n                <div style="font-weight:bold;font-size:12pt;">\r\n                    ${Name}\r\n                </div>\r\n                <div>${$item.GetOrganizationName($item.data.Organization_uid)}</div>\r\n                <div>\r\n                    <p style="margin:0;">\r\n                        ${$item.FullAddress($item.data)}\r\n                        <br/> ${Address.Phone} </p>\r\n                </div>\r\n            </td>\r\n            <td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/locations",["require","general_functions","utilities","core","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","text!../../../tmpl/forms/locations.html","text!../../../tmpl/editpanels/locations.html","text!../../../tmpl/listview/templateListLocation.html"],function(a){function i(a,b){console.log("form_locations locations changed"),a.listview.bindItems(),b.IsNetworkUpdate()&&a.saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&d.NetworkChangeNotification(h,b.NetworkChangeObject),a.updateSaygLabels()}function j(a,c){a.selected&&a.$editpanel&&b.SetDropDownList(a.$editpanel.find("#cboFloorChart"),f.FloorCharts,a.selected.PrimaryFloorChart_uid,{Organization_uid:a.selected.Organization_uid,Location_uid:a.selected.UniqueID},!1)}function k(a,b){a.listview.bindItems(),a.updateSaygLabels()}function l(){this.selected=undefined,this.listview=undefined,this.$editpanel=undefined,this.saygpanel=undefined,this.$mainLayout=undefined}var b=a("general_functions"),c=a("utilities"),d=a("core"),e=a("objects/schema/form_classes"),f=a("objects/schema/models"),g=a("objects/schema/component_classes"),h=new e.FormDescription;return h.ID="6653a627-4290-42ff-b815-03956d977c51",h.InternalName="locations",h.Name="Locations",h.NameSpace="base.Backoffice.Locations",h.Keywords="locations,admin,location",h.CanActivate=!0,h.UITemplate=a("text!../../../tmpl/forms/locations.html"),h.InstanceClass=l,h.RequireModel(f.Locations,i),h.RequireModel(f.FloorCharts,j),h.RequireModel(f.Organizations,k),h.viewmodel=f.Locations,l.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize(),this.saygpanel.Resize()},l.prototype.updateSaygLabels=function(){if(!this.saygpanel||!this.$editpanel||!this.selected)return;this.selected.Organization_uid!="xxx_variable_xxx"&&this.$editpanel.find("#Organization_uid").text(f.GetTemplatedOrganizationName(this.selected.Organization_uid))},l.prototype.Load=function(e){this.state=e;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.saygpanel=new g.SaveAsYouGoPanel(this.$editpanel,a("text!../../../tmpl/editpanels/locations.html")),this.saygpanel.FieldChangedFunction=function(a,c,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,c,function(){d(g.SaveAsYouGoStatus.Success)},function(a,c){d(g.SaveAsYouGoStatus.Failure),b.DialogError(c)})},this.saygpanel.editPanelTemplateFormatter={GetOrganizationName:f.GetTemplatedOrganizationName},this.listview=new g.ListView(this.$contents.find("#list_view"),f.Locations,a("text!../../../tmpl/listview/templateListLocation.html")),this.listview.SetState(this.state.ListViewState),this.listview.sortIndex=0,this.listview.sortAscending=!0,this.listview.fields=["Name","Address.Street1","Address.Street2","Address.City","Address.State","Address.Zip","Address.Phone","OrganizationName"],this.listview.fieldCaptions=["Name","Street","Street 2","City","State","Zip","Phone","Organization"],this.listview.itemTemplateFormatter={FullAddress:function(a){return b.FormatAddress(a)},GetOrganizationName:f.GetTemplatedOrganizationName},this.listview.multiSelect=!0,this.listview.AddNew=function(a,c){var d={};b.AddNewWithOrganization(f,h.viewmodel,"New Location","Which Organization would you like to create a new Location for?",d,a,c)},this.listview.FilterFunction=function(a,c){switch(c.toLowerCase()){case"organizationname":return f.GetTemplatedOrganizationName(a.Organization_uid);default:return b.GetNotatedValue(a,c)}},this.listview.SortFunction=function(a,c,d,e){var g=b.ToString(b.GetNotatedValue(a,d)).toString().toLowerCase(),h=b.ToString(b.GetNotatedValue(c,d)).toString().toLowerCase();switch(d.toLowerCase()){case"organizationname":g=f.GetTemplatedOrganizationName(a.Organization_uid),h=f.GetTemplatedOrganizationName(c.Organization_uid)}return e?g>h?1:-1:g<h?1:-1},this.listview.Delete=function(a,c,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> locations";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> location"),b.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,c,d)},d)},this.listview.SelectionChanged=function(a){i.selected=i.saygpanel.SetSelectedItems(a);if(c.IsEmptyObject(i.selected))return;b.SetDropDownList(i.$editpanel.find("#cboFloorChart"),f.FloorCharts,i.selected.PrimaryFloorChart_uid,{Organization_uid:i.selected.Organization_uid,Location_uid:i.selected.UniqueID},!1),i.$editpanel.find("#jump_orgs").click(function(){var a=b.CreateSubFormLinkState(i.selected.Organization_uid);d.NavigateToForm(d.FormDescriptions.organizations,a)}),i.$editpanel.find("#jump_charts").click(function(){var a=b.CreateSubFormLinkState(i.selected.PrimaryFloorChart_uid);d.NavigateToForm(d.FormDescriptions.floorcharts,a)}),i.saygpanel.Resize()},this.listview.StateChanged=function(a){i.state.ListViewState=a,d.StateChanged(i)},this.listview.Load()},h}),define("text!objects/../../tmpl/forms/myaccount.html",[],function(){return"<div id='edit_panel' style='padding:4px;margin-right:12px;'>\r\n</div>\r\n"}),define("text!objects/../../tmpl/editpanels/myaccount.html",[],function(){return'<div>\r\n\t<div class="ui-widget-header ui-widget-content ui-corner-top" style="padding:7px 10px;">General Information</div>\r\n\t<div class="ui-widget ui-widget-content ui-corner-bottom" style="margin-bottom: 2px;">\r\n\t\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t\t<tr class="single-edit-only">\r\n\t\t\t\t<td style="width:90px;"><span class="ui-dialog-title">Email</span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<input style="width:246px;" type="text" name="Email" value="${Email}"/>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr class="single-edit-only">\r\n\t\t\t\t<td><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</div>\r\n\t<div class="ui-widget-header ui-widget-content ui-corner-top" style="padding:7px 10px;">Change Password</div>\r\n\t<div class="ui-widget ui-widget-content ui-corner-bottom" style="margin-bottom: 2px;">\r\n\t\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t\t<tr class="single-edit-only">\r\n\t\t\t\t<td style="width:140px;"><span class="ui-dialog-title">Old Password</span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<input style="width:196px;" type="password" id="oldpass"/>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr class="single-edit-only">\r\n\t\t\t\t<td style="width:140px;"><span class="ui-dialog-title">New Password</span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<input style="width:196px;" type="password" id="pass1"/>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr class="single-edit-only">\r\n\t\t\t\t<td><span class="ui-dialog-title">Confirm</span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<input style="width:196px;" type="password" id="pass2"/>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr class="single-edit-only">\r\n\t\t\t\t<td></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<button id="change_password">Change</button>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</div>\r\n\t<div class="ui-widget-header ui-widget-content ui-corner-top" style="padding:7px 10px;">Avatar</div>\r\n\t<div class="ui-widget ui-widget-content ui-corner-bottom" style="margin-bottom: 2px;padding:4px;">\r\n\t\t<table>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<img id="avatar" style=\'width:110px;height:110px;border-radius: 2px;\'>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td style=\'padding-left:16px;\'>\r\n\t\t\t\t\t<img src=\'img/gravatar-logo.png\' style=\'height:25px;\'/><br/>\r\n\t\t\t\t\temagine pos uses Gravatar to provide avatars for our users. It allows you to easily link\r\n\t\t\t\t\tan avatar to your email address, which can then be automatically used on many different\r\n\t\t\t\t\tsites across the Internet.\r\n\t\t\t\t\t<br/><br/><a href="http://gravatar.com" target="_blank">Edit your avatar at Gravatar</a></td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</div>\r\n</div>'}),define("objects/forms/myaccount",["require","master_api","utilities","general_functions","objects/schema/models","objects/schema/form_classes","coreglobals","objects/schema/component_classes","core","text!../../../tmpl/forms/myaccount.html","text!../../../tmpl/editpanels/myaccount.html"],function(a){function k(){this.selected=undefined,this.$editpanel=undefined,this.saygpanel=undefined}function l(a,b){console.log("form_myaccount accounts changed"),a.updateMyAccount(),b.IsNetworkUpdate()&&a.saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&i.NetworkChangeNotification(j,b.NetworkChangeObject)}var b=a("master_api"),c=a("utilities"),d=a("general_functions"),e=a("objects/schema/models"),f=a("objects/schema/form_classes"),g=a("coreglobals"),h=a("objects/schema/component_classes"),i=a("core"),j=new f.FormDescription;return k.prototype.Resize=function(){this.saygpanel.Resize()},k.prototype.updateMyAccount=function(){this.$contents.show(),this.saygpanel.SetSelectedItems(new Array(j.viewmodel.GetItemByKey(g.CurrentAccountID))),this.$contents.find("#avatar").attr("src",c.CreateGravatarMarkup(j.viewmodel.GetItemByKey(g.CurrentAccountID),110)),this.$contents.find("button").button(),this.$contents.find("#change_password").click(function(){var a=$("#oldpass").val(),c=$("#pass1").val(),e=$("#pass2").val();if(a==""||c==""||e==""){d.DialogAlert("You must enter your old password and a new password to change your password","Change Password Failed",!0);return}if(c!=e){d.DialogAlert("Your new password and confirmation password do not match","Change Password Failed",!0);return}b.ChangePassword(g.CurrentAccountID,a,c,function(a){d.DialogAlert("Your password has been changed successfully.","Password Changed"),$("#oldpass").val(""),$("#pass1").val(""),$("#pass2").val("")},d.DialogError)}),this.saygpanel.Resize()},j.UITemplate=a("text!../../../tmpl/forms/myaccount.html"),j.ID=g.FORM_MY_ACCOUNT,j.Name="My Account",j.InternalName="myaccount",j.NameSpace="base.Tools.My Account",j.Keywords="me,accounts,admin,account,my,mine",j.CanActivate=!0,j.viewmodel=e.Accounts,j.RequireModel(e.Accounts,l),j.InstanceClass=k,k.prototype.Load=function(b){this.state=b;var c=this;this.$contents=$(j.UITemplate),this.saygpanel=new h.SaveAsYouGoPanel(this.$contents,a("text!../../../tmpl/editpanels/myaccount.html")),this.saygpanel.FieldChangedFunction=function(a,b,e){j.viewmodel.UpdateItems(c.saygpanel.selectedItems,b,function(){e(h.SaveAsYouGoStatus.Success)},function(a,b){e(h.SaveAsYouGoStatus.Failure),d.DialogError(b)})},c.updateMyAccount()},j}),define("text!objects/../../tmpl/forms/networkstatus.html",[],function(){return'<div style="position: relative;">\r\n\t<button id="refresh_graphs" style="z-index:2000;position:absolute;top:46px;right:16px;">Refresh</button>\r\n\t<div id="tabset">\r\n\t\t<ul>\r\n\t\t\t<li><a href="#tab1">Sunburst</a></li>\r\n\t\t\t<li><a href="#tab2">R-Graph</a></li>\r\n\t\t</ul>\r\n\t\t<div id="tab1" class=\'tab-content\' >\r\n\t\t\t<div id="sunburst"></div>\r\n\t\t</div>\r\n\t\t<div id="tab2" class=\'tab-content\' >\r\n\t\t\t<div id="rgraph"></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/widgets/networksummary.html",[],function(){return'<table id="tblConnectionSummary" style="width:100%;">\r\n\t<thead>\r\n\t<tr>\r\n\t\t<td></td>\r\n\t\t<td><img src="img/icons/flag_green.png" alt=""/></td>\r\n\t\t<td><img src="img/icons/flag_red.png" alt=""/></td>\r\n\t\t<td><img src="img/icons/flag_orange.png" alt=""/></td>\r\n\t</tr>\r\n\t</thead>\r\n\t<tbody></tbody>\r\n</table>\r\n'}),define("objects/forms/networkstatus",["require","master_api","general_functions","utilities","connectionStatus","objects/schema/form_classes","core","coreglobals","text!../../../tmpl/forms/networkstatus.html","text!../../../tmpl/widgets/networksummary.html"],function(a){function m(a){console.log("connection received"),i.processNotification(a.ConnectionEntry),s.loadContents()}function n(a){console.log("disconnection received"),i.processNotification(a.ConnectionEntry),s.loadContents()}function p(){this._formRgraph=undefined,this._formSunburst=undefined,this.$tabset=undefined,this.graphsLoaded=!1}function t(){if(j)return;j=!0,h.AddSubscriptions([h.NewNetworkSubscription("ConnectNotification",m),h.NewNetworkSubscription("DisconnectNotification",n)]),b.GetConnections(function(a){i.Load(a.Connections),i.RefreshGraphs(),s.loadContents()},c.DialogError)}var b=a("master_api"),c=a("general_functions"),d=a("utilities"),e=a("connectionStatus"),f=a("objects/schema/form_classes"),g=a("core"),h=a("coreglobals"),i=e.NewState(),j=!1,k=undefined,l=undefined,o=new f.FormDescription;o.ID="3a821de1-b7db-45ba-a903-5c3b5676a932",o.UITemplate=a("text!../../../tmpl/forms/networkstatus.html"),o.Name="Network Status",o.InternalName="networkstatus",o.NameSpace="base.Administrative.Network Status",o.Keywords="network,status,graphs,charts,tables",o.CanActivate=!0,o.InstanceClass=p,p.prototype.Load=function(a){this.state=a;var b=this;t(),this.state.selectedTab==undefined&&(this.state.selectedTab=0),this.$contents=$(o.UITemplate),this._formRgraph=b.$contents.find("#rgraph"),this._formSunburst=b.$contents.find("#sunburst"),this.$contents.find("button").button(),this.$contents.find("#refresh_graphs").click(function(){t()}),this.$tabset=b.$contents.find("#tabset"),this.$tabset.tabs({show:function(){b.$contents.find(".tab-content").css("height",b.$contents.closest(".jspContainer").height()-54),i.RefreshGraphs()},select:function(a,c){b.state.selectedTab=c.index,g.StateChanged(b)}}).tabs("select",this.state.selectedTab),i.RefreshGraphs()},p.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$contents.find(".tab-content").css("height",this.$contents.height()-48),this.graphsLoaded||(i.AppendElement("RGraph",this._formRgraph,70,!0),i.AppendElement("Sunburst",this._formSunburst,70,!0),this.graphsLoaded=!0),i!=undefined&&i.RefreshGraphs()},p.prototype.selectTab=function(a){this.$tabset&&this.$tabset.tabs("select",a)},p.prototype.Unload=function(){this.$tabset=undefined,i.RemoveElement(this._formRgraph),i.RemoveElement(this._formSunburst),this._formRgraph.remove(),this._formSunburst.remove()};var q=new f.Widget;q.ID=o.ID+".0",q.Name="Network Sunburst",q.Icon="img/widgets/widget-sunburst.png",q.$sungraph=undefined,q.FormActivated=function(a){a.selectTab(0)},q.Load=function(a){t(),this.$contents=$('<div style="height:160px;"></div>'),this.$sungraph=$('<div id="emaginesungraphwidget20120220" style="background-color:#303030; position:absolute;left:0;top:0;right:0;bottom:0;"></div>');var b=$('<div style="position:abosolute; width:10px; height:10px;"></div>');$("body").append(b),b.append(this.$sungraph),i.AppendElement("Sunburst",this.$sungraph,32,!1),this.$sungraph.detach(),this.$contents.append(this.$sungraph)},q.Resize=function(){i.RefreshGraphs()},q.Unload=function(){i.RemoveElement(this.$sungraph),this.$sungraph.remove()},o.AddWidget(q);var r=new f.Widget;r.ID=o.ID+".1",r.Name="Network RGraph",r.Icon="img/widgets/widget-rgraph.png",r.$rgraph=undefined,r.FormActivated=function(a){a.selectTab(1)},r.Load=function(a){t(),this.$contents=$('<div style="height:160px;"></div>'),this.$rgraph=$('<div id="emaginergraphwidget20120220" style="background-color:#303030; position:absolute;left:0;top:0;right:0;bottom:0;"></div>');var b=$('<div style="position:abosolute; width:10px; height:10px;"></div>');$("body").append(b),b.append(this.$rgraph),i.AppendElement("RGraph",this.$rgraph,32,!1),this.$rgraph.detach(),this.$contents.append(this.$rgraph)},r.Resize=function(){i.RefreshGraphs()},r.Unload=function(){i.RemoveElement(this.$rgraph),this.$rgraph.remove()},o.AddWidget(r);var s=new f.Widget;return s.ID=o.ID+".2",s.Name="Network Summary",s.Icon="img/widgets/widget-summary.png",s.Load=function(b){var c=this,d=a("text!../../../tmpl/widgets/networksummary.html");t(),this.$contents=$("<div></div>"),this.$contents.append($(d)),this.loadContents(!0)},s.loadContents=function(a){if(!this.Loaded&&!a)return;var b=this.$contents.find("#tblConnectionSummary").find("tbody");b.html("");var c=i.GetSummary();b.append(d.FormatString("<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td></tr>","Master",c.Master.Connected,c.Master.Disconnected,c.Master.Unknown)),b.append(d.FormatString("<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td></tr>","Proxy",c.Proxy.Connected,c.Proxy.Disconnected,c.Proxy.Unknown)),b.append(d.FormatString("<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td></tr>","Backoffice",c.Backoffice.Connected,"-","-")),b.append(d.FormatString("<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td></tr>","POS",c.Pos.Connected,c.Pos.Disconnected,c.Pos.Unknown))},o.AddWidget(s),o}),define("text!objects/../../tmpl/forms/organizations.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel" >\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/organizations.html",[],function(){return'<div class="multi_edit">\r\n\tThere are multiple Organizations selected. Any changes that you make will be applied to all selected Organizations.\r\n</div>\r\n<div class="ui-widget-header ui-widget-content single-edit-only" style="padding:7px 10px;">General Information</div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Primary Structure<img id=\'jump_structures\' class=\'jump-button\' title=\'Jump to Structures\' alt=\'Edit Structures\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<select id="cboStructure" name="PrimaryOrgStructure_uid"></select>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Address</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Street</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.Street1" value="${Address.Street1}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Suite / Apartment</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.Street2" value="${Address.Street2}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">City</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.City" value="${Address.City}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">State</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:120px;" type="text" name="Address.State" value="${Address.State}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Zip</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:90px;" type="text" name="Address.Zip" value="${Address.Zip}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Phone</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:120px;" type="text" name="Address.Phone" value="${Address.Phone}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content  single-edit-only" style="padding:7px 10px;"><span>Locations<img id=\'new_location\' style=\'margin-left:6px;margin-top:-4px;vertical-align: middle;cursor:  pointer;\' title=\'Add a new Location to this Organization\' alt=\'\' src=\'img/icons/icon-plus.png\'/></span></div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<div id="listLocations" class=\'item-list\' style="margin:2px;padding:4px;"></div>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content  single-edit-only" style="padding:7px 10px;"><span>Structures<img id=\'new_structure\' style=\'margin-left:6px;margin-top:-4px;vertical-align: middle;cursor:  pointer;\' title=\'Add a new Structure to this Organization\' alt=\'\' src=\'img/icons/icon-plus.png\'/></span></div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<div id="listStructures" class=\'item-list\' style="margin:2px;padding:4px;"></div>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content  single-edit-only" style="padding:7px 10px;"><span>User<img id=\'new_user\' style=\'margin-left:6px;margin-top:-4px;vertical-align: middle;cursor:  pointer;\' title=\'Add a new User to this Organization\' alt=\'\' src=\'img/icons/icon-plus.png\'/></span></div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<div id="listUsers" class=\'item-list\' style="margin:2px;padding:4px;"></div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/listview/templateListOrganization.html",[],function(){return'<div class="vp_widget" id="${UniqueID}">\r\n    <table style="width:100%;padding:0;">\r\n        <tr>\r\n            <td style="vertical-align: text-top;padding:3px;">\r\n                <div style="font-weight:bold;font-size:12pt;" class="filter-search">\r\n                    ${Name}\r\n                </div>\r\n                <div>\r\n                    <p style="margin:0;" class="filter-search">\r\n                        ${$item.FullAddress($item.data)}\r\n                        <br/> ${Address.Phone} </p>\r\n                </div>\r\n            </td>\r\n            <td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/organizations",["require","general_functions","utilities","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/organizations.html","text!../../../tmpl/editpanels/organizations.html","text!../../../tmpl/listview/templateListOrganization.html"],function(a){function i(a){return e.GetTemplatedAccountName(a.Account_uid)}function j(a){return a.Name}function k(a){return a.Name}function l(a,b){console.log("form_organizations organizations changed"),b.IsNetworkUpdate()&&a.saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&g.NetworkChangeNotification(h,b.NetworkChangeObject),a.listview.bindItems()}function m(a,b){console.log("form_organizations locations changed"),b.IsNew()&&a.loadLocationList(),b.IsDelete()&&a.loadLocationList(),b.IsUpdate()&&(b.Fields.Organization_uid||b.Fields.Name)&&(console.log("form_organizations locations changed actually changing something"),a.loadLocationList())}function n(a,b){a.loadUserList()}function o(a,c){a.loadStructureList(),a.$editpanel&&a.selected&&b.SetDropDownList(a.$editpanel.find("#cboStructure"),e.Structures,a.selected.PrimaryOrgStructure_uid,{Organization_uid:a.selected.UniqueID})}function p(){this.listview=undefined,this.saygpanel=undefined,this.$editpanel=undefined,this.$mainLayout=undefined,this.selected=undefined,this.buttonListUsers=new f.ButtonList(this.handleButtonUser,i),this.buttonListLocations=new f.ButtonList(this.handleButtonLocation,j),this.buttonListStructures=new f.ButtonList(this.handleButtonStructure,k)}var b=a("general_functions"),c=a("utilities"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("objects/schema/component_classes"),g=a("core"),h=new d.FormDescription;return h.ID="22a094bd-9ec6-4d63-a339-798a91437c56",h.InternalName="organizations",h.Name="Organizations",h.NameSpace="base.Administrative.Organizations",h.Keywords="organizations,admin,organization",h.CanActivate=!0,h.UITemplate=a("text!../../../tmpl/forms/organizations.html"),h.InstanceClass=p,h.RequireModel(e.Organizations,l),h.RequireModel(e.Structures,o),h.RequireModel(e.Locations,m),h.RequireModel(e.Users,n),h.RequireModel(e.Accounts,n),h.viewmodel=e.Organizations,p.prototype.handleButtonUser=function(a){var b=new f.ListViewSelectedState(a.UniqueID);g.NavigateToForm(g.FormDescriptions.users,b)},p.prototype.handleButtonLocation=function(a){var b=new f.ListViewSelectedState(a.UniqueID);g.NavigateToForm(g.FormDescriptions.locations,b)},p.prototype.handleButtonStructure=function(a){var b=new f.ListViewSelectedState(a.UniqueID);g.NavigateToForm(g.FormDescriptions.structures,b)},p.prototype.loadLocationList=function(){if(!this.selected)return;this.buttonListLocations.Load(this.$editpanel.find("#listLocations"),e.Locations.GetItems({Organization_uid:this.selected.UniqueID}))},p.prototype.loadStructureList=function(){if(!this.selected)return;this.buttonListStructures.Load(this.$editpanel.find("#listStructures"),e.Structures.GetItems({Organization_uid:this.selected.UniqueID}))},p.prototype.loadUserList=function(){if(!this.selected)return;this.buttonListUsers.Load(this.$editpanel.find("#listUsers"),e.Users.GetItems({Organization_uid:this.selected.UniqueID}))},p.prototype.Load=function(d){this.state=d;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.saygpanel=new f.SaveAsYouGoPanel(this.$editpanel,a("text!../../../tmpl/editpanels/organizations.html")),this.saygpanel.FieldChangedFunction=function(a,c,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,c,function(){d(f.SaveAsYouGoStatus.Success)},function(a,c){d(f.SaveAsYouGoStatus.Failure),b.DialogError(c)})},this.listview=new f.ListView(this.$contents.find("#list_view"),e.Organizations,a("text!../../../tmpl/listview/templateListOrganization.html")),this.listview.SetState(this.state.ListViewState),this.listview.sortIndex=0,this.listview.sortAscending=!0,this.listview.fields=["Name","Address.Street1","Address.Street2","Address.City","Address.State","Address.Zip","Address.Phone"],this.listview.fieldCaptions=["Name","Street","Street 2","City","State","Zip","Phone"],this.listview.itemTemplateFormatter={FullAddress:function(a){return b.FormatAddress(a)}},this.listview.multiSelect=!0,this.listview.AddNew=function(a,b){h.viewmodel.AddNew({Name:"New Organization"},a,b)},this.listview.Delete=function(a,c,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> organizations";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> organization"),b.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,c,d)},d)},this.listview.SelectionChanged=function(a){i.selected=i.saygpanel.SetSelectedItems(a);if(c.IsEmptyObject(i.selected))return;b.SetDropDownList(i.$contents.find("#cboStructure"),e.Structures,i.selected.PrimaryOrgStructure_uid,{Organization_uid:i.selected.UniqueID}),i.$editpanel.find("#jump_structures").click(function(){var a=b.CreateSubFormLinkState(i.selected.PrimaryOrgStructure_uid);g.NavigateToForm(g.FormDescriptions.structures,a)}),i.loadLocationList(),i.loadUserList(),i.loadStructureList(),i.$editpanel.find("#new_location").click(function(){e.Locations.AddNew({Organization_uid:i.selected.UniqueID},function(a){var c=b.CreateSubFormLinkState(a.UniqueID);g.NavigateToForm(g.FormDescriptions.locations,c)})}),i.$editpanel.find("#new_structure").click(function(){e.Structures.AddNew({Organization_uid:i.selected.UniqueID,Name:"New Organization Structure"},function(a){var c=b.CreateSubFormLinkState(a.UniqueID);g.NavigateToForm(g.FormDescriptions.structures,c)})}),i.$editpanel.find("#new_user").click(function(){e.Users.AddNew({Organization_uid:i.selected.UniqueID},function(a){var c=b.CreateSubFormLinkState(a.User.UniqueID);g.NavigateToForm(g.FormDescriptions.users,c)})}),i.Resize()},this.listview.StateChanged=function(a){i.state.ListViewState=a,g.StateChanged(i)},this.listview.Load()},p.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize(),this.ResizeButtonLists(),this.saygpanel.Resize()},p.prototype.ResizeButtonLists=function(){this.buttonListLocations.Resize(),this.buttonListStructures.Resize(),this.buttonListUsers.Resize()},h}),define("text!objects/../../tmpl/forms/posgroups.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel">\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t\t<div class="ui-layout-center " style="height:100%;padding:2px;position:relative;border-width:0;">\r\n\t\t\t<div class="inner-scroller lv_body">\r\n\t\t\t\t<div id="lv_body"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div id="lv_header" class="ui-layout-north" style="padding:2px;border-width:0;"></div>\r\n\t\t<div id="lv_footer" class="ui-layout-south" style="padding:6px;border-width:0;overflow: hidden;"></div>\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/posgroups.html",[],function(){return'<div class="multi_edit">\r\n\tThere are multiple Groups selected. Any changes that you make will be applied to all selected Groups.\r\n</div>\r\n<div class="ui-widget-header ui-widget-content single-edit-only" style="padding:7px 10px;">General Information</div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t<tr>\r\n\t\t<td style="width:180px;"><span class="ui-dialog-title">Name</span></td>\r\n\t\t<td>\r\n\t\t\t<input style="width:246px;" type="text" name="Name" value="${Name}"/>\r\n\t\t</td>\r\n\t</tr>\r\n</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Advanced</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Organization<img id=\'jump_orgs\' class=\'jump-button\'  title=\'Jump to Organizations\' alt=\'Edit Organizations\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<span id="Organization_uid" style=\'font-weight: bold;\'>${$item.GetOrganizationName($item.data.Organization_uid)}</span>\r\n\t\t\t\t<!--<select id="cboOrg" name="Organization_uid"></select>-->\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td>Color</td>\r\n\t\t\t<td>\r\n\t\t\t\t<div name="Color2" style="border-radius:2px;width:48px;height:48px;color:#${Color};background-color:#${Color}"></div>\r\n\t\t\t\t<input readonly="true" name="Color" maxlength="6" style=\'visibility:hidden;height:0px;cursor:  pointer;user-select:none;-moz-user-select:none;-webkit-user-select:none;width:0px;color:#${Color};background-color:#${Color};text-align: center;\' type="text" value="${Color}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Permissions</div>\r\n<div id=\'permission_table\' class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<div style=\'margin:12px;\' class=\'no-sayg\'>\r\n\t\t<input type=\'text\' id=\'perm_filter\' style=\'margin-left:-3px;margin-bottom:12px;width:240px;\' placeholder=\'type here to filter permissions ...\'/>\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/listview/templateListPosGroup.html",[],function(){return'<div class="vp_widget" id="${UniqueID}">\r\n\t<table style="width:100%;padding:0;">\r\n\t\t<tr>\r\n\t\t\t<td style=\'width:8px;background-color:#${Color};\'></td>\r\n\t\t\t<td style="vertical-align: text-top;padding:3px;">\r\n\t\t\t\t<div style="font-weight:bold;font-size:12pt;">\r\n\t\t\t\t\t${Name}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>${$item.GetOrganizationName($item.data.Organization_uid)}</div>\r\n\t\t\t</td>\r\n\t\t\t<td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n\t\t\t\t<div class="ui-icon ui-icon-circle-check"></div>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>'}),define("objects/forms/posgroups",["require","master_api","general_functions","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/posgroups.html","text!../../../tmpl/editpanels/posgroups.html","text!../../../tmpl/listview/templateListPosGroup.html"],function(a){function i(){this.selected=undefined,this.elem=undefined,this.listview=undefined,this.$editpanel=undefined,this.saygpanel=undefined,this.selectedColor="#ff0000",this.lastfilter="",this.$mainLayout=undefined,this.$cp=undefined,this.colorPicker=new f.ColorPicker}function j(a,b){console.log("form_posgroups posgroups changed"),a.listview.bindItems(),b.IsNetworkUpdate()&&saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&g.NetworkChangeNotification(h,b.NetworkChangeObject),a.updateSaygLabels()}function k(a,b){a.listview.bindItems(),a.updateSaygLabels()}function l(a,b){}var b=a("master_api"),c=a("general_functions"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("objects/schema/component_classes"),g=a("core"),h=new d.FormDescription;return i.prototype.refreshSwatch=function(){var a=this.$cp.find("#red").slider("value"),b=this.$cp.find("#green").slider("value"),c=this.$cp.find("#blue").slider("value"),d=this.colorPicker.hexFromRGB(a,b,c);this.selectedColor=d,this.$cp.find("#swatch").css("background-color","#"+d)},i.prototype.updateSaygLabels=function(){if(!this.saygpanel||!this.$editpanel||!this.selected)return;this.selected.Organization_uid!="xxx_variable_xxx"&&this.$editpanel.find("#Organization_uid").text(e.GetTemplatedOrganizationName(this.selected.Organization_uid))},h.ID="31336a5d-885f-4177-9320-d2546b60e538",h.UITemplate=a("text!../../../tmpl/forms/posgroups.html"),h.Name="POS Permissions",h.InternalName="posgroups",h.NameSpace="base.Point of Sale.POS Permissions",h.Keywords="security,permissions,users,groups,pos",h.CanActivate=!0,h.InstanceClass=i,h.viewmodel=e.PosGroups,h.RequireModel(e.PosGroups,j),h.RequireModel(e.Organizations,k),h.RequireModel(e.PosPermissions,l),i.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize()},i.prototype.Load=function(d){this.state=d;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.$cp=this.$contents.find("#color_picker"),i.saygpanel=new f.SaveAsYouGoPanel(i.$editpanel,a("text!../../../tmpl/editpanels/posgroups.html")),i.saygpanel.FieldChangedFunction=function(a,b,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,b,function(){d(f.SaveAsYouGoStatus.Success)},function(a,b){d(f.SaveAsYouGoStatus.Failure),c.DialogError(b)})},i.saygpanel.editPanelTemplateFormatter={GetOrganizationName:e.GetTemplatedOrganizationName},i.listview=new f.ListView(i.$contents.find("#list_view"),e.PosGroups,a("text!../../../tmpl/listview/templateListPosGroup.html")),i.listview.SetState(this.state.ListViewState),i.listview.sortIndex=0,i.listview.sortAscending=!0,i.listview.fields=["Name","OrganizationName"],i.listview.fieldCaptions=["Name","Organization"],this.listview.FilterFunction=function(a,b){switch(b.toLowerCase()){case"organizationname":return e.GetTemplatedOrganizationName(a.Organization_uid);default:return c.GetNotatedValue(a,b)}},this.listview.SortFunction=function(a,b,d,f){var g=c.ToString(c.GetNotatedValue(a,d)).toString().toLowerCase(),h=c.ToString(c.GetNotatedValue(b,d)).toString().toLowerCase();switch(d.toLowerCase()){case"organizationname":g=e.GetTemplatedOrganizationName(a.Organization_uid),h=e.GetTemplatedOrganizationName(b.Organization_uid)}return f?g>h?1:-1:g<h?1:-1},i.listview.loadingDetailsOverlayContainer=i.$contents.find(".ui-layout-center").first(),i.listview.itemTemplateFormatter={FullAddress:function(a){return c.FormatAddress(a)},GetOrganizationName:e.GetTemplatedOrganizationName},i.listview.multiSelect=!0,i.listview.AddNew=function(a,b){var d={};c.AddNewWithOrganization(e,h.viewmodel,"New POS Group","Which Organization would you like to create a new POS Group for?",d,a,b)},i.listview.Delete=function(a,b,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> permission groups";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> permission groups"),c.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,b,d)},d)},i.listview.SelectionChanged=function(a){function d(){var b=$("<table style='border-radius:2px;width:48px;height:48px;' cellspacing='0' cellpadding='0'></table>"),c=$("<tr></tr>");$.each(a,function(a,b){c.append("<td style='background-color:#"+b.Color+";'>&nbsp;</td>")}),b.append(c),i.$editpanel.find("[name=Color2]").html("").append(b)}i.selected=i.saygpanel.SetSelectedItems(a),i.$editpanel.find("button").button(),i.$editpanel.find("#perm_filter").keyup(function(){var a=$(this).val().toLowerCase().trim();i.$editpanel.find(".perm-item").each(function(b,c){a==""||$(c).text().toLowerCase().indexOf(a)!=-1?$(c).closest("tr").show():$(c).closest("tr").hide()}),i.$editpanel.find(".perm_group").each(function(a,b){var c=$(b).find("table:first"),d=!1;c.find("tr").each(function(a,b){$(b).css("display")!="none"&&(d=!0)}),d?$(b).show():$(b).hide()}),i.lastfilter=a}).val(i.lastfilter).trigger("keyup"),d(),i.$editpanel.find("[name=Color]").change(function(){$(this).css("background-color","#"+$(this).val()),$(this).css("color",i.colorPicker.getForegroundColor($(this).val())),i.$editpanel.find("[name=Color2]").html("").css("background-color","#"+$(this).val()),i.$editpanel.find("[name=Color2]").html("").css("color",i.colorPicker.getForegroundColor($(this).val())),d()}),i.$editpanel.find("[name=Color2]").click(function(){i.colorPicker.ShowDialog(i.selected.Color,function(b){$.each(a,function(a,c){c.Color=b}),i.$editpanel.find("[name=Color]").val(b).css("background-color","#"+b).trigger("change").css("color","#"+b),d()})}),$.each(e.PosPermissions.GetItems(),function(a,b){var c=i.$editpanel.find(".category_"+b.Header.replace(" ",""));if(c.length==0){var d=$("<div class='perm_group' style='padding:7px 10px;'><div style='font-weight:bold;border-bottom:1px dotted #808080;'>"+b.Header+"</div></div>");i.$editpanel.find("#permission_table").append(d),c=$("<div class='category_"+b.Header.replace(" ","")+" no-sayg' style='margin-bottom: 2px;'><table style='width:98%;margin:4px;font-size:11pt;'></table></div>").appendTo(d)}var e=$("<tr></tr>").appendTo(c.find("table"));e.append("<td style='width:90px;'><span class='ui-dialog-title perm-item' style='min-width:170px;white-space: nowrap;'>"+b.Name+"</span></td>");var f=undefined;switch(b.Kind.toLowerCase()){case"bool":f=$("<span id='"+a+"'></span>");break;default:}var g=$("<td></td>").appendTo(e);g.append(f)}),i.$editpanel.find(".perm_group").sortElements(function(a,b){var c=$(a).first("div").text(),d=$(b).first("div").text();return c>d?1:-1}),i.$editpanel.find(".perm_group").each(function(a,b){$(b).find("table>tbody>tr").sortElements(function(a,b){var c=$(a).first("td").first("span").text(),d=$(b).first("td").first("span").text();return c>d?1:-1})}),$(h.viewmodel).unbind("permissionChanged").bind("permissionChanged",function(b,c){var d=!1;$.each(a,function(a,b){b.UniqueID==c.id&&(d=!0)});if(d){var e=i.$editpanel,f=$(e).closest(".formDesc-object").data(c.remote);f||(f=$("<img title='Change made remotely by "+c.remote+"' style='display:none;margin-left:5px;vertical-align: top;border-radius:2px;' src='"+c.image.replace("s=24","s=18")+"'/>"),$(e).closest(".formDesc-object").data(c.remote,f),$(e).closest(".formDesc-object").find(".formDesc-collab-status").append(f).show(),$(f).stop().css("opacity",1).fadeIn(750).delay(8e3).fadeOut(750,function(){$(e).closest(".formDesc-object").data(c.remote,!1),$(f).remove(),$(e).closest(".formDesc-object").find(".formDesc-collab-status").children().length==0&&$(e).closest(".formDesc-object").find(".formDesc-collab-status").hide()})),i.listview.TriggerSelectionChanged()}}),$.each(e.PosPermissions.GetItems(),function(d,e){var f=e.UniqueID,g="";switch(e.Kind.toLowerCase()){case"bool":g="BoolValue";break;default:}var h=undefined;$.each(a,function(a,b){var c=b.Detail.Permissions[f];c==undefined&&(c=e.Default);if(c[g]!=h)if(h==undefined)h=c[g];else return h=null,!1});var j=i.$editpanel.find("#"+d);switch(e.Kind.toLowerCase()){case"bool":h==null&&(h="mixed");var k=new SteelUnderpants.TriStateCheckbox({enabled:!0,checked:h,tabIndex:1});$(k).bind("checked",function(){var d={Kind:"Bool",BoolValue:k.checked()},e=new Array;$.each(a,function(a,b){e.push(b.UniqueID)});if(!$(j).data("working")){var g=$("<img style='margin-left:5px;vertical-align: middle;' src='./img/ajax-loader-small.gif'/>");$(j).data("working",g),$(j).after(g)}b.SetPosGroupsPermission(e,f,d,function(b){$.each(a,function(a,b){b.Detail.Permissions[f]=d}),$(j).data("working")!=undefined&&$(j).data("working").remove(),$(j).data("success")!=undefined&&$(j).data("success").remove();var c=$("<img style='margin-left:5px;vertical-align: middle;' src='./img/icons/icon-accept.png'/>");$(j).data("success",c),$(j).is("select")?$(j).next().after(c):$(j).after(c),$(c).fadeIn(750,function(){$(c).delay(1e3).fadeOut()})},c.DialogError)}),j.append(k);break;default:}}),i.$editpanel.find(".permissions").change(function(){var d=e.PosPermissions.GetItemByKey($(this).attr("id")),f={};switch(d.Kind.toLowerCase()){case"bool":f.Kind="Bool",f.BoolValue=!1,$(this).attr("checked")=="checked"&&(f.BoolValue=!0);break;default:}var g=$(this).attr("id"),h=new Array;$.each(a,function(a,b){h.push(b.UniqueID)}),b.SetPosGroupsPermission(h,g,f,function(b){$.each(a,function(a,b){b.Detail.Permissions[g]=f})},c.DialogError)}),i.$editpanel.find("#jump_orgs").click(function(){var a=c.CreateSubFormLinkState(i.selected.Organization_uid);g.NavigateToForm(g.FormDescriptions.organizations,a)}),i.saygpanel.Resize()},i.listview.StateChanged=function(a){i.state.ListViewState=a,g.StateChanged(i)},i.listview.Load()},h}),define("text!objects/../../tmpl/forms/posuserpermissions.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n        <div style="height:100%;width:100%;">\r\n            <div id="edit_panel">\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n        <div id="lv_panel" style="float:left;padding:2px;">\r\n            <div style=\'margin:4px;font-weight:bold;border-bottom:1px dotted #808080\'>Assigned Locations<img id=\'show_tools\' style=\'vertical-align: top;margin-left:12px;cursor:  pointer;\' alt=\'\' src=\'img/icons/icon-edit.png\'/></span></div>\r\n            <ul id="ul_perms" class=\'no-close\'>\r\n                <li>\r\n                    <div class="user-box perm-root" style=\'background-color:#f0f0f0;\'>\r\n                        <div class=\'left\' style=\'background-color:transparent;\'></div>\r\n                        <div class=\'center\'></div>\r\n                        <div class=\'right\'></div>\r\n                    </div>\r\n                    <ul></ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div id="lv_east" style="display:none;float:right;padding:2px;border-width:0;">\r\n            <div id="toolbox" style=\'overflow:auto;\'>\r\n                <div id="toolbox_scroll" style=\'height:auto;padding:4px;margin:4px;margin-top:0;padding-top:0;\'>\r\n                    <div style=\'clear:both;\'>\r\n                        <div style=\'text-align:right;margin:4px;font-weight:bold;border-bottom:1px dotted #808080\'>Job\r\n                            Positions\r\n                        </div>\r\n                        <div id="toolbox_jobtypes"></div>\r\n                    </div>\r\n                    <div style=\'clear:both;\'>\r\n                        <div style=\'text-align:right;padding-top:12px;margin:4px;font-weight:bold;border-bottom:1px dotted #808080\'>Unassigned Locations</div>\r\n                        <div id="toolbox_locations"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/posuserpermissions.html",[],function(){return'<div style="width:100%;">\r\n\t<div class="multi_edit" id="multi_text">\r\n\t</div>\r\n\t<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">General\r\n\t\tInformation\r\n\t</div>\r\n\t<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t\t<tr class="location-edit">\r\n\t\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Login Code</span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<input style="width:246px;" type="text" name="LoginCode" value="${LoginCode}"/>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr class="job-edit">\r\n\t\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Pay Rate</span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<input style="width:246px;" type="text" name="PayRateStr" value="${PayRateStr}"/>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr class=\'job-edit\'>\r\n\t\t\t\t<td style="width:180px;"><span class="ui-dialog-title">POS Permissions<img\r\n\t\t\t\t\t\tid=\'jump_group\' class=\'jump-button\' title=\'Jump to POS Permissions\' alt=\'Edit POS Permissions\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<select style=\'display:none;\' id="cboGroup" name="PosGroup_uid"></select>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</div>\r\n</div>'}),define("objects/forms/posuserpermissions",["require","general_functions","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/posuserpermissions.html","text!../../../tmpl/editpanels/posuserpermissions.html"],function(a){function h(){this.selected=undefined,this.saygpanel=undefined,this.selectedItems=new Array,this.$editpanel=undefined,this.innerselected=undefined}function i(a,b){console.log("form_posuserpermissions posuserpermissions changed"),a.loadLocations();if(a.$editpanel){var c=d.PosUsers.GetItems({User_uid:a.selected.UniqueID});for(var e=0;e<c.length;e++){var f=d.PosUserJobPositions.GetItems({PosUser_uid:c[e].UniqueID});f.length>0&&$.each(f,function(b,c){var e=a.$editpanel.find("#ul_perms").find("#job_"+c.UniqueID);e.find(".left").css("background-color","#"+d.GetTemplatedInitialPosGroupColor(c.PosGroup_uid)),e.find(".center").text(c.JobPositionName)})}}}function j(a,b){a.loadLocations()}function k(a,b){a.loadLocations()}function l(a,b){a.loadJobPositions()}function m(a,b){}function n(a,b){}var b=a("general_functions"),c=a("objects/schema/form_classes"),d=a("objects/schema/models"),e=a("objects/schema/component_classes"),f=a("core"),g=new c.FormDescription;return h.prototype.loadToolbox=function(){this.loadLocations(),this.loadJobPositions()},h.prototype.resizeToolbox=function(){var a=this.$contents.find("#toolbox"),b=0;a.find(".user-box").css("width",""),a.find(".user-box").each(function(a,c){$(c).width()>b&&(b=$(c).width())}),a.find(".user-box").css("width",b);var c=this.$contents.find("#ul_perms").width()+a.width()+40;this.$mainLayout.sizePane("west",c);var d=this.$contents.find("#toolbox_scroll").data("jsp");d&&d.reinitialise()},h.prototype.resizePanel=function(){var a=0;this.$contents.find("#ul_perms").find(".perm-location,.perm-job").css("width",""),this.$contents.find("#ul_perms").find(".perm-location,.perm-job").each(function(b,c){$(c).width()>a&&(a=$(c).width())}),this.$contents.find("#ul_perms").find(".perm-location,.perm-job").css("width",a)},h.prototype.loadJobPositions=function(){if(!this.$editpanel||!this.selected)return;var a=this.$contents.find("#toolbox"),b=a.find("#toolbox_jobtypes"),c=this.selected;b.html(""),$.each(d.JobPositions.GetItems({Organization_uid:c.Organization_uid}),function(a,c){var e=$("<div style='clear:both;background-color:#f0f0f0;'></div>");e.data("job",c),e.addClass("user-box").css({color:"#303030","float":"right"}).addClass("perm-job"),e.append("<div class='left' style='background-color: #"+d.GetTemplatedInitialPosGroupColor(c.InitialPosGroup_uid)+";'></div>"),e.append("<div class='center'>"+c.Name+"</div>"),e.append("<div class='right' style='position:relative;'><img id='close_user' style='position:absolute;right:4px;top:4px;' src='img/window-close.gif'/></div>"),e.append("<div style='clear:both;'></div>"),e.draggable({revert:"invalid",helper:function(){return $(this).clone().appendTo("body").css({"z-index":"5000",cursor:"pointer",color:"#303030"})}}),b.append(e)}),this.resizeToolbox()},h.prototype.loadLocations=function(){var a=this;if(!this.$editpanel||!this.selected)return;var b=this.$contents.find("#toolbox"),c=b.find("#toolbox_locations"),e=this.selected;c.html(""),$.each(d.Locations.GetItems({Organization_uid:e.Organization_uid}),function(b,e){var f=d.PosUsers.GetItems({Location_uid:e.UniqueID,User_uid:a.selected.UniqueID});if(f.length==0){a.$editpanel.find("#ul_perms").find("#location_"+e.UniqueID).remove();var g=$("<div id='location_"+e.UniqueID+"' style='clear:both;background-color:#f0f0f0;'></div>");g.data("location",e),g.addClass("user-box").css({color:"#303030","float":"right"}).addClass("perm-location"),g.append("<div class='left' style='background-color: #303030;'></div>"),g.append("<div class='center'>"+e.Name+"</div>"),g.append("<div class='right' style='position:relative;'><img id='close_user' style='position:absolute;right:4px;top:4px;' src='img/window-close.gif'/></div>"),g.append("<div style='clear:both;'></div>"),g.draggable({revert:"invalid",helper:function(){return $(this).clone().appendTo("body").css({"z-index":"5000",cursor:"pointer",color:"#303030"})}}),c.append(g)}else if(a.$editpanel.find("#ul_perms").find("#location_"+e.UniqueID).length==0){var g=$("<div id='location_"+e.UniqueID+"' style='clear:both;background-color:#f0f0f0;'></div>");g.data("posuser",f[0]),g.addClass("user-box").css({color:"#303030"}).addClass("perm-location"),g.append("<div class='left' style='background-color: #303030;'></div>"),g.append("<div class='center'>"+e.Name+"</div>"),g.append("<div class='right' style='position:relative;'><img id='close_user' style='position:absolute;right:4px;top:4px;' src='img/window-close.gif'/></div>"),g.append("<div style='clear:both;'></div>"),a.addLinkedLocation(a.$contents.find("#ul_perms").find("ul:first"),g);var h=d.PosUserJobPositions.GetItems({PosUser_uid:f[0].UniqueID});h.length>0&&$.each(h,function(b,c){var e=$("<div id='job_"+c.UniqueID+"' style='clear:both;background-color:#f0f0f0;'></div>");e.data("job",c),e.addClass("user-box").css({color:"#303030"}).addClass("perm-job"),e.append("<div class='left' style='background-color: #"+d.PosGroups.GetItemByKey(c.PosGroup_uid).Color+";'></div>"),e.append("<div class='center'>"+d.GetTemplatedJobPositionName(c.JobPosition_uid)+"</div>"),e.append("<div class='right' style='position:relative;'><img id='close_user' style='position:absolute;right:4px;top:4px;' src='img/window-close.gif'/></div>"),e.append("<div style='clear:both;'></div>"),a.addLinkedJob(g.parent().find("ul:first"),e)})}else{var i=a.$editpanel.find("#ul_perms").find("#location_"+e.UniqueID);i.find(".center").text(e.Name)}}),c.children().sortElements(function(a,b){var c=$(a).find(".center").text(),d=$(b).find(".center").text();return c>d?1:-1}),this.resizeToolbox()},h.prototype.clearAllSelections=function(){this.$contents.find(".perm-location").removeClass("s-selected"),this.$contents.find(".perm-job").removeClass("s-selected")},h.prototype.addLinkedJob=function(a,b){var c=this;b.appendTo(a);var d=$(b).data("job");$(b).click(function(){c.$contents.find(".perm-location").removeClass("s-selected"),$(this).toggleClass("s-selected"),c.showSelected()}),$(b).find("#close_user:first").click(function(a){a.stopPropagation(),$(this).addClass("s-selected"),c.deleteSelectedJobs()}),c.resizePanel()},h.prototype.addLinkedLocation=function(a,c){var e=this,f=$("<li></li>"),g=$("<ul></ul>");f.append($(c)).append(g),f.appendTo(a),g.addClass("perm-ul");var h=$(c).data("posuser");$(c).find("#close_user:first").click(function(a){a.stopPropagation(),$(this).addClass("s-selected"),e.deleteSelectedLocations()}),$(c).click(function(){$(".perm-job").removeClass("s-selected"),$(this).toggleClass("s-selected"),e.showSelected()}),$(c).droppable({tolerance:"pointer",greedy:!0,accept:".perm-job",hoverClass:"s-hover",drop:function(a,c){var f=$(c.draggable).clone(),g=this,i=$(c.draggable).data("job");d.PosUserJobPositions.AddNew({PosGroup_uid:i.InitialPosGroup_uid,JobPosition_uid:i.UniqueID,PosUser_uid:h.UniqueID,PayRateStr:i.InitialPayRateStr},function(a){f.attr("id","job_"+a.UniqueID),f.data("job",a),e.addLinkedJob($(g).parent().find("ul:first"),f),e.clearAllSelections(),$(f).addClass("s-selected"),e.showSelected(),e.resizeToolbox()},b.DialogError)}}),e.resizePanel()},h.prototype.deleteSelectedJobs=function(){var a=this,c=a.$editpanel.find(".perm-job.s-selected"),e=new Array;c.each(function(a,b){e.push($(b).data("job"))}),d.PosUserJobPositions.DeleteItems(e,function(){c.each(function(a,b){$(b).remove()}),a.loadToolbox()},b.DialogError)},h.prototype.deleteSelectedLocations=function(){var a=this,c=a.$editpanel.find(".perm-location.s-selected"),e=new Array;c.each(function(a,b){$(b).closest("li").remove(),e.push($(b).data("posuser"))}),d.PosUsers.DeleteItems(e,function(){a.loadToolbox()},b.DialogError)},h.prototype.showSelected=function(){var a=this,c=a.$editpanel.find(".perm-job.s-selected"),e=a.$editpanel.find(".perm-location.s-selected");if(c.length==0&&e.length==0){a.innerselected=undefined,a.$editpanel.find("#edit_panel").hide();return}a.innerselected={},a.selectedItems=new Array;var h={};c.length>0?($.each(c,function(b,c){a.selectedItems.push($(c).data("job"))}),g.viewmodel=d.PosUserJobPositions):e.length>0&&($.each(e,function(b,c){a.selectedItems.push($(c).data("posuser"))}),g.viewmodel=d.PosUsers),a.innerselected=a.saygpanel.SetSelectedItems(a.selectedItems),c.length>0&&(a.$editpanel.find(".location-edit").hide(),a.$editpanel.find(".job-edit").show(),a.$editpanel.find("#multi_text").html("There are multiple Job Positions are selected. Any changes that you make will be applied to all selected Job Positions.")),e.length>0&&(a.$editpanel.find(".job-edit").hide(),a.$editpanel.find(".location-edit").show(),a.$editpanel.find("#multi_text").html("There are multiple Locations are selected. Any changes that you make will be applied to all selected Locations.")),c.length>1||e.length>1?(a.$editpanel.find(".multi_edit").show(),a.$editpanel.find(".single-edit-only").hide()):(a.$editpanel.find(".multi_edit").hide(),a.$editpanel.find(".single-edit-only").show()),a.innerselected&&c.length>0&&(a.$editpanel.find("#cboGroup").selectmenu("destroy"),b.SetDropDownList(a.$editpanel.find("#cboGroup"),d.PosGroups,a.innerselected.PosGroup_uid,{Organization_uid:a.state.User.Organization_uid},!1),c.length>1&&a.$editpanel.find("#cboGroup").each(function(a,b){$(b).children().each(function(a,b){$(b).attr("value")==""&&$(b).html($(b).html().replace("None","Variable"))})}),a.$editpanel.find("#cboGroup").selectmenu()),a.$editpanel.find("#jump_group").click(function(){var b={ListViewState:{selectedIds:[a.selectedItems[0].PosGroup_uid]}};f.NavigateToForm(f.FormDescriptions.posgroups,b)}),a.$editpanel.find("#edit_panel").show()},g.ID="8b094b7a-eec1-43fd-b8e6-bb39e9b247b8",g.UITemplate=a("text!../../../tmpl/forms/posuserpermissions.html"),g.Name="User Locations",g.InternalName="posuserpermissions",g.NameSpace="base.Backoffice.User Locations",g.Keywords="users,admin,user",g.InstanceClass=h,g.CanActivate=!1,g.viewmodel=d.PosUsers,g.RequireModel(d.PosUserJobPositions,i),g.RequireModel(d.PosUsers,j),g.RequireModel(d.Locations,k),g.RequireModel(d.JobPositions,l),g.RequireModel(d.Organizations,n),g.RequireModel(d.PosGroups,m),h.prototype.Show=function(){this.loadLocations(),this.showSelected(),this.loadToolbox(),this.resizePanel(),this.resizeToolbox()},h.prototype.Load=function(c){this.state=c,this.selected=this.state.User;var f=this;this.$contents=$(g.UITemplate),this.$editpanel=this.$contents,this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:"560",resizable:!1,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){f.listview.Resize(),f.saygpanel.Resize()}}),this.saygpanel=new e.SaveAsYouGoPanel(this.$editpanel.find("#edit_panel"),a("text!../../../tmpl/editpanels/posuserpermissions.html")),this.saygpanel.FieldChangedFunction=function(a,c,d){g.viewmodel.UpdateItems(f.saygpanel.selectedItems,c,function(){d(e.SaveAsYouGoStatus.Success)},function(a,c){d(e.SaveAsYouGoStatus.Failure),b.DialogError(c)})},this.loadLocations(),this.loadJobPositions(),this.state.JobPositions&&$.each(this.state.JobPositions,function(a,b){f.$editpanel.find("#job_"+b.UniqueID).addClass("s-selected")}),this.state.Locations&&$.each(this.state.Locations,function(a,b){f.$editpanel.find("#ul_perms").find("#location_"+b.Location_uid).addClass("s-selected")}),this.showSelected(),this.loadToolbox(),this.resizePanel(),this.resizeToolbox(),this.$editpanel.find(".perm-root .center").html(d.GetTemplatedAccountName(f.selected.Account_uid)),this.$editpanel.find(".perm-root").droppable({tolerance:"pointer",greedy:!0,accept:".perm-location,.perm-job",hoverClass:"s-hover",drop:function(a,c){var e=$(c.draggable).data("location");if(e)d.PosUsers.AddNew({Organization_uid:e.Organization_uid,Location_uid:e.UniqueID,User_uid:f.selected.UniqueID},function(){f.loadLocations(),f.resizeToolbox()},b.DialogError);else{var g=$(c.draggable).data("job");f.clearAllSelections(),$(this).parent().find(".perm-location").each(function(a,b){var e=b,h=$(c.draggable).clone(),i=$(b).data("posuser");d.PosUserJobPositions.AddNew({PosGroup_uid:g.InitialPosGroup_uid,JobPosition_uid:g.UniqueID,PosUser_uid:i.UniqueID,PayRateStr:g.InitialPayRateStr},function(a){h.attr("id","job_"+a.UniqueID),h.data("job",a),f.addLinkedJob($(e).parent().find("ul:first"),h),$(h).addClass("s-selected"),f.showSelected(),f.resizeToolbox()},function(){})})}}}),this.$contents.find("#show_tools").click(function(){f.$contents.find("#lv_east").toggle(),f.$contents.find("#ul_perms").toggleClass("no-close"),f.resizeToolbox()}).trigger("click")},h.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.saygpanel.Resize(),this.resizePanel(),this.resizeToolbox()},g}),define("text!objects/../../tmpl/forms/statsmap.html",[],function(){return'<div class="form-template">\r\n    <div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n        <div id="map_canvas" style="width:100%;height:100%;"></div>\r\n    </div>\r\n    <div id="list_view" class="ui-layout-east" style="height:100%;padding:4px;border-width:0;">\r\n        <div id="infobox" style="display:none;margin:6px;">\r\n            <img id="img_icon" style="float:left;margin-top:4px;margin-right:8px;"/>\r\n            <div style=\'font-size:12pt;font-weight:bold;\' id="location_name"></div>\r\n            <div id="location_address"></div>\r\n            <div id="alerts" style=\'margin-top:24px;\'></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("objects/forms/statsmap",["require","general_functions","objects/schema/form_classes","objects/schema/models","text!../../../tmpl/forms/statsmap.html"],function(a){function h(){this.markersArray=[],this.bounds=undefined,this.map=undefined,this.$mainLayout=undefined}function i(a,b){a.loadMap()}function j(b){if(f){b();return}console.warn("hard-coded to use google maps 3.7 as there is a bug in 3.8.  keep eyes open for an update here"),a(["async!http://maps.googleapis.com/maps/api/js?v=3.7&key=AIzaSyD_B8LukMnbkNmlvbz71UYm7r_Vpr1ajKM&sensor=false"],function(){f=!0,g=new google.maps.Geocoder,b()})}var b=a("general_functions"),c=a("objects/schema/form_classes"),d=a("objects/schema/models"),e=new c.FormDescription,f=!1,g=undefined;return h.prototype.clearOverlays=function(){if(this.markersArray)for(var a=0;a<this.markersArray.length;a++)this.markersArray[a].setMap(null)},h.prototype.loadMap=function(){var a=this;if(!this.map){var c={center:new google.maps.LatLng(40.7462,-82.4895),zoom:4,mapTypeId:google.maps.MapTypeId.TERRAIN};this.map=new google.maps.Map(this.$contents.find("#map_canvas").get(0),c);var e=[{featureType:"road",elementType:"geometry",stylers:[{visibility:"off"}]}];this.map.setOptions({styles:e})}this.resizeMap(),this.clearOverlays(),this.bounds=new google.maps.LatLngBounds,$.each(d.Locations.GetItems(),function(c,d){var e=d;c==0&&(e.alerts=new Array,e.alerts.push({reason:"Labor Percentage High",description:"Labor percentage for this location is currently 45%"}),e.alerts.push({reason:"Sales Below Projections",description:"Daily sales for this location are currently 12% below projections"}));var f=b.FormatAddress(d);if(e.coordinates&&e.formattedAddress==f)a.addMarker(e,e.coordinates);else{var h={address:f};e.formattedAddress=f;var i=g.geocode(h,function(b,c){c==google.maps.GeocoderStatus.OK&&(e.FullAddress=h.address,e.coordinates=b[0].geometry.location,a.addMarker(e,b[0].geometry.location))})}}),a.map.setCenter(new google.maps.LatLng(40.7462,-82.4895))},h.prototype.addMarker=function(a,b){var c=this,d=new google.maps.Marker({map:this.map,position:b,icon:"img/maps/location-green.png"});a.alerts&&(d.icon="img/maps/location-red.png"),c.markersArray.push(d),google.maps.event.addListener(d,"mouseover",function(){a.alerts?c.$contents.find("#img_icon").attr("src","img/maps/location-red.png"):c.$contents.find("#img_icon").attr("src","img/maps/location-green.png"),c.$contents.find("#location_name").html(a.Name),c.$contents.find("#location_address").html(a.FullAddress),c.$contents.find("#alerts").html(""),a.alerts&&$.each(a.alerts,function(a,b){var d=$("<div></div>");$("<div style='font-size:9pt;font-weight:bold;'>"+b.reason+"</div>").appendTo(d),$("<div style='font-size:9pt;'>"+b.description+"</div>").appendTo(d),d.appendTo(c.$contents.find("#alerts")),d.addClass("alert_box")}),c.$contents.find("#infobox").show()}),google.maps.event.addListener(d,"mouseout",function(){c.$contents.find("#infobox").hide()}),c.bounds.extend(b)},h.prototype.resizeMap=function(){if(!this.map)return;google.maps.event.trigger(this.map,"resize")},e.ID="0d9c23a3-0efb-4474-a787-5e309111d66c",e.UITemplate=a("text!../../../tmpl/forms/statsmap.html"),e.Name="RiskBoard&trade;",e.InternalName="statsmap",e.NameSpace="base.Backoffice.RiskBoard&trade;",e.Keywords="map,analytics,stats",e.CanActivate=!0,e.InstanceClass=h,e.viewmodel=d.Locations,e.RequireModel(d.Locations,i),h.prototype.Show=function(){},h.prototype.Unload=function(){},h.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.resizeMap()},h.prototype.LoadAsync=function(a,b){var c=this;j(function(){c.state=a,c.$contents=$(e.UITemplate).show(),c.$mainLayout=c.$contents.layout({resizeWithWindow:!0,east__size:320,east__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1}),c.loadMap(),b()})},e}),define("text!objects/../../tmpl/listview/templateStructureNode2.html",[],function(){return'<div class="ui-buttonset" style=\'position:relative;white-space:nowrap;z-index:20000;margin:0!important;padding:0;\'>\r\n\t<div style="width:100%;margin:0;">\r\n\t\t<table style="width:100%;margin:0;position: relative;" cellspacing="0" cellpadding="0">\r\n\t\t\t<tr>\r\n\t\t\t\t<td style="position:relative;width:24px!important;min-width:24px;height:24px;display:table-cell!important;" id="expand" class="ui-button ui-widget ui-state-default ui-button-icon-only ui-corner-left s-color">\r\n\t\t\t\t</td>\r\n\t\t\t\t<td width="*" style="font-size:11pt;text-align:left;min-height:24px;display:table-cell!important;" id="btn" class="ui-button ui-widget ui-state-default ui-button-text-icon-primary s-color">\r\n\t\t\t\t\t<div class=\'ui-button-text\' style=\'padding-top:0;padding-bottom:0;line-height:24px;\'>\r\n\t\t\t\t\t\t<div id=\'caption_label\' style=\'color:#000;margin-top:1px;font-size:10pt!important;\'>${Caption}</div>\r\n\t\t\t\t\t\t<input id="caption_edit" style="opacity:.95;padding-top:2px;padding-bottom:2px;width:100%;display:none;" type="text" value="${Caption}"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\'padding-left:4px;white-space: normal;\' id=\'sub_users\'></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td style="width:24px!important;min-width:24px;height:100%;display:table-cell!important;"  class="ui-button ui-widget ui-state-default ui-button-icon-only s-color">\r\n\t\t\t\t</td>\r\n\t\t\t\t<td style="width:24px!important;min-width:24px;height:100%;display:table-cell!important;"  class="ui-button ui-widget ui-state-default ui-button-icon-only ui-corner-right s-color">\r\n\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t\t<div style=\'cursor:pointer;position:absolute;top:6px;left:6px;\' class="ui-button-icon-primary ui-icon ui-icon-folder-open treeview-toggle"></div>\r\n\t\t<div style=\'cursor:pointer;position:absolute;top:6px;left:34px;\' id="icon_type" class="ui-button-icon-primary ui-icon"></div>\r\n\t\t<div style=\'cursor:pointer;position:absolute;top:6px;right:30px;\' id="addnew" class="ui-button-icon-primary ui-icon ui-icon-circle-plus"></div>\r\n\t\t<div style=\'cursor:pointer;position:absolute;top:6px;right:6px;\' id="delete" class="ui-button-icon-primary ui-icon ui-icon-circle-close "></div>\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/forms/structures.html",[],function(){return'<div class="form-template">\r\n\t<div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel" class="" style="width:auto;">\r\n\t\t\t<div id="toolbar" style="position:absolute;left:4px;top:0;right:0;height:52px;">\r\n\t\t\t\t<button id="toggle_toolbox">Toolbox</button>\r\n\t\t\t\t<br/>\r\n\t\t\t\t<input id="chkHide" type=\'checkbox\' /><label for="chkHide">Hide Users</label>\r\n\t\t\t</div>\r\n\t\t\t<div id="treeview" style="position: absolute;top:60px;left:0;right:0;bottom:0;overflow-x:hidden;overflow-y:auto;">\r\n\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n\t</div>\r\n\t<div id="toolbox" title="Organization Structure Toolbox" style="display:none;width:300px;overflow-x: hidden;">\r\n\t\t<span style="font-weight:bold;font-size:10pt;">Unassigned Locations</span><br/>\r\n\t\t<span style="font-size:8pt;font-style:italic;">Drag unassigned locations to the organization structure</span><br/>\r\n\t\t<ul id="unassigned_locations" style="margin-left:-22px;margin-top:12px;"></ul>\r\n\t\t<br/>\r\n\t\t<span style="font-weight:bold;font-size:10pt;margin-top:30px;">Users</span><br/>\r\n\t\t<span style="font-size:8pt;font-style:italic;">Drag users to the organization structure to assign permissions</span><br/>\r\n\t\t<ul id="unassigned_users" style="margin-left:-22px;margin-top:12px;"></ul>\r\n\t</div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/listview/templateListStructure.html",[],function(){return'<div class="vp_widget" id="${UniqueID}" >\r\n    <table style="width:100%;padding:0;">\r\n        <tr>\r\n\t\t\t<td style=\'width:10px;padding:0;\'>\r\n\t\t\t\t<img id=\'imgPrimary\' alt=\'\' title="This is the primary structure for this organization" style="display:${$item.IsPrimaryStructure($item.data)};margin-top:8px;width:10px;" src=\'img/02-star.png\'/>\r\n\t\t\t</td>\r\n            <td style="vertical-align: text-top;padding:3px;">\r\n                <div style="font-weight:bold;font-size:12pt;">\r\n                    ${Name}\r\n                </div>\r\n                <div>${$item.GetOrganizationName($item.data.Organization_uid)}</div>\r\n            </td>\r\n            <!--\r\n            <td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n            </td>-->\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/structures",["require","general_functions","utilities","core","master_api","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","text!../../../tmpl/listview/templateStructureNode2.html","text!../../../tmpl/forms/structures.html","text!../../../tmpl/listview/templateListStructure.html"],function(a){function k(){this.selected=undefined,this.users=undefined,this.listview=undefined,this.treeview=undefined,this.$editpanel=undefined,this.$treeview=undefined,this.$toolbar=undefined,this.$toolbox=$("<div style='padding:4px;'></div>"),this.toolbox=undefined,this.usersHidden=!1}function l(a,b){a.listview.bindItems(),a.loadToolbox()}function m(a,b){a.loadToolbox()}function n(a,b){a.loadToolbox(),a.$treeview.find(".user-box").each(function(a,b){var c=$(b).data("user");c&&(g.Users.GetItemByKey(c.UniqueID)||$(b).remove())})}function o(a,b){}function p(a,b){a.loadToolbox(),a.listview.bindItems()}function q(a){$(a).parents(".treeview-node").each(function(a,b){$(b).find("table:first").addClass("new-structure-hover")})}function r(a){$(a).parents(".treeview-node").each(function(a,b){$(b).find("table:first").removeClass("new-structure-hover")})}function s(a){$(a).closest(".treeview-node").addClass("new-structure-hover"),$(a).closest(".treeview-node").find(".treeview-node").each(function(a,b){$(b).find("table:first").addClass("new-structure-hover")})}function t(a){$(a).closest(".treeview-node").removeClass("new-structure-hover"),$(a).closest(".treeview-node").find(".treeview-node").each(function(a,b){$(b).find("table:first").removeClass("new-structure-hover")})}var b=a("general_functions"),c=a("utilities"),d=a("core"),e=a("master_api"),f=a("objects/schema/form_classes"),g=a("objects/schema/models"),h=a("objects/schema/component_classes"),i=a("text!../../../tmpl/listview/templateStructureNode2.html"),j=new f.FormDescription;return k.prototype.toggleToolbox=function(){this.toolbox.Toggle()},k.prototype.getToggleToolbox=function(){var a=this;return function(){a.toolbox.Toggle()}},k.prototype.loadToolbox=function(){var a=this;a.$toolbox.html("");if(!a.selected)return;a.$toolbox.append("<div style='font-weight:bold;border-bottom:1px dotted #404040;'>Users</div>");var b=$("<div></div>");a.$toolbox.append(b);var c=g.Users.GetItems({Organization_uid:a.selected.Organization_uid});for(var d=0;d<c.length;d++){var e=$("<div class='new-structure-user-button'>"+g.GetTemplatedAccountName(c[d].Account_uid)+"</div>");e.data("user",c[d]),e.draggable({cursorAt:{top:4,left:4},distance:12,helper:function(a,b){return $(this).clone().css("z-index","500001").css("width","200px").appendTo("body").show()},revert:"invalid",revertDuration:250,cursor:"move",opacity:.95}),b.append(e)}b.children().sortElements(function(a,b){var c=$(a).text(),d=$(b).text();return c>d?1:-1}),a.$toolbox.append("<div style='font-weight:bold;border-bottom:1px dotted #404040;margin-top:32px;'>Locations</div>");var f=$("<div></div>");a.$toolbox.append(f);var h=g.Locations.GetItems({Organization_uid:a.selected.Organization_uid});for(var d=0;d<h.length;d++)if(a.$contents.find(".location"+h[d].UniqueID).length==0){var e=$("<div class='new-structure-location-button'>"+h[d].Name+"</div>");e.data("location",h[d]),e.draggable({cursorAt:{top:4,left:4},distance:12,helper:function(a,b){return $(this).clone().css("z-index","500001").css("width","200px").appendTo("body").show()},revert:"invalid",revertDuration:250,cursor:"move",opacity:.95}),f.append(e)}f.children().sortElements(function(a,b){var c=$(a).text(),d=$(b).text();return c>d?1:-1}),a.toolbox.Resize()},k.prototype.toggleUsers=function(){this.usersHidden=!this.usersHidden,this.usersHidden?this.$editpanel.find(".user-box").hide():this.$editpanel.find(".user-box").show()},k.prototype.addGroup=function(a,c){var d=this,e={Kind:"NewGroupElement",Parent_uid:c.UniqueID,Caption:"New Structure Group"};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,e,function(a){d.listview.TriggerSelectionChanged()},b.DialogError)},k.prototype.deleteGroup=function(a,c){var d=this;if(d.treeview.NodeChildCount(c)==0)b.DialogConfirmYesNo("You are about to delete the <b>"+c.Caption+"</b> structure group.   Are you sure you want to do this?","Confirm Delete",function(){var e={Kind:"DeleteElement",Element_uid:c.UniqueID,MoveChildrenToParent:!0,Parent_uid:"",Index:0,Caption:""};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,e,function(b){a.remove(),d.loadToolbox()},b.DialogError)});else{var e=$("<div>You are about to delete the <b>"+c.Caption+"</b> structure group.<br/><br/>What do you want to do with this structure group's children?</div>");$(e).dialog({title:"<div class='icon-confirm' style='float:left;'></div>Confirm Delete",modal:!0,width:640,resizable:!1,buttons:{"Delete/Unassign":function(){var a=this,e={Kind:"DeleteElement",Element_uid:c.UniqueID,MoveChildrenToParent:!1,Parent_uid:"",Index:0,Caption:""};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,e,function(b){$(a).dialog("close"),alert(JSON.stringify(b)),d.listview.TriggerSelectionChanged()},b.DialogError)},"Move Up a Level":function(){$(this).dialog("close");var a={Kind:"DeleteElement",Element_uid:c.UniqueID,MoveChildrenToParent:!0,Parent_uid:"",Index:0,Caption:""};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,a,function(a){alert(JSON.stringify(a)),d.listview.TriggerSelectionChanged()},b.DialogError)},Cancel:function(){$(this).dialog("close")}}})}},k.prototype.deleteLocation=function(a,c){var d=this;b.DialogConfirmYesNo("Are you sure you want to remove this location?","Confirm Location Delete",function(){var a={Kind:"DeleteElement",Element_uid:c.UniqueID,MoveChildrenToParent:!1,Parent_uid:"",Index:0,Caption:""};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,a,function(a){d.treeview.RemoveNode(c),d.loadToolbox()},b.DialogError)})},k.prototype.deleteTreeUser=function(a,c,d,e){var f=this;b.DialogConfirmYesNo("Are you sure you want to remove this user?","Confirm User Delete",function(){var a={Kind:"DeleteUser",Element_uid:e.UniqueID,MoveChildrenToParent:!1,Parent_uid:"",Index:0,Caption:""};j.viewmodel.ChangeOrgStructure(f.selected.UniqueID,a,function(){d.remove()},b.DialogError)})},k.prototype.addLocation=function(a,c){var d=this,e={Kind:"AddLocationElement",Parent_uid:c.UniqueID,Location_uid:a.UniqueID};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,e,function(a){d.listview.TriggerSelectionChanged()},function(a,c){return b.DialogError(a,c),!1})},k.prototype.addUser=function(a,c){var d=this,e={Kind:"AddUser",User_uid:a.UniqueID,MoveChildrenToParent:!0,Parent_uid:c.UniqueID,Index:0,RemoveUserFromBranch:!0,Caption:""};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,e,function(a){d.listview.TriggerSelectionChanged()},function(a,c){return b.DialogError(a,c),!1})},k.prototype.moveUser=function(a,c){var d=this,e={Kind:"MoveUser",Parent_uid:c.UniqueID,Element_uid:a.UniqueID,Index:0,RemoveUserFromBranch:!0};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,e,function(a){d.listview.TriggerSelectionChanged()},function(a,c){return b.DialogError(a,c),!1})},k.prototype.moveNode=function(a,c){var d=this,e={Kind:"MoveElement",Element_uid:a.UniqueID,MoveChildrenToParent:!0,Parent_uid:c.UniqueID,Index:0,Caption:""};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,e,function(b){d.treeview.MoveNode(a,c,0)},function(a,c){return b.DialogError(a,c),!1})},k.prototype.nodeEnter=function(){},k.prototype.nodeLeave=function(){},k.prototype.configureGenericNode=function(a,b){a.find("#icon_type").mouseenter(this.nodeEnter).mouseleave(this.nodeLeave)},k.prototype.configureMainNode=function(a,c){function e(){var a=$(this),c=a.parent().find("#caption_label"),e=a.val();j.viewmodel.UpdateItems([d.selected],{Name:e},function(b){c.text(a.val()),a.blur()},b.DialogError)}var d=this;a.find("#icon_type").addClass("ui-icon-bullet"),a.find("#delete>div").hide(),a.find("#addnew").click(function(b){b.stopPropagation(),d.addGroup(a,c)}),a.droppable({accept:".new-structure-group,.new-structure-user,.new-structure-location,.new-structure-location-button,.new-structure-user-button,.user-box",hoverClass:"new-structure-hover",drop:function(a,b){var e=$(b.draggable).data("item");e?d.moveNode(e,c,0):(e=$(b.draggable).data("location"),e?d.addLocation(e,c,0):(e=$(b.draggable).data("user"),$(b.draggable).hasClass("user-box")?d.moveUser($(b.draggable).data("linkeduser"),c,0):d.addUser(e,c,0)))}}),a.find("#caption_label").unbind("click").click(function(){var b=$(this);b.hide();var c=a.find("#caption_edit");c.val(b.text()),c.unbind("change",e).bind("change",e).blur(function(){c.hide(),b.show()}),c.show(),c.focus(),c.select()})},k.prototype.configureGroupNode=function(a,c){function e(){var a=$(this),c=a.parent().find("#caption_label"),e=a.val();j.viewmodel.UpdateItems([d.selected],{Name:e},function(b){c.text(a.val()),a.blur()},b.DialogError)}var d=this;a.find("#icon_type").addClass("ui-icon-bullet"),a.find("#addnew").click(function(b){b.stopPropagation(),d.addGroup(a,c)}),a.find("#delete").click(function(b){b.stopPropagation(),d.deleteGroup(a,c)}),a.find("#caption_label").click(function(){var b=$(this);b.hide();var c=a.find("#caption_edit");c.val(b.text()),c.unbind("change",e).bind("change",e).blur(function(){c.hide(),b.show()}),c.show(),c.focus(),c.select()}),a.find("#icon_type").mouseover(function(){q(this)}).mouseout(function(){r(this)}),a.draggable({cursorAt:{top:4,left:4},distance:12,helper:function(a,b){return $(this).clone().css("z-index","500001").css("width","200px").appendTo("body").show()},revert:"invalid",revertDuration:250,cursor:"move",opacity:.95}),a.droppable({accept:".new-structure-group,.new-structure-user,.new-structure-location,.new-structure-location-button,.new-structure-user-button,.user-box",hoverClass:"new-structure-hover",drop:function(a,b){var e=$(b.draggable).data("item");e?d.moveNode(e,c,0):(e=$(b.draggable).data("location"),e?d.addLocation(e,c,0):(e=$(b.draggable).data("user"),$(b.draggable).hasClass("user-box")?d.moveUser($(b.draggable).data("linkeduser"),c,0):d.addUser(e,c,0)))}})},k.prototype.configureLocationNode=function(a,b){var c=this;a.addClass("location"+b.Location_uid),a.find("#icon_type").addClass("ui-icon-home"),a.find("#addnew>div").hide(),a.find("#delete").click(function(d){d.stopPropagation(),c.deleteLocation(a,b)}),a.find("#caption_label").text(g.GetTemplatedLocationName(b.Location_uid)),a.draggable({cursorAt:{top:4,left:4},distance:12,helper:function(a,b){return $(this).clone().css("z-index","500001").css("width","200px").appendTo("body").show()},revert:"invalid",revertDuration:250,cursor:"move",opacity:.95}),a.droppable({accept:".new-structure-user-button,.user-box",hoverClass:"new-structure-hover",drop:function(a,d){var e=$(d.draggable).data("user");$(d.draggable).hasClass("user-box")?c.moveUser($(d.draggable).data("linkeduser"),b,0):c.addUser(e,b,0)}}),a.find("#icon_type").mouseover(function(){q(this)}).mouseout(function(){r(this)})},k.prototype.configureUserNode=function(a,c){function f(a){if($(a.target).closest(".group-selector").length!=0)return;$(".group-selector").remove()}var d=this,e=c;$(document).unbind("mousedown",f).bind("mousedown",f),a.find(".center,.left").click(function(c){c.stopPropagation();if($(this).parent().data("dragging"))return;$(".group-selector").remove(),$(window).keyup(function(a){a.keyCode==27&&$(".group-selector").remove()});var f=$(this).parent().offset().left,h=$(this).parent().offset().top+20,i=$(this).parent().width(),k=$("<div class='ui-corner-bottom' style='color:#303030;background-color:#d0d0d0;'></div>");k.css({padding:0,width:"auto",left:f,top:h,position:"absolute",zIndex:5e4}).appendTo("body").show();var l=g.BOGroups.GetItems({Organization_uid:d.selected.Organization_uid}),m=$("<div></div>");m.addClass("user-box"),m.addClass("group-selector"),m.css("clear","both").width("98%").css("margin","1px"),m.append("<div class='left'></div>"),m.append("<div class='center'>No Permissions</div>"),m.append("<div class='right' style='position:relative;'></div>"),m.append("<div style='clear:both;'></div>"),m.find(".left").css("background-color","#303030"),k.append(m),m.click(function(c){var f=this;c.stopPropagation(),$(".group-selector").remove();var g={Kind:"UpdateUser",Element_uid:e.UniqueID,BOGroup_uid:""};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,g,function(b){a.find(".left").css("background-color","#303030")},b.DialogError)}),$.each(l,function(c,f){var g=$("<div></div>");g.addClass("user-box"),g.addClass("group-selector"),g.css("clear","both").width("98%").css("margin","1px"),g.append("<div class='left'></div>"),g.append("<div class='center'>"+f.Name+"</div>"),g.append("<div class='right' style='position:relative;'></div>"),g.append("<div style='clear:both;'></div>"),g.find(".left").css("background-color","#"+f.Color),k.append(g),g.click(function(){a.find(".left").css("background-color","#"+f.Color),$(".group-selector").remove();var c={Kind:"UpdateUser",Element_uid:e.UniqueID,BOGroup_uid:f.UniqueID};j.viewmodel.ChangeOrgStructure(d.selected.UniqueID,c,function(a){},b.DialogError)})})})},k.prototype.createUserNode=function(a){var b=g.Accounts.GetItemByKey(a.Account_uid),c=$("<div></div>");return c.addClass("user-box"),c.data("user",a),c.data("account",b),c.append("<div class='left' style='background-color:#303030;'></div>"),c.append("<div class='center'>"+b.Name+"</div>"),c.append("<div class='right' style='position:relative;'><img id='info_user' style='position:absolute;right:16px;top:3px;' src='img/eye.png'/><img id='close_user' style='position:absolute;right:4px;top:4px;' src='img/window-close.gif'/></div>"),c.append("<div style='clear:both;'></div>"),c},k.prototype.addTreeNodeUsers=function(a,b){var c=this;if(!b.Users)return;$.each(b.Users,function(d,e){var f=g.Users.GetItemByKey(e.User_uid),h=c.createUserNode(f);h.data("linkeduser",e),e.BOGroup_uid==""?h.find(".left").css("background-color","#303030"):h.find(".left").css("background-color","#"+g.GetTemplatedBOGroupColor(e.BOGroup_uid)),c.configureUserNode(h,e),a.find("#sub_users").append(h),h.find("#close_user").click(function(d){d.stopPropagation(),c.deleteTreeUser(a,b,h,e)}),h.draggable({distance:12,helper:function(a,b){return $(this).clone().css("z-index","500001").css({"background-color":"#fff",color:"#303030"}).appendTo("body").show()},revert:"invalid",revertDuration:250,cursor:"move",opacity:.95}),h.find("#info_user").mouseover(function(){s(this)}).mouseout(function(){t(this)})}),a.find("#sub_users").children().sortElements(function(a,b){var c=$(a).find(".center").text(),d=$(b).find(".center").text();return c>d?1:-1})},k.prototype.addTreeNode=function(a,b){var c=this,d=a.Kind.toLowerCase(),e="new-structure-"+d,f=c.treeview.AddNode(a,b,e);c.configureGenericNode(f,a);switch(d){case"main":c.configureMainNode(f,a);break;case"group":c.configureGroupNode(f,a);break;case"location":c.configureLocationNode(f,a)}c.addTreeNodeUsers(f,a),$.each(a.Children,function(b,d){c.addTreeNode(d,a)})},j.ID="87803e0c-8af6-409d-b685-ba2f6d960ded",j.UITemplate=a("text!../../../tmpl/forms/structures.html"),j.Name="Structures",j.InternalName="structures",j.NameSpace="base.Backoffice.Structures",j.Keywords="structures,admin,structure",j.CanActivate=!0,j.InstanceClass=k,j.viewmodel=g.Structures,j.RequireModel(g.Organizations,p),j.RequireModel(g.Structures,l),j.RequireModel(g.Locations,m),j.RequireModel(g.Users,n),j.RequireModel(g.BOGroups,o),j.RequireModel(g.Accounts,n),k.prototype.Show=function(){this.toolbox&&this.state.ToolBoxState&&this.state.ToolBoxState.visible&&this.toolbox.Show()},k.prototype.Hide=function(){this.toolbox&&this.toolbox.Hide()},k.prototype.Load=function(e){this.state=e;var f=this;this.$contents=$(j.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$toolbar=this.$contents.find("#toolbar"),this.$treeview=this.$contents.find("#treeview"),this.toolbox=new h.ToolBox("Organization Structure Tools",this.$toolbox,this.state.ToolBoxState),this.toolbox.StateChanged=function(a){f.state.ToolBoxState=a,d.StateChanged(f)},this.$toolbar.find("#toggle_toolbox").click(this.getToggleToolbox()),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){f.listview.Resize()}}),this.$editpanel.find("button").button(),this.$editpanel.find("#chkHide").change(function(){f.toggleUsers()}),this.listview=new h.ListView(this.$contents.find("#list_view"),g.Structures,a("text!../../../tmpl/listview/templateListStructure.html")),this.listview.SetState(this.state.ListViewState),this.listview.sortIndex=0,this.listview.sortAscending=!0,this.listview.fields=["Name","OrganizationName"],this.listview.fieldCaptions=["Name","Organization"],this.listview.loadingDetailsOverlayContainer=this.$contents.find(".ui-layout-center").first(),this.listview.itemTemplateFormatter={GetOrganizationName:g.GetTemplatedOrganizationName,IsPrimaryStructure:function(a){var b=g.Organizations.GetItemByKey(a.Organization_uid);return b?b.PrimaryOrgStructure_uid==a.UniqueID?"inline":"none":"none"}},this.listview.FilterFunction=function(a,c){switch(c.toLowerCase()){case"organizationname":return g.GetTemplatedOrganizationName(a.Organization_uid);default:return b.GetNotatedValue(a,c)}},this.listview.SortFunction=function(a,c,d,e){var f=b.ToString(b.GetNotatedValue(a,d)).toString().toLowerCase(),h=b.ToString(b.GetNotatedValue(c,d)).toString().toLowerCase();switch(d.toLowerCase()){case"organizationname":f=g.GetTemplatedOrganizationName(a.Organization_uid),h=g.GetTemplatedOrganizationName(c.Organization_uid)}return e?f>h?1:-1:f<h?1:-1},this.listview.multiSelect=!1,this.listview.AddNew=function(a,c){var d={};d.Name="New Structure",b.AddNewWithOrganization(g,j.viewmodel,"New Structure","Which Organization would you like to create a new Structure for?",d,a,c)},this.listview.Delete=function(a,c,d){var e="these <b>"+f.listview.SelectedItems.length+"</b> structures";f.listview.SelectedItems.length==1&&(e=" the <b>"+f.listview.SelectedItems[0].Name+"</b> structure"),b.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){j.viewmodel.DeleteItems(f.listview.SelectedItems,c,d),f.toolbox.Hide()},d)},this.listview.SelectionChanged=function(a){if(c.IsEmptyArray(a)){f.$editpanel.hide();return}f.$editpanel.show(),f.selected=a[0],f.treeview=new h.TreeView(f.$treeview),f.treeview.nodeTemplate=i,f.treeview.toggleSelector=".treeview-toggle",f.treeview.Load(),f.addTreeNode(f.selected.Detail.MainElement,undefined,"structure-root"),f.loadToolbox()},this.listview.StateChanged=function(a){f.state.ListViewState=a,d.StateChanged(f)},this.listview.Load()},k.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize()},j}),define("text!objects/../../tmpl/forms/users.html",[],function(){return'<div class="form-template">\r\n    <div class="ui-layout-center" style="padding:4px;margin-top:-4px;border-width:0;overflow: hidden;">\r\n\t\t<div id="edit_panel">\r\n\t\t</div>\r\n    </div>\r\n    <div id="list_view" class="ui-layout-west" style="height:100%;padding:4px;border-width:0;">\r\n    </div>\r\n</div>\r\n'}),define("text!objects/../../tmpl/editpanels/users.html",[],function(){return'<div class="multi_edit">\r\n\tThere are multiple Users are selected. Any changes that you make will be applied to all selected Users.\r\n</div>\r\n<div class="ui-widget-header ui-widget-content single-edit-only" style="padding:7px 10px;">General Information</div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Name</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Name" value="${$item.GetAccountName($item.data.Account_uid)}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Email</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Email" value="${$item.GetAccountEmail($item.data.Account_uid)}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style="width:220px;"><span class="ui-dialog-title">Organization<img id=\'jump_orgs\' class=\'jump-button\' title=\'Jump to Organizations\' alt=\'Edit Organizations\' src=\'img/icons/icon-edit.png\'/></span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<span id="Organization_uid" style=\'font-weight: bold;\'>${$item.GetOrganizationName($item.data.Organization_uid)}</span>\r\n\t\t\t\t<!--<select id="cboOrg" name="Organization_uid"></select>-->\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content" style="padding:7px 10px;">Contact Information</div>\r\n<div class="ui-widget ui-widget-content" style="margin-bottom: 2px;">\r\n\t<table style="width:98%;margin:4px;font-size:11pt;">\r\n\t\t<tr>\r\n\t\t\t<td style="width:180px;"><span class="ui-dialog-title">Street</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.Street1" value="${Address.Street1}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Suite / Apartment</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.Street2" value="${Address.Street2}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">City</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:246px;" type="text" name="Address.City" value="${Address.City}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">State</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:120px;" type="text" name="Address.State" value="${Address.State}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Zip</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:90px;" type="text" name="Address.Zip" value="${Address.Zip}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td><span class="ui-dialog-title">Phone</span></td>\r\n\t\t\t<td>\r\n\t\t\t\t<input style="width:120px;" type="text" name="Address.Phone" value="${Address.Phone}"/>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n<div class="ui-widget-header ui-widget-content single-edit-only" style="padding:7px 10px;">POS Location Assignments<img id=\'jump_permissions\' class=\'jump-button\' title=\'Edit POS Permissions\' alt=\'\' src=\'img/icons/icon-edit.png\'/></div>\r\n<div class="ui-widget ui-widget-content single-edit-only" style="margin-bottom: 2px;">\r\n\t<div id=\'listPermissions\'></div>\r\n</div>'}),define("text!objects/../../tmpl/listview/templateListUser.html",[],function(){return'<div class="vp_widget" id="${UniqueID}" >\r\n    <table style="width:100%;padding:0;">\r\n        <tr>\r\n            <td style="vertical-align: text-top;padding:3px;">\r\n                <div style="font-weight:bold;font-size:12pt;">\r\n\t\t\t\t\t${$item.GetAccountName($item.data.Account_uid)}\r\n                </div>\r\n                <div><b>${$item.GetOrganizationName($item.data.Organization_uid)}</b></div>\r\n                <div>\r\n                    <p style="margin:0;">\r\n\t\t\t\t\t\t${$item.GetAccountEmail($item.data.Account_uid)} </p>\r\n                </div>\r\n            </td>\r\n            <td title="Include this item in multiple selection" id="mselect" style="padding:0;width:32px" class="vp-multiselect-bar">\r\n                <div class="ui-icon ui-icon-circle-check"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>'}),define("objects/forms/users",["require","general_functions","utilities","objects/schema/form_classes","objects/schema/models","objects/schema/component_classes","core","text!../../../tmpl/forms/users.html","text!../../../tmpl/editpanels/users.html","text!../../../tmpl/listview/templateListUser.html","text!../../../tmpl/listview/templateListUser.html"],function(a){function i(){this.selected=undefined,this.listview=undefined,this.$editpanel=undefined,this.saygpanel=undefined}function j(a,b){console.log("form_users users changed"),a.listview.bindItems(),b.IsNetworkUpdate()&&saygpanel.ApplyNetworkChangedItem(b.NetworkChangeObject)&&g.NetworkChangeNotification(h,b.NetworkChangeObject),a.updateSaygLabels()}function k(a,b){a.loadLocations()}function l(a,b){a.loadLocations()}function m(a,b){a.listview.bindItems(),a.updateSaygLabels()}function n(a,b){a.loadLocations()}function o(a,b){a.loadLocations()}function p(a,b){a.updateSaygLabels()}var b=a("general_functions"),c=a("utilities"),d=a("objects/schema/form_classes"),e=a("objects/schema/models"),f=a("objects/schema/component_classes"),g=a("core"),h=new d.FormDescription;return i.prototype.loadLocations=function(){var a=this;if(!this.$editpanel)return;this.$editpanel.find("#listPermissions").html("");if(!this.selected)return;$.each(e.PosUsers.GetItems({User_uid:a.selected.UniqueID}),function(b,c){var d=$("<div class='perm_group' style='padding:7px 10px;'></div>"),f=$("<span class='small-list-item small-location-item' style='font-weight:bold;'>"+e.GetTemplatedLocationName(c.Location_uid)+"</span>");$(f).click(function(){var b={User:a.selected,Locations:new Array(c)};g.NavigateToForm(g.FormDescriptions.posuserpermissions,b)}),d.append(f),a.$editpanel.find("#listPermissions").append(d),$.each(e.PosUserJobPositions.GetItems({PosUser_uid:c.UniqueID}),function(b,c){var f=$("<span class='small-list-item small-job-item'>"+e.GetTemplatedJobPositionName(c.JobPosition_uid)+"</span>");$(f).click(function(){var b={User:a.selected,JobPositions:new Array(c)};g.NavigateToForm(g.FormDescriptions.posuserpermissions,b)}),d.append(f)})}),this.sizeItems()},i.prototype.sizeItems=function(){var a=this;if(!this.$editpanel)return;this.$editpanel.find(".small-location-item").css("width",""),this.$editpanel.find(".small-job-item").css("width","");var b=0;$.each(this.$editpanel.find(".small-location-item"),function(a,c){$(c).width()>b&&(b=$(c).width())}),this.$editpanel.find(".small-location-item").width(b),b=0,$.each(this.$editpanel.find(".small-job-item"),function(a,c){$(c).width()>b&&(b=$(c).width())}),this.$editpanel.find(".small-job-item").width(b)},i.prototype.updateSaygLabels=function(){if(!this.saygpanel||!this.$editpanel||!this.selected)return;this.selected.Organization_uid!="xxx_variable_xxx"&&this.$editpanel.find("#Organization_uid").text(e.GetTemplatedOrganizationName(this.selected.Organization_uid)),this.selected.Account_uid!="xxx_variable_xxx"&&(this.$editpanel.find("[name=Name]").val(e.GetTemplatedAccountName(this.selected.Account_uid)),this.$editpanel.find("[name=Email]").val(e.GetTemplatedAccountEmail(this.selected.Account_uid)))},h.ID="2058c129-411f-4ad8-bf66-6dc67e3741d8",h.UITemplate=a("text!../../../tmpl/forms/users.html"),h.Name="Users",h.InternalName="users",h.NameSpace="base.Backoffice.Users",h.Keywords="users,admin,user",h.CanActivate=!0,h.viewmodel=e.Users,h.InstanceClass=i,h.RequireModel(e.Accounts,p),h.RequireModel(e.Users,j),h.RequireModel(e.JobPositions,k),h.RequireModel(e.Locations,l),h.RequireModel(e.Organizations,m),h.RequireModel(e.PosUsers,o),h.RequireModel(e.PosUserJobPositions,n),i.prototype.Show=function(){this.loadLocations()},i.prototype.Load=function(d){this.state=d;var i=this;this.$contents=$(h.UITemplate),this.$editpanel=this.$contents.find("#edit_panel"),this.$mainLayout=this.$contents.layout({resizeWithWindow:!0,west__size:320,west__minSize:320,triggerEventsOnLoad:!1,resizeWhileDragging:!1,triggerEventsWhileDragging:!1,center__onresize:function(){i.listview.Resize(),i.saygpanel.Resize()}}),this.saygpanel=new f.SaveAsYouGoPanel(this.$editpanel,a("text!../../../tmpl/editpanels/users.html")),this.saygpanel.FieldChangedFunction=function(a,c,d){h.viewmodel.UpdateItems(i.saygpanel.selectedItems,c,function(){d(f.SaveAsYouGoStatus.Success)},function(a,c){d(f.SaveAsYouGoStatus.Failure),b.DialogError(c)})},this.saygpanel.editPanelTemplateFormatter={GetOrganizationName:e.GetTemplatedOrganizationName,GetAccountName:e.GetTemplatedAccountName,GetAccountEmail:e.GetTemplatedAccountEmail},this.listview=new f.ListView(this.$contents.find("#list_view"),e.Users,a("text!../../../tmpl/listview/templateListUser.html")),this.listview.SetState(this.state.ListViewState),this.listview.sortIndex=1,this.listview.sortAscending=!0,this.listview.fields=["Name","Email","OrganizationName"],this.listview.fieldCaptions=["Name","Email","Organization"],this.listview.FilterFunction=function(a,c){switch(c.toLowerCase()){case"name":return e.GetTemplatedAccountName(a.Account_uid);case"email":return e.GetTemplatedAccountEmail(a.Account_uid);case"organizationname":return e.GetTemplatedOrganizationName(a.Organization_uid);default:return b.GetNotatedValue(a,c)}},this.listview.itemTemplate=a("text!../../../tmpl/listview/templateListUser.html"),this.listview.itemTemplateFormatter={FullAddress:function(a){return b.FormatAddress(a)},GetOrganizationName:e.GetTemplatedOrganizationName,GetAccountName:e.GetTemplatedAccountName,GetAccountEmail:e.GetTemplatedAccountEmail},this.listview.SortFunction=function(a,c,d,f){var g=b.ToString(b.GetNotatedValue(a,d)).toString().toLowerCase(),h=b.ToString(b.GetNotatedValue(c,d)).toString().toLowerCase();switch(d.toLowerCase()){case"name":g=e.GetTemplatedAccountName(a.Account_uid),h=e.GetTemplatedAccountName(c.Account_uid);break;case"email":g=e.GetTemplatedAccountEmail(a.Account_uid),h=e.GetTemplatedAccountEmail(c.Account_uid);break;case"organizationname":g=e.GetTemplatedOrganizationName(a.Organization_uid),h=e.GetTemplatedOrganizationName(c.Organization_uid)}return f?g>h?1:-1:g<h?1:-1},this.listview.multiSelect=!0,this.listview.AddNew=function(a,c){var d={};b.AddNewWithOrganization(e,h.viewmodel,"New User","Which Organization would you like to create a new User for?",d,a,c)},this.listview.Delete=function(a,c,d){var e="these <b>"+i.listview.SelectedItems.length+"</b> users";i.listview.SelectedItems.length==1&&(e=" the <b>"+i.listview.SelectedItems[0].Name+"</b> user"),b.DialogConfirmYesNo("Are you sure you want to permanently delete "+e+"?","Confirm Delete",function(){h.viewmodel.DeleteItems(i.listview.SelectedItems,c,d)},d)},this.listview.SelectionChanged=function(a){i.selected=i.saygpanel.SetSelectedItems(a);if(c.IsEmptyObject(i.selected))return;i.loadLocations(),i.$editpanel.find("#jump_orgs").click(function(){var a=b.CreateSubFormLinkState(i.selected.Organization_uid);g.NavigateToForm(g.FormDescriptions.organizations,a)}),i.$editpanel.find("#jump_permissions").click(function(){var a={User:i.selected};g.NavigateToForm(g.FormDescriptions.posuserpermissions,a)}),i.$editpanel.find("#jump_bopermissions").click(function(){var a=b.CreateSubFormLinkState(e.Organizations.GetItems({UniqueID:i.selected.Organization_uid})[0].PrimaryOrgStructure_uid);g.NavigateToForm(g.FormDescriptions.bogroups,a)}),i.saygpanel.Resize()},this.listview.StateChanged=function(a){i.state.ListViewState=a,g.StateChanged(i)},this.listview.Load()},i.prototype.Resize=function(){this.$contents.css({width:"100%",height:"100%"}),this.$mainLayout.resizeAll(),this.listview.Resize(),this.sizeItems(),this.saygpanel.Resize()},h}),define("text!objects/../../tmpl/forms/weather.html",[],function(){return'<div>\r\n    <h3>The Week Ahead : <span name="weather_city" style="font-weight: bold;"></span>\r\n    </h3>\r\n    <input placeholder=\'Enter a zip code ...\' id="change_zip" type=\'text\'/>\r\n\r\n    <table cellpadding="4" style="padding:4px;font-size:12pt;font-weight: normal;width:100%;" id="forecast">\r\n        <thead>\r\n        <tr>\r\n            <th></th>\r\n            <th>Day</th>\r\n            <th>Low</th>\r\n            <th>High</th>\r\n            <th style="text-align: left;">Forecast</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody></tbody>\r\n        <tfoot>\r\n        <tr>\r\n            <td colspan="5"\r\n                style="border-bottom:none;text-align:right;font-size: 8pt;font-style:italic;font-weight: normal;">\r\n                <a target="_blank" href="http://www.weatherbug.com"><img src="img/WeatherbugLogo.png" alt="WeatherBug"/></a>\r\n            </td>\r\n        </tr>\r\n        </tfoot>\r\n    </table>\r\n</div>'}),define("objects/forms/weather",["require","core","objects/schema/form_classes","utilities","text!../../../tmpl/forms/weather.html"],function(a){function g(){}var b=a("core"),c=a("objects/schema/form_classes"),d=a("utilities"),e="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20location%3D{0}&format=json&callback=?",f=new c.FormDescription;f.ID="d6e2966a-049a-4f62-a545-eae56feb5938",f.UITemplate=a("text!../../../tmpl/forms/weather.html"),f.Name="Weather",f.InternalName="weather",f.NameSpace="extended.Tools.Weather",f.Keywords="weather,temperature,cold,hot,freezing,freeze,blizzard,ice,snow,rain,heat",f.CanActivate=!1,f.InstanceClass=g,g.prototype.Load=function(a){this.$contents=$("<div></div>")};var h=new c.Widget;return h.ID=f.ID+".0",h.Name="Weather",h.Icon="img/widgets/widget-weather.png",h.Load=function(a){this.state=a,this.$contents=$("<div></div>"),this.state.zipcode||(this.state.zipcode="44903"),this.loadWeather()},h.loadWeather=function(){var a=this,c=$("<div style='font-size:9pt;'></div>"),f=$("<input style='margin-bottom:12px;' placeholder='enter a zip code...'/>");f.change(function(){a.state.zipcode=$(this).val(),b.StateChanged(),a.loadWeather()}),c.append(f),$.getJSON(d.FormatString(e,a.state.zipcode),function(d){a.$contents.html("").append(c);var e=d.query.results.channel;c.append("<table></table>"),c.append("<div style='font-weight: bold;'>"+d.query.results.channel.item.title+"</div>"),c.append(d.query.results.channel.item.description),c.find("a").attr("target","_blank"),c.append("<img style='float:right;width:100px;padding-top:16px;' src='"+d.query.results.channel.image.url+"'/>"),b.WidgetContentsChanged()})},f.AddWidget(h),f}),require(["order!lib/jquery-ui-1.8.18.custom.min","order!plugins-modded/jquery.ui.selectmenu","order!lib/TriStateCheckbox","order!lib/jquery.tmpl","order!lib/jquery.autoresize","order!lib/jquery.titlealert","order!lib/jquery.event.drag-2.0.min","order!lib/jquery.layout","order!lib/jquery.mousewheel","order!lib/jquery.jscrollpane","order!lib/jquery.idle-timer"]),define("index",["require","core","domReady","objects/forms/about","objects/forms/accounts","objects/forms/bogroups","objects/forms/clock","objects/forms/conversations","objects/forms/debugging","objects/forms/docman","objects/forms/favorites","objects/forms/floorcharts","objects/forms/floorchart_editor","objects/forms/jobpositions","objects/forms/locations","objects/forms/managerslog","objects/forms/myaccount","objects/forms/networkstatus","objects/forms/organizations","objects/forms/posgroups","objects/forms/posuserpermissions","objects/forms/statsmap","objects/forms/structures","objects/forms/users","objects/forms/weather","objects/forms/widgetselector","objects/forms/test_dtm","objects/forms/test_dtm2","objects/forms/test_tyler"],function(a){var b=a("core"),c=a("domReady");c(function(){b.AddFormDescription(a("objects/forms/about")),b.AddFormDescription(a("objects/forms/accounts")),b.AddFormDescription(a("objects/forms/bogroups")),b.AddFormDescription(a("objects/forms/clock")),b.AddFormDescription(a("objects/forms/conversations")),b.AddFormDescription(a("objects/forms/debugging")),b.AddFormDescription(a("objects/forms/docman")),b.AddFormDescription(a("objects/forms/favorites")),b.AddFormDescription(a("objects/forms/floorcharts")),b.AddFormDescription(a("objects/forms/floorchart_editor")),b.AddFormDescription(a("objects/forms/jobpositions")),b.AddFormDescription(a("objects/forms/locations")),b.AddFormDescription(a("objects/forms/managerslog")),b.AddFormDescription(a("objects/forms/myaccount")),b.AddFormDescription(a("objects/forms/networkstatus")),b.AddFormDescription(a("objects/forms/organizations")),b.AddFormDescription(a("objects/forms/posgroups")),b.AddFormDescription(a("objects/forms/posuserpermissions")),b.AddFormDescription(a("objects/forms/statsmap")),b.AddFormDescription(a("objects/forms/structures")),b.AddFormDescription(a("objects/forms/users")),b.AddFormDescription(a("objects/forms/weather")),b.AddFormDescription(a("objects/forms/widgetselector")),b.AddFormDescription(a("objects/forms/test_dtm")),b.AddFormDescription(a("objects/forms/test_dtm2")),b.AddFormDescription(a("objects/forms/test_tyler")),b.Start()})}),define("async",[],function(){function c(a){var b,c;b=document.createElement("script"),b.type="text/javascript",b.async=!0,b.src=a,c=document.getElementsByTagName("script")[0],c.parentNode.insertBefore(b,c)}function d(b,c){var d=/!(.+)/,e=b.replace(d,""),f=d.test(b)?b.replace(/.+!/,""):a;return e+=e.indexOf("?")<0?"?":"&",e+f+"="+c}function e(){return b+=1,"__async_req_"+b+"__"}var a="callback",b=0;return{load:function(a,b,f,g){if(g.isBuild)f(null);else{var h=e();window[h]=f,c(d(a,h))}}}})